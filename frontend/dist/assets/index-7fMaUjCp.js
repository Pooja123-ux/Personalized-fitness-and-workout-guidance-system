var u3=Object.defineProperty;var d3=(t,e,n)=>e in t?u3(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var qe=(t,e,n)=>d3(t,typeof e!="symbol"?e+"":e,n);function UN(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();var di=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function GN(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function h3(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var r=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return t[s]}})}),n}var HN={exports:{}},Km={},KN={exports:{}},tt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wd=Symbol.for("react.element"),f3=Symbol.for("react.portal"),p3=Symbol.for("react.fragment"),m3=Symbol.for("react.strict_mode"),g3=Symbol.for("react.profiler"),x3=Symbol.for("react.provider"),y3=Symbol.for("react.context"),b3=Symbol.for("react.forward_ref"),v3=Symbol.for("react.suspense"),w3=Symbol.for("react.memo"),k3=Symbol.for("react.lazy"),cS=Symbol.iterator;function C3(t){return t===null||typeof t!="object"?null:(t=cS&&t[cS]||t["@@iterator"],typeof t=="function"?t:null)}var XN={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qN=Object.assign,YN={};function Ec(t,e,n){this.props=t,this.context=e,this.refs=YN,this.updater=n||XN}Ec.prototype.isReactComponent={};Ec.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ec.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function QN(){}QN.prototype=Ec.prototype;function C1(t,e,n){this.props=t,this.context=e,this.refs=YN,this.updater=n||XN}var S1=C1.prototype=new QN;S1.constructor=C1;qN(S1,Ec.prototype);S1.isPureReactComponent=!0;var uS=Array.isArray,JN=Object.prototype.hasOwnProperty,I1={current:null},ZN={key:!0,ref:!0,__self:!0,__source:!0};function eT(t,e,n){var s,r={},i=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)JN.call(e,s)&&!ZN.hasOwnProperty(s)&&(r[s]=e[s]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(s in a=t.defaultProps,a)r[s]===void 0&&(r[s]=a[s]);return{$$typeof:Wd,type:t,key:i,ref:o,props:r,_owner:I1.current}}function S3(t,e){return{$$typeof:Wd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function $1(t){return typeof t=="object"&&t!==null&&t.$$typeof===Wd}function I3(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var dS=/\/+/g;function y0(t,e){return typeof t=="object"&&t!==null&&t.key!=null?I3(""+t.key):e.toString(36)}function gp(t,e,n,s,r){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Wd:case f3:o=!0}}if(o)return o=t,r=r(o),t=s===""?"."+y0(o,0):s,uS(r)?(n="",t!=null&&(n=t.replace(dS,"$&/")+"/"),gp(r,e,n,"",function(c){return c})):r!=null&&($1(r)&&(r=S3(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(dS,"$&/")+"/")+t)),e.push(r)),1;if(o=0,s=s===""?".":s+":",uS(t))for(var a=0;a<t.length;a++){i=t[a];var l=s+y0(i,a);o+=gp(i,e,n,l,r)}else if(l=C3(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=s+y0(i,a++),o+=gp(i,e,n,l,r);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Nf(t,e,n){if(t==null)return t;var s=[],r=0;return gp(t,s,"","",function(i){return e.call(n,i,r++)}),s}function $3(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var us={current:null},xp={transition:null},N3={ReactCurrentDispatcher:us,ReactCurrentBatchConfig:xp,ReactCurrentOwner:I1};function tT(){throw Error("act(...) is not supported in production builds of React.")}tt.Children={map:Nf,forEach:function(t,e,n){Nf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Nf(t,function(){e++}),e},toArray:function(t){return Nf(t,function(e){return e})||[]},only:function(t){if(!$1(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};tt.Component=Ec;tt.Fragment=p3;tt.Profiler=g3;tt.PureComponent=C1;tt.StrictMode=m3;tt.Suspense=v3;tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N3;tt.act=tT;tt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=qN({},t.props),r=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=I1.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)JN.call(e,l)&&!ZN.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];s.children=a}return{$$typeof:Wd,type:t.type,key:r,ref:i,props:s,_owner:o}};tt.createContext=function(t){return t={$$typeof:y3,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:x3,_context:t},t.Consumer=t};tt.createElement=eT;tt.createFactory=function(t){var e=eT.bind(null,t);return e.type=t,e};tt.createRef=function(){return{current:null}};tt.forwardRef=function(t){return{$$typeof:b3,render:t}};tt.isValidElement=$1;tt.lazy=function(t){return{$$typeof:k3,_payload:{_status:-1,_result:t},_init:$3}};tt.memo=function(t,e){return{$$typeof:w3,type:t,compare:e===void 0?null:e}};tt.startTransition=function(t){var e=xp.transition;xp.transition={};try{t()}finally{xp.transition=e}};tt.unstable_act=tT;tt.useCallback=function(t,e){return us.current.useCallback(t,e)};tt.useContext=function(t){return us.current.useContext(t)};tt.useDebugValue=function(){};tt.useDeferredValue=function(t){return us.current.useDeferredValue(t)};tt.useEffect=function(t,e){return us.current.useEffect(t,e)};tt.useId=function(){return us.current.useId()};tt.useImperativeHandle=function(t,e,n){return us.current.useImperativeHandle(t,e,n)};tt.useInsertionEffect=function(t,e){return us.current.useInsertionEffect(t,e)};tt.useLayoutEffect=function(t,e){return us.current.useLayoutEffect(t,e)};tt.useMemo=function(t,e){return us.current.useMemo(t,e)};tt.useReducer=function(t,e,n){return us.current.useReducer(t,e,n)};tt.useRef=function(t){return us.current.useRef(t)};tt.useState=function(t){return us.current.useState(t)};tt.useSyncExternalStore=function(t,e,n){return us.current.useSyncExternalStore(t,e,n)};tt.useTransition=function(){return us.current.useTransition()};tt.version="18.3.1";KN.exports=tt;var J=KN.exports;const nT=GN(J),T3=UN({__proto__:null,default:nT},[J]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E3=J,_3=Symbol.for("react.element"),R3=Symbol.for("react.fragment"),A3=Object.prototype.hasOwnProperty,D3=E3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,F3={key:!0,ref:!0,__self:!0,__source:!0};function sT(t,e,n){var s,r={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)A3.call(e,s)&&!F3.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:_3,type:t,key:i,ref:o,props:r,_owner:D3.current}}Km.Fragment=R3;Km.jsx=sT;Km.jsxs=sT;HN.exports=Km;var S=HN.exports,rT={exports:{}},Us={},iT={exports:{}},oT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(M,X){var Z=M.length;M.push(X);e:for(;0<Z;){var oe=Z-1>>>1,ae=M[oe];if(0<r(ae,X))M[oe]=X,M[Z]=ae,Z=oe;else break e}}function n(M){return M.length===0?null:M[0]}function s(M){if(M.length===0)return null;var X=M[0],Z=M.pop();if(Z!==X){M[0]=Z;e:for(var oe=0,ae=M.length,ce=ae>>>1;oe<ce;){var pe=2*(oe+1)-1,fe=M[pe],be=pe+1,Ne=M[be];if(0>r(fe,Z))be<ae&&0>r(Ne,fe)?(M[oe]=Ne,M[be]=Z,oe=be):(M[oe]=fe,M[pe]=Z,oe=pe);else if(be<ae&&0>r(Ne,Z))M[oe]=Ne,M[be]=Z,oe=be;else break e}}return X}function r(M,X){var Z=M.sortIndex-X.sortIndex;return Z!==0?Z:M.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(M){for(var X=n(c);X!==null;){if(X.callback===null)s(c);else if(X.startTime<=M)s(c),X.sortIndex=X.expirationTime,e(l,X);else break;X=n(c)}}function w(M){if(m=!1,v(M),!p)if(n(l)!==null)p=!0,Y(C);else{var X=n(c);X!==null&&te(w,X.startTime-M)}}function C(M,X){p=!1,m&&(m=!1,x(N),N=-1),f=!0;var Z=h;try{for(v(X),d=n(l);d!==null&&(!(d.expirationTime>X)||M&&!O());){var oe=d.callback;if(typeof oe=="function"){d.callback=null,h=d.priorityLevel;var ae=oe(d.expirationTime<=X);X=t.unstable_now(),typeof ae=="function"?d.callback=ae:d===n(l)&&s(l),v(X)}else s(l);d=n(l)}if(d!==null)var ce=!0;else{var pe=n(c);pe!==null&&te(w,pe.startTime-X),ce=!1}return ce}finally{d=null,h=Z,f=!1}}var $=!1,T=null,N=-1,_=5,A=-1;function O(){return!(t.unstable_now()-A<_)}function W(){if(T!==null){var M=t.unstable_now();A=M;var X=!0;try{X=T(!0,M)}finally{X?G():($=!1,T=null)}}else $=!1}var G;if(typeof b=="function")G=function(){b(W)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,U=q.port2;q.port1.onmessage=W,G=function(){U.postMessage(null)}}else G=function(){g(W,0)};function Y(M){T=M,$||($=!0,G())}function te(M,X){N=g(function(){M(t.unstable_now())},X)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(M){M.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,Y(C))},t.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<M?Math.floor(1e3/M):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(M){switch(h){case 1:case 2:case 3:var X=3;break;default:X=h}var Z=h;h=X;try{return M()}finally{h=Z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(M,X){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var Z=h;h=M;try{return X()}finally{h=Z}},t.unstable_scheduleCallback=function(M,X,Z){var oe=t.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?oe+Z:oe):Z=oe,M){case 1:var ae=-1;break;case 2:ae=250;break;case 5:ae=1073741823;break;case 4:ae=1e4;break;default:ae=5e3}return ae=Z+ae,M={id:u++,callback:X,priorityLevel:M,startTime:Z,expirationTime:ae,sortIndex:-1},Z>oe?(M.sortIndex=Z,e(c,M),n(l)===null&&M===n(c)&&(m?(x(N),N=-1):m=!0,te(w,Z-oe))):(M.sortIndex=ae,e(l,M),p||f||(p=!0,Y(C))),M},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(M){var X=h;return function(){var Z=h;h=X;try{return M.apply(this,arguments)}finally{h=Z}}}})(oT);iT.exports=oT;var O3=iT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P3=J,js=O3;function ye(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var aT=new Set,sd={};function al(t,e){ac(t,e),ac(t+"Capture",e)}function ac(t,e){for(sd[t]=e,t=0;t<e.length;t++)aT.add(e[t])}var Bi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Iy=Object.prototype.hasOwnProperty,L3=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,hS={},fS={};function M3(t){return Iy.call(fS,t)?!0:Iy.call(hS,t)?!1:L3.test(t)?fS[t]=!0:(hS[t]=!0,!1)}function z3(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function B3(t,e,n,s){if(e===null||typeof e>"u"||z3(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ds(t,e,n,s,r,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var On={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){On[t]=new ds(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];On[e]=new ds(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){On[t]=new ds(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){On[t]=new ds(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){On[t]=new ds(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){On[t]=new ds(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){On[t]=new ds(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){On[t]=new ds(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){On[t]=new ds(t,5,!1,t.toLowerCase(),null,!1,!1)});var N1=/[\-:]([a-z])/g;function T1(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(N1,T1);On[e]=new ds(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(N1,T1);On[e]=new ds(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(N1,T1);On[e]=new ds(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){On[t]=new ds(t,1,!1,t.toLowerCase(),null,!1,!1)});On.xlinkHref=new ds("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){On[t]=new ds(t,1,!1,t.toLowerCase(),null,!0,!0)});function E1(t,e,n,s){var r=On.hasOwnProperty(e)?On[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(B3(e,n,r,s)&&(n=null),s||r===null?M3(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var Xi=P3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Tf=Symbol.for("react.element"),Ol=Symbol.for("react.portal"),Pl=Symbol.for("react.fragment"),_1=Symbol.for("react.strict_mode"),$y=Symbol.for("react.profiler"),lT=Symbol.for("react.provider"),cT=Symbol.for("react.context"),R1=Symbol.for("react.forward_ref"),Ny=Symbol.for("react.suspense"),Ty=Symbol.for("react.suspense_list"),A1=Symbol.for("react.memo"),oo=Symbol.for("react.lazy"),uT=Symbol.for("react.offscreen"),pS=Symbol.iterator;function cu(t){return t===null||typeof t!="object"?null:(t=pS&&t[pS]||t["@@iterator"],typeof t=="function"?t:null)}var Ut=Object.assign,b0;function Nu(t){if(b0===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);b0=e&&e[1]||""}return`
`+b0+t}var v0=!1;function w0(t,e){if(!t||v0)return"";v0=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var s=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){s=c}t.call(e.prototype)}else{try{throw Error()}catch(c){s=c}t()}}catch(c){if(c&&s&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),i=s.stack.split(`
`),o=r.length-1,a=i.length-1;1<=o&&0<=a&&r[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==i[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{v0=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Nu(t):""}function W3(t){switch(t.tag){case 5:return Nu(t.type);case 16:return Nu("Lazy");case 13:return Nu("Suspense");case 19:return Nu("SuspenseList");case 0:case 2:case 15:return t=w0(t.type,!1),t;case 11:return t=w0(t.type.render,!1),t;case 1:return t=w0(t.type,!0),t;default:return""}}function Ey(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Pl:return"Fragment";case Ol:return"Portal";case $y:return"Profiler";case _1:return"StrictMode";case Ny:return"Suspense";case Ty:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case cT:return(t.displayName||"Context")+".Consumer";case lT:return(t._context.displayName||"Context")+".Provider";case R1:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case A1:return e=t.displayName||null,e!==null?e:Ey(t.type)||"Memo";case oo:e=t._payload,t=t._init;try{return Ey(t(e))}catch{}}return null}function j3(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ey(e);case 8:return e===_1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Po(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function dT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function V3(t){var e=dT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ef(t){t._valueTracker||(t._valueTracker=V3(t))}function hT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=dT(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function Pp(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function _y(t,e){var n=e.checked;return Ut({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function mS(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=Po(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function fT(t,e){e=e.checked,e!=null&&E1(t,"checked",e,!1)}function Ry(t,e){fT(t,e);var n=Po(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ay(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ay(t,e.type,Po(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function gS(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ay(t,e,n){(e!=="number"||Pp(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Tu=Array.isArray;function ql(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+Po(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function Dy(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ye(91));return Ut({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function xS(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ye(92));if(Tu(n)){if(1<n.length)throw Error(ye(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Po(n)}}function pT(t,e){var n=Po(e.value),s=Po(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function yS(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function mT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Fy(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?mT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var _f,gT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(_f=_f||document.createElement("div"),_f.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=_f.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function rd(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Bu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},U3=["Webkit","ms","Moz","O"];Object.keys(Bu).forEach(function(t){U3.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Bu[e]=Bu[t]})});function xT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Bu.hasOwnProperty(t)&&Bu[t]?(""+e).trim():e+"px"}function yT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=xT(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var G3=Ut({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Oy(t,e){if(e){if(G3[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ye(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ye(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ye(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ye(62))}}function Py(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ly=null;function D1(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var My=null,Yl=null,Ql=null;function bS(t){if(t=Ud(t)){if(typeof My!="function")throw Error(ye(280));var e=t.stateNode;e&&(e=Jm(e),My(t.stateNode,t.type,e))}}function bT(t){Yl?Ql?Ql.push(t):Ql=[t]:Yl=t}function vT(){if(Yl){var t=Yl,e=Ql;if(Ql=Yl=null,bS(t),e)for(t=0;t<e.length;t++)bS(e[t])}}function wT(t,e){return t(e)}function kT(){}var k0=!1;function CT(t,e,n){if(k0)return t(e,n);k0=!0;try{return wT(t,e,n)}finally{k0=!1,(Yl!==null||Ql!==null)&&(kT(),vT())}}function id(t,e){var n=t.stateNode;if(n===null)return null;var s=Jm(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ye(231,e,typeof n));return n}var zy=!1;if(Bi)try{var uu={};Object.defineProperty(uu,"passive",{get:function(){zy=!0}}),window.addEventListener("test",uu,uu),window.removeEventListener("test",uu,uu)}catch{zy=!1}function H3(t,e,n,s,r,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Wu=!1,Lp=null,Mp=!1,By=null,K3={onError:function(t){Wu=!0,Lp=t}};function X3(t,e,n,s,r,i,o,a,l){Wu=!1,Lp=null,H3.apply(K3,arguments)}function q3(t,e,n,s,r,i,o,a,l){if(X3.apply(this,arguments),Wu){if(Wu){var c=Lp;Wu=!1,Lp=null}else throw Error(ye(198));Mp||(Mp=!0,By=c)}}function ll(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function ST(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function vS(t){if(ll(t)!==t)throw Error(ye(188))}function Y3(t){var e=t.alternate;if(!e){if(e=ll(t),e===null)throw Error(ye(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return vS(r),t;if(i===s)return vS(r),e;i=i.sibling}throw Error(ye(188))}if(n.return!==s.return)n=r,s=i;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,s=i;break}if(a===s){o=!0,s=r,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,s=r;break}if(a===s){o=!0,s=i,n=r;break}a=a.sibling}if(!o)throw Error(ye(189))}}if(n.alternate!==s)throw Error(ye(190))}if(n.tag!==3)throw Error(ye(188));return n.stateNode.current===n?t:e}function IT(t){return t=Y3(t),t!==null?$T(t):null}function $T(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=$T(t);if(e!==null)return e;t=t.sibling}return null}var NT=js.unstable_scheduleCallback,wS=js.unstable_cancelCallback,Q3=js.unstable_shouldYield,J3=js.unstable_requestPaint,Zt=js.unstable_now,Z3=js.unstable_getCurrentPriorityLevel,F1=js.unstable_ImmediatePriority,TT=js.unstable_UserBlockingPriority,zp=js.unstable_NormalPriority,ez=js.unstable_LowPriority,ET=js.unstable_IdlePriority,Xm=null,hi=null;function tz(t){if(hi&&typeof hi.onCommitFiberRoot=="function")try{hi.onCommitFiberRoot(Xm,t,void 0,(t.current.flags&128)===128)}catch{}}var Rr=Math.clz32?Math.clz32:rz,nz=Math.log,sz=Math.LN2;function rz(t){return t>>>=0,t===0?32:31-(nz(t)/sz|0)|0}var Rf=64,Af=4194304;function Eu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Bp(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?s=Eu(a):(i&=o,i!==0&&(s=Eu(i)))}else o=n&~r,o!==0?s=Eu(o):i!==0&&(s=Eu(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-Rr(e),r=1<<n,s|=t[n],e&=~r;return s}function iz(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oz(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Rr(i),a=1<<o,l=r[o];l===-1?(!(a&n)||a&s)&&(r[o]=iz(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function Wy(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function _T(){var t=Rf;return Rf<<=1,!(Rf&4194240)&&(Rf=64),t}function C0(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function jd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Rr(e),t[e]=n}function az(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Rr(n),i=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~i}}function O1(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-Rr(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var yt=0;function RT(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var AT,P1,DT,FT,OT,jy=!1,Df=[],ko=null,Co=null,So=null,od=new Map,ad=new Map,co=[],lz="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kS(t,e){switch(t){case"focusin":case"focusout":ko=null;break;case"dragenter":case"dragleave":Co=null;break;case"mouseover":case"mouseout":So=null;break;case"pointerover":case"pointerout":od.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ad.delete(e.pointerId)}}function du(t,e,n,s,r,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},e!==null&&(e=Ud(e),e!==null&&P1(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function cz(t,e,n,s,r){switch(e){case"focusin":return ko=du(ko,t,e,n,s,r),!0;case"dragenter":return Co=du(Co,t,e,n,s,r),!0;case"mouseover":return So=du(So,t,e,n,s,r),!0;case"pointerover":var i=r.pointerId;return od.set(i,du(od.get(i)||null,t,e,n,s,r)),!0;case"gotpointercapture":return i=r.pointerId,ad.set(i,du(ad.get(i)||null,t,e,n,s,r)),!0}return!1}function PT(t){var e=Ca(t.target);if(e!==null){var n=ll(e);if(n!==null){if(e=n.tag,e===13){if(e=ST(n),e!==null){t.blockedOn=e,OT(t.priority,function(){DT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function yp(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Vy(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);Ly=s,n.target.dispatchEvent(s),Ly=null}else return e=Ud(n),e!==null&&P1(e),t.blockedOn=n,!1;e.shift()}return!0}function CS(t,e,n){yp(t)&&n.delete(e)}function uz(){jy=!1,ko!==null&&yp(ko)&&(ko=null),Co!==null&&yp(Co)&&(Co=null),So!==null&&yp(So)&&(So=null),od.forEach(CS),ad.forEach(CS)}function hu(t,e){t.blockedOn===e&&(t.blockedOn=null,jy||(jy=!0,js.unstable_scheduleCallback(js.unstable_NormalPriority,uz)))}function ld(t){function e(r){return hu(r,t)}if(0<Df.length){hu(Df[0],t);for(var n=1;n<Df.length;n++){var s=Df[n];s.blockedOn===t&&(s.blockedOn=null)}}for(ko!==null&&hu(ko,t),Co!==null&&hu(Co,t),So!==null&&hu(So,t),od.forEach(e),ad.forEach(e),n=0;n<co.length;n++)s=co[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<co.length&&(n=co[0],n.blockedOn===null);)PT(n),n.blockedOn===null&&co.shift()}var Jl=Xi.ReactCurrentBatchConfig,Wp=!0;function dz(t,e,n,s){var r=yt,i=Jl.transition;Jl.transition=null;try{yt=1,L1(t,e,n,s)}finally{yt=r,Jl.transition=i}}function hz(t,e,n,s){var r=yt,i=Jl.transition;Jl.transition=null;try{yt=4,L1(t,e,n,s)}finally{yt=r,Jl.transition=i}}function L1(t,e,n,s){if(Wp){var r=Vy(t,e,n,s);if(r===null)D0(t,e,s,jp,n),kS(t,s);else if(cz(r,t,e,n,s))s.stopPropagation();else if(kS(t,s),e&4&&-1<lz.indexOf(t)){for(;r!==null;){var i=Ud(r);if(i!==null&&AT(i),i=Vy(t,e,n,s),i===null&&D0(t,e,s,jp,n),i===r)break;r=i}r!==null&&s.stopPropagation()}else D0(t,e,s,null,n)}}var jp=null;function Vy(t,e,n,s){if(jp=null,t=D1(s),t=Ca(t),t!==null)if(e=ll(t),e===null)t=null;else if(n=e.tag,n===13){if(t=ST(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return jp=t,null}function LT(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Z3()){case F1:return 1;case TT:return 4;case zp:case ez:return 16;case ET:return 536870912;default:return 16}default:return 16}}var ho=null,M1=null,bp=null;function MT(){if(bp)return bp;var t,e=M1,n=e.length,s,r="value"in ho?ho.value:ho.textContent,i=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(s=1;s<=o&&e[n-s]===r[i-s];s++);return bp=r.slice(t,1<s?1-s:void 0)}function vp(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ff(){return!0}function SS(){return!1}function Gs(t){function e(n,s,r,i,o){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ff:SS,this.isPropagationStopped=SS,this}return Ut(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ff)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ff)},persist:function(){},isPersistent:Ff}),e}var _c={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},z1=Gs(_c),Vd=Ut({},_c,{view:0,detail:0}),fz=Gs(Vd),S0,I0,fu,qm=Ut({},Vd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:B1,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==fu&&(fu&&t.type==="mousemove"?(S0=t.screenX-fu.screenX,I0=t.screenY-fu.screenY):I0=S0=0,fu=t),S0)},movementY:function(t){return"movementY"in t?t.movementY:I0}}),IS=Gs(qm),pz=Ut({},qm,{dataTransfer:0}),mz=Gs(pz),gz=Ut({},Vd,{relatedTarget:0}),$0=Gs(gz),xz=Ut({},_c,{animationName:0,elapsedTime:0,pseudoElement:0}),yz=Gs(xz),bz=Ut({},_c,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),vz=Gs(bz),wz=Ut({},_c,{data:0}),$S=Gs(wz),kz={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cz={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sz={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Iz(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Sz[t])?!!e[t]:!1}function B1(){return Iz}var $z=Ut({},Vd,{key:function(t){if(t.key){var e=kz[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=vp(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Cz[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:B1,charCode:function(t){return t.type==="keypress"?vp(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?vp(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Nz=Gs($z),Tz=Ut({},qm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),NS=Gs(Tz),Ez=Ut({},Vd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:B1}),_z=Gs(Ez),Rz=Ut({},_c,{propertyName:0,elapsedTime:0,pseudoElement:0}),Az=Gs(Rz),Dz=Ut({},qm,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Fz=Gs(Dz),Oz=[9,13,27,32],W1=Bi&&"CompositionEvent"in window,ju=null;Bi&&"documentMode"in document&&(ju=document.documentMode);var Pz=Bi&&"TextEvent"in window&&!ju,zT=Bi&&(!W1||ju&&8<ju&&11>=ju),TS=" ",ES=!1;function BT(t,e){switch(t){case"keyup":return Oz.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function WT(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ll=!1;function Lz(t,e){switch(t){case"compositionend":return WT(e);case"keypress":return e.which!==32?null:(ES=!0,TS);case"textInput":return t=e.data,t===TS&&ES?null:t;default:return null}}function Mz(t,e){if(Ll)return t==="compositionend"||!W1&&BT(t,e)?(t=MT(),bp=M1=ho=null,Ll=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return zT&&e.locale!=="ko"?null:e.data;default:return null}}var zz={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _S(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!zz[t.type]:e==="textarea"}function jT(t,e,n,s){bT(s),e=Vp(e,"onChange"),0<e.length&&(n=new z1("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var Vu=null,cd=null;function Bz(t){ZT(t,0)}function Ym(t){var e=Bl(t);if(hT(e))return t}function Wz(t,e){if(t==="change")return e}var VT=!1;if(Bi){var N0;if(Bi){var T0="oninput"in document;if(!T0){var RS=document.createElement("div");RS.setAttribute("oninput","return;"),T0=typeof RS.oninput=="function"}N0=T0}else N0=!1;VT=N0&&(!document.documentMode||9<document.documentMode)}function AS(){Vu&&(Vu.detachEvent("onpropertychange",UT),cd=Vu=null)}function UT(t){if(t.propertyName==="value"&&Ym(cd)){var e=[];jT(e,cd,t,D1(t)),CT(Bz,e)}}function jz(t,e,n){t==="focusin"?(AS(),Vu=e,cd=n,Vu.attachEvent("onpropertychange",UT)):t==="focusout"&&AS()}function Vz(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ym(cd)}function Uz(t,e){if(t==="click")return Ym(e)}function Gz(t,e){if(t==="input"||t==="change")return Ym(e)}function Hz(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Lr=typeof Object.is=="function"?Object.is:Hz;function ud(t,e){if(Lr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!Iy.call(e,r)||!Lr(t[r],e[r]))return!1}return!0}function DS(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function FS(t,e){var n=DS(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=DS(n)}}function GT(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?GT(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function HT(){for(var t=window,e=Pp();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Pp(t.document)}return e}function j1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Kz(t){var e=HT(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&GT(n.ownerDocument.documentElement,n)){if(s!==null&&j1(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!t.extend&&i>s&&(r=s,s=i,i=r),r=FS(n,i);var o=FS(n,s);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Xz=Bi&&"documentMode"in document&&11>=document.documentMode,Ml=null,Uy=null,Uu=null,Gy=!1;function OS(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Gy||Ml==null||Ml!==Pp(s)||(s=Ml,"selectionStart"in s&&j1(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Uu&&ud(Uu,s)||(Uu=s,s=Vp(Uy,"onSelect"),0<s.length&&(e=new z1("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=Ml)))}function Of(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var zl={animationend:Of("Animation","AnimationEnd"),animationiteration:Of("Animation","AnimationIteration"),animationstart:Of("Animation","AnimationStart"),transitionend:Of("Transition","TransitionEnd")},E0={},KT={};Bi&&(KT=document.createElement("div").style,"AnimationEvent"in window||(delete zl.animationend.animation,delete zl.animationiteration.animation,delete zl.animationstart.animation),"TransitionEvent"in window||delete zl.transitionend.transition);function Qm(t){if(E0[t])return E0[t];if(!zl[t])return t;var e=zl[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in KT)return E0[t]=e[n];return t}var XT=Qm("animationend"),qT=Qm("animationiteration"),YT=Qm("animationstart"),QT=Qm("transitionend"),JT=new Map,PS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ho(t,e){JT.set(t,e),al(e,[t])}for(var _0=0;_0<PS.length;_0++){var R0=PS[_0],qz=R0.toLowerCase(),Yz=R0[0].toUpperCase()+R0.slice(1);Ho(qz,"on"+Yz)}Ho(XT,"onAnimationEnd");Ho(qT,"onAnimationIteration");Ho(YT,"onAnimationStart");Ho("dblclick","onDoubleClick");Ho("focusin","onFocus");Ho("focusout","onBlur");Ho(QT,"onTransitionEnd");ac("onMouseEnter",["mouseout","mouseover"]);ac("onMouseLeave",["mouseout","mouseover"]);ac("onPointerEnter",["pointerout","pointerover"]);ac("onPointerLeave",["pointerout","pointerover"]);al("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));al("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));al("onBeforeInput",["compositionend","keypress","textInput","paste"]);al("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));al("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));al("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _u="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qz=new Set("cancel close invalid load scroll toggle".split(" ").concat(_u));function LS(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,q3(s,e,void 0,t),t.currentTarget=null}function ZT(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var o=s.length-1;0<=o;o--){var a=s[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&r.isPropagationStopped())break e;LS(r,a,c),i=l}else for(o=0;o<s.length;o++){if(a=s[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&r.isPropagationStopped())break e;LS(r,a,c),i=l}}}if(Mp)throw t=By,Mp=!1,By=null,t}function Ft(t,e){var n=e[Yy];n===void 0&&(n=e[Yy]=new Set);var s=t+"__bubble";n.has(s)||(eE(e,t,2,!1),n.add(s))}function A0(t,e,n){var s=0;e&&(s|=4),eE(n,t,s,e)}var Pf="_reactListening"+Math.random().toString(36).slice(2);function dd(t){if(!t[Pf]){t[Pf]=!0,aT.forEach(function(n){n!=="selectionchange"&&(Qz.has(n)||A0(n,!1,t),A0(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Pf]||(e[Pf]=!0,A0("selectionchange",!1,e))}}function eE(t,e,n,s){switch(LT(e)){case 1:var r=dz;break;case 4:r=hz;break;default:r=L1}n=r.bind(null,e,n,t),r=void 0,!zy||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function D0(t,e,n,s,r){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var a=s.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=s.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Ca(a),o===null)return;if(l=o.tag,l===5||l===6){s=i=o;continue e}a=a.parentNode}}s=s.return}CT(function(){var c=i,u=D1(n),d=[];e:{var h=JT.get(t);if(h!==void 0){var f=z1,p=t;switch(t){case"keypress":if(vp(n)===0)break e;case"keydown":case"keyup":f=Nz;break;case"focusin":p="focus",f=$0;break;case"focusout":p="blur",f=$0;break;case"beforeblur":case"afterblur":f=$0;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=IS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=mz;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=_z;break;case XT:case qT:case YT:f=yz;break;case QT:f=Az;break;case"scroll":f=fz;break;case"wheel":f=Fz;break;case"copy":case"cut":case"paste":f=vz;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=NS}var m=(e&4)!==0,g=!m&&t==="scroll",x=m?h!==null?h+"Capture":null:h;m=[];for(var b=c,v;b!==null;){v=b;var w=v.stateNode;if(v.tag===5&&w!==null&&(v=w,x!==null&&(w=id(b,x),w!=null&&m.push(hd(b,w,v)))),g)break;b=b.return}0<m.length&&(h=new f(h,p,null,n,u),d.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==Ly&&(p=n.relatedTarget||n.fromElement)&&(Ca(p)||p[Wi]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=c,p=p?Ca(p):null,p!==null&&(g=ll(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(m=IS,w="onMouseLeave",x="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(m=NS,w="onPointerLeave",x="onPointerEnter",b="pointer"),g=f==null?h:Bl(f),v=p==null?h:Bl(p),h=new m(w,b+"leave",f,n,u),h.target=g,h.relatedTarget=v,w=null,Ca(u)===c&&(m=new m(x,b+"enter",p,n,u),m.target=v,m.relatedTarget=g,w=m),g=w,f&&p)t:{for(m=f,x=p,b=0,v=m;v;v=Nl(v))b++;for(v=0,w=x;w;w=Nl(w))v++;for(;0<b-v;)m=Nl(m),b--;for(;0<v-b;)x=Nl(x),v--;for(;b--;){if(m===x||x!==null&&m===x.alternate)break t;m=Nl(m),x=Nl(x)}m=null}else m=null;f!==null&&MS(d,h,f,m,!1),p!==null&&g!==null&&MS(d,g,p,m,!0)}}e:{if(h=c?Bl(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var C=Wz;else if(_S(h))if(VT)C=Gz;else{C=Vz;var $=jz}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(C=Uz);if(C&&(C=C(t,c))){jT(d,C,n,u);break e}$&&$(t,h,c),t==="focusout"&&($=h._wrapperState)&&$.controlled&&h.type==="number"&&Ay(h,"number",h.value)}switch($=c?Bl(c):window,t){case"focusin":(_S($)||$.contentEditable==="true")&&(Ml=$,Uy=c,Uu=null);break;case"focusout":Uu=Uy=Ml=null;break;case"mousedown":Gy=!0;break;case"contextmenu":case"mouseup":case"dragend":Gy=!1,OS(d,n,u);break;case"selectionchange":if(Xz)break;case"keydown":case"keyup":OS(d,n,u)}var T;if(W1)e:{switch(t){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Ll?BT(t,n)&&(N="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(N="onCompositionStart");N&&(zT&&n.locale!=="ko"&&(Ll||N!=="onCompositionStart"?N==="onCompositionEnd"&&Ll&&(T=MT()):(ho=u,M1="value"in ho?ho.value:ho.textContent,Ll=!0)),$=Vp(c,N),0<$.length&&(N=new $S(N,t,null,n,u),d.push({event:N,listeners:$}),T?N.data=T:(T=WT(n),T!==null&&(N.data=T)))),(T=Pz?Lz(t,n):Mz(t,n))&&(c=Vp(c,"onBeforeInput"),0<c.length&&(u=new $S("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=T))}ZT(d,e)})}function hd(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Vp(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=id(t,n),i!=null&&s.unshift(hd(t,i,r)),i=id(t,e),i!=null&&s.push(hd(t,i,r))),t=t.return}return s}function Nl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function MS(t,e,n,s,r){for(var i=e._reactName,o=[];n!==null&&n!==s;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===s)break;a.tag===5&&c!==null&&(a=c,r?(l=id(n,i),l!=null&&o.unshift(hd(n,l,a))):r||(l=id(n,i),l!=null&&o.push(hd(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var Jz=/\r\n?/g,Zz=/\u0000|\uFFFD/g;function zS(t){return(typeof t=="string"?t:""+t).replace(Jz,`
`).replace(Zz,"")}function Lf(t,e,n){if(e=zS(e),zS(t)!==e&&n)throw Error(ye(425))}function Up(){}var Hy=null,Ky=null;function Xy(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var qy=typeof setTimeout=="function"?setTimeout:void 0,e4=typeof clearTimeout=="function"?clearTimeout:void 0,BS=typeof Promise=="function"?Promise:void 0,t4=typeof queueMicrotask=="function"?queueMicrotask:typeof BS<"u"?function(t){return BS.resolve(null).then(t).catch(n4)}:qy;function n4(t){setTimeout(function(){throw t})}function F0(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),ld(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);ld(e)}function Io(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function WS(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Rc=Math.random().toString(36).slice(2),ci="__reactFiber$"+Rc,fd="__reactProps$"+Rc,Wi="__reactContainer$"+Rc,Yy="__reactEvents$"+Rc,s4="__reactListeners$"+Rc,r4="__reactHandles$"+Rc;function Ca(t){var e=t[ci];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Wi]||n[ci]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=WS(t);t!==null;){if(n=t[ci])return n;t=WS(t)}return e}t=n,n=t.parentNode}return null}function Ud(t){return t=t[ci]||t[Wi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Bl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ye(33))}function Jm(t){return t[fd]||null}var Qy=[],Wl=-1;function Ko(t){return{current:t}}function Pt(t){0>Wl||(t.current=Qy[Wl],Qy[Wl]=null,Wl--)}function It(t,e){Wl++,Qy[Wl]=t.current,t.current=e}var Lo={},Qn=Ko(Lo),Is=Ko(!1),za=Lo;function lc(t,e){var n=t.type.contextTypes;if(!n)return Lo;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in n)r[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function $s(t){return t=t.childContextTypes,t!=null}function Gp(){Pt(Is),Pt(Qn)}function jS(t,e,n){if(Qn.current!==Lo)throw Error(ye(168));It(Qn,e),It(Is,n)}function tE(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(ye(108,j3(t)||"Unknown",r));return Ut({},n,s)}function Hp(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Lo,za=Qn.current,It(Qn,t),It(Is,Is.current),!0}function VS(t,e,n){var s=t.stateNode;if(!s)throw Error(ye(169));n?(t=tE(t,e,za),s.__reactInternalMemoizedMergedChildContext=t,Pt(Is),Pt(Qn),It(Qn,t)):Pt(Is),It(Is,n)}var _i=null,Zm=!1,O0=!1;function nE(t){_i===null?_i=[t]:_i.push(t)}function i4(t){Zm=!0,nE(t)}function Xo(){if(!O0&&_i!==null){O0=!0;var t=0,e=yt;try{var n=_i;for(yt=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}_i=null,Zm=!1}catch(r){throw _i!==null&&(_i=_i.slice(t+1)),NT(F1,Xo),r}finally{yt=e,O0=!1}}return null}var jl=[],Vl=0,Kp=null,Xp=0,tr=[],nr=0,Ba=null,Fi=1,Oi="";function ma(t,e){jl[Vl++]=Xp,jl[Vl++]=Kp,Kp=t,Xp=e}function sE(t,e,n){tr[nr++]=Fi,tr[nr++]=Oi,tr[nr++]=Ba,Ba=t;var s=Fi;t=Oi;var r=32-Rr(s)-1;s&=~(1<<r),n+=1;var i=32-Rr(e)+r;if(30<i){var o=r-r%5;i=(s&(1<<o)-1).toString(32),s>>=o,r-=o,Fi=1<<32-Rr(e)+r|n<<r|s,Oi=i+t}else Fi=1<<i|n<<r|s,Oi=t}function V1(t){t.return!==null&&(ma(t,1),sE(t,1,0))}function U1(t){for(;t===Kp;)Kp=jl[--Vl],jl[Vl]=null,Xp=jl[--Vl],jl[Vl]=null;for(;t===Ba;)Ba=tr[--nr],tr[nr]=null,Oi=tr[--nr],tr[nr]=null,Fi=tr[--nr],tr[nr]=null}var zs=null,Ls=null,zt=!1,$r=null;function rE(t,e){var n=rr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function US(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,zs=t,Ls=Io(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,zs=t,Ls=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ba!==null?{id:Fi,overflow:Oi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=rr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,zs=t,Ls=null,!0):!1;default:return!1}}function Jy(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Zy(t){if(zt){var e=Ls;if(e){var n=e;if(!US(t,e)){if(Jy(t))throw Error(ye(418));e=Io(n.nextSibling);var s=zs;e&&US(t,e)?rE(s,n):(t.flags=t.flags&-4097|2,zt=!1,zs=t)}}else{if(Jy(t))throw Error(ye(418));t.flags=t.flags&-4097|2,zt=!1,zs=t}}}function GS(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;zs=t}function Mf(t){if(t!==zs)return!1;if(!zt)return GS(t),zt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Xy(t.type,t.memoizedProps)),e&&(e=Ls)){if(Jy(t))throw iE(),Error(ye(418));for(;e;)rE(t,e),e=Io(e.nextSibling)}if(GS(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ye(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ls=Io(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ls=null}}else Ls=zs?Io(t.stateNode.nextSibling):null;return!0}function iE(){for(var t=Ls;t;)t=Io(t.nextSibling)}function cc(){Ls=zs=null,zt=!1}function G1(t){$r===null?$r=[t]:$r.push(t)}var o4=Xi.ReactCurrentBatchConfig;function pu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ye(309));var s=n.stateNode}if(!s)throw Error(ye(147,t));var r=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=r.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(ye(284));if(!n._owner)throw Error(ye(290,t))}return t}function zf(t,e){throw t=Object.prototype.toString.call(e),Error(ye(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function HS(t){var e=t._init;return e(t._payload)}function oE(t){function e(x,b){if(t){var v=x.deletions;v===null?(x.deletions=[b],x.flags|=16):v.push(b)}}function n(x,b){if(!t)return null;for(;b!==null;)e(x,b),b=b.sibling;return null}function s(x,b){for(x=new Map;b!==null;)b.key!==null?x.set(b.key,b):x.set(b.index,b),b=b.sibling;return x}function r(x,b){return x=Eo(x,b),x.index=0,x.sibling=null,x}function i(x,b,v){return x.index=v,t?(v=x.alternate,v!==null?(v=v.index,v<b?(x.flags|=2,b):v):(x.flags|=2,b)):(x.flags|=1048576,b)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function a(x,b,v,w){return b===null||b.tag!==6?(b=j0(v,x.mode,w),b.return=x,b):(b=r(b,v),b.return=x,b)}function l(x,b,v,w){var C=v.type;return C===Pl?u(x,b,v.props.children,w,v.key):b!==null&&(b.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===oo&&HS(C)===b.type)?(w=r(b,v.props),w.ref=pu(x,b,v),w.return=x,w):(w=Np(v.type,v.key,v.props,null,x.mode,w),w.ref=pu(x,b,v),w.return=x,w)}function c(x,b,v,w){return b===null||b.tag!==4||b.stateNode.containerInfo!==v.containerInfo||b.stateNode.implementation!==v.implementation?(b=V0(v,x.mode,w),b.return=x,b):(b=r(b,v.children||[]),b.return=x,b)}function u(x,b,v,w,C){return b===null||b.tag!==7?(b=Da(v,x.mode,w,C),b.return=x,b):(b=r(b,v),b.return=x,b)}function d(x,b,v){if(typeof b=="string"&&b!==""||typeof b=="number")return b=j0(""+b,x.mode,v),b.return=x,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Tf:return v=Np(b.type,b.key,b.props,null,x.mode,v),v.ref=pu(x,null,b),v.return=x,v;case Ol:return b=V0(b,x.mode,v),b.return=x,b;case oo:var w=b._init;return d(x,w(b._payload),v)}if(Tu(b)||cu(b))return b=Da(b,x.mode,v,null),b.return=x,b;zf(x,b)}return null}function h(x,b,v,w){var C=b!==null?b.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return C!==null?null:a(x,b,""+v,w);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Tf:return v.key===C?l(x,b,v,w):null;case Ol:return v.key===C?c(x,b,v,w):null;case oo:return C=v._init,h(x,b,C(v._payload),w)}if(Tu(v)||cu(v))return C!==null?null:u(x,b,v,w,null);zf(x,v)}return null}function f(x,b,v,w,C){if(typeof w=="string"&&w!==""||typeof w=="number")return x=x.get(v)||null,a(b,x,""+w,C);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Tf:return x=x.get(w.key===null?v:w.key)||null,l(b,x,w,C);case Ol:return x=x.get(w.key===null?v:w.key)||null,c(b,x,w,C);case oo:var $=w._init;return f(x,b,v,$(w._payload),C)}if(Tu(w)||cu(w))return x=x.get(v)||null,u(b,x,w,C,null);zf(b,w)}return null}function p(x,b,v,w){for(var C=null,$=null,T=b,N=b=0,_=null;T!==null&&N<v.length;N++){T.index>N?(_=T,T=null):_=T.sibling;var A=h(x,T,v[N],w);if(A===null){T===null&&(T=_);break}t&&T&&A.alternate===null&&e(x,T),b=i(A,b,N),$===null?C=A:$.sibling=A,$=A,T=_}if(N===v.length)return n(x,T),zt&&ma(x,N),C;if(T===null){for(;N<v.length;N++)T=d(x,v[N],w),T!==null&&(b=i(T,b,N),$===null?C=T:$.sibling=T,$=T);return zt&&ma(x,N),C}for(T=s(x,T);N<v.length;N++)_=f(T,x,N,v[N],w),_!==null&&(t&&_.alternate!==null&&T.delete(_.key===null?N:_.key),b=i(_,b,N),$===null?C=_:$.sibling=_,$=_);return t&&T.forEach(function(O){return e(x,O)}),zt&&ma(x,N),C}function m(x,b,v,w){var C=cu(v);if(typeof C!="function")throw Error(ye(150));if(v=C.call(v),v==null)throw Error(ye(151));for(var $=C=null,T=b,N=b=0,_=null,A=v.next();T!==null&&!A.done;N++,A=v.next()){T.index>N?(_=T,T=null):_=T.sibling;var O=h(x,T,A.value,w);if(O===null){T===null&&(T=_);break}t&&T&&O.alternate===null&&e(x,T),b=i(O,b,N),$===null?C=O:$.sibling=O,$=O,T=_}if(A.done)return n(x,T),zt&&ma(x,N),C;if(T===null){for(;!A.done;N++,A=v.next())A=d(x,A.value,w),A!==null&&(b=i(A,b,N),$===null?C=A:$.sibling=A,$=A);return zt&&ma(x,N),C}for(T=s(x,T);!A.done;N++,A=v.next())A=f(T,x,N,A.value,w),A!==null&&(t&&A.alternate!==null&&T.delete(A.key===null?N:A.key),b=i(A,b,N),$===null?C=A:$.sibling=A,$=A);return t&&T.forEach(function(W){return e(x,W)}),zt&&ma(x,N),C}function g(x,b,v,w){if(typeof v=="object"&&v!==null&&v.type===Pl&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Tf:e:{for(var C=v.key,$=b;$!==null;){if($.key===C){if(C=v.type,C===Pl){if($.tag===7){n(x,$.sibling),b=r($,v.props.children),b.return=x,x=b;break e}}else if($.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===oo&&HS(C)===$.type){n(x,$.sibling),b=r($,v.props),b.ref=pu(x,$,v),b.return=x,x=b;break e}n(x,$);break}else e(x,$);$=$.sibling}v.type===Pl?(b=Da(v.props.children,x.mode,w,v.key),b.return=x,x=b):(w=Np(v.type,v.key,v.props,null,x.mode,w),w.ref=pu(x,b,v),w.return=x,x=w)}return o(x);case Ol:e:{for($=v.key;b!==null;){if(b.key===$)if(b.tag===4&&b.stateNode.containerInfo===v.containerInfo&&b.stateNode.implementation===v.implementation){n(x,b.sibling),b=r(b,v.children||[]),b.return=x,x=b;break e}else{n(x,b);break}else e(x,b);b=b.sibling}b=V0(v,x.mode,w),b.return=x,x=b}return o(x);case oo:return $=v._init,g(x,b,$(v._payload),w)}if(Tu(v))return p(x,b,v,w);if(cu(v))return m(x,b,v,w);zf(x,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,b!==null&&b.tag===6?(n(x,b.sibling),b=r(b,v),b.return=x,x=b):(n(x,b),b=j0(v,x.mode,w),b.return=x,x=b),o(x)):n(x,b)}return g}var uc=oE(!0),aE=oE(!1),qp=Ko(null),Yp=null,Ul=null,H1=null;function K1(){H1=Ul=Yp=null}function X1(t){var e=qp.current;Pt(qp),t._currentValue=e}function eb(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function Zl(t,e){Yp=t,H1=Ul=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ws=!0),t.firstContext=null)}function hr(t){var e=t._currentValue;if(H1!==t)if(t={context:t,memoizedValue:e,next:null},Ul===null){if(Yp===null)throw Error(ye(308));Ul=t,Yp.dependencies={lanes:0,firstContext:t}}else Ul=Ul.next=t;return e}var Sa=null;function q1(t){Sa===null?Sa=[t]:Sa.push(t)}function lE(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,q1(e)):(n.next=r.next,r.next=n),e.interleaved=n,ji(t,s)}function ji(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ao=!1;function Y1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function cE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Mi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function $o(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,ct&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,ji(t,n)}return r=s.interleaved,r===null?(e.next=e,q1(s)):(e.next=r.next,r.next=e),s.interleaved=e,ji(t,n)}function wp(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,O1(t,n)}}function KS(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?r=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?r=i=e:i=i.next=e}else r=i=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Qp(t,e,n,s){var r=t.updateQueue;ao=!1;var i=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var d=r.baseState;o=0,u=c=l=null,a=i;do{var h=a.lane,f=a.eventTime;if((s&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(h=e,f=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=Ut({},d,h);break e;case 2:ao=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=r.effects,h===null?r.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,o|=h;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;h=a,a=h.next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}while(!0);if(u===null&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);ja|=o,t.lanes=o,t.memoizedState=d}}function XS(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(ye(191,r));r.call(s)}}}var Gd={},fi=Ko(Gd),pd=Ko(Gd),md=Ko(Gd);function Ia(t){if(t===Gd)throw Error(ye(174));return t}function Q1(t,e){switch(It(md,e),It(pd,t),It(fi,Gd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Fy(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Fy(e,t)}Pt(fi),It(fi,e)}function dc(){Pt(fi),Pt(pd),Pt(md)}function uE(t){Ia(md.current);var e=Ia(fi.current),n=Fy(e,t.type);e!==n&&(It(pd,t),It(fi,n))}function J1(t){pd.current===t&&(Pt(fi),Pt(pd))}var jt=Ko(0);function Jp(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var P0=[];function Z1(){for(var t=0;t<P0.length;t++)P0[t]._workInProgressVersionPrimary=null;P0.length=0}var kp=Xi.ReactCurrentDispatcher,L0=Xi.ReactCurrentBatchConfig,Wa=0,Vt=null,xn=null,Cn=null,Zp=!1,Gu=!1,gd=0,a4=0;function jn(){throw Error(ye(321))}function ev(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Lr(t[n],e[n]))return!1;return!0}function tv(t,e,n,s,r,i){if(Wa=i,Vt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,kp.current=t===null||t.memoizedState===null?d4:h4,t=n(s,r),Gu){i=0;do{if(Gu=!1,gd=0,25<=i)throw Error(ye(301));i+=1,Cn=xn=null,e.updateQueue=null,kp.current=f4,t=n(s,r)}while(Gu)}if(kp.current=em,e=xn!==null&&xn.next!==null,Wa=0,Cn=xn=Vt=null,Zp=!1,e)throw Error(ye(300));return t}function nv(){var t=gd!==0;return gd=0,t}function ti(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Cn===null?Vt.memoizedState=Cn=t:Cn=Cn.next=t,Cn}function fr(){if(xn===null){var t=Vt.alternate;t=t!==null?t.memoizedState:null}else t=xn.next;var e=Cn===null?Vt.memoizedState:Cn.next;if(e!==null)Cn=e,xn=t;else{if(t===null)throw Error(ye(310));xn=t,t={memoizedState:xn.memoizedState,baseState:xn.baseState,baseQueue:xn.baseQueue,queue:xn.queue,next:null},Cn===null?Vt.memoizedState=Cn=t:Cn=Cn.next=t}return Cn}function xd(t,e){return typeof e=="function"?e(t):e}function M0(t){var e=fr(),n=e.queue;if(n===null)throw Error(ye(311));n.lastRenderedReducer=t;var s=xn,r=s.baseQueue,i=n.pending;if(i!==null){if(r!==null){var o=r.next;r.next=i.next,i.next=o}s.baseQueue=r=i,n.pending=null}if(r!==null){i=r.next,s=s.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((Wa&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),s=c.hasEagerState?c.eagerState:t(s,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=s):l=l.next=d,Vt.lanes|=u,ja|=u}c=c.next}while(c!==null&&c!==i);l===null?o=s:l.next=a,Lr(s,e.memoizedState)||(ws=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=l,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do i=r.lane,Vt.lanes|=i,ja|=i,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function z0(t){var e=fr(),n=e.queue;if(n===null)throw Error(ye(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,i=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do i=t(i,o.action),o=o.next;while(o!==r);Lr(i,e.memoizedState)||(ws=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,s]}function dE(){}function hE(t,e){var n=Vt,s=fr(),r=e(),i=!Lr(s.memoizedState,r);if(i&&(s.memoizedState=r,ws=!0),s=s.queue,sv(mE.bind(null,n,s,t),[t]),s.getSnapshot!==e||i||Cn!==null&&Cn.memoizedState.tag&1){if(n.flags|=2048,yd(9,pE.bind(null,n,s,r,e),void 0,null),$n===null)throw Error(ye(349));Wa&30||fE(n,e,r)}return r}function fE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Vt.updateQueue,e===null?(e={lastEffect:null,stores:null},Vt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function pE(t,e,n,s){e.value=n,e.getSnapshot=s,gE(e)&&xE(t)}function mE(t,e,n){return n(function(){gE(e)&&xE(t)})}function gE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Lr(t,n)}catch{return!0}}function xE(t){var e=ji(t,1);e!==null&&Ar(e,t,1,-1)}function qS(t){var e=ti();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xd,lastRenderedState:t},e.queue=t,t=t.dispatch=u4.bind(null,Vt,t),[e.memoizedState,t]}function yd(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=Vt.updateQueue,e===null?(e={lastEffect:null,stores:null},Vt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function yE(){return fr().memoizedState}function Cp(t,e,n,s){var r=ti();Vt.flags|=t,r.memoizedState=yd(1|e,n,void 0,s===void 0?null:s)}function eg(t,e,n,s){var r=fr();s=s===void 0?null:s;var i=void 0;if(xn!==null){var o=xn.memoizedState;if(i=o.destroy,s!==null&&ev(s,o.deps)){r.memoizedState=yd(e,n,i,s);return}}Vt.flags|=t,r.memoizedState=yd(1|e,n,i,s)}function YS(t,e){return Cp(8390656,8,t,e)}function sv(t,e){return eg(2048,8,t,e)}function bE(t,e){return eg(4,2,t,e)}function vE(t,e){return eg(4,4,t,e)}function wE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function kE(t,e,n){return n=n!=null?n.concat([t]):null,eg(4,4,wE.bind(null,e,t),n)}function rv(){}function CE(t,e){var n=fr();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&ev(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function SE(t,e){var n=fr();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&ev(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function IE(t,e,n){return Wa&21?(Lr(n,e)||(n=_T(),Vt.lanes|=n,ja|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ws=!0),t.memoizedState=n)}function l4(t,e){var n=yt;yt=n!==0&&4>n?n:4,t(!0);var s=L0.transition;L0.transition={};try{t(!1),e()}finally{yt=n,L0.transition=s}}function $E(){return fr().memoizedState}function c4(t,e,n){var s=To(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},NE(t))TE(e,n);else if(n=lE(t,e,n,s),n!==null){var r=os();Ar(n,t,s,r),EE(n,e,s)}}function u4(t,e,n){var s=To(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(NE(t))TE(e,r);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(r.hasEagerState=!0,r.eagerState=a,Lr(a,o)){var l=e.interleaved;l===null?(r.next=r,q1(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=lE(t,e,r,s),n!==null&&(r=os(),Ar(n,t,s,r),EE(n,e,s))}}function NE(t){var e=t.alternate;return t===Vt||e!==null&&e===Vt}function TE(t,e){Gu=Zp=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function EE(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,O1(t,n)}}var em={readContext:hr,useCallback:jn,useContext:jn,useEffect:jn,useImperativeHandle:jn,useInsertionEffect:jn,useLayoutEffect:jn,useMemo:jn,useReducer:jn,useRef:jn,useState:jn,useDebugValue:jn,useDeferredValue:jn,useTransition:jn,useMutableSource:jn,useSyncExternalStore:jn,useId:jn,unstable_isNewReconciler:!1},d4={readContext:hr,useCallback:function(t,e){return ti().memoizedState=[t,e===void 0?null:e],t},useContext:hr,useEffect:YS,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Cp(4194308,4,wE.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Cp(4194308,4,t,e)},useInsertionEffect:function(t,e){return Cp(4,2,t,e)},useMemo:function(t,e){var n=ti();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=ti();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=c4.bind(null,Vt,t),[s.memoizedState,t]},useRef:function(t){var e=ti();return t={current:t},e.memoizedState=t},useState:qS,useDebugValue:rv,useDeferredValue:function(t){return ti().memoizedState=t},useTransition:function(){var t=qS(!1),e=t[0];return t=l4.bind(null,t[1]),ti().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=Vt,r=ti();if(zt){if(n===void 0)throw Error(ye(407));n=n()}else{if(n=e(),$n===null)throw Error(ye(349));Wa&30||fE(s,e,n)}r.memoizedState=n;var i={value:n,getSnapshot:e};return r.queue=i,YS(mE.bind(null,s,i,t),[t]),s.flags|=2048,yd(9,pE.bind(null,s,i,n,e),void 0,null),n},useId:function(){var t=ti(),e=$n.identifierPrefix;if(zt){var n=Oi,s=Fi;n=(s&~(1<<32-Rr(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=gd++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=a4++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},h4={readContext:hr,useCallback:CE,useContext:hr,useEffect:sv,useImperativeHandle:kE,useInsertionEffect:bE,useLayoutEffect:vE,useMemo:SE,useReducer:M0,useRef:yE,useState:function(){return M0(xd)},useDebugValue:rv,useDeferredValue:function(t){var e=fr();return IE(e,xn.memoizedState,t)},useTransition:function(){var t=M0(xd)[0],e=fr().memoizedState;return[t,e]},useMutableSource:dE,useSyncExternalStore:hE,useId:$E,unstable_isNewReconciler:!1},f4={readContext:hr,useCallback:CE,useContext:hr,useEffect:sv,useImperativeHandle:kE,useInsertionEffect:bE,useLayoutEffect:vE,useMemo:SE,useReducer:z0,useRef:yE,useState:function(){return z0(xd)},useDebugValue:rv,useDeferredValue:function(t){var e=fr();return xn===null?e.memoizedState=t:IE(e,xn.memoizedState,t)},useTransition:function(){var t=z0(xd)[0],e=fr().memoizedState;return[t,e]},useMutableSource:dE,useSyncExternalStore:hE,useId:$E,unstable_isNewReconciler:!1};function Sr(t,e){if(t&&t.defaultProps){e=Ut({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function tb(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Ut({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var tg={isMounted:function(t){return(t=t._reactInternals)?ll(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=os(),r=To(t),i=Mi(s,r);i.payload=e,n!=null&&(i.callback=n),e=$o(t,i,r),e!==null&&(Ar(e,t,r,s),wp(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=os(),r=To(t),i=Mi(s,r);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=$o(t,i,r),e!==null&&(Ar(e,t,r,s),wp(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=os(),s=To(t),r=Mi(n,s);r.tag=2,e!=null&&(r.callback=e),e=$o(t,r,s),e!==null&&(Ar(e,t,s,n),wp(e,t,s))}};function QS(t,e,n,s,r,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,o):e.prototype&&e.prototype.isPureReactComponent?!ud(n,s)||!ud(r,i):!0}function _E(t,e,n){var s=!1,r=Lo,i=e.contextType;return typeof i=="object"&&i!==null?i=hr(i):(r=$s(e)?za:Qn.current,s=e.contextTypes,i=(s=s!=null)?lc(t,r):Lo),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=tg,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=i),e}function JS(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&tg.enqueueReplaceState(e,e.state,null)}function nb(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},Y1(t);var i=e.contextType;typeof i=="object"&&i!==null?r.context=hr(i):(i=$s(e)?za:Qn.current,r.context=lc(t,i)),r.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(tb(t,e,i,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&tg.enqueueReplaceState(r,r.state,null),Qp(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function hc(t,e){try{var n="",s=e;do n+=W3(s),s=s.return;while(s);var r=n}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:r,digest:null}}function B0(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function sb(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var p4=typeof WeakMap=="function"?WeakMap:Map;function RE(t,e,n){n=Mi(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){nm||(nm=!0,fb=s),sb(t,e)},n}function AE(t,e,n){n=Mi(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){sb(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){sb(t,e),typeof s!="function"&&(No===null?No=new Set([this]):No.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function ZS(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new p4;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=T4.bind(null,t,e,n),e.then(t,t))}function e2(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function t2(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Mi(-1,1),e.tag=2,$o(n,e,1))),n.lanes|=1),t)}var m4=Xi.ReactCurrentOwner,ws=!1;function ns(t,e,n,s){e.child=t===null?aE(e,null,n,s):uc(e,t.child,n,s)}function n2(t,e,n,s,r){n=n.render;var i=e.ref;return Zl(e,r),s=tv(t,e,n,s,i,r),n=nv(),t!==null&&!ws?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Vi(t,e,r)):(zt&&n&&V1(e),e.flags|=1,ns(t,e,s,r),e.child)}function s2(t,e,n,s,r){if(t===null){var i=n.type;return typeof i=="function"&&!hv(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,DE(t,e,i,s,r)):(t=Np(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&r)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:ud,n(o,s)&&t.ref===e.ref)return Vi(t,e,r)}return e.flags|=1,t=Eo(i,s),t.ref=e.ref,t.return=e,e.child=t}function DE(t,e,n,s,r){if(t!==null){var i=t.memoizedProps;if(ud(i,s)&&t.ref===e.ref)if(ws=!1,e.pendingProps=s=i,(t.lanes&r)!==0)t.flags&131072&&(ws=!0);else return e.lanes=t.lanes,Vi(t,e,r)}return rb(t,e,n,s,r)}function FE(t,e,n){var s=e.pendingProps,r=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},It(Hl,Os),Os|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,It(Hl,Os),Os|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,It(Hl,Os),Os|=s}else i!==null?(s=i.baseLanes|n,e.memoizedState=null):s=n,It(Hl,Os),Os|=s;return ns(t,e,r,n),e.child}function OE(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function rb(t,e,n,s,r){var i=$s(n)?za:Qn.current;return i=lc(e,i),Zl(e,r),n=tv(t,e,n,s,i,r),s=nv(),t!==null&&!ws?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Vi(t,e,r)):(zt&&s&&V1(e),e.flags|=1,ns(t,e,n,r),e.child)}function r2(t,e,n,s,r){if($s(n)){var i=!0;Hp(e)}else i=!1;if(Zl(e,r),e.stateNode===null)Sp(t,e),_E(e,n,s),nb(e,n,s,r),s=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=hr(c):(c=$s(n)?za:Qn.current,c=lc(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==s||l!==c)&&JS(e,o,s,c),ao=!1;var h=e.memoizedState;o.state=h,Qp(e,s,o,r),l=e.memoizedState,a!==s||h!==l||Is.current||ao?(typeof u=="function"&&(tb(e,n,u,s),l=e.memoizedState),(a=ao||QS(e,n,a,s,h,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),o.props=s,o.state=l,o.context=c,s=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,cE(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Sr(e.type,a),o.props=c,d=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=hr(l):(l=$s(n)?za:Qn.current,l=lc(e,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||h!==l)&&JS(e,o,s,l),ao=!1,h=e.memoizedState,o.state=h,Qp(e,s,o,r);var p=e.memoizedState;a!==d||h!==p||Is.current||ao?(typeof f=="function"&&(tb(e,n,f,s),p=e.memoizedState),(c=ao||QS(e,n,c,s,h,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=p),o.props=s,o.state=p,o.context=l,s=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),s=!1)}return ib(t,e,n,s,i,r)}function ib(t,e,n,s,r,i){OE(t,e);var o=(e.flags&128)!==0;if(!s&&!o)return r&&VS(e,n,!1),Vi(t,e,i);s=e.stateNode,m4.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&o?(e.child=uc(e,t.child,null,i),e.child=uc(e,null,a,i)):ns(t,e,a,i),e.memoizedState=s.state,r&&VS(e,n,!0),e.child}function PE(t){var e=t.stateNode;e.pendingContext?jS(t,e.pendingContext,e.pendingContext!==e.context):e.context&&jS(t,e.context,!1),Q1(t,e.containerInfo)}function i2(t,e,n,s,r){return cc(),G1(r),e.flags|=256,ns(t,e,n,s),e.child}var ob={dehydrated:null,treeContext:null,retryLane:0};function ab(t){return{baseLanes:t,cachePool:null,transitions:null}}function LE(t,e,n){var s=e.pendingProps,r=jt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),It(jt,r&1),t===null)return Zy(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,t=s.fallback,i?(s=e.mode,i=e.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=rg(o,s,0,null),t=Da(t,s,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=ab(n),e.memoizedState=ob,t):iv(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return g4(t,e,o,s,a,r,n);if(i){i=s.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:s.children};return!(o&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=Eo(r,l),s.subtreeFlags=r.subtreeFlags&14680064),a!==null?i=Eo(a,i):(i=Da(i,o,n,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,o=t.child.memoizedState,o=o===null?ab(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=ob,s}return i=t.child,t=i.sibling,s=Eo(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function iv(t,e){return e=rg({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Bf(t,e,n,s){return s!==null&&G1(s),uc(e,t.child,null,n),t=iv(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function g4(t,e,n,s,r,i,o){if(n)return e.flags&256?(e.flags&=-257,s=B0(Error(ye(422))),Bf(t,e,o,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,r=e.mode,s=rg({mode:"visible",children:s.children},r,0,null),i=Da(i,r,o,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&uc(e,t.child,null,o),e.child.memoizedState=ab(o),e.memoizedState=ob,i);if(!(e.mode&1))return Bf(t,e,o,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var a=s.dgst;return s=a,i=Error(ye(419)),s=B0(i,s,void 0),Bf(t,e,o,s)}if(a=(o&t.childLanes)!==0,ws||a){if(s=$n,s!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|o)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,ji(t,r),Ar(s,t,r,-1))}return dv(),s=B0(Error(ye(421))),Bf(t,e,o,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=E4.bind(null,t),r._reactRetry=e,null):(t=i.treeContext,Ls=Io(r.nextSibling),zs=e,zt=!0,$r=null,t!==null&&(tr[nr++]=Fi,tr[nr++]=Oi,tr[nr++]=Ba,Fi=t.id,Oi=t.overflow,Ba=e),e=iv(e,s.children),e.flags|=4096,e)}function o2(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),eb(t.return,e,n)}function W0(t,e,n,s,r){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=r)}function ME(t,e,n){var s=e.pendingProps,r=s.revealOrder,i=s.tail;if(ns(t,e,s.children,n),s=jt.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&o2(t,n,e);else if(t.tag===19)o2(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(It(jt,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&Jp(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),W0(e,!1,r,n,i);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Jp(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}W0(e,!0,n,null,i);break;case"together":W0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Sp(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Vi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ja|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ye(153));if(e.child!==null){for(t=e.child,n=Eo(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Eo(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function x4(t,e,n){switch(e.tag){case 3:PE(e),cc();break;case 5:uE(e);break;case 1:$s(e.type)&&Hp(e);break;case 4:Q1(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;It(qp,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(It(jt,jt.current&1),e.flags|=128,null):n&e.child.childLanes?LE(t,e,n):(It(jt,jt.current&1),t=Vi(t,e,n),t!==null?t.sibling:null);It(jt,jt.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return ME(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),It(jt,jt.current),s)break;return null;case 22:case 23:return e.lanes=0,FE(t,e,n)}return Vi(t,e,n)}var zE,lb,BE,WE;zE=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};lb=function(){};BE=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,Ia(fi.current);var i=null;switch(n){case"input":r=_y(t,r),s=_y(t,s),i=[];break;case"select":r=Ut({},r,{value:void 0}),s=Ut({},s,{value:void 0}),i=[];break;case"textarea":r=Dy(t,r),s=Dy(t,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=Up)}Oy(n,s);var o;n=null;for(c in r)if(!s.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(sd.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in s){var l=s[c];if(a=r!=null?r[c]:void 0,s.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(sd.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ft("scroll",t),i||a===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};WE=function(t,e,n,s){n!==s&&(e.flags|=4)};function mu(t,e){if(!zt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Vn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function y4(t,e,n){var s=e.pendingProps;switch(U1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vn(e),null;case 1:return $s(e.type)&&Gp(),Vn(e),null;case 3:return s=e.stateNode,dc(),Pt(Is),Pt(Qn),Z1(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(Mf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,$r!==null&&(gb($r),$r=null))),lb(t,e),Vn(e),null;case 5:J1(e);var r=Ia(md.current);if(n=e.type,t!==null&&e.stateNode!=null)BE(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(ye(166));return Vn(e),null}if(t=Ia(fi.current),Mf(e)){s=e.stateNode,n=e.type;var i=e.memoizedProps;switch(s[ci]=e,s[fd]=i,t=(e.mode&1)!==0,n){case"dialog":Ft("cancel",s),Ft("close",s);break;case"iframe":case"object":case"embed":Ft("load",s);break;case"video":case"audio":for(r=0;r<_u.length;r++)Ft(_u[r],s);break;case"source":Ft("error",s);break;case"img":case"image":case"link":Ft("error",s),Ft("load",s);break;case"details":Ft("toggle",s);break;case"input":mS(s,i),Ft("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},Ft("invalid",s);break;case"textarea":xS(s,i),Ft("invalid",s)}Oy(n,i),r=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?s.textContent!==a&&(i.suppressHydrationWarning!==!0&&Lf(s.textContent,a,t),r=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Lf(s.textContent,a,t),r=["children",""+a]):sd.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ft("scroll",s)}switch(n){case"input":Ef(s),gS(s,i,!0);break;case"textarea":Ef(s),yS(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=Up)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=mT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=o.createElement(n,{is:s.is}):(t=o.createElement(n),n==="select"&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,n),t[ci]=e,t[fd]=s,zE(t,e,!1,!1),e.stateNode=t;e:{switch(o=Py(n,s),n){case"dialog":Ft("cancel",t),Ft("close",t),r=s;break;case"iframe":case"object":case"embed":Ft("load",t),r=s;break;case"video":case"audio":for(r=0;r<_u.length;r++)Ft(_u[r],t);r=s;break;case"source":Ft("error",t),r=s;break;case"img":case"image":case"link":Ft("error",t),Ft("load",t),r=s;break;case"details":Ft("toggle",t),r=s;break;case"input":mS(t,s),r=_y(t,s),Ft("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=Ut({},s,{value:void 0}),Ft("invalid",t);break;case"textarea":xS(t,s),r=Dy(t,s),Ft("invalid",t);break;default:r=s}Oy(n,r),a=r;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?yT(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&gT(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&rd(t,l):typeof l=="number"&&rd(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(sd.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Ft("scroll",t):l!=null&&E1(t,i,l,o))}switch(n){case"input":Ef(t),gS(t,s,!1);break;case"textarea":Ef(t),yS(t);break;case"option":s.value!=null&&t.setAttribute("value",""+Po(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?ql(t,!!s.multiple,i,!1):s.defaultValue!=null&&ql(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=Up)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Vn(e),null;case 6:if(t&&e.stateNode!=null)WE(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(ye(166));if(n=Ia(md.current),Ia(fi.current),Mf(e)){if(s=e.stateNode,n=e.memoizedProps,s[ci]=e,(i=s.nodeValue!==n)&&(t=zs,t!==null))switch(t.tag){case 3:Lf(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Lf(s.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[ci]=e,e.stateNode=s}return Vn(e),null;case 13:if(Pt(jt),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(zt&&Ls!==null&&e.mode&1&&!(e.flags&128))iE(),cc(),e.flags|=98560,i=!1;else if(i=Mf(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(ye(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ye(317));i[ci]=e}else cc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Vn(e),i=!1}else $r!==null&&(gb($r),$r=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||jt.current&1?vn===0&&(vn=3):dv())),e.updateQueue!==null&&(e.flags|=4),Vn(e),null);case 4:return dc(),lb(t,e),t===null&&dd(e.stateNode.containerInfo),Vn(e),null;case 10:return X1(e.type._context),Vn(e),null;case 17:return $s(e.type)&&Gp(),Vn(e),null;case 19:if(Pt(jt),i=e.memoizedState,i===null)return Vn(e),null;if(s=(e.flags&128)!==0,o=i.rendering,o===null)if(s)mu(i,!1);else{if(vn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Jp(t),o!==null){for(e.flags|=128,mu(i,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)i=n,t=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return It(jt,jt.current&1|2),e.child}t=t.sibling}i.tail!==null&&Zt()>fc&&(e.flags|=128,s=!0,mu(i,!1),e.lanes=4194304)}else{if(!s)if(t=Jp(o),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),mu(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!zt)return Vn(e),null}else 2*Zt()-i.renderingStartTime>fc&&n!==1073741824&&(e.flags|=128,s=!0,mu(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Zt(),e.sibling=null,n=jt.current,It(jt,s?n&1|2:n&1),e):(Vn(e),null);case 22:case 23:return uv(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Os&1073741824&&(Vn(e),e.subtreeFlags&6&&(e.flags|=8192)):Vn(e),null;case 24:return null;case 25:return null}throw Error(ye(156,e.tag))}function b4(t,e){switch(U1(e),e.tag){case 1:return $s(e.type)&&Gp(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return dc(),Pt(Is),Pt(Qn),Z1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return J1(e),null;case 13:if(Pt(jt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ye(340));cc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Pt(jt),null;case 4:return dc(),null;case 10:return X1(e.type._context),null;case 22:case 23:return uv(),null;case 24:return null;default:return null}}var Wf=!1,Hn=!1,v4=typeof WeakSet=="function"?WeakSet:Set,Ee=null;function Gl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){Gt(t,e,s)}else n.current=null}function cb(t,e,n){try{n()}catch(s){Gt(t,e,s)}}var a2=!1;function w4(t,e){if(Hy=Wp,t=HT(),j1(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=t,h=null;t:for(;;){for(var f;d!==n||r!==0&&d.nodeType!==3||(a=o+r),d!==i||s!==0&&d.nodeType!==3||(l=o+s),d.nodeType===3&&(o+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===t)break t;if(h===n&&++c===r&&(a=o),h===i&&++u===s&&(l=o),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ky={focusedElem:t,selectionRange:n},Wp=!1,Ee=e;Ee!==null;)if(e=Ee,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ee=t;else for(;Ee!==null;){e=Ee;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,x=e.stateNode,b=x.getSnapshotBeforeUpdate(e.elementType===e.type?m:Sr(e.type,m),g);x.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ye(163))}}catch(w){Gt(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,Ee=t;break}Ee=e.return}return p=a2,a2=!1,p}function Hu(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var i=r.destroy;r.destroy=void 0,i!==void 0&&cb(e,n,i)}r=r.next}while(r!==s)}}function ng(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function ub(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function jE(t){var e=t.alternate;e!==null&&(t.alternate=null,jE(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ci],delete e[fd],delete e[Yy],delete e[s4],delete e[r4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function VE(t){return t.tag===5||t.tag===3||t.tag===4}function l2(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||VE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function db(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Up));else if(s!==4&&(t=t.child,t!==null))for(db(t,e,n),t=t.sibling;t!==null;)db(t,e,n),t=t.sibling}function hb(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(hb(t,e,n),t=t.sibling;t!==null;)hb(t,e,n),t=t.sibling}var Dn=null,Ir=!1;function to(t,e,n){for(n=n.child;n!==null;)UE(t,e,n),n=n.sibling}function UE(t,e,n){if(hi&&typeof hi.onCommitFiberUnmount=="function")try{hi.onCommitFiberUnmount(Xm,n)}catch{}switch(n.tag){case 5:Hn||Gl(n,e);case 6:var s=Dn,r=Ir;Dn=null,to(t,e,n),Dn=s,Ir=r,Dn!==null&&(Ir?(t=Dn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Dn.removeChild(n.stateNode));break;case 18:Dn!==null&&(Ir?(t=Dn,n=n.stateNode,t.nodeType===8?F0(t.parentNode,n):t.nodeType===1&&F0(t,n),ld(t)):F0(Dn,n.stateNode));break;case 4:s=Dn,r=Ir,Dn=n.stateNode.containerInfo,Ir=!0,to(t,e,n),Dn=s,Ir=r;break;case 0:case 11:case 14:case 15:if(!Hn&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&cb(n,e,o),r=r.next}while(r!==s)}to(t,e,n);break;case 1:if(!Hn&&(Gl(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){Gt(n,e,a)}to(t,e,n);break;case 21:to(t,e,n);break;case 22:n.mode&1?(Hn=(s=Hn)||n.memoizedState!==null,to(t,e,n),Hn=s):to(t,e,n);break;default:to(t,e,n)}}function c2(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new v4),e.forEach(function(s){var r=_4.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function wr(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Dn=a.stateNode,Ir=!1;break e;case 3:Dn=a.stateNode.containerInfo,Ir=!0;break e;case 4:Dn=a.stateNode.containerInfo,Ir=!0;break e}a=a.return}if(Dn===null)throw Error(ye(160));UE(i,o,r),Dn=null,Ir=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){Gt(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)GE(e,t),e=e.sibling}function GE(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(wr(e,t),Qr(t),s&4){try{Hu(3,t,t.return),ng(3,t)}catch(m){Gt(t,t.return,m)}try{Hu(5,t,t.return)}catch(m){Gt(t,t.return,m)}}break;case 1:wr(e,t),Qr(t),s&512&&n!==null&&Gl(n,n.return);break;case 5:if(wr(e,t),Qr(t),s&512&&n!==null&&Gl(n,n.return),t.flags&32){var r=t.stateNode;try{rd(r,"")}catch(m){Gt(t,t.return,m)}}if(s&4&&(r=t.stateNode,r!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&fT(r,i),Py(a,o);var c=Py(a,i);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?yT(r,d):u==="dangerouslySetInnerHTML"?gT(r,d):u==="children"?rd(r,d):E1(r,u,d,c)}switch(a){case"input":Ry(r,i);break;case"textarea":pT(r,i);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?ql(r,!!i.multiple,f,!1):h!==!!i.multiple&&(i.defaultValue!=null?ql(r,!!i.multiple,i.defaultValue,!0):ql(r,!!i.multiple,i.multiple?[]:"",!1))}r[fd]=i}catch(m){Gt(t,t.return,m)}}break;case 6:if(wr(e,t),Qr(t),s&4){if(t.stateNode===null)throw Error(ye(162));r=t.stateNode,i=t.memoizedProps;try{r.nodeValue=i}catch(m){Gt(t,t.return,m)}}break;case 3:if(wr(e,t),Qr(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{ld(e.containerInfo)}catch(m){Gt(t,t.return,m)}break;case 4:wr(e,t),Qr(t);break;case 13:wr(e,t),Qr(t),r=t.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(lv=Zt())),s&4&&c2(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Hn=(c=Hn)||u,wr(e,t),Hn=c):wr(e,t),Qr(t),s&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Ee=t,u=t.child;u!==null;){for(d=Ee=u;Ee!==null;){switch(h=Ee,f=h.child,h.tag){case 0:case 11:case 14:case 15:Hu(4,h,h.return);break;case 1:Gl(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){s=h,n=h.return;try{e=s,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Gt(s,n,m)}}break;case 5:Gl(h,h.return);break;case 22:if(h.memoizedState!==null){d2(d);continue}}f!==null?(f.return=h,Ee=f):d2(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{r=d.stateNode,c?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=xT("display",o))}catch(m){Gt(t,t.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){Gt(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:wr(e,t),Qr(t),s&4&&c2(t);break;case 21:break;default:wr(e,t),Qr(t)}}function Qr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(VE(n)){var s=n;break e}n=n.return}throw Error(ye(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(rd(r,""),s.flags&=-33);var i=l2(t);hb(t,i,r);break;case 3:case 4:var o=s.stateNode.containerInfo,a=l2(t);db(t,a,o);break;default:throw Error(ye(161))}}catch(l){Gt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function k4(t,e,n){Ee=t,HE(t)}function HE(t,e,n){for(var s=(t.mode&1)!==0;Ee!==null;){var r=Ee,i=r.child;if(r.tag===22&&s){var o=r.memoizedState!==null||Wf;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Hn;a=Wf;var c=Hn;if(Wf=o,(Hn=l)&&!c)for(Ee=r;Ee!==null;)o=Ee,l=o.child,o.tag===22&&o.memoizedState!==null?h2(r):l!==null?(l.return=o,Ee=l):h2(r);for(;i!==null;)Ee=i,HE(i),i=i.sibling;Ee=r,Wf=a,Hn=c}u2(t)}else r.subtreeFlags&8772&&i!==null?(i.return=r,Ee=i):u2(t)}}function u2(t){for(;Ee!==null;){var e=Ee;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Hn||ng(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Hn)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Sr(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&XS(e,i,s);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}XS(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&ld(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ye(163))}Hn||e.flags&512&&ub(e)}catch(h){Gt(e,e.return,h)}}if(e===t){Ee=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ee=n;break}Ee=e.return}}function d2(t){for(;Ee!==null;){var e=Ee;if(e===t){Ee=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ee=n;break}Ee=e.return}}function h2(t){for(;Ee!==null;){var e=Ee;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ng(4,e)}catch(l){Gt(e,n,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(l){Gt(e,r,l)}}var i=e.return;try{ub(e)}catch(l){Gt(e,i,l)}break;case 5:var o=e.return;try{ub(e)}catch(l){Gt(e,o,l)}}}catch(l){Gt(e,e.return,l)}if(e===t){Ee=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Ee=a;break}Ee=e.return}}var C4=Math.ceil,tm=Xi.ReactCurrentDispatcher,ov=Xi.ReactCurrentOwner,dr=Xi.ReactCurrentBatchConfig,ct=0,$n=null,ln=null,Fn=0,Os=0,Hl=Ko(0),vn=0,bd=null,ja=0,sg=0,av=0,Ku=null,ys=null,lv=0,fc=1/0,Ei=null,nm=!1,fb=null,No=null,jf=!1,fo=null,sm=0,Xu=0,pb=null,Ip=-1,$p=0;function os(){return ct&6?Zt():Ip!==-1?Ip:Ip=Zt()}function To(t){return t.mode&1?ct&2&&Fn!==0?Fn&-Fn:o4.transition!==null?($p===0&&($p=_T()),$p):(t=yt,t!==0||(t=window.event,t=t===void 0?16:LT(t.type)),t):1}function Ar(t,e,n,s){if(50<Xu)throw Xu=0,pb=null,Error(ye(185));jd(t,n,s),(!(ct&2)||t!==$n)&&(t===$n&&(!(ct&2)&&(sg|=n),vn===4&&uo(t,Fn)),Ns(t,s),n===1&&ct===0&&!(e.mode&1)&&(fc=Zt()+500,Zm&&Xo()))}function Ns(t,e){var n=t.callbackNode;oz(t,e);var s=Bp(t,t===$n?Fn:0);if(s===0)n!==null&&wS(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&wS(n),e===1)t.tag===0?i4(f2.bind(null,t)):nE(f2.bind(null,t)),t4(function(){!(ct&6)&&Xo()}),n=null;else{switch(RT(s)){case 1:n=F1;break;case 4:n=TT;break;case 16:n=zp;break;case 536870912:n=ET;break;default:n=zp}n=e_(n,KE.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function KE(t,e){if(Ip=-1,$p=0,ct&6)throw Error(ye(327));var n=t.callbackNode;if(ec()&&t.callbackNode!==n)return null;var s=Bp(t,t===$n?Fn:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=rm(t,s);else{e=s;var r=ct;ct|=2;var i=qE();($n!==t||Fn!==e)&&(Ei=null,fc=Zt()+500,Aa(t,e));do try{$4();break}catch(a){XE(t,a)}while(!0);K1(),tm.current=i,ct=r,ln!==null?e=0:($n=null,Fn=0,e=vn)}if(e!==0){if(e===2&&(r=Wy(t),r!==0&&(s=r,e=mb(t,r))),e===1)throw n=bd,Aa(t,0),uo(t,s),Ns(t,Zt()),n;if(e===6)uo(t,s);else{if(r=t.current.alternate,!(s&30)&&!S4(r)&&(e=rm(t,s),e===2&&(i=Wy(t),i!==0&&(s=i,e=mb(t,i))),e===1))throw n=bd,Aa(t,0),uo(t,s),Ns(t,Zt()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(ye(345));case 2:ga(t,ys,Ei);break;case 3:if(uo(t,s),(s&130023424)===s&&(e=lv+500-Zt(),10<e)){if(Bp(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){os(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=qy(ga.bind(null,t,ys,Ei),e);break}ga(t,ys,Ei);break;case 4:if(uo(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var o=31-Rr(s);i=1<<o,o=e[o],o>r&&(r=o),s&=~i}if(s=r,s=Zt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*C4(s/1960))-s,10<s){t.timeoutHandle=qy(ga.bind(null,t,ys,Ei),s);break}ga(t,ys,Ei);break;case 5:ga(t,ys,Ei);break;default:throw Error(ye(329))}}}return Ns(t,Zt()),t.callbackNode===n?KE.bind(null,t):null}function mb(t,e){var n=Ku;return t.current.memoizedState.isDehydrated&&(Aa(t,e).flags|=256),t=rm(t,e),t!==2&&(e=ys,ys=n,e!==null&&gb(e)),t}function gb(t){ys===null?ys=t:ys.push.apply(ys,t)}function S4(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],i=r.getSnapshot;r=r.value;try{if(!Lr(i(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function uo(t,e){for(e&=~av,e&=~sg,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Rr(e),s=1<<n;t[n]=-1,e&=~s}}function f2(t){if(ct&6)throw Error(ye(327));ec();var e=Bp(t,0);if(!(e&1))return Ns(t,Zt()),null;var n=rm(t,e);if(t.tag!==0&&n===2){var s=Wy(t);s!==0&&(e=s,n=mb(t,s))}if(n===1)throw n=bd,Aa(t,0),uo(t,e),Ns(t,Zt()),n;if(n===6)throw Error(ye(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ga(t,ys,Ei),Ns(t,Zt()),null}function cv(t,e){var n=ct;ct|=1;try{return t(e)}finally{ct=n,ct===0&&(fc=Zt()+500,Zm&&Xo())}}function Va(t){fo!==null&&fo.tag===0&&!(ct&6)&&ec();var e=ct;ct|=1;var n=dr.transition,s=yt;try{if(dr.transition=null,yt=1,t)return t()}finally{yt=s,dr.transition=n,ct=e,!(ct&6)&&Xo()}}function uv(){Os=Hl.current,Pt(Hl)}function Aa(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,e4(n)),ln!==null)for(n=ln.return;n!==null;){var s=n;switch(U1(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Gp();break;case 3:dc(),Pt(Is),Pt(Qn),Z1();break;case 5:J1(s);break;case 4:dc();break;case 13:Pt(jt);break;case 19:Pt(jt);break;case 10:X1(s.type._context);break;case 22:case 23:uv()}n=n.return}if($n=t,ln=t=Eo(t.current,null),Fn=Os=e,vn=0,bd=null,av=sg=ja=0,ys=Ku=null,Sa!==null){for(e=0;e<Sa.length;e++)if(n=Sa[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,i=n.pending;if(i!==null){var o=i.next;i.next=r,s.next=o}n.pending=s}Sa=null}return t}function XE(t,e){do{var n=ln;try{if(K1(),kp.current=em,Zp){for(var s=Vt.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}Zp=!1}if(Wa=0,Cn=xn=Vt=null,Gu=!1,gd=0,ov.current=null,n===null||n.return===null){vn=1,bd=e,ln=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=Fn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=e2(o);if(f!==null){f.flags&=-257,t2(f,o,a,i,e),f.mode&1&&ZS(i,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){ZS(i,c,e),dv();break e}l=Error(ye(426))}}else if(zt&&a.mode&1){var g=e2(o);if(g!==null){!(g.flags&65536)&&(g.flags|=256),t2(g,o,a,i,e),G1(hc(l,a));break e}}i=l=hc(l,a),vn!==4&&(vn=2),Ku===null?Ku=[i]:Ku.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var x=RE(i,l,e);KS(i,x);break e;case 1:a=l;var b=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(No===null||!No.has(v)))){i.flags|=65536,e&=-e,i.lanes|=e;var w=AE(i,a,e);KS(i,w);break e}}i=i.return}while(i!==null)}QE(n)}catch(C){e=C,ln===n&&n!==null&&(ln=n=n.return);continue}break}while(!0)}function qE(){var t=tm.current;return tm.current=em,t===null?em:t}function dv(){(vn===0||vn===3||vn===2)&&(vn=4),$n===null||!(ja&268435455)&&!(sg&268435455)||uo($n,Fn)}function rm(t,e){var n=ct;ct|=2;var s=qE();($n!==t||Fn!==e)&&(Ei=null,Aa(t,e));do try{I4();break}catch(r){XE(t,r)}while(!0);if(K1(),ct=n,tm.current=s,ln!==null)throw Error(ye(261));return $n=null,Fn=0,vn}function I4(){for(;ln!==null;)YE(ln)}function $4(){for(;ln!==null&&!Q3();)YE(ln)}function YE(t){var e=ZE(t.alternate,t,Os);t.memoizedProps=t.pendingProps,e===null?QE(t):ln=e,ov.current=null}function QE(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=b4(n,e),n!==null){n.flags&=32767,ln=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{vn=6,ln=null;return}}else if(n=y4(n,e,Os),n!==null){ln=n;return}if(e=e.sibling,e!==null){ln=e;return}ln=e=t}while(e!==null);vn===0&&(vn=5)}function ga(t,e,n){var s=yt,r=dr.transition;try{dr.transition=null,yt=1,N4(t,e,n,s)}finally{dr.transition=r,yt=s}return null}function N4(t,e,n,s){do ec();while(fo!==null);if(ct&6)throw Error(ye(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ye(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(az(t,i),t===$n&&(ln=$n=null,Fn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||jf||(jf=!0,e_(zp,function(){return ec(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=dr.transition,dr.transition=null;var o=yt;yt=1;var a=ct;ct|=4,ov.current=null,w4(t,n),GE(n,t),Kz(Ky),Wp=!!Hy,Ky=Hy=null,t.current=n,k4(n),J3(),ct=a,yt=o,dr.transition=i}else t.current=n;if(jf&&(jf=!1,fo=t,sm=r),i=t.pendingLanes,i===0&&(No=null),tz(n.stateNode),Ns(t,Zt()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(nm)throw nm=!1,t=fb,fb=null,t;return sm&1&&t.tag!==0&&ec(),i=t.pendingLanes,i&1?t===pb?Xu++:(Xu=0,pb=t):Xu=0,Xo(),null}function ec(){if(fo!==null){var t=RT(sm),e=dr.transition,n=yt;try{if(dr.transition=null,yt=16>t?16:t,fo===null)var s=!1;else{if(t=fo,fo=null,sm=0,ct&6)throw Error(ye(331));var r=ct;for(ct|=4,Ee=t.current;Ee!==null;){var i=Ee,o=i.child;if(Ee.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(Ee=c;Ee!==null;){var u=Ee;switch(u.tag){case 0:case 11:case 15:Hu(8,u,i)}var d=u.child;if(d!==null)d.return=u,Ee=d;else for(;Ee!==null;){u=Ee;var h=u.sibling,f=u.return;if(jE(u),u===c){Ee=null;break}if(h!==null){h.return=f,Ee=h;break}Ee=f}}}var p=i.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}Ee=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Ee=o;else e:for(;Ee!==null;){if(i=Ee,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Hu(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,Ee=x;break e}Ee=i.return}}var b=t.current;for(Ee=b;Ee!==null;){o=Ee;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,Ee=v;else e:for(o=b;Ee!==null;){if(a=Ee,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:ng(9,a)}}catch(C){Gt(a,a.return,C)}if(a===o){Ee=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,Ee=w;break e}Ee=a.return}}if(ct=r,Xo(),hi&&typeof hi.onPostCommitFiberRoot=="function")try{hi.onPostCommitFiberRoot(Xm,t)}catch{}s=!0}return s}finally{yt=n,dr.transition=e}}return!1}function p2(t,e,n){e=hc(n,e),e=RE(t,e,1),t=$o(t,e,1),e=os(),t!==null&&(jd(t,1,e),Ns(t,e))}function Gt(t,e,n){if(t.tag===3)p2(t,t,n);else for(;e!==null;){if(e.tag===3){p2(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(No===null||!No.has(s))){t=hc(n,t),t=AE(e,t,1),e=$o(e,t,1),t=os(),e!==null&&(jd(e,1,t),Ns(e,t));break}}e=e.return}}function T4(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=os(),t.pingedLanes|=t.suspendedLanes&n,$n===t&&(Fn&n)===n&&(vn===4||vn===3&&(Fn&130023424)===Fn&&500>Zt()-lv?Aa(t,0):av|=n),Ns(t,e)}function JE(t,e){e===0&&(t.mode&1?(e=Af,Af<<=1,!(Af&130023424)&&(Af=4194304)):e=1);var n=os();t=ji(t,e),t!==null&&(jd(t,e,n),Ns(t,n))}function E4(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),JE(t,n)}function _4(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(ye(314))}s!==null&&s.delete(e),JE(t,n)}var ZE;ZE=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Is.current)ws=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ws=!1,x4(t,e,n);ws=!!(t.flags&131072)}else ws=!1,zt&&e.flags&1048576&&sE(e,Xp,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Sp(t,e),t=e.pendingProps;var r=lc(e,Qn.current);Zl(e,n),r=tv(null,e,s,t,r,n);var i=nv();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,$s(s)?(i=!0,Hp(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,Y1(e),r.updater=tg,e.stateNode=r,r._reactInternals=e,nb(e,s,t,n),e=ib(null,e,s,!0,i,n)):(e.tag=0,zt&&i&&V1(e),ns(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(Sp(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=A4(s),t=Sr(s,t),r){case 0:e=rb(null,e,s,t,n);break e;case 1:e=r2(null,e,s,t,n);break e;case 11:e=n2(null,e,s,t,n);break e;case 14:e=s2(null,e,s,Sr(s.type,t),n);break e}throw Error(ye(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Sr(s,r),rb(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Sr(s,r),r2(t,e,s,r,n);case 3:e:{if(PE(e),t===null)throw Error(ye(387));s=e.pendingProps,i=e.memoizedState,r=i.element,cE(t,e),Qp(e,s,null,n);var o=e.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=hc(Error(ye(423)),e),e=i2(t,e,s,n,r);break e}else if(s!==r){r=hc(Error(ye(424)),e),e=i2(t,e,s,n,r);break e}else for(Ls=Io(e.stateNode.containerInfo.firstChild),zs=e,zt=!0,$r=null,n=aE(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(cc(),s===r){e=Vi(t,e,n);break e}ns(t,e,s,n)}e=e.child}return e;case 5:return uE(e),t===null&&Zy(e),s=e.type,r=e.pendingProps,i=t!==null?t.memoizedProps:null,o=r.children,Xy(s,r)?o=null:i!==null&&Xy(s,i)&&(e.flags|=32),OE(t,e),ns(t,e,o,n),e.child;case 6:return t===null&&Zy(e),null;case 13:return LE(t,e,n);case 4:return Q1(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=uc(e,null,s,n):ns(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Sr(s,r),n2(t,e,s,r,n);case 7:return ns(t,e,e.pendingProps,n),e.child;case 8:return ns(t,e,e.pendingProps.children,n),e.child;case 12:return ns(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,i=e.memoizedProps,o=r.value,It(qp,s._currentValue),s._currentValue=o,i!==null)if(Lr(i.value,o)){if(i.children===r.children&&!Is.current){e=Vi(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===s){if(i.tag===1){l=Mi(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),eb(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(ye(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),eb(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}ns(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,Zl(e,n),r=hr(r),s=s(r),e.flags|=1,ns(t,e,s,n),e.child;case 14:return s=e.type,r=Sr(s,e.pendingProps),r=Sr(s.type,r),s2(t,e,s,r,n);case 15:return DE(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Sr(s,r),Sp(t,e),e.tag=1,$s(s)?(t=!0,Hp(e)):t=!1,Zl(e,n),_E(e,s,r),nb(e,s,r,n),ib(null,e,s,!0,t,n);case 19:return ME(t,e,n);case 22:return FE(t,e,n)}throw Error(ye(156,e.tag))};function e_(t,e){return NT(t,e)}function R4(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function rr(t,e,n,s){return new R4(t,e,n,s)}function hv(t){return t=t.prototype,!(!t||!t.isReactComponent)}function A4(t){if(typeof t=="function")return hv(t)?1:0;if(t!=null){if(t=t.$$typeof,t===R1)return 11;if(t===A1)return 14}return 2}function Eo(t,e){var n=t.alternate;return n===null?(n=rr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Np(t,e,n,s,r,i){var o=2;if(s=t,typeof t=="function")hv(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Pl:return Da(n.children,r,i,e);case _1:o=8,r|=8;break;case $y:return t=rr(12,n,e,r|2),t.elementType=$y,t.lanes=i,t;case Ny:return t=rr(13,n,e,r),t.elementType=Ny,t.lanes=i,t;case Ty:return t=rr(19,n,e,r),t.elementType=Ty,t.lanes=i,t;case uT:return rg(n,r,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case lT:o=10;break e;case cT:o=9;break e;case R1:o=11;break e;case A1:o=14;break e;case oo:o=16,s=null;break e}throw Error(ye(130,t==null?t:typeof t,""))}return e=rr(o,n,e,r),e.elementType=t,e.type=s,e.lanes=i,e}function Da(t,e,n,s){return t=rr(7,t,s,e),t.lanes=n,t}function rg(t,e,n,s){return t=rr(22,t,s,e),t.elementType=uT,t.lanes=n,t.stateNode={isHidden:!1},t}function j0(t,e,n){return t=rr(6,t,null,e),t.lanes=n,t}function V0(t,e,n){return e=rr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function D4(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=C0(0),this.expirationTimes=C0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=C0(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function fv(t,e,n,s,r,i,o,a,l){return t=new D4(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=rr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Y1(i),t}function F4(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ol,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function t_(t){if(!t)return Lo;t=t._reactInternals;e:{if(ll(t)!==t||t.tag!==1)throw Error(ye(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if($s(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ye(171))}if(t.tag===1){var n=t.type;if($s(n))return tE(t,n,e)}return e}function n_(t,e,n,s,r,i,o,a,l){return t=fv(n,s,!0,t,r,i,o,a,l),t.context=t_(null),n=t.current,s=os(),r=To(n),i=Mi(s,r),i.callback=e??null,$o(n,i,r),t.current.lanes=r,jd(t,r,s),Ns(t,s),t}function ig(t,e,n,s){var r=e.current,i=os(),o=To(r);return n=t_(n),e.context===null?e.context=n:e.pendingContext=n,e=Mi(i,o),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=$o(r,e,o),t!==null&&(Ar(t,r,o,i),wp(t,r,o)),o}function im(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function m2(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function pv(t,e){m2(t,e),(t=t.alternate)&&m2(t,e)}function O4(){return null}var s_=typeof reportError=="function"?reportError:function(t){console.error(t)};function mv(t){this._internalRoot=t}og.prototype.render=mv.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ye(409));ig(t,e,null,null)};og.prototype.unmount=mv.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Va(function(){ig(null,t,null,null)}),e[Wi]=null}};function og(t){this._internalRoot=t}og.prototype.unstable_scheduleHydration=function(t){if(t){var e=FT();t={blockedOn:null,target:t,priority:e};for(var n=0;n<co.length&&e!==0&&e<co[n].priority;n++);co.splice(n,0,t),n===0&&PT(t)}};function gv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ag(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function g2(){}function P4(t,e,n,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var c=im(o);i.call(c)}}var o=n_(e,s,t,0,null,!1,!1,"",g2);return t._reactRootContainer=o,t[Wi]=o.current,dd(t.nodeType===8?t.parentNode:t),Va(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var a=s;s=function(){var c=im(l);a.call(c)}}var l=fv(t,0,!1,null,null,!1,!1,"",g2);return t._reactRootContainer=l,t[Wi]=l.current,dd(t.nodeType===8?t.parentNode:t),Va(function(){ig(e,l,n,s)}),l}function lg(t,e,n,s,r){var i=n._reactRootContainer;if(i){var o=i;if(typeof r=="function"){var a=r;r=function(){var l=im(o);a.call(l)}}ig(e,o,t,r)}else o=P4(n,e,t,r,s);return im(o)}AT=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Eu(e.pendingLanes);n!==0&&(O1(e,n|1),Ns(e,Zt()),!(ct&6)&&(fc=Zt()+500,Xo()))}break;case 13:Va(function(){var s=ji(t,1);if(s!==null){var r=os();Ar(s,t,1,r)}}),pv(t,1)}};P1=function(t){if(t.tag===13){var e=ji(t,134217728);if(e!==null){var n=os();Ar(e,t,134217728,n)}pv(t,134217728)}};DT=function(t){if(t.tag===13){var e=To(t),n=ji(t,e);if(n!==null){var s=os();Ar(n,t,e,s)}pv(t,e)}};FT=function(){return yt};OT=function(t,e){var n=yt;try{return yt=t,e()}finally{yt=n}};My=function(t,e,n){switch(e){case"input":if(Ry(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=Jm(s);if(!r)throw Error(ye(90));hT(s),Ry(s,r)}}}break;case"textarea":pT(t,n);break;case"select":e=n.value,e!=null&&ql(t,!!n.multiple,e,!1)}};wT=cv;kT=Va;var L4={usingClientEntryPoint:!1,Events:[Ud,Bl,Jm,bT,vT,cv]},gu={findFiberByHostInstance:Ca,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},M4={bundleType:gu.bundleType,version:gu.version,rendererPackageName:gu.rendererPackageName,rendererConfig:gu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Xi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=IT(t),t===null?null:t.stateNode},findFiberByHostInstance:gu.findFiberByHostInstance||O4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vf.isDisabled&&Vf.supportsFiber)try{Xm=Vf.inject(M4),hi=Vf}catch{}}Us.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L4;Us.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gv(e))throw Error(ye(200));return F4(t,e,null,n)};Us.createRoot=function(t,e){if(!gv(t))throw Error(ye(299));var n=!1,s="",r=s_;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=fv(t,1,!1,null,null,n,!1,s,r),t[Wi]=e.current,dd(t.nodeType===8?t.parentNode:t),new mv(e)};Us.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ye(188)):(t=Object.keys(t).join(","),Error(ye(268,t)));return t=IT(e),t=t===null?null:t.stateNode,t};Us.flushSync=function(t){return Va(t)};Us.hydrate=function(t,e,n){if(!ag(e))throw Error(ye(200));return lg(null,t,e,!0,n)};Us.hydrateRoot=function(t,e,n){if(!gv(t))throw Error(ye(405));var s=n!=null&&n.hydratedSources||null,r=!1,i="",o=s_;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=n_(e,null,t,1,n??null,r,!1,i,o),t[Wi]=e.current,dd(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new og(e)};Us.render=function(t,e,n){if(!ag(e))throw Error(ye(200));return lg(null,t,e,!1,n)};Us.unmountComponentAtNode=function(t){if(!ag(t))throw Error(ye(40));return t._reactRootContainer?(Va(function(){lg(null,null,t,!1,function(){t._reactRootContainer=null,t[Wi]=null})}),!0):!1};Us.unstable_batchedUpdates=cv;Us.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!ag(n))throw Error(ye(200));if(t==null||t._reactInternals===void 0)throw Error(ye(38));return lg(t,e,n,!1,s)};Us.version="18.3.1-next-f1338f8080-20240426";function r_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r_)}catch(t){console.error(t)}}r_(),rT.exports=Us;var z4=rT.exports,i_,x2=z4;i_=x2.createRoot,x2.hydrateRoot;/**
 * @remix-run/router v1.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vd(){return vd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},vd.apply(this,arguments)}var po;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(po||(po={}));const y2="popstate";function B4(t){t===void 0&&(t={});function e(s,r){let{pathname:i,search:o,hash:a}=s.location;return xb("",{pathname:i,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:om(r)}return j4(e,n,null,t)}function nn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function o_(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function W4(){return Math.random().toString(36).substr(2,8)}function b2(t,e){return{usr:t.state,key:t.key,idx:e}}function xb(t,e,n,s){return n===void 0&&(n=null),vd({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ac(e):e,{state:n,key:e&&e.key||s||W4()})}function om(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Ac(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function j4(t,e,n,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:i=!1}=s,o=r.history,a=po.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(vd({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function d(){a=po.Pop;let g=u(),x=g==null?null:g-c;c=g,l&&l({action:a,location:m.location,delta:x})}function h(g,x){a=po.Push;let b=xb(m.location,g,x);c=u()+1;let v=b2(b,c),w=m.createHref(b);try{o.pushState(v,"",w)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;r.location.assign(w)}i&&l&&l({action:a,location:m.location,delta:1})}function f(g,x){a=po.Replace;let b=xb(m.location,g,x);c=u();let v=b2(b,c),w=m.createHref(b);o.replaceState(v,"",w),i&&l&&l({action:a,location:m.location,delta:0})}function p(g){let x=r.location.origin!=="null"?r.location.origin:r.location.href,b=typeof g=="string"?g:om(g);return b=b.replace(/ $/,"%20"),nn(x,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,x)}let m={get action(){return a},get location(){return t(r,o)},listen(g){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(y2,d),l=g,()=>{r.removeEventListener(y2,d),l=null}},createHref(g){return e(r,g)},createURL:p,encodeLocation(g){let x=p(g);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:h,replace:f,go(g){return o.go(g)}};return m}var v2;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(v2||(v2={}));function V4(t,e,n){return n===void 0&&(n="/"),U4(t,e,n)}function U4(t,e,n,s){let r=typeof e=="string"?Ac(e):e,i=xv(r.pathname||"/",n);if(i==null)return null;let o=a_(t);G4(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=sB(i);a=eB(o[l],c)}return a}function a_(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let r=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(nn(l.relativePath.startsWith(s),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(s.length));let c=_o([s,l.relativePath]),u=n.concat(l);i.children&&i.children.length>0&&(nn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),a_(i.children,e,u,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:J4(c,i.index),routesMeta:u})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))r(i,o);else for(let l of l_(i.path))r(i,o,l)}),e}function l_(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let o=l_(s.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),r&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function G4(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:Z4(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const H4=/^:[\w-]+$/,K4=3,X4=2,q4=1,Y4=10,Q4=-2,w2=t=>t==="*";function J4(t,e){let n=t.split("/"),s=n.length;return n.some(w2)&&(s+=Q4),e&&(s+=X4),n.filter(r=>!w2(r)).reduce((r,i)=>r+(H4.test(i)?K4:i===""?q4:Y4),s)}function Z4(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function eB(t,e,n){let{routesMeta:s}=t,r={},i="/",o=[];for(let a=0;a<s.length;++a){let l=s[a],c=a===s.length-1,u=i==="/"?e:e.slice(i.length)||"/",d=tB({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!d)return null;Object.assign(r,d.params),o.push({params:r,pathname:_o([i,d.pathname]),pathnameBase:aB(_o([i,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(i=_o([i,d.pathnameBase]))}return o}function tB(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=nB(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let i=r[0],o=i.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:s.reduce((c,u,d)=>{let{paramName:h,isOptional:f}=u;if(h==="*"){let m=a[d]||"";o=i.slice(0,i.length-m.length).replace(/(.)\/+$/,"$1")}const p=a[d];return f&&!p?c[h]=void 0:c[h]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:t}}function nB(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),o_(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(s.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function sB(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return o_(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function xv(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function rB(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?Ac(t):t;return{pathname:n?n.startsWith("/")?n:iB(n,e):e,search:lB(s),hash:cB(r)}}function iB(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function U0(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function oB(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function yv(t,e){let n=oB(t);return e?n.map((s,r)=>r===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function bv(t,e,n,s){s===void 0&&(s=!1);let r;typeof t=="string"?r=Ac(t):(r=vd({},t),nn(!r.pathname||!r.pathname.includes("?"),U0("?","pathname","search",r)),nn(!r.pathname||!r.pathname.includes("#"),U0("#","pathname","hash",r)),nn(!r.search||!r.search.includes("#"),U0("#","search","hash",r)));let i=t===""||r.pathname==="",o=i?"/":r.pathname,a;if(o==null)a=n;else{let d=e.length-1;if(!s&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),d-=1;r.pathname=h.join("/")}a=d>=0?e[d]:"/"}let l=rB(r,a),c=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const _o=t=>t.join("/").replace(/\/\/+/g,"/"),aB=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),lB=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,cB=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function uB(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const c_=["post","put","patch","delete"];new Set(c_);const dB=["get",...c_];new Set(dB);/**
 * React Router v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function wd(){return wd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},wd.apply(this,arguments)}const vv=J.createContext(null),hB=J.createContext(null),qo=J.createContext(null),cg=J.createContext(null),Yo=J.createContext({outlet:null,matches:[],isDataRoute:!1}),u_=J.createContext(null);function fB(t,e){let{relative:n}=e===void 0?{}:e;Dc()||nn(!1);let{basename:s,navigator:r}=J.useContext(qo),{hash:i,pathname:o,search:a}=h_(t,{relative:n}),l=o;return s!=="/"&&(l=o==="/"?s:_o([s,o])),r.createHref({pathname:l,search:a,hash:i})}function Dc(){return J.useContext(cg)!=null}function cl(){return Dc()||nn(!1),J.useContext(cg).location}function d_(t){J.useContext(qo).static||J.useLayoutEffect(t)}function ul(){let{isDataRoute:t}=J.useContext(Yo);return t?$B():pB()}function pB(){Dc()||nn(!1);let t=J.useContext(vv),{basename:e,future:n,navigator:s}=J.useContext(qo),{matches:r}=J.useContext(Yo),{pathname:i}=cl(),o=JSON.stringify(yv(r,n.v7_relativeSplatPath)),a=J.useRef(!1);return d_(()=>{a.current=!0}),J.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){s.go(c);return}let d=bv(c,JSON.parse(o),i,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:_o([e,d.pathname])),(u.replace?s.replace:s.push)(d,u.state,u)},[e,s,o,i,t])}function h_(t,e){let{relative:n}=e===void 0?{}:e,{future:s}=J.useContext(qo),{matches:r}=J.useContext(Yo),{pathname:i}=cl(),o=JSON.stringify(yv(r,s.v7_relativeSplatPath));return J.useMemo(()=>bv(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function mB(t,e){return gB(t,e)}function gB(t,e,n,s){Dc()||nn(!1);let{navigator:r}=J.useContext(qo),{matches:i}=J.useContext(Yo),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=cl(),u;if(e){var d;let g=typeof e=="string"?Ac(e):e;l==="/"||(d=g.pathname)!=null&&d.startsWith(l)||nn(!1),u=g}else u=c;let h=u.pathname||"/",f=h;if(l!=="/"){let g=l.replace(/^\//,"").split("/");f="/"+h.replace(/^\//,"").split("/").slice(g.length).join("/")}let p=V4(t,{pathname:f}),m=wB(p&&p.map(g=>Object.assign({},g,{params:Object.assign({},a,g.params),pathname:_o([l,r.encodeLocation?r.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?l:_o([l,r.encodeLocation?r.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),i,n,s);return e&&m?J.createElement(cg.Provider,{value:{location:wd({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:po.Pop}},m):m}function xB(){let t=IB(),e=uB(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return J.createElement(J.Fragment,null,J.createElement("h2",null,"Unexpected Application Error!"),J.createElement("h3",{style:{fontStyle:"italic"}},e),n?J.createElement("pre",{style:r},n):null,null)}const yB=J.createElement(xB,null);class bB extends J.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?J.createElement(Yo.Provider,{value:this.props.routeContext},J.createElement(u_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function vB(t){let{routeContext:e,match:n,children:s}=t,r=J.useContext(vv);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),J.createElement(Yo.Provider,{value:e},s)}function wB(t,e,n,s){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=s)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(r=n)==null?void 0:r.errors;if(a!=null){let u=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);u>=0||nn(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(n&&s&&s.v7_partialHydration)for(let u=0;u<o.length;u++){let d=o[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:h,errors:f}=n,p=d.route.loader&&h[d.route.id]===void 0&&(!f||f[d.route.id]===void 0);if(d.route.lazy||p){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,d,h)=>{let f,p=!1,m=null,g=null;n&&(f=a&&d.route.id?a[d.route.id]:void 0,m=d.route.errorElement||yB,l&&(c<0&&h===0?(NB("route-fallback"),p=!0,g=null):c===h&&(p=!0,g=d.route.hydrateFallbackElement||null)));let x=e.concat(o.slice(0,h+1)),b=()=>{let v;return f?v=m:p?v=g:d.route.Component?v=J.createElement(d.route.Component,null):d.route.element?v=d.route.element:v=u,J.createElement(vB,{match:d,routeContext:{outlet:u,matches:x,isDataRoute:n!=null},children:v})};return n&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?J.createElement(bB,{location:n.location,revalidation:n.revalidation,component:m,error:f,children:b(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):b()},null)}var f_=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(f_||{}),p_=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(p_||{});function kB(t){let e=J.useContext(vv);return e||nn(!1),e}function CB(t){let e=J.useContext(hB);return e||nn(!1),e}function SB(t){let e=J.useContext(Yo);return e||nn(!1),e}function m_(t){let e=SB(),n=e.matches[e.matches.length-1];return n.route.id||nn(!1),n.route.id}function IB(){var t;let e=J.useContext(u_),n=CB(),s=m_();return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function $B(){let{router:t}=kB(f_.UseNavigateStable),e=m_(p_.UseNavigateStable),n=J.useRef(!1);return d_(()=>{n.current=!0}),J.useCallback(function(r,i){i===void 0&&(i={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,wd({fromRouteId:e},i)))},[t,e])}const k2={};function NB(t,e,n){k2[t]||(k2[t]=!0)}const C2={};function TB(t,e){C2[e]||(C2[e]=!0,console.warn(e))}const S2=(t,e,n)=>TB(t," React Router Future Flag Warning: "+e+". "+("You can use the `"+t+"` future flag to opt-in early. ")+("For more information, see "+n+"."));function EB(t,e){t!=null&&t.v7_startTransition||S2("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),t!=null&&t.v7_relativeSplatPath||S2("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function wv(t){let{to:e,replace:n,state:s,relative:r}=t;Dc()||nn(!1);let{future:i,static:o}=J.useContext(qo),{matches:a}=J.useContext(Yo),{pathname:l}=cl(),c=ul(),u=bv(e,yv(a,i.v7_relativeSplatPath),l,r==="path"),d=JSON.stringify(u);return J.useEffect(()=>c(JSON.parse(d),{replace:n,state:s,relative:r}),[c,d,r,n,s]),null}function Zs(t){nn(!1)}function _B(t){let{basename:e="/",children:n=null,location:s,navigationType:r=po.Pop,navigator:i,static:o=!1,future:a}=t;Dc()&&nn(!1);let l=e.replace(/^\/*/,"/"),c=J.useMemo(()=>({basename:l,navigator:i,static:o,future:wd({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof s=="string"&&(s=Ac(s));let{pathname:u="/",search:d="",hash:h="",state:f=null,key:p="default"}=s,m=J.useMemo(()=>{let g=xv(u,l);return g==null?null:{location:{pathname:g,search:d,hash:h,state:f,key:p},navigationType:r}},[l,u,d,h,f,p,r]);return m==null?null:J.createElement(qo.Provider,{value:c},J.createElement(cg.Provider,{children:n,value:m}))}function RB(t){let{children:e,location:n}=t;return mB(yb(e),n)}new Promise(()=>{});function yb(t,e){e===void 0&&(e=[]);let n=[];return J.Children.forEach(t,(s,r)=>{if(!J.isValidElement(s))return;let i=[...e,r];if(s.type===J.Fragment){n.push.apply(n,yb(s.props.children,i));return}s.type!==Zs&&nn(!1),!s.props.index||!s.props.children||nn(!1);let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=yb(s.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bb(){return bb=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},bb.apply(this,arguments)}function AB(t,e){if(t==null)return{};var n={},s=Object.keys(t),r,i;for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function DB(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function FB(t,e){return t.button===0&&(!e||e==="_self")&&!DB(t)}const OB=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],PB="6";try{window.__reactRouterVersion=PB}catch{}const LB="startTransition",I2=T3[LB];function MB(t){let{basename:e,children:n,future:s,window:r}=t,i=J.useRef();i.current==null&&(i.current=B4({window:r,v5Compat:!0}));let o=i.current,[a,l]=J.useState({action:o.action,location:o.location}),{v7_startTransition:c}=s||{},u=J.useCallback(d=>{c&&I2?I2(()=>l(d)):l(d)},[l,c]);return J.useLayoutEffect(()=>o.listen(u),[o,u]),J.useEffect(()=>EB(s),[s]),J.createElement(_B,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:s})}const zB=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",BB=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Pi=J.forwardRef(function(e,n){let{onClick:s,relative:r,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:d}=e,h=AB(e,OB),{basename:f}=J.useContext(qo),p,m=!1;if(typeof c=="string"&&BB.test(c)&&(p=c,zB))try{let v=new URL(window.location.href),w=c.startsWith("//")?new URL(v.protocol+c):new URL(c),C=xv(w.pathname,f);w.origin===v.origin&&C!=null?c=C+w.search+w.hash:m=!0}catch{}let g=fB(c,{relative:r}),x=WB(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:r,viewTransition:d});function b(v){s&&s(v),v.defaultPrevented||x(v)}return J.createElement("a",bb({},h,{href:p||g,onClick:m||i?s:b,ref:n,target:l}))});var $2;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})($2||($2={}));var N2;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(N2||(N2={}));function WB(t,e){let{target:n,replace:s,state:r,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,l=ul(),c=cl(),u=h_(t,{relative:o});return J.useCallback(d=>{if(FB(d,n)){d.preventDefault();let h=s!==void 0?s:om(c)===om(u);l(t,{replace:h,state:r,preventScrollReset:i,relative:o,viewTransition:a})}},[c,l,u,s,r,n,t,i,o,a])}function g_(t,e){return function(){return t.apply(e,arguments)}}const{toString:jB}=Object.prototype,{getPrototypeOf:kv}=Object,ug=(t=>e=>{const n=jB.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),jr=t=>(t=t.toLowerCase(),e=>ug(e)===t),dg=t=>e=>typeof e===t,{isArray:Fc}=Array,kd=dg("undefined");function VB(t){return t!==null&&!kd(t)&&t.constructor!==null&&!kd(t.constructor)&&Bs(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const x_=jr("ArrayBuffer");function UB(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&x_(t.buffer),e}const GB=dg("string"),Bs=dg("function"),y_=dg("number"),hg=t=>t!==null&&typeof t=="object",HB=t=>t===!0||t===!1,Tp=t=>{if(ug(t)!=="object")return!1;const e=kv(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},KB=jr("Date"),XB=jr("File"),qB=jr("Blob"),YB=jr("FileList"),QB=t=>hg(t)&&Bs(t.pipe),JB=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Bs(t.append)&&((e=ug(t))==="formdata"||e==="object"&&Bs(t.toString)&&t.toString()==="[object FormData]"))},ZB=jr("URLSearchParams"),[eW,tW,nW,sW]=["ReadableStream","Request","Response","Headers"].map(jr),rW=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Hd(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let s,r;if(typeof t!="object"&&(t=[t]),Fc(t))for(s=0,r=t.length;s<r;s++)e.call(null,t[s],s,t);else{const i=n?Object.getOwnPropertyNames(t):Object.keys(t),o=i.length;let a;for(s=0;s<o;s++)a=i[s],e.call(null,t[a],a,t)}}function b_(t,e){e=e.toLowerCase();const n=Object.keys(t);let s=n.length,r;for(;s-- >0;)if(r=n[s],e===r.toLowerCase())return r;return null}const $a=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,v_=t=>!kd(t)&&t!==$a;function vb(){const{caseless:t}=v_(this)&&this||{},e={},n=(s,r)=>{const i=t&&b_(e,r)||r;Tp(e[i])&&Tp(s)?e[i]=vb(e[i],s):Tp(s)?e[i]=vb({},s):Fc(s)?e[i]=s.slice():e[i]=s};for(let s=0,r=arguments.length;s<r;s++)arguments[s]&&Hd(arguments[s],n);return e}const iW=(t,e,n,{allOwnKeys:s}={})=>(Hd(e,(r,i)=>{n&&Bs(r)?t[i]=g_(r,n):t[i]=r},{allOwnKeys:s}),t),oW=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),aW=(t,e,n,s)=>{t.prototype=Object.create(e.prototype,s),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},lW=(t,e,n,s)=>{let r,i,o;const a={};if(e=e||{},t==null)return e;do{for(r=Object.getOwnPropertyNames(t),i=r.length;i-- >0;)o=r[i],(!s||s(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=n!==!1&&kv(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},cW=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const s=t.indexOf(e,n);return s!==-1&&s===n},uW=t=>{if(!t)return null;if(Fc(t))return t;let e=t.length;if(!y_(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},dW=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&kv(Uint8Array)),hW=(t,e)=>{const s=(t&&t[Symbol.iterator]).call(t);let r;for(;(r=s.next())&&!r.done;){const i=r.value;e.call(t,i[0],i[1])}},fW=(t,e)=>{let n;const s=[];for(;(n=t.exec(e))!==null;)s.push(n);return s},pW=jr("HTMLFormElement"),mW=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,r){return s.toUpperCase()+r}),T2=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),gW=jr("RegExp"),w_=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),s={};Hd(n,(r,i)=>{let o;(o=e(r,i,t))!==!1&&(s[i]=o||r)}),Object.defineProperties(t,s)},xW=t=>{w_(t,(e,n)=>{if(Bs(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=t[n];if(Bs(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},yW=(t,e)=>{const n={},s=r=>{r.forEach(i=>{n[i]=!0})};return Fc(t)?s(t):s(String(t).split(e)),n},bW=()=>{},vW=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e,G0="abcdefghijklmnopqrstuvwxyz",E2="0123456789",k_={DIGIT:E2,ALPHA:G0,ALPHA_DIGIT:G0+G0.toUpperCase()+E2},wW=(t=16,e=k_.ALPHA_DIGIT)=>{let n="";const{length:s}=e;for(;t--;)n+=e[Math.random()*s|0];return n};function kW(t){return!!(t&&Bs(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const CW=t=>{const e=new Array(10),n=(s,r)=>{if(hg(s)){if(e.indexOf(s)>=0)return;if(!("toJSON"in s)){e[r]=s;const i=Fc(s)?[]:{};return Hd(s,(o,a)=>{const l=n(o,r+1);!kd(l)&&(i[a]=l)}),e[r]=void 0,i}}return s};return n(t,0)},SW=jr("AsyncFunction"),IW=t=>t&&(hg(t)||Bs(t))&&Bs(t.then)&&Bs(t.catch),C_=((t,e)=>t?setImmediate:e?((n,s)=>($a.addEventListener("message",({source:r,data:i})=>{r===$a&&i===n&&s.length&&s.shift()()},!1),r=>{s.push(r),$a.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Bs($a.postMessage)),$W=typeof queueMicrotask<"u"?queueMicrotask.bind($a):typeof process<"u"&&process.nextTick||C_,ie={isArray:Fc,isArrayBuffer:x_,isBuffer:VB,isFormData:JB,isArrayBufferView:UB,isString:GB,isNumber:y_,isBoolean:HB,isObject:hg,isPlainObject:Tp,isReadableStream:eW,isRequest:tW,isResponse:nW,isHeaders:sW,isUndefined:kd,isDate:KB,isFile:XB,isBlob:qB,isRegExp:gW,isFunction:Bs,isStream:QB,isURLSearchParams:ZB,isTypedArray:dW,isFileList:YB,forEach:Hd,merge:vb,extend:iW,trim:rW,stripBOM:oW,inherits:aW,toFlatObject:lW,kindOf:ug,kindOfTest:jr,endsWith:cW,toArray:uW,forEachEntry:hW,matchAll:fW,isHTMLForm:pW,hasOwnProperty:T2,hasOwnProp:T2,reduceDescriptors:w_,freezeMethods:xW,toObjectSet:yW,toCamelCase:mW,noop:bW,toFiniteNumber:vW,findKey:b_,global:$a,isContextDefined:v_,ALPHABET:k_,generateString:wW,isSpecCompliantForm:kW,toJSONObject:CW,isAsyncFn:SW,isThenable:IW,setImmediate:C_,asap:$W};function Ke(t,e,n,s,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),s&&(this.request=s),r&&(this.response=r,this.status=r.status?r.status:null)}ie.inherits(Ke,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ie.toJSONObject(this.config),code:this.code,status:this.status}}});const S_=Ke.prototype,I_={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{I_[t]={value:t}});Object.defineProperties(Ke,I_);Object.defineProperty(S_,"isAxiosError",{value:!0});Ke.from=(t,e,n,s,r,i)=>{const o=Object.create(S_);return ie.toFlatObject(t,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),Ke.call(o,t.message,e,n,s,r),o.cause=t,o.name=t.name,i&&Object.assign(o,i),o};const NW=null;function wb(t){return ie.isPlainObject(t)||ie.isArray(t)}function $_(t){return ie.endsWith(t,"[]")?t.slice(0,-2):t}function _2(t,e,n){return t?t.concat(e).map(function(r,i){return r=$_(r),!n&&i?"["+r+"]":r}).join(n?".":""):e}function TW(t){return ie.isArray(t)&&!t.some(wb)}const EW=ie.toFlatObject(ie,{},null,function(e){return/^is[A-Z]/.test(e)});function fg(t,e,n){if(!ie.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=ie.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,g){return!ie.isUndefined(g[m])});const s=n.metaTokens,r=n.visitor||u,i=n.dots,o=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&ie.isSpecCompliantForm(e);if(!ie.isFunction(r))throw new TypeError("visitor must be a function");function c(p){if(p===null)return"";if(ie.isDate(p))return p.toISOString();if(!l&&ie.isBlob(p))throw new Ke("Blob is not supported. Use a Buffer instead.");return ie.isArrayBuffer(p)||ie.isTypedArray(p)?l&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function u(p,m,g){let x=p;if(p&&!g&&typeof p=="object"){if(ie.endsWith(m,"{}"))m=s?m:m.slice(0,-2),p=JSON.stringify(p);else if(ie.isArray(p)&&TW(p)||(ie.isFileList(p)||ie.endsWith(m,"[]"))&&(x=ie.toArray(p)))return m=$_(m),x.forEach(function(v,w){!(ie.isUndefined(v)||v===null)&&e.append(o===!0?_2([m],w,i):o===null?m:m+"[]",c(v))}),!1}return wb(p)?!0:(e.append(_2(g,m,i),c(p)),!1)}const d=[],h=Object.assign(EW,{defaultVisitor:u,convertValue:c,isVisitable:wb});function f(p,m){if(!ie.isUndefined(p)){if(d.indexOf(p)!==-1)throw Error("Circular reference detected in "+m.join("."));d.push(p),ie.forEach(p,function(x,b){(!(ie.isUndefined(x)||x===null)&&r.call(e,x,ie.isString(b)?b.trim():b,m,h))===!0&&f(x,m?m.concat(b):[b])}),d.pop()}}if(!ie.isObject(t))throw new TypeError("data must be an object");return f(t),e}function R2(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function Cv(t,e){this._pairs=[],t&&fg(t,this,e)}const N_=Cv.prototype;N_.append=function(e,n){this._pairs.push([e,n])};N_.toString=function(e){const n=e?function(s){return e.call(this,s,R2)}:R2;return this._pairs.map(function(r){return n(r[0])+"="+n(r[1])},"").join("&")};function _W(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function T_(t,e,n){if(!e)return t;const s=n&&n.encode||_W,r=n&&n.serialize;let i;if(r?i=r(e,n):i=ie.isURLSearchParams(e)?e.toString():new Cv(e,n).toString(s),i){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class A2{constructor(){this.handlers=[]}use(e,n,s){return this.handlers.push({fulfilled:e,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ie.forEach(this.handlers,function(s){s!==null&&e(s)})}}const E_={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},RW=typeof URLSearchParams<"u"?URLSearchParams:Cv,AW=typeof FormData<"u"?FormData:null,DW=typeof Blob<"u"?Blob:null,FW={isBrowser:!0,classes:{URLSearchParams:RW,FormData:AW,Blob:DW},protocols:["http","https","file","blob","url","data"]},Sv=typeof window<"u"&&typeof document<"u",kb=typeof navigator=="object"&&navigator||void 0,OW=Sv&&(!kb||["ReactNative","NativeScript","NS"].indexOf(kb.product)<0),PW=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",LW=Sv&&window.location.href||"http://localhost",MW=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Sv,hasStandardBrowserEnv:OW,hasStandardBrowserWebWorkerEnv:PW,navigator:kb,origin:LW},Symbol.toStringTag,{value:"Module"})),Ts={...MW,...FW};function zW(t,e){return fg(t,new Ts.classes.URLSearchParams,Object.assign({visitor:function(n,s,r,i){return Ts.isNode&&ie.isBuffer(n)?(this.append(s,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function BW(t){return ie.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function WW(t){const e={},n=Object.keys(t);let s;const r=n.length;let i;for(s=0;s<r;s++)i=n[s],e[i]=t[i];return e}function __(t){function e(n,s,r,i){let o=n[i++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=i>=n.length;return o=!o&&ie.isArray(r)?r.length:o,l?(ie.hasOwnProp(r,o)?r[o]=[r[o],s]:r[o]=s,!a):((!r[o]||!ie.isObject(r[o]))&&(r[o]=[]),e(n,s,r[o],i)&&ie.isArray(r[o])&&(r[o]=WW(r[o])),!a)}if(ie.isFormData(t)&&ie.isFunction(t.entries)){const n={};return ie.forEachEntry(t,(s,r)=>{e(BW(s),r,n,0)}),n}return null}function jW(t,e,n){if(ie.isString(t))try{return(e||JSON.parse)(t),ie.trim(t)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(t)}const Kd={transitional:E_,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const s=n.getContentType()||"",r=s.indexOf("application/json")>-1,i=ie.isObject(e);if(i&&ie.isHTMLForm(e)&&(e=new FormData(e)),ie.isFormData(e))return r?JSON.stringify(__(e)):e;if(ie.isArrayBuffer(e)||ie.isBuffer(e)||ie.isStream(e)||ie.isFile(e)||ie.isBlob(e)||ie.isReadableStream(e))return e;if(ie.isArrayBufferView(e))return e.buffer;if(ie.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(i){if(s.indexOf("application/x-www-form-urlencoded")>-1)return zW(e,this.formSerializer).toString();if((a=ie.isFileList(e))||s.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return fg(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return i||r?(n.setContentType("application/json",!1),jW(e)):e}],transformResponse:[function(e){const n=this.transitional||Kd.transitional,s=n&&n.forcedJSONParsing,r=this.responseType==="json";if(ie.isResponse(e)||ie.isReadableStream(e))return e;if(e&&ie.isString(e)&&(s&&!this.responseType||r)){const o=!(n&&n.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?Ke.from(a,Ke.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ts.classes.FormData,Blob:Ts.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ie.forEach(["delete","get","head","post","put","patch"],t=>{Kd.headers[t]={}});const VW=ie.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),UW=t=>{const e={};let n,s,r;return t&&t.split(`
`).forEach(function(o){r=o.indexOf(":"),n=o.substring(0,r).trim().toLowerCase(),s=o.substring(r+1).trim(),!(!n||e[n]&&VW[n])&&(n==="set-cookie"?e[n]?e[n].push(s):e[n]=[s]:e[n]=e[n]?e[n]+", "+s:s)}),e},D2=Symbol("internals");function xu(t){return t&&String(t).trim().toLowerCase()}function Ep(t){return t===!1||t==null?t:ie.isArray(t)?t.map(Ep):String(t)}function GW(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(t);)e[s[1]]=s[2];return e}const HW=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function H0(t,e,n,s,r){if(ie.isFunction(s))return s.call(this,e,n);if(r&&(e=n),!!ie.isString(e)){if(ie.isString(s))return e.indexOf(s)!==-1;if(ie.isRegExp(s))return s.test(e)}}function KW(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,s)=>n.toUpperCase()+s)}function XW(t,e){const n=ie.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(t,s+n,{value:function(r,i,o){return this[s].call(this,e,r,i,o)},configurable:!0})})}let Es=class{constructor(e){e&&this.set(e)}set(e,n,s){const r=this;function i(a,l,c){const u=xu(l);if(!u)throw new Error("header name must be a non-empty string");const d=ie.findKey(r,u);(!d||r[d]===void 0||c===!0||c===void 0&&r[d]!==!1)&&(r[d||l]=Ep(a))}const o=(a,l)=>ie.forEach(a,(c,u)=>i(c,u,l));if(ie.isPlainObject(e)||e instanceof this.constructor)o(e,n);else if(ie.isString(e)&&(e=e.trim())&&!HW(e))o(UW(e),n);else if(ie.isHeaders(e))for(const[a,l]of e.entries())i(l,a,s);else e!=null&&i(n,e,s);return this}get(e,n){if(e=xu(e),e){const s=ie.findKey(this,e);if(s){const r=this[s];if(!n)return r;if(n===!0)return GW(r);if(ie.isFunction(n))return n.call(this,r,s);if(ie.isRegExp(n))return n.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=xu(e),e){const s=ie.findKey(this,e);return!!(s&&this[s]!==void 0&&(!n||H0(this,this[s],s,n)))}return!1}delete(e,n){const s=this;let r=!1;function i(o){if(o=xu(o),o){const a=ie.findKey(s,o);a&&(!n||H0(s,s[a],a,n))&&(delete s[a],r=!0)}}return ie.isArray(e)?e.forEach(i):i(e),r}clear(e){const n=Object.keys(this);let s=n.length,r=!1;for(;s--;){const i=n[s];(!e||H0(this,this[i],i,e,!0))&&(delete this[i],r=!0)}return r}normalize(e){const n=this,s={};return ie.forEach(this,(r,i)=>{const o=ie.findKey(s,i);if(o){n[o]=Ep(r),delete n[i];return}const a=e?KW(i):String(i).trim();a!==i&&delete n[i],n[a]=Ep(r),s[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return ie.forEach(this,(s,r)=>{s!=null&&s!==!1&&(n[r]=e&&ie.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const s=new this(e);return n.forEach(r=>s.set(r)),s}static accessor(e){const s=(this[D2]=this[D2]={accessors:{}}).accessors,r=this.prototype;function i(o){const a=xu(o);s[a]||(XW(r,o),s[a]=!0)}return ie.isArray(e)?e.forEach(i):i(e),this}};Es.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ie.reduceDescriptors(Es.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(s){this[n]=s}}});ie.freezeMethods(Es);function K0(t,e){const n=this||Kd,s=e||n,r=Es.from(s.headers);let i=s.data;return ie.forEach(t,function(a){i=a.call(n,i,r.normalize(),e?e.status:void 0)}),r.normalize(),i}function R_(t){return!!(t&&t.__CANCEL__)}function Oc(t,e,n){Ke.call(this,t??"canceled",Ke.ERR_CANCELED,e,n),this.name="CanceledError"}ie.inherits(Oc,Ke,{__CANCEL__:!0});function A_(t,e,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?t(n):e(new Ke("Request failed with status code "+n.status,[Ke.ERR_BAD_REQUEST,Ke.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function qW(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function YW(t,e){t=t||10;const n=new Array(t),s=new Array(t);let r=0,i=0,o;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),u=s[i];o||(o=c),n[r]=l,s[r]=c;let d=i,h=0;for(;d!==r;)h+=n[d++],d=d%t;if(r=(r+1)%t,r===i&&(i=(i+1)%t),c-o<e)return;const f=u&&c-u;return f?Math.round(h*1e3/f):void 0}}function QW(t,e){let n=0,s=1e3/e,r,i;const o=(c,u=Date.now())=>{n=u,r=null,i&&(clearTimeout(i),i=null),t.apply(null,c)};return[(...c)=>{const u=Date.now(),d=u-n;d>=s?o(c,u):(r=c,i||(i=setTimeout(()=>{i=null,o(r)},s-d)))},()=>r&&o(r)]}const am=(t,e,n=3)=>{let s=0;const r=YW(50,250);return QW(i=>{const o=i.loaded,a=i.lengthComputable?i.total:void 0,l=o-s,c=r(l),u=o<=a;s=o;const d={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:c||void 0,estimated:c&&a&&u?(a-o)/c:void 0,event:i,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(d)},n)},F2=(t,e)=>{const n=t!=null;return[s=>e[0]({lengthComputable:n,total:t,loaded:s}),e[1]]},O2=t=>(...e)=>ie.asap(()=>t(...e)),JW=Ts.hasStandardBrowserEnv?function(){const e=Ts.navigator&&/(msie|trident)/i.test(Ts.navigator.userAgent),n=document.createElement("a");let s;function r(i){let o=i;return e&&(n.setAttribute("href",o),o=n.href),n.setAttribute("href",o),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return s=r(window.location.href),function(o){const a=ie.isString(o)?r(o):o;return a.protocol===s.protocol&&a.host===s.host}}():function(){return function(){return!0}}(),ZW=Ts.hasStandardBrowserEnv?{write(t,e,n,s,r,i){const o=[t+"="+encodeURIComponent(e)];ie.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),ie.isString(s)&&o.push("path="+s),ie.isString(r)&&o.push("domain="+r),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function ej(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function tj(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function D_(t,e){return t&&!ej(e)?tj(t,e):e}const P2=t=>t instanceof Es?{...t}:t;function Ua(t,e){e=e||{};const n={};function s(c,u,d){return ie.isPlainObject(c)&&ie.isPlainObject(u)?ie.merge.call({caseless:d},c,u):ie.isPlainObject(u)?ie.merge({},u):ie.isArray(u)?u.slice():u}function r(c,u,d){if(ie.isUndefined(u)){if(!ie.isUndefined(c))return s(void 0,c,d)}else return s(c,u,d)}function i(c,u){if(!ie.isUndefined(u))return s(void 0,u)}function o(c,u){if(ie.isUndefined(u)){if(!ie.isUndefined(c))return s(void 0,c)}else return s(void 0,u)}function a(c,u,d){if(d in e)return s(c,u);if(d in t)return s(void 0,c)}const l={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(c,u)=>r(P2(c),P2(u),!0)};return ie.forEach(Object.keys(Object.assign({},t,e)),function(u){const d=l[u]||r,h=d(t[u],e[u],u);ie.isUndefined(h)&&d!==a||(n[u]=h)}),n}const F_=t=>{const e=Ua({},t);let{data:n,withXSRFToken:s,xsrfHeaderName:r,xsrfCookieName:i,headers:o,auth:a}=e;e.headers=o=Es.from(o),e.url=T_(D_(e.baseURL,e.url),t.params,t.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let l;if(ie.isFormData(n)){if(Ts.hasStandardBrowserEnv||Ts.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[c,...u]=l?l.split(";").map(d=>d.trim()).filter(Boolean):[];o.setContentType([c||"multipart/form-data",...u].join("; "))}}if(Ts.hasStandardBrowserEnv&&(s&&ie.isFunction(s)&&(s=s(e)),s||s!==!1&&JW(e.url))){const c=r&&i&&ZW.read(i);c&&o.set(r,c)}return e},nj=typeof XMLHttpRequest<"u",sj=nj&&function(t){return new Promise(function(n,s){const r=F_(t);let i=r.data;const o=Es.from(r.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:c}=r,u,d,h,f,p;function m(){f&&f(),p&&p(),r.cancelToken&&r.cancelToken.unsubscribe(u),r.signal&&r.signal.removeEventListener("abort",u)}let g=new XMLHttpRequest;g.open(r.method.toUpperCase(),r.url,!0),g.timeout=r.timeout;function x(){if(!g)return;const v=Es.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),C={data:!a||a==="text"||a==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:v,config:t,request:g};A_(function(T){n(T),m()},function(T){s(T),m()},C),g=null}"onloadend"in g?g.onloadend=x:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(x)},g.onabort=function(){g&&(s(new Ke("Request aborted",Ke.ECONNABORTED,t,g)),g=null)},g.onerror=function(){s(new Ke("Network Error",Ke.ERR_NETWORK,t,g)),g=null},g.ontimeout=function(){let w=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const C=r.transitional||E_;r.timeoutErrorMessage&&(w=r.timeoutErrorMessage),s(new Ke(w,C.clarifyTimeoutError?Ke.ETIMEDOUT:Ke.ECONNABORTED,t,g)),g=null},i===void 0&&o.setContentType(null),"setRequestHeader"in g&&ie.forEach(o.toJSON(),function(w,C){g.setRequestHeader(C,w)}),ie.isUndefined(r.withCredentials)||(g.withCredentials=!!r.withCredentials),a&&a!=="json"&&(g.responseType=r.responseType),c&&([h,p]=am(c,!0),g.addEventListener("progress",h)),l&&g.upload&&([d,f]=am(l),g.upload.addEventListener("progress",d),g.upload.addEventListener("loadend",f)),(r.cancelToken||r.signal)&&(u=v=>{g&&(s(!v||v.type?new Oc(null,t,g):v),g.abort(),g=null)},r.cancelToken&&r.cancelToken.subscribe(u),r.signal&&(r.signal.aborted?u():r.signal.addEventListener("abort",u)));const b=qW(r.url);if(b&&Ts.protocols.indexOf(b)===-1){s(new Ke("Unsupported protocol "+b+":",Ke.ERR_BAD_REQUEST,t));return}g.send(i||null)})},rj=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let s=new AbortController,r;const i=function(c){if(!r){r=!0,a();const u=c instanceof Error?c:this.reason;s.abort(u instanceof Ke?u:new Oc(u instanceof Error?u.message:u))}};let o=e&&setTimeout(()=>{o=null,i(new Ke(`timeout ${e} of ms exceeded`,Ke.ETIMEDOUT))},e);const a=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(c=>{c.unsubscribe?c.unsubscribe(i):c.removeEventListener("abort",i)}),t=null)};t.forEach(c=>c.addEventListener("abort",i));const{signal:l}=s;return l.unsubscribe=()=>ie.asap(a),l}},ij=function*(t,e){let n=t.byteLength;if(n<e){yield t;return}let s=0,r;for(;s<n;)r=s+e,yield t.slice(s,r),s=r},oj=async function*(t,e){for await(const n of aj(t))yield*ij(n,e)},aj=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:s}=await e.read();if(n)break;yield s}}finally{await e.cancel()}},L2=(t,e,n,s)=>{const r=oj(t,e);let i=0,o,a=l=>{o||(o=!0,s&&s(l))};return new ReadableStream({async pull(l){try{const{done:c,value:u}=await r.next();if(c){a(),l.close();return}let d=u.byteLength;if(n){let h=i+=d;n(h)}l.enqueue(new Uint8Array(u))}catch(c){throw a(c),c}},cancel(l){return a(l),r.return()}},{highWaterMark:2})},pg=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",O_=pg&&typeof ReadableStream=="function",lj=pg&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),P_=(t,...e)=>{try{return!!t(...e)}catch{return!1}},cj=O_&&P_(()=>{let t=!1;const e=new Request(Ts.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),M2=64*1024,Cb=O_&&P_(()=>ie.isReadableStream(new Response("").body)),lm={stream:Cb&&(t=>t.body)};pg&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!lm[e]&&(lm[e]=ie.isFunction(t[e])?n=>n[e]():(n,s)=>{throw new Ke(`Response type '${e}' is not supported`,Ke.ERR_NOT_SUPPORT,s)})})})(new Response);const uj=async t=>{if(t==null)return 0;if(ie.isBlob(t))return t.size;if(ie.isSpecCompliantForm(t))return(await new Request(Ts.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(ie.isArrayBufferView(t)||ie.isArrayBuffer(t))return t.byteLength;if(ie.isURLSearchParams(t)&&(t=t+""),ie.isString(t))return(await lj(t)).byteLength},dj=async(t,e)=>{const n=ie.toFiniteNumber(t.getContentLength());return n??uj(e)},hj=pg&&(async t=>{let{url:e,method:n,data:s,signal:r,cancelToken:i,timeout:o,onDownloadProgress:a,onUploadProgress:l,responseType:c,headers:u,withCredentials:d="same-origin",fetchOptions:h}=F_(t);c=c?(c+"").toLowerCase():"text";let f=rj([r,i&&i.toAbortSignal()],o),p;const m=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let g;try{if(l&&cj&&n!=="get"&&n!=="head"&&(g=await dj(u,s))!==0){let C=new Request(e,{method:"POST",body:s,duplex:"half"}),$;if(ie.isFormData(s)&&($=C.headers.get("content-type"))&&u.setContentType($),C.body){const[T,N]=F2(g,am(O2(l)));s=L2(C.body,M2,T,N)}}ie.isString(d)||(d=d?"include":"omit");const x="credentials"in Request.prototype;p=new Request(e,{...h,signal:f,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:s,duplex:"half",credentials:x?d:void 0});let b=await fetch(p);const v=Cb&&(c==="stream"||c==="response");if(Cb&&(a||v&&m)){const C={};["status","statusText","headers"].forEach(_=>{C[_]=b[_]});const $=ie.toFiniteNumber(b.headers.get("content-length")),[T,N]=a&&F2($,am(O2(a),!0))||[];b=new Response(L2(b.body,M2,T,()=>{N&&N(),m&&m()}),C)}c=c||"text";let w=await lm[ie.findKey(lm,c)||"text"](b,t);return!v&&m&&m(),await new Promise((C,$)=>{A_(C,$,{data:w,headers:Es.from(b.headers),status:b.status,statusText:b.statusText,config:t,request:p})})}catch(x){throw m&&m(),x&&x.name==="TypeError"&&/fetch/i.test(x.message)?Object.assign(new Ke("Network Error",Ke.ERR_NETWORK,t,p),{cause:x.cause||x}):Ke.from(x,x&&x.code,t,p)}}),Sb={http:NW,xhr:sj,fetch:hj};ie.forEach(Sb,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const z2=t=>`- ${t}`,fj=t=>ie.isFunction(t)||t===null||t===!1,L_={getAdapter:t=>{t=ie.isArray(t)?t:[t];const{length:e}=t;let n,s;const r={};for(let i=0;i<e;i++){n=t[i];let o;if(s=n,!fj(n)&&(s=Sb[(o=String(n)).toLowerCase()],s===void 0))throw new Ke(`Unknown adapter '${o}'`);if(s)break;r[o||"#"+i]=s}if(!s){const i=Object.entries(r).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?i.length>1?`since :
`+i.map(z2).join(`
`):" "+z2(i[0]):"as no adapter specified";throw new Ke("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s},adapters:Sb};function X0(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Oc(null,t)}function B2(t){return X0(t),t.headers=Es.from(t.headers),t.data=K0.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),L_.getAdapter(t.adapter||Kd.adapter)(t).then(function(s){return X0(t),s.data=K0.call(t,t.transformResponse,s),s.headers=Es.from(s.headers),s},function(s){return R_(s)||(X0(t),s&&s.response&&(s.response.data=K0.call(t,t.transformResponse,s.response),s.response.headers=Es.from(s.response.headers))),Promise.reject(s)})}const M_="1.7.7",Iv={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Iv[t]=function(s){return typeof s===t||"a"+(e<1?"n ":" ")+t}});const W2={};Iv.transitional=function(e,n,s){function r(i,o){return"[Axios v"+M_+"] Transitional option '"+i+"'"+o+(s?". "+s:"")}return(i,o,a)=>{if(e===!1)throw new Ke(r(o," has been removed"+(n?" in "+n:"")),Ke.ERR_DEPRECATED);return n&&!W2[o]&&(W2[o]=!0,console.warn(r(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(i,o,a):!0}};function pj(t,e,n){if(typeof t!="object")throw new Ke("options must be an object",Ke.ERR_BAD_OPTION_VALUE);const s=Object.keys(t);let r=s.length;for(;r-- >0;){const i=s[r],o=e[i];if(o){const a=t[i],l=a===void 0||o(a,i,t);if(l!==!0)throw new Ke("option "+i+" must be "+l,Ke.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Ke("Unknown option "+i,Ke.ERR_BAD_OPTION)}}const Ib={assertOptions:pj,validators:Iv},no=Ib.validators;let Fa=class{constructor(e){this.defaults=e,this.interceptors={request:new A2,response:new A2}}async request(e,n){try{return await this._request(e,n)}catch(s){if(s instanceof Error){let r;Error.captureStackTrace?Error.captureStackTrace(r={}):r=new Error;const i=r.stack?r.stack.replace(/^.+\n/,""):"";try{s.stack?i&&!String(s.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+i):s.stack=i}catch{}}throw s}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Ua(this.defaults,n);const{transitional:s,paramsSerializer:r,headers:i}=n;s!==void 0&&Ib.assertOptions(s,{silentJSONParsing:no.transitional(no.boolean),forcedJSONParsing:no.transitional(no.boolean),clarifyTimeoutError:no.transitional(no.boolean)},!1),r!=null&&(ie.isFunction(r)?n.paramsSerializer={serialize:r}:Ib.assertOptions(r,{encode:no.function,serialize:no.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=i&&ie.merge(i.common,i[n.method]);i&&ie.forEach(["delete","get","head","post","put","patch","common"],p=>{delete i[p]}),n.headers=Es.concat(o,i);const a=[];let l=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(n)===!1||(l=l&&m.synchronous,a.unshift(m.fulfilled,m.rejected))});const c=[];this.interceptors.response.forEach(function(m){c.push(m.fulfilled,m.rejected)});let u,d=0,h;if(!l){const p=[B2.bind(this),void 0];for(p.unshift.apply(p,a),p.push.apply(p,c),h=p.length,u=Promise.resolve(n);d<h;)u=u.then(p[d++],p[d++]);return u}h=a.length;let f=n;for(d=0;d<h;){const p=a[d++],m=a[d++];try{f=p(f)}catch(g){m.call(this,g);break}}try{u=B2.call(this,f)}catch(p){return Promise.reject(p)}for(d=0,h=c.length;d<h;)u=u.then(c[d++],c[d++]);return u}getUri(e){e=Ua(this.defaults,e);const n=D_(e.baseURL,e.url);return T_(n,e.params,e.paramsSerializer)}};ie.forEach(["delete","get","head","options"],function(e){Fa.prototype[e]=function(n,s){return this.request(Ua(s||{},{method:e,url:n,data:(s||{}).data}))}});ie.forEach(["post","put","patch"],function(e){function n(s){return function(i,o,a){return this.request(Ua(a||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}Fa.prototype[e]=n(),Fa.prototype[e+"Form"]=n(!0)});let mj=class z_{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const s=this;this.promise.then(r=>{if(!s._listeners)return;let i=s._listeners.length;for(;i-- >0;)s._listeners[i](r);s._listeners=null}),this.promise.then=r=>{let i;const o=new Promise(a=>{s.subscribe(a),i=a}).then(r);return o.cancel=function(){s.unsubscribe(i)},o},e(function(i,o,a){s.reason||(s.reason=new Oc(i,o,a),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=s=>{e.abort(s)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new z_(function(r){e=r}),cancel:e}}};function gj(t){return function(n){return t.apply(null,n)}}function xj(t){return ie.isObject(t)&&t.isAxiosError===!0}const $b={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries($b).forEach(([t,e])=>{$b[e]=t});function B_(t){const e=new Fa(t),n=g_(Fa.prototype.request,e);return ie.extend(n,Fa.prototype,e,{allOwnKeys:!0}),ie.extend(n,e,null,{allOwnKeys:!0}),n.create=function(r){return B_(Ua(t,r))},n}const sn=B_(Kd);sn.Axios=Fa;sn.CanceledError=Oc;sn.CancelToken=mj;sn.isCancel=R_;sn.VERSION=M_;sn.toFormData=fg;sn.AxiosError=Ke;sn.Cancel=sn.CanceledError;sn.all=function(e){return Promise.all(e)};sn.spread=gj;sn.isAxiosError=xj;sn.mergeConfig=Ua;sn.AxiosHeaders=Es;sn.formToJSON=t=>__(ie.isHTMLForm(t)?new FormData(t):t);sn.getAdapter=L_.getAdapter;sn.HttpStatusCode=$b;sn.default=sn;const{Axios:txe,AxiosError:nxe,CanceledError:sxe,isCancel:rxe,CancelToken:ixe,VERSION:oxe,all:axe,Cancel:lxe,isAxiosError:cxe,spread:uxe,toFormData:dxe,AxiosHeaders:hxe,HttpStatusCode:fxe,formToJSON:pxe,getAdapter:mxe,mergeConfig:gxe}=sn,cn=sn.create({baseURL:"http://localhost:8000"});function Ga(t){t?cn.defaults.headers.common.Authorization=`Bearer ${t}`:delete cn.defaults.headers.common.Authorization}const j2=localStorage.getItem("token");j2&&Ga(j2);const W_=J.createContext(void 0),mg=()=>{const t=J.useContext(W_);if(!t)throw new Error("useProfile must be used within a ProfileProvider");return t},yj=({children:t})=>{const[e,n]=J.useState(null),[s,r]=J.useState([]),[i,o]=J.useState(null),[a,l]=J.useState(!0),c=async()=>{var f,p;l(!0);const h=localStorage.getItem("token");if(!h){console.warn("No token found"),l(!1);return}Ga(h);try{console.log("Fetching profile data...");const m=await cn.get("/profile"),g=await cn.get("/progress"),x=await cn.get("/recommendations");console.log("Profile response:",m.data),console.log("Progress response:",g.data),console.log("Recommendations response:",x.data),n(m.data),r(g.data||[]),o(x.data)}catch(m){console.error("Data fetch error:",(f=m.response)==null?void 0:f.status,((p=m.response)==null?void 0:p.data)||m.message)}l(!1)};J.useEffect(()=>{c()},[]);const u=()=>{c()},d=h=>{n(h)};return S.jsx(W_.Provider,{value:{profile:e,progress:s,rec:i,loading:a,refetch:u,updateProfile:d},children:t})};function bj(){const[t,e]=J.useState(""),[n,s]=J.useState(""),[r,i]=J.useState(""),[o,a]=J.useState(!1),l=ul(),{refetch:c}=mg();async function u(d){var h,f;d.preventDefault(),i(""),a(!0);try{const m=(await cn.post("/auth/signup",{email:t.trim(),password:n})).data.access_token;localStorage.setItem("token",m),Ga(m),c(),l("/home")}catch(p){i(((f=(h=p==null?void 0:p.response)==null?void 0:h.data)==null?void 0:f.detail)||"Signup failed. Please try again.")}finally{a(!1)}}return S.jsxs("div",{style:At.wrapper,children:[S.jsx("header",{style:At.topHeader,children:S.jsx("div",{style:At.headerContainer,children:S.jsxs("div",{style:At.logoTitleGroup,children:[S.jsx("div",{style:At.logoIconContainer,children:S.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"#00B894",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:S.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"})})}),S.jsxs("h1",{style:At.brandTitle,children:["PERSONALIZED ",S.jsx("span",{style:At.brandHighlight,children:"FITNESS"}),S.jsx("span",{style:At.brandDivider,children:"|"}),S.jsx("span",{style:At.brandSubText,children:"WORKOUT GUIDANCE SYSTEM"})]})]})})}),S.jsx("main",{style:At.main,children:S.jsxs("div",{style:At.card,children:[S.jsxs("div",{style:At.cardHeader,children:[S.jsx("h2",{style:At.cardTitle,children:"Create Account"}),S.jsx("p",{style:At.cardSubtitle,children:"Start your journey to peak performance."})]}),r&&S.jsx("div",{style:At.errorBox,children:r}),S.jsxs("form",{onSubmit:u,style:At.form,children:[S.jsxs("div",{style:At.field,children:[S.jsx("label",{style:At.label,children:"Email Address"}),S.jsx("input",{style:At.input,type:"email",value:t,onChange:d=>e(d.target.value),required:!0})]}),S.jsxs("div",{style:At.field,children:[S.jsx("label",{style:At.label,children:"Password"}),S.jsx("input",{style:At.input,type:"password",value:n,onChange:d=>s(d.target.value),required:!0})]}),S.jsx("button",{style:{...At.button,opacity:o?.7:1},type:"submit",disabled:o,children:o?"Creating Account...":"Sign Up"})]}),S.jsxs("div",{style:At.footer,children:[S.jsx("span",{children:"Already have an account?"})," ",S.jsx(Pi,{to:"/signin",style:At.link,children:"Sign In"})]})]})})]})}const At={wrapper:{minHeight:"100vh",display:"flex",flexDirection:"column",backgroundColor:"#F8FAFC",fontFamily:'"Inter", -apple-system, sans-serif'},topHeader:{height:"60px",backgroundColor:"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(16px)",WebkitBackdropFilter:"blur(16px)",border:"1px solid rgba(0, 0, 0, 0.05)",display:"flex",alignItems:"center",justifyContent:"center",position:"fixed",top:"16px",left:"24px",right:"24px",borderRadius:"20px",zIndex:100,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.03)"},headerContainer:{display:"flex",alignItems:"center",justifyContent:"center"},logoIconContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:"30px",height:"30px",borderRadius:"8px",backgroundColor:"rgba(0, 184, 148, 0.08)"},logoTitleGroup:{display:"flex",alignItems:"center",gap:"14px"},brandTitle:{fontSize:"13px",fontWeight:500,color:"#64748B",margin:0,letterSpacing:"0.12em",textTransform:"uppercase"},brandHighlight:{color:"#0F172A",fontWeight:700},brandDivider:{margin:"0 8px",color:"#CBD5E1",fontWeight:300},brandSubText:{fontWeight:400,color:"#94A3B8"},main:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"120px 20px 40px"},card:{width:"100%",maxWidth:"350px",background:"#ffffff",padding:"40px 32px",borderRadius:"24px",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.02), 0 8px 10px -6px rgba(0, 0, 0, 0.03)",border:"1px solid #F1F5F9"},cardHeader:{textAlign:"center",marginBottom:"32px"},cardTitle:{fontSize:"22px",fontWeight:800,color:"#0F172A",margin:"0 0 8px 0",letterSpacing:"-0.02em"},cardSubtitle:{fontSize:"14px",color:"#64748B",margin:0},errorBox:{background:"#FFF1F2",color:"#E11D48",padding:"12px",borderRadius:"12px",fontSize:"13px",marginBottom:"20px",border:"1px solid #FFE4E6",textAlign:"center",fontWeight:500},form:{display:"flex",flexDirection:"column",gap:"20px"},field:{display:"flex",flexDirection:"column",gap:"8px"},label:{fontSize:"12px",fontWeight:600,color:"#475569",textTransform:"uppercase",letterSpacing:"0.05em",marginLeft:"4px"},input:{padding:"12px 16px",borderRadius:"12px",border:"1px solid #E2E8F0",fontSize:"15px",outline:"none",backgroundColor:"#F8FAFC",transition:"all 0.2s ease"},button:{width:"100%",padding:"14px",border:"none",borderRadius:"12px",fontSize:"15px",fontWeight:700,color:"#ffffff",background:"#0F172A",cursor:"pointer",marginTop:"10px",boxShadow:"0 4px 6px -1px rgba(15, 23, 42, 0.15)"},footer:{marginTop:"32px",textAlign:"center",fontSize:"14px",color:"#64748B"},link:{color:"#00B894",fontWeight:700,textDecoration:"none",borderBottom:"1.5px solid rgba(0, 184, 148, 0.2)"}};function vj(){const[t,e]=J.useState(""),[n,s]=J.useState(""),[r,i]=J.useState(!1),[o,a]=J.useState(""),l=ul(),{refetch:c}=mg();J.useEffect(()=>{const d=localStorage.getItem("token");d&&(Ga(d),c(),l("/dashboard",{replace:!0}))},[l]);async function u(d){var h,f;d.preventDefault(),a(""),i(!0);try{const m=(await cn.post("/auth/login",{email:t.trim(),password:n})).data.access_token;localStorage.setItem("token",m),Ga(m),c(),l("/dashboard",{replace:!0})}catch(p){a(((f=(h=p.response)==null?void 0:h.data)==null?void 0:f.detail)||"Invalid credentials. Please try again.")}finally{i(!1)}}return S.jsxs("div",{style:Dt.wrapper,children:[S.jsx("header",{style:Dt.topHeader,children:S.jsx("div",{style:Dt.headerContainer,children:S.jsxs("div",{style:Dt.logoTitleGroup,children:[S.jsx("div",{style:Dt.logoIconContainer,children:S.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"#00B894",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:S.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"})})}),S.jsxs("h1",{style:Dt.brandTitle,children:["PERSONALIZED ",S.jsx("span",{style:Dt.brandHighlight,children:"FITNESS"}),S.jsx("span",{style:Dt.brandDivider,children:"|"}),S.jsx("span",{style:Dt.brandSubText,children:"WORKOUT GUIDANCE SYSTEM"})]})]})})}),S.jsx("main",{style:Dt.main,children:S.jsxs("div",{style:Dt.card,children:[S.jsxs("div",{style:Dt.cardHeader,children:[S.jsx("h2",{style:Dt.cardTitle,children:"Welcome Back"}),S.jsx("p",{style:Dt.cardSubtitle,children:"Sign in to continue your progress."})]}),o&&S.jsx("div",{style:Dt.errorBox,children:o}),S.jsxs("form",{onSubmit:u,style:Dt.form,children:[S.jsxs("div",{style:Dt.field,children:[S.jsx("label",{style:Dt.label,children:"Email Address"}),S.jsx("input",{style:Dt.input,type:"email",value:t,onChange:d=>e(d.target.value),required:!0})]}),S.jsxs("div",{style:Dt.field,children:[S.jsx("label",{style:Dt.label,children:"Password"}),S.jsx("input",{style:Dt.input,type:"password",value:n,onChange:d=>s(d.target.value),required:!0})]}),S.jsx("button",{style:{...Dt.button,opacity:r?.7:1},type:"submit",disabled:r,children:r?"Authenticating...":"Sign In"})]}),S.jsxs("div",{style:Dt.footer,children:[S.jsx("span",{children:"Don't have an account?"})," ",S.jsx(Pi,{to:"/signup",style:Dt.link,children:"Create Account"})]})]})})]})}const Dt={wrapper:{minHeight:"100vh",display:"flex",flexDirection:"column",backgroundColor:"#F8FAFC",fontFamily:'"Inter", -apple-system, sans-serif'},topHeader:{height:"60px",backgroundColor:"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(16px)",WebkitBackdropFilter:"blur(16px)",border:"1px solid rgba(0, 0, 0, 0.05)",display:"flex",alignItems:"center",justifyContent:"center",position:"fixed",top:"16px",left:"24px",right:"24px",borderRadius:"20px",zIndex:100,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.03)"},headerContainer:{display:"flex",alignItems:"center",justifyContent:"center"},logoIconContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:"30px",height:"30px",borderRadius:"8px",backgroundColor:"rgba(0, 184, 148, 0.08)"},logoTitleGroup:{display:"flex",alignItems:"center",gap:"14px"},brandTitle:{fontSize:"13px",fontWeight:500,color:"#64748B",margin:0,letterSpacing:"0.12em",textTransform:"uppercase"},brandHighlight:{color:"#0F172A",fontWeight:700},brandDivider:{margin:"0 8px",color:"#CBD5E1",fontWeight:300},brandSubText:{fontWeight:400,color:"#94A3B8"},main:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"120px 20px 40px"},card:{width:"100%",maxWidth:"350px",background:"#ffffff",padding:"40px 32px",borderRadius:"24px",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.02), 0 8px 10px -6px rgba(0, 0, 0, 0.03)",border:"1px solid #F1F5F9"},cardHeader:{textAlign:"center",marginBottom:"32px"},cardTitle:{fontSize:"22px",fontWeight:800,color:"#0F172A",margin:"0 0 8px 0",letterSpacing:"-0.02em"},cardSubtitle:{fontSize:"14px",color:"#64748B",margin:0},errorBox:{background:"#FFF1F2",color:"#E11D48",padding:"12px",borderRadius:"12px",fontSize:"13px",marginBottom:"20px",border:"1px solid #FFE4E6",textAlign:"center",fontWeight:500},form:{display:"flex",flexDirection:"column",gap:"20px"},field:{display:"flex",flexDirection:"column",gap:"8px"},label:{fontSize:"12px",fontWeight:600,color:"#475569",textTransform:"uppercase",letterSpacing:"0.05em",marginLeft:"4px"},input:{padding:"12px 16px",borderRadius:"12px",border:"1px solid #E2E8F0",fontSize:"15px",outline:"none",backgroundColor:"#F8FAFC",transition:"all 0.2s ease"},button:{width:"100%",padding:"14px",border:"none",borderRadius:"12px",fontSize:"15px",fontWeight:700,color:"#ffffff",background:"#0F172A",cursor:"pointer",marginTop:"10px",boxShadow:"0 4px 6px -1px rgba(15, 23, 42, 0.15)"},footer:{marginTop:"32px",textAlign:"center",fontSize:"14px",color:"#64748B"},link:{color:"#00B894",fontWeight:700,textDecoration:"none",borderBottom:"1.5px solid rgba(0, 184, 148, 0.2)"}};function wj(){const t=ul();return S.jsxs("div",{className:"home-wrapper",children:[S.jsx("style",{children:`
        .home-wrapper {
          min-height: 100vh;
          background: #f8fafc; /* Very light slate-grey for a premium feel */
          font-family: 'Inter', system-ui, sans-serif;
          color: #0f172a;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 24px;
        }

        .bento-container {
          max-width: 800px;
          width: 100%;
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 16px;
        }

        /* HEADER BOX - Elegant Minimalist */
        .box-header {
          grid-column: span 3;
          padding: 40px 20px;
          background: transparent;
          text-align: center;
        }

        .box-header h1 {
          font-size: 2.2rem;
          font-weight: 900;
          letter-spacing: -0.05em;
          margin: 0;
          color: #0f172a;
        }

        .box-header p {
          font-size: 1rem;
          color: #64748b;
          margin-top: 8px;
        }

        /* FEATURE BOXES - White & Elevated */
        .box-feature {
          text-decoration: none;
          background: #ffffff;
          padding: 32px 24px;
          border-radius: 32px;
          border: 1px solid rgba(226, 232, 240, 0.6);
          transition: all 0.4s cubic-bezier(0.2, 1, 0.3, 1);
          display: flex;
          flex-direction: column;
          justify-content: center;
          align-items: center;
          text-align: center;
          box-shadow: 0 4px 15px rgba(0, 0, 0, 0.02);
        }

        .box-feature:hover {
          transform: translateY(-6px);
          border-color: #cbd5e1;
          box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.05);
        }

        /* Span adjustments - Maintaining your structure */
        .span-2 { grid-column: span 2; }
        .span-1 { grid-column: span 1; }

        .icon { 
          font-size: 32px; 
          margin-bottom: 16px; 
          display: flex;
          align-items: center;
          justify-content: center;
          width: 60px;
          height: 60px;
          border-radius: 20px;
        }

        /* Subtle Color Accents for Icons */
        .ic-1 { background: #eff6ff; } /* Blue tint */
        .ic-2 { background: #fef3c7; } /* Amber tint */
        .ic-3 { background: #ecfdf5; } /* Emerald tint */
        .ic-4 { background: #fdf2f8; } /* Pink tint */

        .box-feature h3 { font-size: 1.1rem; font-weight: 700; margin: 0; color: #1e293b; }
        .box-feature p { font-size: 0.85rem; color: #64748b; margin-top: 6px; line-height: 1.5; }

        /* CTA BOX - Sophisticated Gradient */
        .box-cta {
          grid-column: span 3;
          background: #0f172a; /* Dark Slate for contrast */
          padding: 32px 40px;
          border-radius: 32px;
          display: flex;
          align-items: center;
          justify-content: space-between;
          color: #fff;
          margin-top: 8px;
          box-shadow: 0 10px 30px rgba(15, 23, 42, 0.2);
        }

        .cta-content h2 { font-size: 1.25rem; margin: 0; font-weight: 700; letter-spacing: -0.02em; }
        .cta-content p { font-size: 0.9rem; color: #94a3b8; margin-top: 4px; }

        .cta-btn {
          background: #10b981;
          color: white;
          border: none;
          padding: 14px 32px;
          border-radius: 16px;
          font-weight: 700;
          font-size: 0.95rem;
          cursor: pointer;
          transition: 0.3s;
        }

        .cta-btn:hover { 
          background: #059669; 
          transform: scale(1.03); 
          box-shadow: 0 0 20px rgba(16, 185, 129, 0.4);
        }

        @media (max-width: 700px) {
          .bento-container { grid-template-columns: 1fr; gap: 12px; }
          .box-header, .box-feature, .box-cta, .span-2 { grid-column: span 1; }
          .box-cta { flex-direction: column; text-align: center; gap: 24px; padding: 32px 20px; }
          .box-header h1 { font-size: 1.8rem; }
        }
      `}),S.jsxs("div",{className:"bento-container",children:[S.jsxs("div",{className:"box-header",children:[S.jsx("h1",{children:"Fitness Guidance"}),S.jsx("p",{children:"Personalized health tracking, intelligently designed."})]}),S.jsxs(Pi,{to:"/dashboard",className:"box-feature span-2",children:[S.jsx("div",{className:"icon ic-1",children:""}),S.jsx("h3",{children:"Dashboard"}),S.jsx("p",{children:"Real-time BMI monitoring and activity tracking."})]}),S.jsxs(Pi,{to:"/trainer",className:"box-feature span-1",children:[S.jsx("div",{className:"icon ic-2",children:""}),S.jsx("h3",{children:"AI Trainer"}),S.jsx("p",{children:"Perfect your posture with AI."})]}),S.jsxs(Pi,{to:"/reports",className:"box-feature span-1",children:[S.jsx("div",{className:"icon ic-3",children:""}),S.jsx("h3",{children:"Reports"}),S.jsx("p",{children:"Deep medical analysis."})]}),S.jsxs(Pi,{to:"/chat",className:"box-feature span-2",children:[S.jsx("div",{className:"icon ic-4",children:""}),S.jsx("h3",{children:"Health Assistant"}),S.jsx("p",{children:"Instant fitness advice and custom workout routines."})]}),S.jsxs("div",{className:"box-cta",children:[S.jsxs("div",{className:"cta-content",children:[S.jsx("h2",{children:"Start Assessment"}),S.jsx("p",{children:"Ready to customize your plan?"})]}),S.jsx("button",{className:"cta-btn",onClick:()=>t("/intake"),children:"Get Started "})]})]})]})}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Xd(t){return t+.5|0}const mo=(t,e,n)=>Math.max(Math.min(t,n),e);function Ru(t){return mo(Xd(t*2.55),0,255)}function Ro(t){return mo(Xd(t*255),0,255)}function Ri(t){return mo(Xd(t/2.55)/100,0,1)}function V2(t){return mo(Xd(t*100),0,100)}const Ys={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Nb=[..."0123456789ABCDEF"],kj=t=>Nb[t&15],Cj=t=>Nb[(t&240)>>4]+Nb[t&15],Uf=t=>(t&240)>>4===(t&15),Sj=t=>Uf(t.r)&&Uf(t.g)&&Uf(t.b)&&Uf(t.a);function Ij(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&Ys[t[1]]*17,g:255&Ys[t[2]]*17,b:255&Ys[t[3]]*17,a:e===5?Ys[t[4]]*17:255}:(e===7||e===9)&&(n={r:Ys[t[1]]<<4|Ys[t[2]],g:Ys[t[3]]<<4|Ys[t[4]],b:Ys[t[5]]<<4|Ys[t[6]],a:e===9?Ys[t[7]]<<4|Ys[t[8]]:255})),n}const $j=(t,e)=>t<255?e(t):"";function Nj(t){var e=Sj(t)?kj:Cj;return t?"#"+e(t.r)+e(t.g)+e(t.b)+$j(t.a,e):void 0}const Tj=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function j_(t,e,n){const s=e*Math.min(n,1-n),r=(i,o=(i+t/30)%12)=>n-s*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function Ej(t,e,n){const s=(r,i=(r+t/60)%6)=>n-n*e*Math.max(Math.min(i,4-i,1),0);return[s(5),s(3),s(1)]}function _j(t,e,n){const s=j_(t,1,.5);let r;for(e+n>1&&(r=1/(e+n),e*=r,n*=r),r=0;r<3;r++)s[r]*=1-e-n,s[r]+=e;return s}function Rj(t,e,n,s,r){return t===r?(e-n)/s+(e<n?6:0):e===r?(n-t)/s+2:(t-e)/s+4}function $v(t){const n=t.r/255,s=t.g/255,r=t.b/255,i=Math.max(n,s,r),o=Math.min(n,s,r),a=(i+o)/2;let l,c,u;return i!==o&&(u=i-o,c=a>.5?u/(2-i-o):u/(i+o),l=Rj(n,s,r,u,i),l=l*60+.5),[l|0,c||0,a]}function Nv(t,e,n,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,s)).map(Ro)}function Tv(t,e,n){return Nv(j_,t,e,n)}function Aj(t,e,n){return Nv(_j,t,e,n)}function Dj(t,e,n){return Nv(Ej,t,e,n)}function V_(t){return(t%360+360)%360}function Fj(t){const e=Tj.exec(t);let n=255,s;if(!e)return;e[5]!==s&&(n=e[6]?Ru(+e[5]):Ro(+e[5]));const r=V_(+e[2]),i=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?s=Aj(r,i,o):e[1]==="hsv"?s=Dj(r,i,o):s=Tv(r,i,o),{r:s[0],g:s[1],b:s[2],a:n}}function Oj(t,e){var n=$v(t);n[0]=V_(n[0]+e),n=Tv(n),t.r=n[0],t.g=n[1],t.b=n[2]}function Pj(t){if(!t)return;const e=$v(t),n=e[0],s=V2(e[1]),r=V2(e[2]);return t.a<255?`hsla(${n}, ${s}%, ${r}%, ${Ri(t.a)})`:`hsl(${n}, ${s}%, ${r}%)`}const U2={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},G2={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Lj(){const t={},e=Object.keys(G2),n=Object.keys(U2);let s,r,i,o,a;for(s=0;s<e.length;s++){for(o=a=e[s],r=0;r<n.length;r++)i=n[r],a=a.replace(i,U2[i]);i=parseInt(G2[o],16),t[a]=[i>>16&255,i>>8&255,i&255]}return t}let Gf;function Mj(t){Gf||(Gf=Lj(),Gf.transparent=[0,0,0,0]);const e=Gf[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const zj=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Bj(t){const e=zj.exec(t);let n=255,s,r,i;if(e){if(e[7]!==s){const o=+e[7];n=e[8]?Ru(o):mo(o*255,0,255)}return s=+e[1],r=+e[3],i=+e[5],s=255&(e[2]?Ru(s):mo(s,0,255)),r=255&(e[4]?Ru(r):mo(r,0,255)),i=255&(e[6]?Ru(i):mo(i,0,255)),{r:s,g:r,b:i,a:n}}}function Wj(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Ri(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const q0=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,Tl=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function jj(t,e,n){const s=Tl(Ri(t.r)),r=Tl(Ri(t.g)),i=Tl(Ri(t.b));return{r:Ro(q0(s+n*(Tl(Ri(e.r))-s))),g:Ro(q0(r+n*(Tl(Ri(e.g))-r))),b:Ro(q0(i+n*(Tl(Ri(e.b))-i))),a:t.a+n*(e.a-t.a)}}function Hf(t,e,n){if(t){let s=$v(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*n,e===0?360:1)),s=Tv(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function U_(t,e){return t&&Object.assign(e||{},t)}function H2(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=Ro(t[3]))):(e=U_(t,{r:0,g:0,b:0,a:1}),e.a=Ro(e.a)),e}function Vj(t){return t.charAt(0)==="r"?Bj(t):Fj(t)}class Cd{constructor(e){if(e instanceof Cd)return e;const n=typeof e;let s;n==="object"?s=H2(e):n==="string"&&(s=Ij(e)||Mj(e)||Vj(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=U_(this._rgb);return e&&(e.a=Ri(e.a)),e}set rgb(e){this._rgb=H2(e)}rgbString(){return this._valid?Wj(this._rgb):void 0}hexString(){return this._valid?Nj(this._rgb):void 0}hslString(){return this._valid?Pj(this._rgb):void 0}mix(e,n){if(e){const s=this.rgb,r=e.rgb;let i;const o=n===i?.5:n,a=2*o-1,l=s.a-r.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;i=1-c,s.r=255&c*s.r+i*r.r+.5,s.g=255&c*s.g+i*r.g+.5,s.b=255&c*s.b+i*r.b+.5,s.a=o*s.a+(1-o)*r.a,this.rgb=s}return this}interpolate(e,n){return e&&(this._rgb=jj(this._rgb,e._rgb,n)),this}clone(){return new Cd(this.rgb)}alpha(e){return this._rgb.a=Ro(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=Xd(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Hf(this._rgb,2,e),this}darken(e){return Hf(this._rgb,2,-e),this}saturate(e){return Hf(this._rgb,1,e),this}desaturate(e){return Hf(this._rgb,1,-e),this}rotate(e){return Oj(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function $i(){}const Uj=(()=>{let t=0;return()=>t++})();function $t(t){return t==null}function Sn(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function at(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function Jn(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function Jr(t,e){return Jn(t)?t:e}function st(t,e){return typeof t>"u"?e:t}const Gj=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function Ot(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function xt(t,e,n,s){let r,i,o;if(Sn(t))for(i=t.length,r=0;r<i;r++)e.call(n,t[r],r);else if(at(t))for(o=Object.keys(t),i=o.length,r=0;r<i;r++)e.call(n,t[o[r]],o[r])}function cm(t,e){let n,s,r,i;if(!t||!e||t.length!==e.length)return!1;for(n=0,s=t.length;n<s;++n)if(r=t[n],i=e[n],r.datasetIndex!==i.datasetIndex||r.index!==i.index)return!1;return!0}function um(t){if(Sn(t))return t.map(um);if(at(t)){const e=Object.create(null),n=Object.keys(t),s=n.length;let r=0;for(;r<s;++r)e[n[r]]=um(t[n[r]]);return e}return t}function G_(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function Hj(t,e,n,s){if(!G_(t))return;const r=e[t],i=n[t];at(r)&&at(i)?Sd(r,i,s):e[t]=um(i)}function Sd(t,e,n){const s=Sn(e)?e:[e],r=s.length;if(!at(t))return t;n=n||{};const i=n.merger||Hj;let o;for(let a=0;a<r;++a){if(o=s[a],!at(o))continue;const l=Object.keys(o);for(let c=0,u=l.length;c<u;++c)i(l[c],t,o,n)}return t}function qu(t,e){return Sd(t,e,{merger:Kj})}function Kj(t,e,n){if(!G_(t))return;const s=e[t],r=n[t];at(s)&&at(r)?qu(s,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=um(r))}const K2={"":t=>t,x:t=>t.x,y:t=>t.y};function Xj(t){const e=t.split("."),n=[];let s="";for(const r of e)s+=r,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function qj(t){const e=Xj(t);return n=>{for(const s of e){if(s==="")break;n=n&&n[s]}return n}}function dm(t,e){return(K2[e]||(K2[e]=qj(e)))(t)}function Ev(t){return t.charAt(0).toUpperCase()+t.slice(1)}const hm=t=>typeof t<"u",Mo=t=>typeof t=="function",X2=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function Yj(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const qn=Math.PI,Dr=2*qn,Qj=Dr+qn,fm=Number.POSITIVE_INFINITY,Jj=qn/180,Er=qn/2,ua=qn/4,q2=qn*2/3,H_=Math.log10,pc=Math.sign;function Yu(t,e,n){return Math.abs(t-e)<n}function Y2(t){const e=Math.round(t);t=Yu(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(H_(t))),s=t/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function Zj(t){const e=[],n=Math.sqrt(t);let s;for(s=1;s<n;s++)t%s===0&&(e.push(s),e.push(t/s));return n===(n|0)&&e.push(n),e.sort((r,i)=>r-i).pop(),e}function eV(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function Id(t){return!eV(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function tV(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function nV(t,e,n){let s,r,i;for(s=0,r=t.length;s<r;s++)i=t[s][n],isNaN(i)||(e.min=Math.min(e.min,i),e.max=Math.max(e.max,i))}function Na(t){return t*(qn/180)}function sV(t){return t*(180/qn)}function Q2(t){if(!Jn(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function rV(t,e){const n=e.x-t.x,s=e.y-t.y,r=Math.sqrt(n*n+s*s);let i=Math.atan2(s,n);return i<-.5*qn&&(i+=Dr),{angle:i,distance:r}}function Tb(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function iV(t,e){return(t-e+Qj)%Dr-qn}function ri(t){return(t%Dr+Dr)%Dr}function K_(t,e,n,s){const r=ri(t),i=ri(e),o=ri(n),a=ri(i-r),l=ri(o-r),c=ri(r-i),u=ri(r-o);return r===i||r===o||s&&i===o||a>l&&c<u}function ir(t,e,n){return Math.max(e,Math.min(n,t))}function oV(t){return ir(t,-32768,32767)}function Kl(t,e,n,s=1e-6){return t>=Math.min(e,n)-s&&t<=Math.max(e,n)+s}function _v(t,e,n){n=n||(o=>t[o]<e);let s=t.length-1,r=0,i;for(;s-r>1;)i=r+s>>1,n(i)?r=i:s=i;return{lo:r,hi:s}}const Ta=(t,e,n,s)=>_v(t,n,s?r=>{const i=t[r][e];return i<n||i===n&&t[r+1][e]===n}:r=>t[r][e]<n),aV=(t,e,n)=>_v(t,n,s=>t[s][e]>=n);function lV(t,e,n){let s=0,r=t.length;for(;s<r&&t[s]<e;)s++;for(;r>s&&t[r-1]>n;)r--;return s>0||r<t.length?t.slice(s,r):t}const X_=["push","pop","shift","splice","unshift"];function cV(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),X_.forEach(n=>{const s="_onData"+Ev(n),r=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...i){const o=r.apply(this,i);return t._chartjs.listeners.forEach(a=>{typeof a[s]=="function"&&a[s](...i)}),o}})})}function J2(t,e){const n=t._chartjs;if(!n)return;const s=n.listeners,r=s.indexOf(e);r!==-1&&s.splice(r,1),!(s.length>0)&&(X_.forEach(i=>{delete t[i]}),delete t._chartjs)}function uV(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const q_=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function Y_(t,e){let n=[],s=!1;return function(...r){n=r,s||(s=!0,q_.call(window,()=>{s=!1,t.apply(e,n)}))}}function dV(t,e){let n;return function(...s){return e?(clearTimeout(n),n=setTimeout(t,e,s)):t.apply(this,s),e}}const Q_=t=>t==="start"?"left":t==="end"?"right":"center",Fs=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,hV=(t,e,n,s)=>t===(s?"left":"right")?n:t==="center"?(e+n)/2:e;function fV(t,e,n){const s=e.length;let r=0,i=s;if(t._sorted){const{iScale:o,vScale:a,_parsed:l}=t,c=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null,u=o.axis,{min:d,max:h,minDefined:f,maxDefined:p}=o.getUserBounds();if(f){if(r=Math.min(Ta(l,u,d).lo,n?s:Ta(e,u,o.getPixelForValue(d)).lo),c){const m=l.slice(0,r+1).reverse().findIndex(g=>!$t(g[a.axis]));r-=Math.max(0,m)}r=ir(r,0,s-1)}if(p){let m=Math.max(Ta(l,o.axis,h,!0).hi+1,n?0:Ta(e,u,o.getPixelForValue(h),!0).hi+1);if(c){const g=l.slice(m-1).findIndex(x=>!$t(x[a.axis]));m+=Math.max(0,g)}i=ir(m,r,s)-r}else i=s-r}return{start:r,count:i}}function pV(t){const{xScale:e,yScale:n,_scaleRanges:s}=t,r={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!s)return t._scaleRanges=r,!0;const i=s.xmin!==e.min||s.xmax!==e.max||s.ymin!==n.min||s.ymax!==n.max;return Object.assign(s,r),i}const Kf=t=>t===0||t===1,Z2=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Dr/n)),eI=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*Dr/n)+1,Qu={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*Er)+1,easeOutSine:t=>Math.sin(t*Er),easeInOutSine:t=>-.5*(Math.cos(qn*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>Kf(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Kf(t)?t:Z2(t,.075,.3),easeOutElastic:t=>Kf(t)?t:eI(t,.075,.3),easeInOutElastic(t){return Kf(t)?t:t<.5?.5*Z2(t*2,.1125,.45):.5+.5*eI(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-Qu.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?Qu.easeInBounce(t*2)*.5:Qu.easeOutBounce(t*2-1)*.5+.5};function Rv(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function tI(t){return Rv(t)?t:new Cd(t)}function Y0(t){return Rv(t)?t:new Cd(t).saturate(.5).darken(.1).hexString()}const mV=["x","y","borderWidth","radius","tension"],gV=["color","borderColor","backgroundColor"];function xV(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:gV},numbers:{type:"number",properties:mV}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function yV(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const nI=new Map;function bV(t,e){e=e||{};const n=t+JSON.stringify(e);let s=nI.get(n);return s||(s=new Intl.NumberFormat(t,e),nI.set(n,s)),s}function J_(t,e,n){return bV(e,n).format(t)}const vV={values(t){return Sn(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const s=this.chart.options.locale;let r,i=t;if(n.length>1){const c=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(c<1e-4||c>1e15)&&(r="scientific"),i=wV(t,n)}const o=H_(Math.abs(i)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),J_(t,s,l)}};function wV(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var Z_={formatters:vV};function kV(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Z_.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Ha=Object.create(null),Eb=Object.create(null);function Ju(t,e){if(!e)return t;const n=e.split(".");for(let s=0,r=n.length;s<r;++s){const i=n[s];t=t[i]||(t[i]=Object.create(null))}return t}function Q0(t,e,n){return typeof e=="string"?Sd(Ju(t,e),n):Sd(Ju(t,""),e)}class CV{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,r)=>Y0(r.backgroundColor),this.hoverBorderColor=(s,r)=>Y0(r.borderColor),this.hoverColor=(s,r)=>Y0(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return Q0(this,e,n)}get(e){return Ju(this,e)}describe(e,n){return Q0(Eb,e,n)}override(e,n){return Q0(Ha,e,n)}route(e,n,s,r){const i=Ju(this,e),o=Ju(this,s),a="_"+n;Object.defineProperties(i,{[a]:{value:i[n],writable:!0},[n]:{enumerable:!0,get(){const l=this[a],c=o[r];return at(l)?Object.assign({},c,l):st(l,c)},set(l){this[a]=l}}})}apply(e){e.forEach(n=>n(this))}}var tn=new CV({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[xV,yV,kV]);function SV(t){return!t||$t(t.size)||$t(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function sI(t,e,n,s,r){let i=e[r];return i||(i=e[r]=t.measureText(r).width,n.push(r)),i>s&&(s=i),s}function da(t,e,n){const s=t.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((e-r)*s)/s+r}function rI(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function _b(t,e,n,s){eR(t,e,n,s,null)}function eR(t,e,n,s,r){let i,o,a,l,c,u,d,h;const f=e.pointStyle,p=e.rotation,m=e.radius;let g=(p||0)*Jj;if(f&&typeof f=="object"&&(i=f.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){t.save(),t.translate(n,s),t.rotate(g),t.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),t.restore();return}if(!(isNaN(m)||m<=0)){switch(t.beginPath(),f){default:r?t.ellipse(n,s,r/2,m,0,0,Dr):t.arc(n,s,m,0,Dr),t.closePath();break;case"triangle":u=r?r/2:m,t.moveTo(n+Math.sin(g)*u,s-Math.cos(g)*m),g+=q2,t.lineTo(n+Math.sin(g)*u,s-Math.cos(g)*m),g+=q2,t.lineTo(n+Math.sin(g)*u,s-Math.cos(g)*m),t.closePath();break;case"rectRounded":c=m*.516,l=m-c,o=Math.cos(g+ua)*l,d=Math.cos(g+ua)*(r?r/2-c:l),a=Math.sin(g+ua)*l,h=Math.sin(g+ua)*(r?r/2-c:l),t.arc(n-d,s-a,c,g-qn,g-Er),t.arc(n+h,s-o,c,g-Er,g),t.arc(n+d,s+a,c,g,g+Er),t.arc(n-h,s+o,c,g+Er,g+qn),t.closePath();break;case"rect":if(!p){l=Math.SQRT1_2*m,u=r?r/2:l,t.rect(n-u,s-l,2*u,2*l);break}g+=ua;case"rectRot":d=Math.cos(g)*(r?r/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,h=Math.sin(g)*(r?r/2:m),t.moveTo(n-d,s-a),t.lineTo(n+h,s-o),t.lineTo(n+d,s+a),t.lineTo(n-h,s+o),t.closePath();break;case"crossRot":g+=ua;case"cross":d=Math.cos(g)*(r?r/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,h=Math.sin(g)*(r?r/2:m),t.moveTo(n-d,s-a),t.lineTo(n+d,s+a),t.moveTo(n+h,s-o),t.lineTo(n-h,s+o);break;case"star":d=Math.cos(g)*(r?r/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,h=Math.sin(g)*(r?r/2:m),t.moveTo(n-d,s-a),t.lineTo(n+d,s+a),t.moveTo(n+h,s-o),t.lineTo(n-h,s+o),g+=ua,d=Math.cos(g)*(r?r/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,h=Math.sin(g)*(r?r/2:m),t.moveTo(n-d,s-a),t.lineTo(n+d,s+a),t.moveTo(n+h,s-o),t.lineTo(n-h,s+o);break;case"line":o=r?r/2:Math.cos(g)*m,a=Math.sin(g)*m,t.moveTo(n-o,s-a),t.lineTo(n+o,s+a);break;case"dash":t.moveTo(n,s),t.lineTo(n+Math.cos(g)*(r?r/2:m),s+Math.sin(g)*m);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function $d(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function gg(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function xg(t){t.restore()}function IV(t,e,n,s,r){if(!e)return t.lineTo(n.x,n.y);if(r==="middle"){const i=(e.x+n.x)/2;t.lineTo(i,e.y),t.lineTo(i,n.y)}else r==="after"!=!!s?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function $V(t,e,n,s){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(s?e.cp1x:e.cp2x,s?e.cp1y:e.cp2y,s?n.cp2x:n.cp1x,s?n.cp2y:n.cp1y,n.x,n.y)}function NV(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),$t(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function TV(t,e,n,s,r){if(r.strikethrough||r.underline){const i=t.measureText(s),o=e-i.actualBoundingBoxLeft,a=e+i.actualBoundingBoxRight,l=n-i.actualBoundingBoxAscent,c=n+i.actualBoundingBoxDescent,u=r.strikethrough?(l+c)/2:c;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(o,u),t.lineTo(a,u),t.stroke()}}function EV(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function pm(t,e,n,s,r,i={}){const o=Sn(e)?e:[e],a=i.strokeWidth>0&&i.strokeColor!=="";let l,c;for(t.save(),t.font=r.string,NV(t,i),l=0;l<o.length;++l)c=o[l],i.backdrop&&EV(t,i.backdrop),a&&(i.strokeColor&&(t.strokeStyle=i.strokeColor),$t(i.strokeWidth)||(t.lineWidth=i.strokeWidth),t.strokeText(c,n,s,i.maxWidth)),t.fillText(c,n,s,i.maxWidth),TV(t,n,s,c,i),s+=Number(r.lineHeight);t.restore()}function Rb(t,e){const{x:n,y:s,w:r,h:i,radius:o}=e;t.arc(n+o.topLeft,s+o.topLeft,o.topLeft,1.5*qn,qn,!0),t.lineTo(n,s+i-o.bottomLeft),t.arc(n+o.bottomLeft,s+i-o.bottomLeft,o.bottomLeft,qn,Er,!0),t.lineTo(n+r-o.bottomRight,s+i),t.arc(n+r-o.bottomRight,s+i-o.bottomRight,o.bottomRight,Er,0,!0),t.lineTo(n+r,s+o.topRight),t.arc(n+r-o.topRight,s+o.topRight,o.topRight,0,-Er,!0),t.lineTo(n+o.topLeft,s)}const _V=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,RV=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function AV(t,e){const n=(""+t).match(_V);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const DV=t=>+t||0;function tR(t,e){const n={},s=at(e),r=s?Object.keys(e):e,i=at(t)?s?o=>st(t[o],t[e[o]]):o=>t[o]:()=>t;for(const o of r)n[o]=DV(i(o));return n}function FV(t){return tR(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Zu(t){return tR(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Mr(t){const e=FV(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function ks(t,e){t=t||{},e=e||tn.font;let n=st(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let s=st(t.style,e.style);s&&!(""+s).match(RV)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const r={family:st(t.family,e.family),lineHeight:AV(st(t.lineHeight,e.lineHeight),n),size:n,style:s,weight:st(t.weight,e.weight),string:""};return r.string=SV(r),r}function Xf(t,e,n,s){let r,i,o;for(r=0,i=t.length;r<i;++r)if(o=t[r],o!==void 0&&o!==void 0)return o}function OV(t,e,n){const{min:s,max:r}=t,i=Gj(e,(r-s)/2),o=(a,l)=>n&&a===0?0:a+l;return{min:o(s,-Math.abs(i)),max:o(r,i)}}function dl(t,e){return Object.assign(Object.create(t),e)}function Av(t,e=[""],n,s,r=()=>t[0]){const i=n||t;typeof s>"u"&&(s=iR("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:i,_fallback:s,_getTarget:r,override:a=>Av([a,...t],e,i,s)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete t[0][l],!0},get(a,l){return sR(a,l,()=>VV(l,e,t,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(a,l){return oI(a).includes(l)},ownKeys(a){return oI(a)},set(a,l,c){const u=a._storage||(a._storage=r());return a[l]=u[l]=c,delete a._keys,!0}})}function mc(t,e,n,s){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:nR(t,s),setContext:i=>mc(t,i,n,s),override:i=>mc(t.override(i),e,n,s)};return new Proxy(r,{deleteProperty(i,o){return delete i[o],delete t[o],!0},get(i,o,a){return sR(i,o,()=>LV(i,o,a))},getOwnPropertyDescriptor(i,o){return i._descriptors.allKeys?Reflect.has(t,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,o)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(i,o){return Reflect.has(t,o)},ownKeys(){return Reflect.ownKeys(t)},set(i,o,a){return t[o]=a,delete i[o],!0}})}function nR(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:s=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:n,indexable:s,isScriptable:Mo(n)?n:()=>n,isIndexable:Mo(s)?s:()=>s}}const PV=(t,e)=>t?t+Ev(e):e,Dv=(t,e)=>at(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function sR(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const s=n();return t[e]=s,s}function LV(t,e,n){const{_proxy:s,_context:r,_subProxy:i,_descriptors:o}=t;let a=s[e];return Mo(a)&&o.isScriptable(e)&&(a=MV(e,a,t,n)),Sn(a)&&a.length&&(a=zV(e,a,t,o.isIndexable)),Dv(e,a)&&(a=mc(a,r,i&&i[e],o)),a}function MV(t,e,n,s){const{_proxy:r,_context:i,_subProxy:o,_stack:a}=n;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t);let l=e(i,o||s);return a.delete(t),Dv(t,l)&&(l=Fv(r._scopes,r,t,l)),l}function zV(t,e,n,s){const{_proxy:r,_context:i,_subProxy:o,_descriptors:a}=n;if(typeof i.index<"u"&&s(t))return e[i.index%e.length];if(at(e[0])){const l=e,c=r._scopes.filter(u=>u!==l);e=[];for(const u of l){const d=Fv(c,r,t,u);e.push(mc(d,i,o&&o[t],a))}}return e}function rR(t,e,n){return Mo(t)?t(e,n):t}const BV=(t,e)=>t===!0?e:typeof t=="string"?dm(e,t):void 0;function WV(t,e,n,s,r){for(const i of e){const o=BV(n,i);if(o){t.add(o);const a=rR(o._fallback,n,r);if(typeof a<"u"&&a!==n&&a!==s)return a}else if(o===!1&&typeof s<"u"&&n!==s)return null}return!1}function Fv(t,e,n,s){const r=e._rootScopes,i=rR(e._fallback,n,s),o=[...t,...r],a=new Set;a.add(s);let l=iI(a,o,n,i||n,s);return l===null||typeof i<"u"&&i!==n&&(l=iI(a,o,i,l,s),l===null)?!1:Av(Array.from(a),[""],r,i,()=>jV(e,n,s))}function iI(t,e,n,s,r){for(;n;)n=WV(t,e,n,s,r);return n}function jV(t,e,n){const s=t._getTarget();e in s||(s[e]={});const r=s[e];return Sn(r)&&at(n)?n:r||{}}function VV(t,e,n,s){let r;for(const i of e)if(r=iR(PV(i,t),n),typeof r<"u")return Dv(t,r)?Fv(n,s,t,r):r}function iR(t,e){for(const n of e){if(!n)continue;const s=n[t];if(typeof s<"u")return s}}function oI(t){let e=t._keys;return e||(e=t._keys=UV(t._scopes)),e}function UV(t){const e=new Set;for(const n of t)for(const s of Object.keys(n).filter(r=>!r.startsWith("_")))e.add(s);return Array.from(e)}const GV=Number.EPSILON||1e-14,gc=(t,e)=>e<t.length&&!t[e].skip&&t[e],oR=t=>t==="x"?"y":"x";function HV(t,e,n,s){const r=t.skip?e:t,i=e,o=n.skip?e:n,a=Tb(i,r),l=Tb(o,i);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const d=s*c,h=s*u;return{previous:{x:i.x-d*(o.x-r.x),y:i.y-d*(o.y-r.y)},next:{x:i.x+h*(o.x-r.x),y:i.y+h*(o.y-r.y)}}}function KV(t,e,n){const s=t.length;let r,i,o,a,l,c=gc(t,0);for(let u=0;u<s-1;++u)if(l=c,c=gc(t,u+1),!(!l||!c)){if(Yu(e[u],0,GV)){n[u]=n[u+1]=0;continue}r=n[u]/e[u],i=n[u+1]/e[u],a=Math.pow(r,2)+Math.pow(i,2),!(a<=9)&&(o=3/Math.sqrt(a),n[u]=r*o*e[u],n[u+1]=i*o*e[u])}}function XV(t,e,n="x"){const s=oR(n),r=t.length;let i,o,a,l=gc(t,0);for(let c=0;c<r;++c){if(o=a,a=l,l=gc(t,c+1),!a)continue;const u=a[n],d=a[s];o&&(i=(u-o[n])/3,a[`cp1${n}`]=u-i,a[`cp1${s}`]=d-i*e[c]),l&&(i=(l[n]-u)/3,a[`cp2${n}`]=u+i,a[`cp2${s}`]=d+i*e[c])}}function qV(t,e="x"){const n=oR(e),s=t.length,r=Array(s).fill(0),i=Array(s);let o,a,l,c=gc(t,0);for(o=0;o<s;++o)if(a=l,l=c,c=gc(t,o+1),!!l){if(c){const u=c[e]-l[e];r[o]=u!==0?(c[n]-l[n])/u:0}i[o]=a?c?pc(r[o-1])!==pc(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}KV(t,r,i),XV(t,i,e)}function qf(t,e,n){return Math.max(Math.min(t,n),e)}function YV(t,e){let n,s,r,i,o,a=$d(t[0],e);for(n=0,s=t.length;n<s;++n)o=i,i=a,a=n<s-1&&$d(t[n+1],e),i&&(r=t[n],o&&(r.cp1x=qf(r.cp1x,e.left,e.right),r.cp1y=qf(r.cp1y,e.top,e.bottom)),a&&(r.cp2x=qf(r.cp2x,e.left,e.right),r.cp2y=qf(r.cp2y,e.top,e.bottom)))}function QV(t,e,n,s,r){let i,o,a,l;if(e.spanGaps&&(t=t.filter(c=>!c.skip)),e.cubicInterpolationMode==="monotone")qV(t,r);else{let c=s?t[t.length-1]:t[0];for(i=0,o=t.length;i<o;++i)a=t[i],l=HV(c,a,t[Math.min(i+1,o-(s?0:1))%o],e.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}e.capBezierPoints&&YV(t,n)}function Ov(){return typeof window<"u"&&typeof document<"u"}function Pv(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function mm(t,e,n){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*e.parentNode[n])):s=t,s}const yg=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function JV(t,e){return yg(t).getPropertyValue(e)}const ZV=["top","right","bottom","left"];function Oa(t,e,n){const s={};n=n?"-"+n:"";for(let r=0;r<4;r++){const i=ZV[r];s[i]=parseFloat(t[e+"-"+i+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const eU=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function tU(t,e){const n=t.touches,s=n&&n.length?n[0]:t,{offsetX:r,offsetY:i}=s;let o=!1,a,l;if(eU(r,i,t.target))a=r,l=i;else{const c=e.getBoundingClientRect();a=s.clientX-c.left,l=s.clientY-c.top,o=!0}return{x:a,y:l,box:o}}function xa(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:s}=e,r=yg(n),i=r.boxSizing==="border-box",o=Oa(r,"padding"),a=Oa(r,"border","width"),{x:l,y:c,box:u}=tU(t,n),d=o.left+(u&&a.left),h=o.top+(u&&a.top);let{width:f,height:p}=e;return i&&(f-=o.width+a.width,p-=o.height+a.height),{x:Math.round((l-d)/f*n.width/s),y:Math.round((c-h)/p*n.height/s)}}function nU(t,e,n){let s,r;if(e===void 0||n===void 0){const i=t&&Pv(t);if(!i)e=t.clientWidth,n=t.clientHeight;else{const o=i.getBoundingClientRect(),a=yg(i),l=Oa(a,"border","width"),c=Oa(a,"padding");e=o.width-c.width-l.width,n=o.height-c.height-l.height,s=mm(a.maxWidth,i,"clientWidth"),r=mm(a.maxHeight,i,"clientHeight")}}return{width:e,height:n,maxWidth:s||fm,maxHeight:r||fm}}const go=t=>Math.round(t*10)/10;function sU(t,e,n,s){const r=yg(t),i=Oa(r,"margin"),o=mm(r.maxWidth,t,"clientWidth")||fm,a=mm(r.maxHeight,t,"clientHeight")||fm,l=nU(t,e,n);let{width:c,height:u}=l;if(r.boxSizing==="content-box"){const h=Oa(r,"border","width"),f=Oa(r,"padding");c-=f.width+h.width,u-=f.height+h.height}return c=Math.max(0,c-i.width),u=Math.max(0,s?c/s:u-i.height),c=go(Math.min(c,o,l.maxWidth)),u=go(Math.min(u,a,l.maxHeight)),c&&!u&&(u=go(c/2)),(e!==void 0||n!==void 0)&&s&&l.height&&u>l.height&&(u=l.height,c=go(Math.floor(u*s))),{width:c,height:u}}function aI(t,e,n){const s=e||1,r=go(t.height*s),i=go(t.width*s);t.height=go(t.height),t.width=go(t.width);const o=t.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||o.height!==r||o.width!==i?(t.currentDevicePixelRatio=s,o.height=r,o.width=i,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const rU=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};Ov()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function lI(t,e){const n=JV(t,e),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function ya(t,e,n,s){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function iU(t,e,n,s){return{x:t.x+n*(e.x-t.x),y:s==="middle"?n<.5?t.y:e.y:s==="after"?n<1?t.y:e.y:n>0?e.y:t.y}}function oU(t,e,n,s){const r={x:t.cp2x,y:t.cp2y},i={x:e.cp1x,y:e.cp1y},o=ya(t,r,n),a=ya(r,i,n),l=ya(i,e,n),c=ya(o,a,n),u=ya(a,l,n);return ya(c,u,n)}const aU=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},lU=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function tc(t,e,n){return t?aU(e,n):lU()}function aR(t,e){let n,s;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=s)}function lR(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function cR(t){return t==="angle"?{between:K_,compare:iV,normalize:ri}:{between:Kl,compare:(e,n)=>e-n,normalize:e=>e}}function cI({start:t,end:e,count:n,loop:s,style:r}){return{start:t%n,end:e%n,loop:s&&(e-t+1)%n===0,style:r}}function cU(t,e,n){const{property:s,start:r,end:i}=n,{between:o,normalize:a}=cR(s),l=e.length;let{start:c,end:u,loop:d}=t,h,f;if(d){for(c+=l,u+=l,h=0,f=l;h<f&&o(a(e[c%l][s]),r,i);++h)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:d,style:t.style}}function uR(t,e,n){if(!n)return[t];const{property:s,start:r,end:i}=n,o=e.length,{compare:a,between:l,normalize:c}=cR(s),{start:u,end:d,loop:h,style:f}=cU(t,e,n),p=[];let m=!1,g=null,x,b,v;const w=()=>l(r,v,x)&&a(r,v)!==0,C=()=>a(i,x)===0||l(i,v,x),$=()=>m||w(),T=()=>!m||C();for(let N=u,_=u;N<=d;++N)b=e[N%o],!b.skip&&(x=c(b[s]),x!==v&&(m=l(x,r,i),g===null&&$()&&(g=a(x,r)===0?N:_),g!==null&&T()&&(p.push(cI({start:g,end:N,loop:h,count:o,style:f})),g=null),_=N,v=x));return g!==null&&p.push(cI({start:g,end:d,loop:h,count:o,style:f})),p}function dR(t,e){const n=[],s=t.segments;for(let r=0;r<s.length;r++){const i=uR(s[r],t.points,e);i.length&&n.push(...i)}return n}function uU(t,e,n,s){let r=0,i=e-1;if(n&&!s)for(;r<e&&!t[r].skip;)r++;for(;r<e&&t[r].skip;)r++;for(r%=e,n&&(i+=r);i>r&&t[i%e].skip;)i--;return i%=e,{start:r,end:i}}function dU(t,e,n,s){const r=t.length,i=[];let o=e,a=t[e],l;for(l=e+1;l<=n;++l){const c=t[l%r];c.skip||c.stop?a.skip||(s=!1,i.push({start:e%r,end:(l-1)%r,loop:s}),e=o=c.stop?l:null):(o=l,a.skip&&(e=l)),a=c}return o!==null&&i.push({start:e%r,end:o%r,loop:s}),i}function hU(t,e){const n=t.points,s=t.options.spanGaps,r=n.length;if(!r)return[];const i=!!t._loop,{start:o,end:a}=uU(n,r,i,s);if(s===!0)return uI(t,[{start:o,end:a,loop:i}],n,e);const l=a<o?a+r:a,c=!!t._fullLoop&&o===0&&a===r-1;return uI(t,dU(n,o,l,c),n,e)}function uI(t,e,n,s){return!s||!s.setContext||!n?e:fU(t,e,n,s)}function fU(t,e,n,s){const r=t._chart.getContext(),i=dI(t.options),{_datasetIndex:o,options:{spanGaps:a}}=t,l=n.length,c=[];let u=i,d=e[0].start,h=d;function f(p,m,g,x){const b=a?-1:1;if(p!==m){for(p+=l;n[p%l].skip;)p-=b;for(;n[m%l].skip;)m+=b;p%l!==m%l&&(c.push({start:p%l,end:m%l,loop:g,style:x}),u=x,d=m%l)}}for(const p of e){d=a?d:p.start;let m=n[d%l],g;for(h=d+1;h<=p.end;h++){const x=n[h%l];g=dI(s.setContext(dl(r,{type:"segment",p0:m,p1:x,p0DataIndex:(h-1)%l,p1DataIndex:h%l,datasetIndex:o}))),pU(g,u)&&f(d,h-1,p.loop,u),m=x,u=g}d<h-1&&f(d,h-1,p.loop,u)}return c}function dI(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function pU(t,e){if(!e)return!1;const n=[],s=function(r,i){return Rv(i)?(n.includes(i)||n.push(i),n.indexOf(i)):i};return JSON.stringify(t,s)!==JSON.stringify(e,s)}function Yf(t,e,n){return t.options.clip?t[n]:e[n]}function mU(t,e){const{xScale:n,yScale:s}=t;return n&&s?{left:Yf(n,e,"left"),right:Yf(n,e,"right"),top:Yf(s,e,"top"),bottom:Yf(s,e,"bottom")}:e}function hR(t,e){const n=e._clip;if(n.disabled)return!1;const s=mU(e,t.chartArea);return{left:n.left===!1?0:s.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:s.right+(n.right===!0?0:n.right),top:n.top===!1?0:s.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:s.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class gU{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,s,r){const i=n.listeners[r],o=n.duration;i.forEach(a=>a({chart:e,initial:n.initial,numSteps:o,currentStep:Math.min(s-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=q_.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((s,r)=>{if(!s.running||!s.items.length)return;const i=s.items;let o=i.length-1,a=!1,l;for(;o>=0;--o)l=i[o],l._active?(l._total>s.duration&&(s.duration=l._total),l.tick(e),a=!0):(i[o]=i[i.length-1],i.pop());a&&(r.draw(),this._notify(r,s,e,"progress")),i.length||(s.running=!1,this._notify(r,s,e,"complete"),s.initial=!1),n+=i.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let s=n.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,s)),s}listen(e,n,s){this._getAnims(e).listeners[n].push(s)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,r)=>Math.max(s,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const s=n.items;let r=s.length-1;for(;r>=0;--r)s[r].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Ni=new gU;const hI="transparent",xU={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const s=tI(t||hI),r=s.valid&&tI(e||hI);return r&&r.valid?r.mix(s,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class yU{constructor(e,n,s,r){const i=n[s];r=Xf([e.to,r,i,e.from]);const o=Xf([e.from,i,r]);this._active=!0,this._fn=e.fn||xU[e.type||typeof o],this._easing=Qu[e.easing]||Qu.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=s,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(e,n,s){if(this._active){this._notify(!1);const r=this._target[this._prop],i=s-this._start,o=this._duration-i;this._start=s,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=Xf([e.to,n,r,e.from]),this._from=Xf([e.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,s=this._duration,r=this._prop,i=this._from,o=this._loop,a=this._to;let l;if(this._active=i!==a&&(o||n<s),!this._active){this._target[r]=a,this._notify(!0);return}if(n<0){this._target[r]=i;return}l=n/s%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[r]=this._fn(i,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,s)=>{e.push({res:n,rej:s})})}_notify(e){const n=e?"res":"rej",s=this._promises||[];for(let r=0;r<s.length;r++)s[r][n]()}}class fR{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!at(e))return;const n=Object.keys(tn.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const i=e[r];if(!at(i))return;const o={};for(const a of n)o[a]=i[a];(Sn(i.properties)&&i.properties||[r]).forEach(a=>{(a===r||!s.has(a))&&s.set(a,o)})})}_animateOptions(e,n){const s=n.options,r=vU(e,s);if(!r)return[];const i=this._createAnimations(r,s);return s.$shared&&bU(e.options.$animations,s).then(()=>{e.options=s},()=>{}),i}_createAnimations(e,n){const s=this._properties,r=[],i=e.$animations||(e.$animations={}),o=Object.keys(n),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if(c.charAt(0)==="$")continue;if(c==="options"){r.push(...this._animateOptions(e,n));continue}const u=n[c];let d=i[c];const h=s.get(c);if(d)if(h&&d.active()){d.update(h,u,a);continue}else d.cancel();if(!h||!h.duration){e[c]=u;continue}i[c]=d=new yU(h,e,c,u),r.push(d)}return r}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const s=this._createAnimations(e,n);if(s.length)return Ni.add(this._chart,s),!0}}function bU(t,e){const n=[],s=Object.keys(e);for(let r=0;r<s.length;r++){const i=t[s[r]];i&&i.active()&&n.push(i.wait())}return Promise.all(n)}function vU(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function fI(t,e){const n=t&&t.options||{},s=n.reverse,r=n.min===void 0?e:0,i=n.max===void 0?e:0;return{start:s?i:r,end:s?r:i}}function wU(t,e,n){if(n===!1)return!1;const s=fI(t,n),r=fI(e,n);return{top:r.end,right:s.end,bottom:r.start,left:s.start}}function kU(t){let e,n,s,r;return at(t)?(e=t.top,n=t.right,s=t.bottom,r=t.left):e=n=s=r=t,{top:e,right:n,bottom:s,left:r,disabled:t===!1}}function pR(t,e){const n=[],s=t._getSortedDatasetMetas(e);let r,i;for(r=0,i=s.length;r<i;++r)n.push(s[r].index);return n}function pI(t,e,n,s={}){const r=t.keys,i=s.mode==="single";let o,a,l,c;if(e===null)return;let u=!1;for(o=0,a=r.length;o<a;++o){if(l=+r[o],l===n){if(u=!0,s.all)continue;break}c=t.values[l],Jn(c)&&(i||e===0||pc(e)===pc(c))&&(e+=c)}return!u&&!s.all?0:e}function CU(t,e){const{iScale:n,vScale:s}=e,r=n.axis==="x"?"x":"y",i=s.axis==="x"?"x":"y",o=Object.keys(t),a=new Array(o.length);let l,c,u;for(l=0,c=o.length;l<c;++l)u=o[l],a[l]={[r]:u,[i]:t[u]};return a}function J0(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function SU(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function IU(t){const{min:e,max:n,minDefined:s,maxDefined:r}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function $U(t,e,n){const s=t[e]||(t[e]={});return s[n]||(s[n]={})}function mI(t,e,n,s){for(const r of e.getMatchingVisibleMetas(s).reverse()){const i=t[r.index];if(n&&i>0||!n&&i<0)return r.index}return null}function gI(t,e){const{chart:n,_cachedMeta:s}=t,r=n._stacks||(n._stacks={}),{iScale:i,vScale:o,index:a}=s,l=i.axis,c=o.axis,u=SU(i,o,s),d=e.length;let h;for(let f=0;f<d;++f){const p=e[f],{[l]:m,[c]:g}=p,x=p._stacks||(p._stacks={});h=x[c]=$U(r,u,m),h[a]=g,h._top=mI(h,o,!0,s.type),h._bottom=mI(h,o,!1,s.type);const b=h._visualValues||(h._visualValues={});b[a]=g}}function Z0(t,e){const n=t.scales;return Object.keys(n).filter(s=>n[s].axis===e).shift()}function NU(t,e){return dl(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function TU(t,e,n){return dl(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function yu(t,e){const n=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const r of e){const i=r._stacks;if(!i||i[s]===void 0||i[s][n]===void 0)return;delete i[s][n],i[s]._visualValues!==void 0&&i[s]._visualValues[n]!==void 0&&delete i[s]._visualValues[n]}}}const ey=t=>t==="reset"||t==="none",xI=(t,e)=>e?t:Object.assign({},t),EU=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:pR(n,!0),values:null};class ed{constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=J0(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&yu(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,s=this.getDataset(),r=(d,h,f,p)=>d==="x"?h:d==="r"?p:f,i=n.xAxisID=st(s.xAxisID,Z0(e,"x")),o=n.yAxisID=st(s.yAxisID,Z0(e,"y")),a=n.rAxisID=st(s.rAxisID,Z0(e,"r")),l=n.indexAxis,c=n.iAxisID=r(l,i,o,a),u=n.vAxisID=r(l,o,i,a);n.xScale=this.getScaleForId(i),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(a),n.iScale=this.getScaleForId(c),n.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&J2(this._data,this),e._stacked&&yu(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),s=this._data;if(at(n)){const r=this._cachedMeta;this._data=CU(n,r)}else if(s!==n){if(s){J2(s,this);const r=this._cachedMeta;yu(r),r._parsed=[]}n&&Object.isExtensible(n)&&cV(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const i=n._stacked;n._stacked=J0(n.vScale,n),n.stack!==s.stack&&(r=!0,yu(n),n.stack=s.stack),this._resyncElements(e),(r||i!==n._stacked)&&(gI(this,n._parsed),n._stacked=J0(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:s,_data:r}=this,{iScale:i,_stacked:o}=s,a=i.axis;let l=e===0&&n===r.length?!0:s._sorted,c=e>0&&s._parsed[e-1],u,d,h;if(this._parsing===!1)s._parsed=r,s._sorted=!0,h=r;else{Sn(r[e])?h=this.parseArrayData(s,r,e,n):at(r[e])?h=this.parseObjectData(s,r,e,n):h=this.parsePrimitiveData(s,r,e,n);const f=()=>d[a]===null||c&&d[a]<c[a];for(u=0;u<n;++u)s._parsed[u+e]=d=h[u],l&&(f()&&(l=!1),c=d);s._sorted=l}o&&gI(this,h)}parsePrimitiveData(e,n,s,r){const{iScale:i,vScale:o}=e,a=i.axis,l=o.axis,c=i.getLabels(),u=i===o,d=new Array(r);let h,f,p;for(h=0,f=r;h<f;++h)p=h+s,d[h]={[a]:u||i.parse(c[p],p),[l]:o.parse(n[p],p)};return d}parseArrayData(e,n,s,r){const{xScale:i,yScale:o}=e,a=new Array(r);let l,c,u,d;for(l=0,c=r;l<c;++l)u=l+s,d=n[u],a[l]={x:i.parse(d[0],u),y:o.parse(d[1],u)};return a}parseObjectData(e,n,s,r){const{xScale:i,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(r);let u,d,h,f;for(u=0,d=r;u<d;++u)h=u+s,f=n[h],c[u]={x:i.parse(dm(f,a),h),y:o.parse(dm(f,l),h)};return c}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,s){const r=this.chart,i=this._cachedMeta,o=n[e.axis],a={keys:pR(r,!0),values:n._stacks[e.axis]._visualValues};return pI(a,o,i.index,{mode:s})}updateRangeFromParsed(e,n,s,r){const i=s[n.axis];let o=i===null?NaN:i;const a=r&&s._stacks[n.axis];r&&a&&(r.values=a,o=pI(r,i,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,n){const s=this._cachedMeta,r=s._parsed,i=s._sorted&&e===s.iScale,o=r.length,a=this._getOtherScale(e),l=EU(n,s,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:d}=IU(a);let h,f;function p(){f=r[h];const m=f[a.axis];return!Jn(f[e.axis])||u>m||d<m}for(h=0;h<o&&!(!p()&&(this.updateRangeFromParsed(c,e,f,l),i));++h);if(i){for(h=o-1;h>=0;--h)if(!p()){this.updateRangeFromParsed(c,e,f,l);break}}return c}getAllParsedValues(e){const n=this._cachedMeta._parsed,s=[];let r,i,o;for(r=0,i=n.length;r<i;++r)o=n[r][e.axis],Jn(o)&&s.push(o);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,s=n.iScale,r=n.vScale,i=this.getParsed(e);return{label:s?""+s.getLabelForValue(i[s.axis]):"",value:r?""+r.getLabelForValue(i[r.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=kU(st(this.options.clip,wU(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,s=this._cachedMeta,r=s.data||[],i=n.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||r.length-a,c=this.options.drawActiveElementsOnTop;let u;for(s.dataset&&s.dataset.draw(e,i,a,l),u=a;u<a+l;++u){const d=r[u];d.hidden||(d.active&&c?o.push(d):d.draw(e,i))}for(u=0;u<o.length;++u)o[u].draw(e,i)}getStyle(e,n){const s=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,n,s){const r=this.getDataset();let i;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];i=o.$context||(o.$context=TU(this.getContext(),e,o)),i.parsed=this.getParsed(e),i.raw=r.data[e],i.index=i.dataIndex=e}else i=this.$context||(this.$context=NU(this.chart.getContext(),this.index)),i.dataset=r,i.index=i.datasetIndex=this.index;return i.active=!!n,i.mode=s,i}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",s){const r=n==="active",i=this._cachedDataOpts,o=e+"-"+n,a=i[o],l=this.enableOptionSharing&&hm(s);if(a)return xI(a,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,e),d=r?[`${e}Hover`,"hover",e,""]:[e,""],h=c.getOptionScopes(this.getDataset(),u),f=Object.keys(tn.elements[e]),p=()=>this.getContext(s,r,n),m=c.resolveNamedOptions(h,f,p,d);return m.$shared&&(m.$shared=l,i[o]=Object.freeze(xI(m,l))),m}_resolveAnimations(e,n,s){const r=this.chart,i=this._cachedDataOpts,o=`animation-${n}`,a=i[o];if(a)return a;let l;if(r.options.animation!==!1){const u=this.chart.config,d=u.datasetAnimationScopeKeys(this._type,n),h=u.getOptionScopes(this.getDataset(),d);l=u.createResolver(h,this.getContext(e,s,n))}const c=new fR(r,l&&l.animations);return l&&l._cacheable&&(i[o]=Object.freeze(c)),c}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||ey(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const s=this.resolveDataElementOptions(e,n),r=this._sharedOptions,i=this.getSharedOptions(s),o=this.includeOptions(n,i)||i!==r;return this.updateSharedOptions(i,n,s),{sharedOptions:i,includeOptions:o}}updateElement(e,n,s,r){ey(r)?Object.assign(e,s):this._resolveAnimations(n,r).update(e,s)}updateSharedOptions(e,n,s){e&&!ey(n)&&this._resolveAnimations(void 0,n).update(e,s)}_setStyle(e,n,s,r){e.active=r;const i=this.getStyle(n,r);this._resolveAnimations(n,s,r).update(e,{options:!r&&this.getSharedOptions(i)||i})}removeHoverStyle(e,n,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,n,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,s=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const r=s.length,i=n.length,o=Math.min(i,r);o&&this.parse(0,o),i>r?this._insertElements(r,i-r,e):i<r&&this._removeElements(i,r-i)}_insertElements(e,n,s=!0){const r=this._cachedMeta,i=r.data,o=e+n;let a;const l=c=>{for(c.length+=n,a=c.length-1;a>=o;a--)c[a]=c[a-n]};for(l(i),a=e;a<o;++a)i[a]=new this.dataElementType;this._parsing&&l(r._parsed),this.parse(e,n),s&&this.updateElements(i,e,n,"reset")}updateElements(e,n,s,r){}_removeElements(e,n){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(e,n);s._stacked&&yu(s,r)}s.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,s,r]=e;this[n](s,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}qe(ed,"defaults",{}),qe(ed,"datasetElementType",null),qe(ed,"dataElementType",null);class _p extends ed{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const n=this._cachedMeta,{dataset:s,data:r=[],_dataset:i}=n,o=this.chart._animationsDisabled;let{start:a,count:l}=fV(n,r,o);this._drawStart=a,this._drawCount=l,pV(n)&&(a=0,l=r.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!i._decimated,s.points=r;const c=this.resolveDatasetElementOptions(e);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(s,void 0,{animated:!o,options:c},e),this.updateElements(r,a,l,e)}updateElements(e,n,s,r){const i=r==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:d}=this._getSharedOptions(n,r),h=o.axis,f=a.axis,{spanGaps:p,segment:m}=this.options,g=Id(p)?p:Number.POSITIVE_INFINITY,x=this.chart._animationsDisabled||i||r==="none",b=n+s,v=e.length;let w=n>0&&this.getParsed(n-1);for(let C=0;C<v;++C){const $=e[C],T=x?$:{};if(C<n||C>=b){T.skip=!0;continue}const N=this.getParsed(C),_=$t(N[f]),A=T[h]=o.getPixelForValue(N[h],C),O=T[f]=i||_?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,N,l):N[f],C);T.skip=isNaN(A)||isNaN(O)||_,T.stop=C>0&&Math.abs(N[h]-w[h])>g,m&&(T.parsed=N,T.raw=c.data[C]),d&&(T.options=u||this.resolveDataElementOptions(C,$.active?"active":r)),x||this.updateElement($,C,T,r),w=N}}getMaxOverflow(){const e=this._cachedMeta,n=e.dataset,s=n.options&&n.options.borderWidth||0,r=e.data||[];if(!r.length)return s;const i=r[0].size(this.resolveDataElementOptions(0)),o=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(s,i,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}qe(_p,"id","line"),qe(_p,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),qe(_p,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});function ha(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Lv{constructor(e){qe(this,"options");this.options=e||{}}static override(e){Object.assign(Lv.prototype,e)}init(){}formats(){return ha()}parse(){return ha()}format(){return ha()}add(){return ha()}diff(){return ha()}startOf(){return ha()}endOf(){return ha()}}var _U={_date:Lv};function RU(t,e,n,s){const{controller:r,data:i,_sorted:o}=t,a=r._cachedMeta.iScale,l=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(a&&e===a.axis&&e!=="r"&&o&&i.length){const c=a._reversePixels?aV:Ta;if(s){if(r._sharedOptions){const u=i[0],d=typeof u.getRange=="function"&&u.getRange(e);if(d){const h=c(i,e,n-d),f=c(i,e,n+d);return{lo:h.lo,hi:f.hi}}}}else{const u=c(i,e,n);if(l){const{vScale:d}=r._cachedMeta,{_parsed:h}=t,f=h.slice(0,u.lo+1).reverse().findIndex(m=>!$t(m[d.axis]));u.lo-=Math.max(0,f);const p=h.slice(u.hi).findIndex(m=>!$t(m[d.axis]));u.hi+=Math.max(0,p)}return u}}return{lo:0,hi:i.length-1}}function bg(t,e,n,s,r){const i=t.getSortedVisibleDatasetMetas(),o=n[e];for(let a=0,l=i.length;a<l;++a){const{index:c,data:u}=i[a],{lo:d,hi:h}=RU(i[a],e,o,r);for(let f=d;f<=h;++f){const p=u[f];p.skip||s(p,c,f)}}}function AU(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(s,r){const i=e?Math.abs(s.x-r.x):0,o=n?Math.abs(s.y-r.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}function ty(t,e,n,s,r){const i=[];return!r&&!t.isPointInArea(e)||bg(t,n,e,function(a,l,c){!r&&!$d(a,t.chartArea,0)||a.inRange(e.x,e.y,s)&&i.push({element:a,datasetIndex:l,index:c})},!0),i}function DU(t,e,n,s){let r=[];function i(o,a,l){const{startAngle:c,endAngle:u}=o.getProps(["startAngle","endAngle"],s),{angle:d}=rV(o,{x:e.x,y:e.y});K_(d,c,u)&&r.push({element:o,datasetIndex:a,index:l})}return bg(t,n,e,i),r}function FU(t,e,n,s,r,i){let o=[];const a=AU(n);let l=Number.POSITIVE_INFINITY;function c(u,d,h){const f=u.inRange(e.x,e.y,r);if(s&&!f)return;const p=u.getCenterPoint(r);if(!(!!i||t.isPointInArea(p))&&!f)return;const g=a(e,p);g<l?(o=[{element:u,datasetIndex:d,index:h}],l=g):g===l&&o.push({element:u,datasetIndex:d,index:h})}return bg(t,n,e,c),o}function ny(t,e,n,s,r,i){return!i&&!t.isPointInArea(e)?[]:n==="r"&&!s?DU(t,e,n,r):FU(t,e,n,s,r,i)}function yI(t,e,n,s,r){const i=[],o=n==="x"?"inXRange":"inYRange";let a=!1;return bg(t,n,e,(l,c,u)=>{l[o]&&l[o](e[n],r)&&(i.push({element:l,datasetIndex:c,index:u}),a=a||l.inRange(e.x,e.y,r))}),s&&!a?[]:i}var OU={modes:{index(t,e,n,s){const r=xa(e,t),i=n.axis||"x",o=n.includeInvisible||!1,a=n.intersect?ty(t,r,i,s,o):ny(t,r,i,!1,s,o),l=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach(c=>{const u=a[0].index,d=c.data[u];d&&!d.skip&&l.push({element:d,datasetIndex:c.index,index:u})}),l):[]},dataset(t,e,n,s){const r=xa(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;let a=n.intersect?ty(t,r,i,s,o):ny(t,r,i,!1,s,o);if(a.length>0){const l=a[0].datasetIndex,c=t.getDatasetMeta(l).data;a=[];for(let u=0;u<c.length;++u)a.push({element:c[u],datasetIndex:l,index:u})}return a},point(t,e,n,s){const r=xa(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;return ty(t,r,i,s,o)},nearest(t,e,n,s){const r=xa(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;return ny(t,r,i,n.intersect,s,o)},x(t,e,n,s){const r=xa(e,t);return yI(t,r,"x",n.intersect,s)},y(t,e,n,s){const r=xa(e,t);return yI(t,r,"y",n.intersect,s)}}};const mR=["left","top","right","bottom"];function bu(t,e){return t.filter(n=>n.pos===e)}function bI(t,e){return t.filter(n=>mR.indexOf(n.pos)===-1&&n.box.axis===e)}function vu(t,e){return t.sort((n,s)=>{const r=e?s:n,i=e?n:s;return r.weight===i.weight?r.index-i.index:r.weight-i.weight})}function PU(t){const e=[];let n,s,r,i,o,a;for(n=0,s=(t||[]).length;n<s;++n)r=t[n],{position:i,options:{stack:o,stackWeight:a=1}}=r,e.push({index:n,box:r,pos:i,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&i+o,stackWeight:a});return e}function LU(t){const e={};for(const n of t){const{stack:s,pos:r,stackWeight:i}=n;if(!s||!mR.includes(r))continue;const o=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=i}return e}function MU(t,e){const n=LU(t),{vBoxMaxWidth:s,hBoxMaxHeight:r}=e;let i,o,a;for(i=0,o=t.length;i<o;++i){a=t[i];const{fullSize:l}=a.box,c=n[a.stack],u=c&&a.stackWeight/c.weight;a.horizontal?(a.width=u?u*s:l&&e.availableWidth,a.height=r):(a.width=s,a.height=u?u*r:l&&e.availableHeight)}return n}function zU(t){const e=PU(t),n=vu(e.filter(c=>c.box.fullSize),!0),s=vu(bu(e,"left"),!0),r=vu(bu(e,"right")),i=vu(bu(e,"top"),!0),o=vu(bu(e,"bottom")),a=bI(e,"x"),l=bI(e,"y");return{fullSize:n,leftAndTop:s.concat(i),rightAndBottom:r.concat(l).concat(o).concat(a),chartArea:bu(e,"chartArea"),vertical:s.concat(r).concat(l),horizontal:i.concat(o).concat(a)}}function vI(t,e,n,s){return Math.max(t[n],e[n])+Math.max(t[s],e[s])}function gR(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function BU(t,e,n,s){const{pos:r,box:i}=n,o=t.maxPadding;if(!at(r)){n.size&&(t[r]-=n.size);const d=s[n.stack]||{size:0,count:1};d.size=Math.max(d.size,n.horizontal?i.height:i.width),n.size=d.size/d.count,t[r]+=n.size}i.getPadding&&gR(o,i.getPadding());const a=Math.max(0,e.outerWidth-vI(o,t,"left","right")),l=Math.max(0,e.outerHeight-vI(o,t,"top","bottom")),c=a!==t.w,u=l!==t.h;return t.w=a,t.h=l,n.horizontal?{same:c,other:u}:{same:u,other:c}}function WU(t){const e=t.maxPadding;function n(s){const r=Math.max(e[s]-t[s],0);return t[s]+=r,r}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function jU(t,e){const n=e.maxPadding;function s(r){const i={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{i[o]=Math.max(e[o],n[o])}),i}return s(t?["left","right"]:["top","bottom"])}function Au(t,e,n,s){const r=[];let i,o,a,l,c,u;for(i=0,o=t.length,c=0;i<o;++i){a=t[i],l=a.box,l.update(a.width||e.w,a.height||e.h,jU(a.horizontal,e));const{same:d,other:h}=BU(e,n,a,s);c|=d&&r.length,u=u||h,l.fullSize||r.push(a)}return c&&Au(r,e,n,s)||u}function Qf(t,e,n,s,r){t.top=n,t.left=e,t.right=e+s,t.bottom=n+r,t.width=s,t.height=r}function wI(t,e,n,s){const r=n.padding;let{x:i,y:o}=e;for(const a of t){const l=a.box,c=s[a.stack]||{placed:0,weight:1},u=a.stackWeight/c.weight||1;if(a.horizontal){const d=e.w*u,h=c.size||l.height;hm(c.start)&&(o=c.start),l.fullSize?Qf(l,r.left,o,n.outerWidth-r.right-r.left,h):Qf(l,e.left+c.placed,o,d,h),c.start=o,c.placed+=d,o=l.bottom}else{const d=e.h*u,h=c.size||l.width;hm(c.start)&&(i=c.start),l.fullSize?Qf(l,i,r.top,h,n.outerHeight-r.bottom-r.top):Qf(l,i,e.top+c.placed,h,d),c.start=i,c.placed+=d,i=l.right}}e.x=i,e.y=o}var xo={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,s){if(!t)return;const r=Mr(t.options.layout.padding),i=Math.max(e-r.width,0),o=Math.max(n-r.height,0),a=zU(t.boxes),l=a.vertical,c=a.horizontal;xt(t.boxes,m=>{typeof m.beforeLayout=="function"&&m.beforeLayout()});const u=l.reduce((m,g)=>g.box.options&&g.box.options.display===!1?m:m+1,0)||1,d=Object.freeze({outerWidth:e,outerHeight:n,padding:r,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/u,hBoxMaxHeight:o/2}),h=Object.assign({},r);gR(h,Mr(s));const f=Object.assign({maxPadding:h,w:i,h:o,x:r.left,y:r.top},r),p=MU(l.concat(c),d);Au(a.fullSize,f,d,p),Au(l,f,d,p),Au(c,f,d,p)&&Au(l,f,d,p),WU(f),wI(a.leftAndTop,f,d,p),f.x+=f.w,f.y+=f.h,wI(a.rightAndBottom,f,d,p),t.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},xt(a.chartArea,m=>{const g=m.box;Object.assign(g,t.chartArea),g.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})})}};class xR{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,s){}removeEventListener(e,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,s,r){return n=Math.max(0,n||e.width),s=s||e.height,{width:n,height:Math.max(0,r?Math.floor(n/r):s)}}isAttached(e){return!0}updateConfig(e){}}class VU extends xR{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Rp="$chartjs",UU={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},kI=t=>t===null||t==="";function GU(t,e){const n=t.style,s=t.getAttribute("height"),r=t.getAttribute("width");if(t[Rp]={initial:{height:s,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",kI(r)){const i=lI(t,"width");i!==void 0&&(t.width=i)}if(kI(s))if(t.style.height==="")t.height=t.width/(e||2);else{const i=lI(t,"height");i!==void 0&&(t.height=i)}return t}const yR=rU?{passive:!0}:!1;function HU(t,e,n){t&&t.addEventListener(e,n,yR)}function KU(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,yR)}function XU(t,e){const n=UU[t.type]||t.type,{x:s,y:r}=xa(t,e);return{type:n,chart:e,native:t,x:s!==void 0?s:null,y:r!==void 0?r:null}}function gm(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function qU(t,e,n){const s=t.canvas,r=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||gm(a.addedNodes,s),o=o&&!gm(a.removedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function YU(t,e,n){const s=t.canvas,r=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||gm(a.removedNodes,s),o=o&&!gm(a.addedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const Nd=new Map;let CI=0;function bR(){const t=window.devicePixelRatio;t!==CI&&(CI=t,Nd.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function QU(t,e){Nd.size||window.addEventListener("resize",bR),Nd.set(t,e)}function JU(t){Nd.delete(t),Nd.size||window.removeEventListener("resize",bR)}function ZU(t,e,n){const s=t.canvas,r=s&&Pv(s);if(!r)return;const i=Y_((a,l)=>{const c=r.clientWidth;n(a,l),c<r.clientWidth&&n()},window),o=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||i(c,u)});return o.observe(r),QU(t,i),o}function sy(t,e,n){n&&n.disconnect(),e==="resize"&&JU(t)}function e5(t,e,n){const s=t.canvas,r=Y_(i=>{t.ctx!==null&&n(XU(i,t))},t);return HU(s,e,r),r}class t5 extends xR{acquireContext(e,n){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(GU(e,n),s):null}releaseContext(e){const n=e.canvas;if(!n[Rp])return!1;const s=n[Rp].initial;["height","width"].forEach(i=>{const o=s[i];$t(o)?n.removeAttribute(i):n.setAttribute(i,o)});const r=s.style||{};return Object.keys(r).forEach(i=>{n.style[i]=r[i]}),n.width=n.width,delete n[Rp],!0}addEventListener(e,n,s){this.removeEventListener(e,n);const r=e.$proxies||(e.$proxies={}),o={attach:qU,detach:YU,resize:ZU}[n]||e5;r[n]=o(e,n,s)}removeEventListener(e,n){const s=e.$proxies||(e.$proxies={}),r=s[n];if(!r)return;({attach:sy,detach:sy,resize:sy}[n]||KU)(e,n,r),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,s,r){return sU(e,n,s,r)}isAttached(e){const n=e&&Pv(e);return!!(n&&n.isConnected)}}function n5(t){return!Ov()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?VU:t5}class zo{constructor(){qe(this,"x");qe(this,"y");qe(this,"active",!1);qe(this,"options");qe(this,"$animations")}tooltipPosition(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}hasValue(){return Id(this.x)&&Id(this.y)}getProps(e,n){const s=this.$animations;if(!n||!s)return this;const r={};return e.forEach(i=>{r[i]=s[i]&&s[i].active()?s[i]._to:this[i]}),r}}qe(zo,"defaults",{}),qe(zo,"defaultRoutes");function s5(t,e){const n=t.options.ticks,s=r5(t),r=Math.min(n.maxTicksLimit||s,s),i=n.major.enabled?o5(e):[],o=i.length,a=i[0],l=i[o-1],c=[];if(o>r)return a5(e,c,i,o/r),c;const u=i5(i,e,r);if(o>0){let d,h;const f=o>1?Math.round((l-a)/(o-1)):null;for(Jf(e,c,u,$t(f)?0:a-f,a),d=0,h=o-1;d<h;d++)Jf(e,c,u,i[d],i[d+1]);return Jf(e,c,u,l,$t(f)?e.length:l+f),c}return Jf(e,c,u),c}function r5(t){const e=t.options.offset,n=t._tickSize(),s=t._length/n+(e?0:1),r=t._maxLength/n;return Math.floor(Math.min(s,r))}function i5(t,e,n){const s=l5(t),r=e.length/n;if(!s)return Math.max(r,1);const i=Zj(s);for(let o=0,a=i.length-1;o<a;o++){const l=i[o];if(l>r)return l}return Math.max(r,1)}function o5(t){const e=[];let n,s;for(n=0,s=t.length;n<s;n++)t[n].major&&e.push(n);return e}function a5(t,e,n,s){let r=0,i=n[0],o;for(s=Math.ceil(s),o=0;o<t.length;o++)o===i&&(e.push(t[o]),r++,i=n[r*s])}function Jf(t,e,n,s,r){const i=st(s,0),o=Math.min(st(r,t.length),t.length);let a=0,l,c,u;for(n=Math.ceil(n),r&&(l=r-s,n=l/Math.floor(l/n)),u=i;u<0;)a++,u=Math.round(i+a*n);for(c=Math.max(i,0);c<o;c++)c===u&&(e.push(t[c]),a++,u=Math.round(i+a*n))}function l5(t){const e=t.length;let n,s;if(e<2)return!1;for(s=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==s)return!1;return s}const c5=t=>t==="left"?"right":t==="right"?"left":t,SI=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,II=(t,e)=>Math.min(e||t,t);function $I(t,e){const n=[],s=t.length/e,r=t.length;let i=0;for(;i<r;i+=s)n.push(t[Math.floor(i)]);return n}function u5(t,e,n){const s=t.ticks.length,r=Math.min(e,s-1),i=t._startPixel,o=t._endPixel,a=1e-6;let l=t.getPixelForTick(r),c;if(!(n&&(s===1?c=Math.max(l-i,o-l):e===0?c=(t.getPixelForTick(1)-l)/2:c=(l-t.getPixelForTick(r-1))/2,l+=r<e?c:-c,l<i-a||l>o+a)))return l}function d5(t,e){xt(t,n=>{const s=n.gc,r=s.length/2;let i;if(r>e){for(i=0;i<r;++i)delete n.data[s[i]];s.splice(0,r)}})}function wu(t){return t.drawTicks?t.tickLength:0}function NI(t,e){if(!t.display)return 0;const n=ks(t.font,e),s=Mr(t.padding);return(Sn(t.text)?t.text.length:1)*n.lineHeight+s.height}function h5(t,e){return dl(t,{scale:e,type:"scale"})}function f5(t,e,n){return dl(t,{tick:n,index:e,type:"tick"})}function p5(t,e,n){let s=Q_(t);return(n&&e!=="right"||!n&&e==="right")&&(s=c5(s)),s}function m5(t,e,n,s){const{top:r,left:i,bottom:o,right:a,chart:l}=t,{chartArea:c,scales:u}=l;let d=0,h,f,p;const m=o-r,g=a-i;if(t.isHorizontal()){if(f=Fs(s,i,a),at(n)){const x=Object.keys(n)[0],b=n[x];p=u[x].getPixelForValue(b)+m-e}else n==="center"?p=(c.bottom+c.top)/2+m-e:p=SI(t,n,e);h=a-i}else{if(at(n)){const x=Object.keys(n)[0],b=n[x];f=u[x].getPixelForValue(b)-g+e}else n==="center"?f=(c.left+c.right)/2-g+e:f=SI(t,n,e);p=Fs(s,o,r),d=n==="left"?-Er:Er}return{titleX:f,titleY:p,maxWidth:h,rotation:d}}class Pc extends zo{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:s,_suggestedMax:r}=this;return e=Jr(e,Number.POSITIVE_INFINITY),n=Jr(n,Number.NEGATIVE_INFINITY),s=Jr(s,Number.POSITIVE_INFINITY),r=Jr(r,Number.NEGATIVE_INFINITY),{min:Jr(e,s),max:Jr(n,r),minDefined:Jn(e),maxDefined:Jn(n)}}getMinMax(e){let{min:n,max:s,minDefined:r,maxDefined:i}=this.getUserBounds(),o;if(r&&i)return{min:n,max:s};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)o=a[l].controller.getMinMax(this,e),r||(n=Math.min(n,o.min)),i||(s=Math.max(s,o.max));return n=i&&n>s?s:n,s=r&&n>s?n:s,{min:Jr(n,Jr(s,n)),max:Jr(s,Jr(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Ot(this.options.beforeUpdate,[this])}update(e,n,s){const{beginAtZero:r,grace:i,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=OV(this,i,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?$I(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=s5(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,e=!e),this._startPixel=n,this._endPixel=s,this._reversePixels=e,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Ot(this.options.afterUpdate,[this])}beforeSetDimensions(){Ot(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Ot(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Ot(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Ot(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let s,r,i;for(s=0,r=e.length;s<r;s++)i=e[s],i.label=Ot(n.callback,[i.value,s,e],this)}afterTickToLabelConversion(){Ot(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Ot(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,s=II(this.ticks.length,e.ticks.maxTicksLimit),r=n.minRotation||0,i=n.maxRotation;let o=r,a,l,c;if(!this._isVisible()||!n.display||r>=i||s<=1||!this.isHorizontal()){this.labelRotation=r;return}const u=this._getLabelSizes(),d=u.widest.width,h=u.highest.height,f=ir(this.chart.width-d,0,this.maxWidth);a=e.offset?this.maxWidth/s:f/(s-1),d+6>a&&(a=f/(s-(e.offset?.5:1)),l=this.maxHeight-wu(e.grid)-n.padding-NI(e.title,this.chart.options.font),c=Math.sqrt(d*d+h*h),o=sV(Math.min(Math.asin(ir((u.highest.height+6)/a,-1,1)),Math.asin(ir(l/c,-1,1))-Math.asin(ir(h/c,-1,1)))),o=Math.max(r,Math.min(i,o))),this.labelRotation=o}afterCalculateLabelRotation(){Ot(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Ot(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:s,title:r,grid:i}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=NI(r,n.options.font);if(a?(e.width=this.maxWidth,e.height=wu(i)+l):(e.height=this.maxHeight,e.width=wu(i)+l),s.display&&this.ticks.length){const{first:c,last:u,widest:d,highest:h}=this._getLabelSizes(),f=s.padding*2,p=Na(this.labelRotation),m=Math.cos(p),g=Math.sin(p);if(a){const x=s.mirror?0:g*d.width+m*h.height;e.height=Math.min(this.maxHeight,e.height+x+f)}else{const x=s.mirror?0:m*d.width+g*h.height;e.width=Math.min(this.maxWidth,e.width+x+f)}this._calculatePadding(c,u,g,m)}}this._handleMargins(),a?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,s,r){const{ticks:{align:i,padding:o},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let h=0,f=0;l?c?(h=r*e.width,f=s*n.height):(h=s*e.height,f=r*n.width):i==="start"?f=n.width:i==="end"?h=e.width:i!=="inner"&&(h=e.width/2,f=n.width/2),this.paddingLeft=Math.max((h-u+o)*this.width/(this.width-u),0),this.paddingRight=Math.max((f-d+o)*this.width/(this.width-d),0)}else{let u=n.height/2,d=e.height/2;i==="start"?(u=0,d=e.height):i==="end"&&(u=n.height,d=0),this.paddingTop=u+o,this.paddingBottom=d+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Ot(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,s;for(n=0,s=e.length;n<s;n++)$t(e[n].label)&&(e.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=$I(s,n)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,s){const{ctx:r,_longestTextCache:i}=this,o=[],a=[],l=Math.floor(n/II(n,s));let c=0,u=0,d,h,f,p,m,g,x,b,v,w,C;for(d=0;d<n;d+=l){if(p=e[d].label,m=this._resolveTickFontOptions(d),r.font=g=m.string,x=i[g]=i[g]||{data:{},gc:[]},b=m.lineHeight,v=w=0,!$t(p)&&!Sn(p))v=sI(r,x.data,x.gc,v,p),w=b;else if(Sn(p))for(h=0,f=p.length;h<f;++h)C=p[h],!$t(C)&&!Sn(C)&&(v=sI(r,x.data,x.gc,v,C),w+=b);o.push(v),a.push(w),c=Math.max(v,c),u=Math.max(w,u)}d5(i,n);const $=o.indexOf(c),T=a.indexOf(u),N=_=>({width:o[_]||0,height:a[_]||0});return{first:N(0),last:N(n-1),widest:N($),highest:N(T),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return oV(this._alignToPixels?da(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const s=n[e];return s.$context||(s.$context=f5(this.getContext(),e,s))}return this.$context||(this.$context=h5(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=Na(this.labelRotation),s=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),i=this._getLabelSizes(),o=e.autoSkipPadding||0,a=i?i.widest.width+o:0,l=i?i.highest.height+o:0;return this.isHorizontal()?l*s>a*r?a/s:l/r:l*r<a*s?l/s:a/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,s=this.chart,r=this.options,{grid:i,position:o,border:a}=r,l=i.offset,c=this.isHorizontal(),d=this.ticks.length+(l?1:0),h=wu(i),f=[],p=a.setContext(this.getContext()),m=p.display?p.width:0,g=m/2,x=function(Y){return da(s,Y,m)};let b,v,w,C,$,T,N,_,A,O,W,G;if(o==="top")b=x(this.bottom),T=this.bottom-h,_=b-g,O=x(e.top)+g,G=e.bottom;else if(o==="bottom")b=x(this.top),O=e.top,G=x(e.bottom)-g,T=b+g,_=this.top+h;else if(o==="left")b=x(this.right),$=this.right-h,N=b-g,A=x(e.left)+g,W=e.right;else if(o==="right")b=x(this.left),A=e.left,W=x(e.right)-g,$=b+g,N=this.left+h;else if(n==="x"){if(o==="center")b=x((e.top+e.bottom)/2+.5);else if(at(o)){const Y=Object.keys(o)[0],te=o[Y];b=x(this.chart.scales[Y].getPixelForValue(te))}O=e.top,G=e.bottom,T=b+g,_=T+h}else if(n==="y"){if(o==="center")b=x((e.left+e.right)/2);else if(at(o)){const Y=Object.keys(o)[0],te=o[Y];b=x(this.chart.scales[Y].getPixelForValue(te))}$=b-g,N=$-h,A=e.left,W=e.right}const q=st(r.ticks.maxTicksLimit,d),U=Math.max(1,Math.ceil(d/q));for(v=0;v<d;v+=U){const Y=this.getContext(v),te=i.setContext(Y),M=a.setContext(Y),X=te.lineWidth,Z=te.color,oe=M.dash||[],ae=M.dashOffset,ce=te.tickWidth,pe=te.tickColor,fe=te.tickBorderDash||[],be=te.tickBorderDashOffset;w=u5(this,v,l),w!==void 0&&(C=da(s,w,X),c?$=N=A=W=C:T=_=O=G=C,f.push({tx1:$,ty1:T,tx2:N,ty2:_,x1:A,y1:O,x2:W,y2:G,width:X,color:Z,borderDash:oe,borderDashOffset:ae,tickWidth:ce,tickColor:pe,tickBorderDash:fe,tickBorderDashOffset:be}))}return this._ticksLength=d,this._borderValue=b,f}_computeLabelItems(e){const n=this.axis,s=this.options,{position:r,ticks:i}=s,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:u,mirror:d}=i,h=wu(s.grid),f=h+u,p=d?-u:f,m=-Na(this.labelRotation),g=[];let x,b,v,w,C,$,T,N,_,A,O,W,G="middle";if(r==="top")$=this.bottom-p,T=this._getXAxisLabelAlignment();else if(r==="bottom")$=this.top+p,T=this._getXAxisLabelAlignment();else if(r==="left"){const U=this._getYAxisLabelAlignment(h);T=U.textAlign,C=U.x}else if(r==="right"){const U=this._getYAxisLabelAlignment(h);T=U.textAlign,C=U.x}else if(n==="x"){if(r==="center")$=(e.top+e.bottom)/2+f;else if(at(r)){const U=Object.keys(r)[0],Y=r[U];$=this.chart.scales[U].getPixelForValue(Y)+f}T=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")C=(e.left+e.right)/2-f;else if(at(r)){const U=Object.keys(r)[0],Y=r[U];C=this.chart.scales[U].getPixelForValue(Y)}T=this._getYAxisLabelAlignment(h).textAlign}n==="y"&&(l==="start"?G="top":l==="end"&&(G="bottom"));const q=this._getLabelSizes();for(x=0,b=a.length;x<b;++x){v=a[x],w=v.label;const U=i.setContext(this.getContext(x));N=this.getPixelForTick(x)+i.labelOffset,_=this._resolveTickFontOptions(x),A=_.lineHeight,O=Sn(w)?w.length:1;const Y=O/2,te=U.color,M=U.textStrokeColor,X=U.textStrokeWidth;let Z=T;o?(C=N,T==="inner"&&(x===b-1?Z=this.options.reverse?"left":"right":x===0?Z=this.options.reverse?"right":"left":Z="center"),r==="top"?c==="near"||m!==0?W=-O*A+A/2:c==="center"?W=-q.highest.height/2-Y*A+A:W=-q.highest.height+A/2:c==="near"||m!==0?W=A/2:c==="center"?W=q.highest.height/2-Y*A:W=q.highest.height-O*A,d&&(W*=-1),m!==0&&!U.showLabelBackdrop&&(C+=A/2*Math.sin(m))):($=N,W=(1-O)*A/2);let oe;if(U.showLabelBackdrop){const ae=Mr(U.backdropPadding),ce=q.heights[x],pe=q.widths[x];let fe=W-ae.top,be=0-ae.left;switch(G){case"middle":fe-=ce/2;break;case"bottom":fe-=ce;break}switch(T){case"center":be-=pe/2;break;case"right":be-=pe;break;case"inner":x===b-1?be-=pe:x>0&&(be-=pe/2);break}oe={left:be,top:fe,width:pe+ae.width,height:ce+ae.height,color:U.backdropColor}}g.push({label:w,font:_,textOffset:W,options:{rotation:m,color:te,strokeColor:M,strokeWidth:X,textAlign:Z,textBaseline:G,translation:[C,$],backdrop:oe}})}return g}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-Na(this.labelRotation))return e==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:s,mirror:r,padding:i}}=this.options,o=this._getLabelSizes(),a=e+i,l=o.widest.width;let c,u;return n==="left"?r?(u=this.right+i,s==="near"?c="left":s==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-a,s==="near"?c="right":s==="center"?(c="center",u-=l/2):(c="left",u=this.left)):n==="right"?r?(u=this.left+i,s==="near"?c="right":s==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+a,s==="near"?c="left":s==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:s,top:r,width:i,height:o}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(s,r,i,o),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(i=>i.value===e);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const n=this.options.grid,s=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let i,o;const a=(l,c,u)=>{!u.width||!u.color||(s.save(),s.lineWidth=u.width,s.strokeStyle=u.color,s.setLineDash(u.borderDash||[]),s.lineDashOffset=u.borderDashOffset,s.beginPath(),s.moveTo(l.x,l.y),s.lineTo(c.x,c.y),s.stroke(),s.restore())};if(n.display)for(i=0,o=r.length;i<o;++i){const l=r[i];n.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),n.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:s,grid:r}}=this,i=s.setContext(this.getContext()),o=s.display?i.width:0;if(!o)return;const a=r.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,u,d,h;this.isHorizontal()?(c=da(e,this.left,o)-o/2,u=da(e,this.right,a)+a/2,d=h=l):(d=da(e,this.top,o)-o/2,h=da(e,this.bottom,a)+a/2,c=u=l),n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.beginPath(),n.moveTo(c,d),n.lineTo(u,h),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,r=this._computeLabelArea();r&&gg(s,r);const i=this.getLabelItems(e);for(const o of i){const a=o.options,l=o.font,c=o.label,u=o.textOffset;pm(s,c,0,u,l,a)}r&&xg(s)}drawTitle(){const{ctx:e,options:{position:n,title:s,reverse:r}}=this;if(!s.display)return;const i=ks(s.font),o=Mr(s.padding),a=s.align;let l=i.lineHeight/2;n==="bottom"||n==="center"||at(n)?(l+=o.bottom,Sn(s.text)&&(l+=i.lineHeight*(s.text.length-1))):l+=o.top;const{titleX:c,titleY:u,maxWidth:d,rotation:h}=m5(this,l,n,a);pm(e,s.text,0,0,i,{color:s.color,maxWidth:d,rotation:h,textAlign:p5(a,n,r),textBaseline:"middle",translation:[c,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,s=st(e.grid&&e.grid.z,-1),r=st(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Pc.prototype.draw?[{z:n,draw:i=>{this.draw(i)}}]:[{z:s,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",r=[];let i,o;for(i=0,o=n.length;i<o;++i){const a=n[i];a[s]===this.id&&(!e||a.type===e)&&r.push(a)}return r}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return ks(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Zf{constructor(e,n,s){this.type=e,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let s;y5(n)&&(s=this.register(n));const r=this.items,i=e.id,o=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+e);return i in r||(r[i]=e,g5(e,o,s),this.override&&tn.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const n=this.items,s=e.id,r=this.scope;s in n&&delete n[s],r&&s in tn[r]&&(delete tn[r][s],this.override&&delete Ha[s])}}function g5(t,e,n){const s=Sd(Object.create(null),[n?tn.get(n):{},tn.get(e),t.defaults]);tn.set(e,s),t.defaultRoutes&&x5(e,t.defaultRoutes),t.descriptors&&tn.describe(e,t.descriptors)}function x5(t,e){Object.keys(e).forEach(n=>{const s=n.split("."),r=s.pop(),i=[t].concat(s).join("."),o=e[n].split("."),a=o.pop(),l=o.join(".");tn.route(i,r,l,a)})}function y5(t){return"id"in t&&"defaults"in t}class b5{constructor(){this.controllers=new Zf(ed,"datasets",!0),this.elements=new Zf(zo,"elements"),this.plugins=new Zf(Object,"plugins"),this.scales=new Zf(Pc,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,s){[...n].forEach(r=>{const i=s||this._getRegistryForType(r);s||i.isForType(r)||i===this.plugins&&r.id?this._exec(e,i,r):xt(r,o=>{const a=s||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,n,s){const r=Ev(e);Ot(s["before"+r],[],s),n[e](s),Ot(s["after"+r],[],s)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(e))return s}return this.plugins}_get(e,n,s){const r=n.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return r}}var ni=new b5;class v5{constructor(){this._init=void 0}notify(e,n,s,r){if(n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const i=r?this._descriptors(e).filter(r):this._descriptors(e),o=this._notify(i,e,n,s);return n==="afterDestroy"&&(this._notify(i,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),o}_notify(e,n,s,r){r=r||{};for(const i of e){const o=i.plugin,a=o[s],l=[n,r,i.options];if(Ot(a,l,o)===!1&&r.cancelable)return!1}return!0}invalidate(){$t(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const s=e&&e.config,r=st(s.options&&s.options.plugins,{}),i=w5(s);return r===!1&&!n?[]:C5(e,i,r,n)}_notifyStateChanges(e){const n=this._oldCache||[],s=this._cache,r=(i,o)=>i.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(r(n,s),e,"stop"),this._notify(r(s,n),e,"start")}}function w5(t){const e={},n=[],s=Object.keys(ni.plugins.items);for(let i=0;i<s.length;i++)n.push(ni.getPlugin(s[i]));const r=t.plugins||[];for(let i=0;i<r.length;i++){const o=r[i];n.indexOf(o)===-1&&(n.push(o),e[o.id]=!0)}return{plugins:n,localIds:e}}function k5(t,e){return!e&&t===!1?null:t===!0?{}:t}function C5(t,{plugins:e,localIds:n},s,r){const i=[],o=t.getContext();for(const a of e){const l=a.id,c=k5(s[l],r);c!==null&&i.push({plugin:a,options:S5(t.config,{plugin:a,local:n[l]},c,o)})}return i}function S5(t,{plugin:e,local:n},s,r){const i=t.pluginScopeKeys(e),o=t.getOptionScopes(s,i);return n&&e.defaults&&o.push(e.defaults),t.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Ab(t,e){const n=tn.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function I5(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function $5(t,e){return t===e?"_index_":"_value_"}function TI(t){if(t==="x"||t==="y"||t==="r")return t}function N5(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function Db(t,...e){if(TI(t))return t;for(const n of e){const s=n.axis||N5(n.position)||t.length>1&&TI(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function EI(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function T5(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(n.length)return EI(t,"x",n[0])||EI(t,"y",n[0])}return{}}function E5(t,e){const n=Ha[t.type]||{scales:{}},s=e.scales||{},r=Ab(t.type,e),i=Object.create(null);return Object.keys(s).forEach(o=>{const a=s[o];if(!at(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=Db(o,a,T5(o,t),tn.scales[a.type]),c=$5(l,r),u=n.scales||{};i[o]=qu(Object.create(null),[{axis:l},a,u[l],u[c]])}),t.data.datasets.forEach(o=>{const a=o.type||t.type,l=o.indexAxis||Ab(a,e),u=(Ha[a]||{}).scales||{};Object.keys(u).forEach(d=>{const h=I5(d,l),f=o[h+"AxisID"]||h;i[f]=i[f]||Object.create(null),qu(i[f],[{axis:h},s[f],u[d]])})}),Object.keys(i).forEach(o=>{const a=i[o];qu(a,[tn.scales[a.type],tn.scale])}),i}function vR(t){const e=t.options||(t.options={});e.plugins=st(e.plugins,{}),e.scales=E5(t,e)}function wR(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function _5(t){return t=t||{},t.data=wR(t.data),vR(t),t}const _I=new Map,kR=new Set;function ep(t,e){let n=_I.get(t);return n||(n=e(),_I.set(t,n),kR.add(n)),n}const ku=(t,e,n)=>{const s=dm(e,n);s!==void 0&&t.add(s)};class R5{constructor(e){this._config=_5(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=wR(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),vR(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return ep(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return ep(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return ep(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,s=this.type;return ep(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const s=this._scopeCache;let r=s.get(e);return(!r||n)&&(r=new Map,s.set(e,r)),r}getOptionScopes(e,n,s){const{options:r,type:i}=this,o=this._cachedScopes(e,s),a=o.get(n);if(a)return a;const l=new Set;n.forEach(u=>{e&&(l.add(e),u.forEach(d=>ku(l,e,d))),u.forEach(d=>ku(l,r,d)),u.forEach(d=>ku(l,Ha[i]||{},d)),u.forEach(d=>ku(l,tn,d)),u.forEach(d=>ku(l,Eb,d))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),kR.has(n)&&o.set(n,c),c}chartOptionScopes(){const{options:e,type:n}=this;return[e,Ha[n]||{},tn.datasets[n]||{},{type:n},tn,Eb]}resolveNamedOptions(e,n,s,r=[""]){const i={$shared:!0},{resolver:o,subPrefixes:a}=RI(this._resolverCache,e,r);let l=o;if(D5(o,n)){i.$shared=!1,s=Mo(s)?s():s;const c=this.createResolver(e,s,a);l=mc(o,s,c)}for(const c of n)i[c]=l[c];return i}createResolver(e,n,s=[""],r){const{resolver:i}=RI(this._resolverCache,e,s);return at(n)?mc(i,n,void 0,r):i}}function RI(t,e,n){let s=t.get(e);s||(s=new Map,t.set(e,s));const r=n.join();let i=s.get(r);return i||(i={resolver:Av(e,n),subPrefixes:n.filter(a=>!a.toLowerCase().includes("hover"))},s.set(r,i)),i}const A5=t=>at(t)&&Object.getOwnPropertyNames(t).some(e=>Mo(t[e]));function D5(t,e){const{isScriptable:n,isIndexable:s}=nR(t);for(const r of e){const i=n(r),o=s(r),a=(o||i)&&t[r];if(i&&(Mo(a)||A5(a))||o&&Sn(a))return!0}return!1}var F5="4.5.1";const O5=["top","bottom","left","right","chartArea"];function AI(t,e){return t==="top"||t==="bottom"||O5.indexOf(t)===-1&&e==="x"}function DI(t,e){return function(n,s){return n[t]===s[t]?n[e]-s[e]:n[t]-s[t]}}function FI(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),Ot(n&&n.onComplete,[t],e)}function P5(t){const e=t.chart,n=e.options.animation;Ot(n&&n.onProgress,[t],e)}function CR(t){return Ov()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const Ap={},OI=t=>{const e=CR(t);return Object.values(Ap).filter(n=>n.canvas===e).pop()};function L5(t,e,n){const s=Object.keys(t);for(const r of s){const i=+r;if(i>=e){const o=t[r];delete t[r],(n>0||i>e)&&(t[i+n]=o)}}}function M5(t,e,n,s){return!n||t.type==="mouseout"?null:s?e:t}var io;let vg=(io=class{static register(...e){ni.add(...e),PI()}static unregister(...e){ni.remove(...e),PI()}constructor(e,n){const s=this.config=new R5(n),r=CR(e),i=OI(r);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const o=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||n5(r)),this.platform.updateConfig(s);const a=this.platform.acquireContext(r,o.aspectRatio),l=a&&a.canvas,c=l&&l.height,u=l&&l.width;if(this.id=Uj(),this.ctx=a,this.canvas=l,this.width=u,this.height=c,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new v5,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=dV(d=>this.update(d),o.resizeDelay||0),this._dataChanges=[],Ap[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Ni.listen(this,"complete",FI),Ni.listen(this,"progress",P5),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:s,height:r,_aspectRatio:i}=this;return $t(e)?n&&i?i:r?s/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return ni}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():aI(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return rI(this.canvas,this.ctx),this}stop(){return Ni.stop(this),this}resize(e,n){Ni.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const s=this.options,r=this.canvas,i=s.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,e,n,i),a=s.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,aI(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),Ot(s.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};xt(n,(s,r)=>{s.id=r})}buildOrUpdateScales(){const e=this.options,n=e.scales,s=this.scales,r=Object.keys(s).reduce((o,a)=>(o[a]=!1,o),{});let i=[];n&&(i=i.concat(Object.keys(n).map(o=>{const a=n[o],l=Db(o,a),c=l==="r",u=l==="x";return{options:a,dposition:c?"chartArea":u?"bottom":"left",dtype:c?"radialLinear":u?"category":"linear"}}))),xt(i,o=>{const a=o.options,l=a.id,c=Db(l,a),u=st(a.type,o.dtype);(a.position===void 0||AI(a.position,c)!==AI(o.dposition))&&(a.position=o.dposition),r[l]=!0;let d=null;if(l in s&&s[l].type===u)d=s[l];else{const h=ni.getScale(u);d=new h({id:l,type:u,ctx:this.ctx,chart:this}),s[d.id]=d}d.init(a,e)}),xt(r,(o,a)=>{o||delete s[a]}),xt(s,o=>{xo.configure(this,o,o.options),xo.addBox(this,o)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,s=e.length;if(e.sort((r,i)=>r.index-i.index),s>n){for(let r=n;r<s;++r)this._destroyDatasetMeta(r);e.splice(n,s-n)}this._sortedMetasets=e.slice(0).sort(DI("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((s,r)=>{n.filter(i=>i===s._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=n.length;s<r;s++){const i=n[s];let o=this.getDatasetMeta(s);const a=i.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(s),o=this.getDatasetMeta(s)),o.type=a,o.indexAxis=i.indexAxis||Ab(a,this.options),o.order=i.order||0,o.index=s,o.label=""+i.label,o.visible=this.isDatasetVisible(s),o.controller)o.controller.updateIndex(s),o.controller.linkScales();else{const l=ni.getController(a),{datasetElementType:c,dataElementType:u}=tn.datasets[a];Object.assign(l,{dataElementType:ni.getElement(u),datasetElementType:c&&ni.getElement(c)}),o.controller=new l(this,s),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){xt(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let c=0,u=this.data.datasets.length;c<u;c++){const{controller:d}=this.getDatasetMeta(c),h=!r&&i.indexOf(d)===-1;d.buildOrUpdateElements(h),o=Math.max(+d.getMaxOverflow(),o)}o=this._minPadding=s.layout.autoPadding?o:0,this._updateLayout(o),r||xt(i,c=>{c.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(DI("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){xt(this.scales,e=>{xo.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!X2(n,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:i}of n){const o=s==="_removeElements"?-i:i;L5(e,r,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=i=>new Set(e.filter(o=>o[0]===i).map((o,a)=>a+","+o.splice(1).join(","))),r=s(0);for(let i=1;i<n;i++)if(!X2(r,s(i)))return;return Array.from(r).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;xo.update(this,this.width,this.height,e);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],xt(this.boxes,r=>{s&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,i)=>{r._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,Mo(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const s=this.getDatasetMeta(e),r={meta:s,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(s.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Ni.has(this)?this.attached&&!Ni.running(this)&&Ni.start(this):(this.draw(),FI({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,s=[];let r,i;for(r=0,i=n.length;r<i;++r){const o=n[r];(!e||o.visible)&&s.push(o)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,s={meta:e,index:e.index,cancelable:!0},r=hR(this,e);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(r&&gg(n,r),e.controller.draw(),r&&xg(n),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return $d(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,s,r){const i=OU.modes[n];return typeof i=="function"?i(this,e,s,r):[]}getDatasetMeta(e){const n=this.data.datasets[e],s=this._metasets;let r=s.filter(i=>i&&i._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=dl(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(e,n){const s=this.getDatasetMeta(e);s.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,s){const r=s?"show":"hide",i=this.getDatasetMeta(e),o=i.controller._resolveAnimations(void 0,r);hm(n)?(i.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),o.update(i,{visible:s}),this.update(a=>a.datasetIndex===e?r:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),Ni.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),rI(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete Ap[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,s=(i,o)=>{n.addEventListener(this,i,o),e[i]=o},r=(i,o,a)=>{i.offsetX=o,i.offsetY=a,this._eventHandler(i)};xt(this.options.events,i=>s(i,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,s=(l,c)=>{n.addEventListener(this,l,c),e[l]=c},r=(l,c)=>{e[l]&&(n.removeEventListener(this,l,c),delete e[l])},i=(l,c)=>{this.canvas&&this.resize(l,c)};let o;const a=()=>{r("attach",a),this.attached=!0,this.resize(),s("resize",i),s("detach",o)};o=()=>{this.attached=!1,r("resize",i),this._stop(),this._resize(0,0),s("attach",a)},n.isAttached(this.canvas)?a():o()}unbindEvents(){xt(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},xt(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,s){const r=s?"set":"remove";let i,o,a,l;for(n==="dataset"&&(i=this.getDatasetMeta(e[0].datasetIndex),i.controller["_"+r+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const c=o&&this.getDatasetMeta(o.datasetIndex).controller;c&&c[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],s=e.map(({datasetIndex:i,index:o})=>{const a=this.getDatasetMeta(i);if(!a)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:a.data[o],index:o}});!cm(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(e,n,s){return this._plugins.notify(this,e,n,s)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,s){const r=this.options.hover,i=(l,c)=>l.filter(u=>!c.some(d=>u.datasetIndex===d.datasetIndex&&u.index===d.index)),o=i(n,e),a=s?e:i(e,n);o.length&&this.updateHoverStyle(o,r.mode,!1),a.length&&r.mode&&this.updateHoverStyle(a,r.mode,!0)}_eventHandler(e,n){const s={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},r=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,r)===!1)return;const i=this._handleEvent(e,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(i||s.changed)&&this.render(),this}_handleEvent(e,n,s){const{_active:r=[],options:i}=this,o=n,a=this._getActiveElements(e,r,s,o),l=Yj(e),c=M5(e,this._lastEvent,s,l);s&&(this._lastEvent=null,Ot(i.onHover,[e,a,this],this),l&&Ot(i.onClick,[e,a,this],this));const u=!cm(a,r);return(u||n)&&(this._active=a,this._updateHoverStyles(a,r,n)),this._lastEvent=c,u}_getActiveElements(e,n,s,r){if(e.type==="mouseout")return[];if(!s)return n;const i=this.options.hover;return this.getElementsAtEventForMode(e,i.mode,i,r)}},qe(io,"defaults",tn),qe(io,"instances",Ap),qe(io,"overrides",Ha),qe(io,"registry",ni),qe(io,"version",F5),qe(io,"getChart",OI),io);function PI(){return xt(vg.instances,t=>t._plugins.invalidate())}function SR(t,e,n=e){t.lineCap=st(n.borderCapStyle,e.borderCapStyle),t.setLineDash(st(n.borderDash,e.borderDash)),t.lineDashOffset=st(n.borderDashOffset,e.borderDashOffset),t.lineJoin=st(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=st(n.borderWidth,e.borderWidth),t.strokeStyle=st(n.borderColor,e.borderColor)}function z5(t,e,n){t.lineTo(n.x,n.y)}function B5(t){return t.stepped?IV:t.tension||t.cubicInterpolationMode==="monotone"?$V:z5}function IR(t,e,n={}){const s=t.length,{start:r=0,end:i=s-1}=n,{start:o,end:a}=e,l=Math.max(r,o),c=Math.min(i,a),u=r<o&&i<o||r>a&&i>a;return{count:s,start:l,loop:e.loop,ilen:c<l&&!u?s+c-l:c-l}}function W5(t,e,n,s){const{points:r,options:i}=e,{count:o,start:a,loop:l,ilen:c}=IR(r,n,s),u=B5(i);let{move:d=!0,reverse:h}=s||{},f,p,m;for(f=0;f<=c;++f)p=r[(a+(h?c-f:f))%o],!p.skip&&(d?(t.moveTo(p.x,p.y),d=!1):u(t,m,p,h,i.stepped),m=p);return l&&(p=r[(a+(h?c:0))%o],u(t,m,p,h,i.stepped)),!!l}function j5(t,e,n,s){const r=e.points,{count:i,start:o,ilen:a}=IR(r,n,s),{move:l=!0,reverse:c}=s||{};let u=0,d=0,h,f,p,m,g,x;const b=w=>(o+(c?a-w:w))%i,v=()=>{m!==g&&(t.lineTo(u,g),t.lineTo(u,m),t.lineTo(u,x))};for(l&&(f=r[b(0)],t.moveTo(f.x,f.y)),h=0;h<=a;++h){if(f=r[b(h)],f.skip)continue;const w=f.x,C=f.y,$=w|0;$===p?(C<m?m=C:C>g&&(g=C),u=(d*u+w)/++d):(v(),t.lineTo(w,C),p=$,d=0,m=g=C),x=C}v()}function Fb(t){const e=t.options,n=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!n?j5:W5}function V5(t){return t.stepped?iU:t.tension||t.cubicInterpolationMode==="monotone"?oU:ya}function U5(t,e,n,s){let r=e._path;r||(r=e._path=new Path2D,e.path(r,n,s)&&r.closePath()),SR(t,e.options),t.stroke(r)}function G5(t,e,n,s){const{segments:r,options:i}=e,o=Fb(e);for(const a of r)SR(t,i,a.style),t.beginPath(),o(t,e,a,{start:n,end:n+s-1})&&t.closePath(),t.stroke()}const H5=typeof Path2D=="function";function K5(t,e,n,s){H5&&!e.options.segment?U5(t,e,n,s):G5(t,e,n,s)}class yo extends zo{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,n){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const r=s.spanGaps?this._loop:this._fullLoop;QV(this._points,s,e,r,n),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=hU(this,this.options.segment))}first(){const e=this.segments,n=this.points;return e.length&&n[e[0].start]}last(){const e=this.segments,n=this.points,s=e.length;return s&&n[e[s-1].end]}interpolate(e,n){const s=this.options,r=e[n],i=this.points,o=dR(this,{property:n,start:r,end:r});if(!o.length)return;const a=[],l=V5(s);let c,u;for(c=0,u=o.length;c<u;++c){const{start:d,end:h}=o[c],f=i[d],p=i[h];if(f===p){a.push(f);continue}const m=Math.abs((r-f[n])/(p[n]-f[n])),g=l(f,p,m,s.stepped);g[n]=e[n],a.push(g)}return a.length===1?a[0]:a}pathSegment(e,n,s){return Fb(this)(e,this,n,s)}path(e,n,s){const r=this.segments,i=Fb(this);let o=this._loop;n=n||0,s=s||this.points.length-n;for(const a of r)o&=i(e,this,a,{start:n,end:n+s-1});return!!o}draw(e,n,s,r){const i=this.options||{};(this.points||[]).length&&i.borderWidth&&(e.save(),K5(e,this,s,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}qe(yo,"id","line"),qe(yo,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),qe(yo,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),qe(yo,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function LI(t,e,n,s){const r=t.options,{[n]:i}=t.getProps([n],s);return Math.abs(e-i)<r.radius+r.hitRadius}class Dp extends zo{constructor(n){super();qe(this,"parsed");qe(this,"skip");qe(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,s,r){const i=this.options,{x:o,y:a}=this.getProps(["x","y"],r);return Math.pow(n-o,2)+Math.pow(s-a,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(n,s){return LI(this,n,"x",s)}inYRange(n,s){return LI(this,n,"y",s)}getCenterPoint(n){const{x:s,y:r}=this.getProps(["x","y"],n);return{x:s,y:r}}size(n){n=n||this.options||{};let s=n.radius||0;s=Math.max(s,s&&n.hoverRadius||0);const r=s&&n.borderWidth||0;return(s+r)*2}draw(n,s){const r=this.options;this.skip||r.radius<.1||!$d(this,s,this.size(r)/2)||(n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.fillStyle=r.backgroundColor,_b(n,r,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}qe(Dp,"id","point"),qe(Dp,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),qe(Dp,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function X5(t,e,n){const s=t.segments,r=t.points,i=e.points,o=[];for(const a of s){let{start:l,end:c}=a;c=wg(l,c,r);const u=Ob(n,r[l],r[c],a.loop);if(!e.segments){o.push({source:a,target:u,start:r[l],end:r[c]});continue}const d=dR(e,u);for(const h of d){const f=Ob(n,i[h.start],i[h.end],h.loop),p=uR(a,r,f);for(const m of p)o.push({source:m,target:h,start:{[n]:MI(u,f,"start",Math.max)},end:{[n]:MI(u,f,"end",Math.min)}})}}return o}function Ob(t,e,n,s){if(s)return;let r=e[t],i=n[t];return t==="angle"&&(r=ri(r),i=ri(i)),{property:t,start:r,end:i}}function q5(t,e){const{x:n=null,y:s=null}=t||{},r=e.points,i=[];return e.segments.forEach(({start:o,end:a})=>{a=wg(o,a,r);const l=r[o],c=r[a];s!==null?(i.push({x:l.x,y:s}),i.push({x:c.x,y:s})):n!==null&&(i.push({x:n,y:l.y}),i.push({x:n,y:c.y}))}),i}function wg(t,e,n){for(;e>t;e--){const s=n[e];if(!isNaN(s.x)&&!isNaN(s.y))break}return e}function MI(t,e,n,s){return t&&e?s(t[n],e[n]):t?t[n]:e?e[n]:0}function $R(t,e){let n=[],s=!1;return Sn(t)?(s=!0,n=t):n=q5(t,e),n.length?new yo({points:n,options:{tension:0},_loop:s,_fullLoop:s}):null}function zI(t){return t&&t.fill!==!1}function Y5(t,e,n){let r=t[e].fill;const i=[e];let o;if(!n)return r;for(;r!==!1&&i.indexOf(r)===-1;){if(!Jn(r))return r;if(o=t[r],!o)return!1;if(o.visible)return r;i.push(r),r=o.fill}return!1}function Q5(t,e,n){const s=tG(t);if(at(s))return isNaN(s.value)?!1:s;let r=parseFloat(s);return Jn(r)&&Math.floor(r)===r?J5(s[0],e,r,n):["origin","start","end","stack","shape"].indexOf(s)>=0&&s}function J5(t,e,n,s){return(t==="-"||t==="+")&&(n=e+n),n===e||n<0||n>=s?!1:n}function Z5(t,e){let n=null;return t==="start"?n=e.bottom:t==="end"?n=e.top:at(t)?n=e.getPixelForValue(t.value):e.getBasePixel&&(n=e.getBasePixel()),n}function eG(t,e,n){let s;return t==="start"?s=n:t==="end"?s=e.options.reverse?e.min:e.max:at(t)?s=t.value:s=e.getBaseValue(),s}function tG(t){const e=t.options,n=e.fill;let s=st(n&&n.target,n);return s===void 0&&(s=!!e.backgroundColor),s===!1||s===null?!1:s===!0?"origin":s}function nG(t){const{scale:e,index:n,line:s}=t,r=[],i=s.segments,o=s.points,a=sG(e,n);a.push($R({x:null,y:e.bottom},s));for(let l=0;l<i.length;l++){const c=i[l];for(let u=c.start;u<=c.end;u++)rG(r,o[u],a)}return new yo({points:r,options:{}})}function sG(t,e){const n=[],s=t.getMatchingVisibleMetas("line");for(let r=0;r<s.length;r++){const i=s[r];if(i.index===e)break;i.hidden||n.unshift(i.dataset)}return n}function rG(t,e,n){const s=[];for(let r=0;r<n.length;r++){const i=n[r],{first:o,last:a,point:l}=iG(i,e,"x");if(!(!l||o&&a)){if(o)s.unshift(l);else if(t.push(l),!a)break}}t.push(...s)}function iG(t,e,n){const s=t.interpolate(e,n);if(!s)return{};const r=s[n],i=t.segments,o=t.points;let a=!1,l=!1;for(let c=0;c<i.length;c++){const u=i[c],d=o[u.start][n],h=o[u.end][n];if(Kl(r,d,h)){a=r===d,l=r===h;break}}return{first:a,last:l,point:s}}class NR{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,n,s){const{x:r,y:i,radius:o}=this;return n=n||{start:0,end:Dr},e.arc(r,i,o,n.end,n.start,!0),!s.bounds}interpolate(e){const{x:n,y:s,radius:r}=this,i=e.angle;return{x:n+Math.cos(i)*r,y:s+Math.sin(i)*r,angle:i}}}function oG(t){const{chart:e,fill:n,line:s}=t;if(Jn(n))return aG(e,n);if(n==="stack")return nG(t);if(n==="shape")return!0;const r=lG(t);return r instanceof NR?r:$R(r,s)}function aG(t,e){const n=t.getDatasetMeta(e);return n&&t.isDatasetVisible(e)?n.dataset:null}function lG(t){return(t.scale||{}).getPointPositionForValue?uG(t):cG(t)}function cG(t){const{scale:e={},fill:n}=t,s=Z5(n,e);if(Jn(s)){const r=e.isHorizontal();return{x:r?s:null,y:r?null:s}}return null}function uG(t){const{scale:e,fill:n}=t,s=e.options,r=e.getLabels().length,i=s.reverse?e.max:e.min,o=eG(n,e,i),a=[];if(s.grid.circular){const l=e.getPointPositionForValue(0,i);return new NR({x:l.x,y:l.y,radius:e.getDistanceFromCenterForValue(o)})}for(let l=0;l<r;++l)a.push(e.getPointPositionForValue(l,o));return a}function ry(t,e,n){const s=oG(e),{chart:r,index:i,line:o,scale:a,axis:l}=e,c=o.options,u=c.fill,d=c.backgroundColor,{above:h=d,below:f=d}=u||{},p=r.getDatasetMeta(i),m=hR(r,p);s&&o.points.length&&(gg(t,n),dG(t,{line:o,target:s,above:h,below:f,area:n,scale:a,axis:l,clip:m}),xg(t))}function dG(t,e){const{line:n,target:s,above:r,below:i,area:o,scale:a,clip:l}=e,c=n._loop?"angle":e.axis;t.save();let u=i;i!==r&&(c==="x"?(BI(t,s,o.top),iy(t,{line:n,target:s,color:r,scale:a,property:c,clip:l}),t.restore(),t.save(),BI(t,s,o.bottom)):c==="y"&&(WI(t,s,o.left),iy(t,{line:n,target:s,color:i,scale:a,property:c,clip:l}),t.restore(),t.save(),WI(t,s,o.right),u=r)),iy(t,{line:n,target:s,color:u,scale:a,property:c,clip:l}),t.restore()}function BI(t,e,n){const{segments:s,points:r}=e;let i=!0,o=!1;t.beginPath();for(const a of s){const{start:l,end:c}=a,u=r[l],d=r[wg(l,c,r)];i?(t.moveTo(u.x,u.y),i=!1):(t.lineTo(u.x,n),t.lineTo(u.x,u.y)),o=!!e.pathSegment(t,a,{move:o}),o?t.closePath():t.lineTo(d.x,n)}t.lineTo(e.first().x,n),t.closePath(),t.clip()}function WI(t,e,n){const{segments:s,points:r}=e;let i=!0,o=!1;t.beginPath();for(const a of s){const{start:l,end:c}=a,u=r[l],d=r[wg(l,c,r)];i?(t.moveTo(u.x,u.y),i=!1):(t.lineTo(n,u.y),t.lineTo(u.x,u.y)),o=!!e.pathSegment(t,a,{move:o}),o?t.closePath():t.lineTo(n,d.y)}t.lineTo(n,e.first().y),t.closePath(),t.clip()}function iy(t,e){const{line:n,target:s,property:r,color:i,scale:o,clip:a}=e,l=X5(n,s,r);for(const{source:c,target:u,start:d,end:h}of l){const{style:{backgroundColor:f=i}={}}=c,p=s!==!0;t.save(),t.fillStyle=f,hG(t,o,a,p&&Ob(r,d,h)),t.beginPath();const m=!!n.pathSegment(t,c);let g;if(p){m?t.closePath():jI(t,s,h,r);const x=!!s.pathSegment(t,u,{move:m,reverse:!0});g=m&&x,g||jI(t,s,d,r)}t.closePath(),t.fill(g?"evenodd":"nonzero"),t.restore()}}function hG(t,e,n,s){const r=e.chart.chartArea,{property:i,start:o,end:a}=s||{};if(i==="x"||i==="y"){let l,c,u,d;i==="x"?(l=o,c=r.top,u=a,d=r.bottom):(l=r.left,c=o,u=r.right,d=a),t.beginPath(),n&&(l=Math.max(l,n.left),u=Math.min(u,n.right),c=Math.max(c,n.top),d=Math.min(d,n.bottom)),t.rect(l,c,u-l,d-c),t.clip()}}function jI(t,e,n,s){const r=e.interpolate(n,s);r&&t.lineTo(r.x,r.y)}var fG={id:"filler",afterDatasetsUpdate(t,e,n){const s=(t.data.datasets||[]).length,r=[];let i,o,a,l;for(o=0;o<s;++o)i=t.getDatasetMeta(o),a=i.dataset,l=null,a&&a.options&&a instanceof yo&&(l={visible:t.isDatasetVisible(o),index:o,fill:Q5(a,o,s),chart:t,axis:i.controller.options.indexAxis,scale:i.vScale,line:a}),i.$filler=l,r.push(l);for(o=0;o<s;++o)l=r[o],!(!l||l.fill===!1)&&(l.fill=Y5(r,o,n.propagate))},beforeDraw(t,e,n){const s=n.drawTime==="beforeDraw",r=t.getSortedVisibleDatasetMetas(),i=t.chartArea;for(let o=r.length-1;o>=0;--o){const a=r[o].$filler;a&&(a.line.updateControlPoints(i,a.axis),s&&a.fill&&ry(t.ctx,a,i))}},beforeDatasetsDraw(t,e,n){if(n.drawTime!=="beforeDatasetsDraw")return;const s=t.getSortedVisibleDatasetMetas();for(let r=s.length-1;r>=0;--r){const i=s[r].$filler;zI(i)&&ry(t.ctx,i,t.chartArea)}},beforeDatasetDraw(t,e,n){const s=e.meta.$filler;!zI(s)||n.drawTime!=="beforeDatasetDraw"||ry(t.ctx,s,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const VI=(t,e)=>{let{boxHeight:n=e,boxWidth:s=e}=t;return t.usePointStyle&&(n=Math.min(n,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(e,n)}},pG=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class UI extends zo{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,s){this.maxWidth=e,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=Ot(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(s=>e.filter(s,this.chart.data))),e.sort&&(n=n.sort((s,r)=>e.sort(s,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,r=ks(s.font),i=r.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=VI(s,i);let c,u;n.font=r.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(o,i,a,l)+10):(u=this.maxHeight,c=this._fitCols(o,r,a,l)+10),this.width=Math.min(c,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,n,s,r){const{ctx:i,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=r+a;let d=e;i.textAlign="left",i.textBaseline="middle";let h=-1,f=-u;return this.legendItems.forEach((p,m)=>{const g=s+n/2+i.measureText(p.text).width;(m===0||c[c.length-1]+g+2*a>o)&&(d+=u,c[c.length-(m>0?0:1)]=0,f+=u,h++),l[m]={left:0,top:f,row:h,width:g,height:r},c[c.length-1]+=g+a}),d}_fitCols(e,n,s,r){const{ctx:i,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=o-e;let d=a,h=0,f=0,p=0,m=0;return this.legendItems.forEach((g,x)=>{const{itemWidth:b,itemHeight:v}=mG(s,n,i,g,r);x>0&&f+v+2*a>u&&(d+=h+a,c.push({width:h,height:f}),p+=h+a,m++,h=f=0),l[x]={left:p,top:f,col:m,width:b,height:v},h=Math.max(h,b),f+=v+a}),d+=h,c.push({width:h,height:f}),d}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:r},rtl:i}}=this,o=tc(i,this.left,this.width);if(this.isHorizontal()){let a=0,l=Fs(s,this.left+r,this.right-this.lineWidths[a]);for(const c of n)a!==c.row&&(a=c.row,l=Fs(s,this.left+r,this.right-this.lineWidths[a])),c.top+=this.top+e+r,c.left=o.leftForLtr(o.x(l),c.width),l+=c.width+r}else{let a=0,l=Fs(s,this.top+e+r,this.bottom-this.columnSizes[a].height);for(const c of n)c.col!==a&&(a=c.col,l=Fs(s,this.top+e+r,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+r,c.left=o.leftForLtr(o.x(c.left),c.width),l+=c.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;gg(e,this),this._draw(),xg(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:s,ctx:r}=this,{align:i,labels:o}=e,a=tn.color,l=tc(e.rtl,this.left,this.width),c=ks(o.font),{padding:u}=o,d=c.size,h=d/2;let f;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=c.string;const{boxWidth:p,boxHeight:m,itemHeight:g}=VI(o,d),x=function($,T,N){if(isNaN(p)||p<=0||isNaN(m)||m<0)return;r.save();const _=st(N.lineWidth,1);if(r.fillStyle=st(N.fillStyle,a),r.lineCap=st(N.lineCap,"butt"),r.lineDashOffset=st(N.lineDashOffset,0),r.lineJoin=st(N.lineJoin,"miter"),r.lineWidth=_,r.strokeStyle=st(N.strokeStyle,a),r.setLineDash(st(N.lineDash,[])),o.usePointStyle){const A={radius:m*Math.SQRT2/2,pointStyle:N.pointStyle,rotation:N.rotation,borderWidth:_},O=l.xPlus($,p/2),W=T+h;eR(r,A,O,W,o.pointStyleWidth&&p)}else{const A=T+Math.max((d-m)/2,0),O=l.leftForLtr($,p),W=Zu(N.borderRadius);r.beginPath(),Object.values(W).some(G=>G!==0)?Rb(r,{x:O,y:A,w:p,h:m,radius:W}):r.rect(O,A,p,m),r.fill(),_!==0&&r.stroke()}r.restore()},b=function($,T,N){pm(r,N.text,$,T+g/2,c,{strikethrough:N.hidden,textAlign:l.textAlign(N.textAlign)})},v=this.isHorizontal(),w=this._computeTitleHeight();v?f={x:Fs(i,this.left+u,this.right-s[0]),y:this.top+u+w,line:0}:f={x:this.left+u,y:Fs(i,this.top+w+u,this.bottom-n[0].height),line:0},aR(this.ctx,e.textDirection);const C=g+u;this.legendItems.forEach(($,T)=>{r.strokeStyle=$.fontColor,r.fillStyle=$.fontColor;const N=r.measureText($.text).width,_=l.textAlign($.textAlign||($.textAlign=o.textAlign)),A=p+h+N;let O=f.x,W=f.y;l.setWidth(this.width),v?T>0&&O+A+u>this.right&&(W=f.y+=C,f.line++,O=f.x=Fs(i,this.left+u,this.right-s[f.line])):T>0&&W+C>this.bottom&&(O=f.x=O+n[f.line].width+u,f.line++,W=f.y=Fs(i,this.top+w+u,this.bottom-n[f.line].height));const G=l.x(O);if(x(G,W,$),O=hV(_,O+p+h,v?O+A:this.right,e.rtl),b(l.x(O),W,$),v)f.x+=A+u;else if(typeof $.text!="string"){const q=c.lineHeight;f.y+=TR($,q)+u}else f.y+=C}),lR(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,s=ks(n.font),r=Mr(n.padding);if(!n.display)return;const i=tc(e.rtl,this.left,this.width),o=this.ctx,a=n.position,l=s.size/2,c=r.top+l;let u,d=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),u=this.top+c,d=Fs(e.align,d,this.right-h);else{const p=this.columnSizes.reduce((m,g)=>Math.max(m,g.height),0);u=c+Fs(e.align,this.top,this.bottom-p-e.labels.padding-this._computeTitleHeight())}const f=Fs(a,d,d+h);o.textAlign=i.textAlign(Q_(a)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=s.string,pm(o,n.text,f,u,s)}_computeTitleHeight(){const e=this.options.title,n=ks(e.font),s=Mr(e.padding);return e.display?n.lineHeight+s.height:0}_getLegendItemAt(e,n){let s,r,i;if(Kl(e,this.left,this.right)&&Kl(n,this.top,this.bottom)){for(i=this.legendHitBoxes,s=0;s<i.length;++s)if(r=i[s],Kl(e,r.left,r.left+r.width)&&Kl(n,r.top,r.top+r.height))return this.legendItems[s]}return null}handleEvent(e){const n=this.options;if(!yG(e.type,n))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,i=pG(r,s);r&&!i&&Ot(n.onLeave,[e,r,this],this),this._hoveredItem=s,s&&!i&&Ot(n.onHover,[e,s,this],this)}else s&&Ot(n.onClick,[e,s,this],this)}}function mG(t,e,n,s,r){const i=gG(s,t,e,n),o=xG(r,s,e.lineHeight);return{itemWidth:i,itemHeight:o}}function gG(t,e,n,s){let r=t.text;return r&&typeof r!="string"&&(r=r.reduce((i,o)=>i.length>o.length?i:o)),e+n.size/2+s.measureText(r).width}function xG(t,e,n){let s=t;return typeof e.text!="string"&&(s=TR(e,n)),s}function TR(t,e){const n=t.text?t.text.length:0;return e*n}function yG(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var bG={id:"legend",_element:UI,start(t,e,n){const s=t.legend=new UI({ctx:t.ctx,options:n,chart:t});xo.configure(t,s,n),xo.addBox(t,s)},stop(t){xo.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const s=t.legend;xo.configure(t,s,n),s.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const s=e.datasetIndex,r=n.chart;r.isDatasetVisible(s)?(r.hide(s),e.hidden=!0):(r.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:r,color:i,useBorderRadius:o,borderRadius:a}}=t.legend.options;return t._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(n?0:void 0),u=Mr(c.borderWidth);return{text:e[l.index].label,fillStyle:c.backgroundColor,fontColor:i,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:s||c.pointStyle,rotation:c.rotation,textAlign:r||c.textAlign,borderRadius:o&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};const Du={average(t){if(!t.length)return!1;let e,n,s=new Set,r=0,i=0;for(e=0,n=t.length;e<n;++e){const a=t[e].element;if(a&&a.hasValue()){const l=a.tooltipPosition();s.add(l.x),r+=l.y,++i}}return i===0||s.size===0?!1:{x:[...s].reduce((a,l)=>a+l)/s.size,y:r/i}},nearest(t,e){if(!t.length)return!1;let n=e.x,s=e.y,r=Number.POSITIVE_INFINITY,i,o,a;for(i=0,o=t.length;i<o;++i){const l=t[i].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),u=Tb(e,c);u<r&&(r=u,a=l)}}if(a){const l=a.tooltipPosition();n=l.x,s=l.y}return{x:n,y:s}}};function ei(t,e){return e&&(Sn(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Ti(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function vG(t,e){const{element:n,datasetIndex:s,index:r}=e,i=t.getDatasetMeta(s).controller,{label:o,value:a}=i.getLabelAndValue(r);return{chart:t,label:o,parsed:i.getParsed(r),raw:t.data.datasets[s].data[r],formattedValue:a,dataset:i.getDataset(),dataIndex:r,datasetIndex:s,element:n}}function GI(t,e){const n=t.chart.ctx,{body:s,footer:r,title:i}=t,{boxWidth:o,boxHeight:a}=e,l=ks(e.bodyFont),c=ks(e.titleFont),u=ks(e.footerFont),d=i.length,h=r.length,f=s.length,p=Mr(e.padding);let m=p.height,g=0,x=s.reduce((w,C)=>w+C.before.length+C.lines.length+C.after.length,0);if(x+=t.beforeBody.length+t.afterBody.length,d&&(m+=d*c.lineHeight+(d-1)*e.titleSpacing+e.titleMarginBottom),x){const w=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;m+=f*w+(x-f)*l.lineHeight+(x-1)*e.bodySpacing}h&&(m+=e.footerMarginTop+h*u.lineHeight+(h-1)*e.footerSpacing);let b=0;const v=function(w){g=Math.max(g,n.measureText(w).width+b)};return n.save(),n.font=c.string,xt(t.title,v),n.font=l.string,xt(t.beforeBody.concat(t.afterBody),v),b=e.displayColors?o+2+e.boxPadding:0,xt(s,w=>{xt(w.before,v),xt(w.lines,v),xt(w.after,v)}),b=0,n.font=u.string,xt(t.footer,v),n.restore(),g+=p.width,{width:g,height:m}}function wG(t,e){const{y:n,height:s}=e;return n<s/2?"top":n>t.height-s/2?"bottom":"center"}function kG(t,e,n,s){const{x:r,width:i}=s,o=n.caretSize+n.caretPadding;if(t==="left"&&r+i+o>e.width||t==="right"&&r-i-o<0)return!0}function CG(t,e,n,s){const{x:r,width:i}=n,{width:o,chartArea:{left:a,right:l}}=t;let c="center";return s==="center"?c=r<=(a+l)/2?"left":"right":r<=i/2?c="left":r>=o-i/2&&(c="right"),kG(c,t,e,n)&&(c="center"),c}function HI(t,e,n){const s=n.yAlign||e.yAlign||wG(t,n);return{xAlign:n.xAlign||e.xAlign||CG(t,e,n,s),yAlign:s}}function SG(t,e){let{x:n,width:s}=t;return e==="right"?n-=s:e==="center"&&(n-=s/2),n}function IG(t,e,n){let{y:s,height:r}=t;return e==="top"?s+=n:e==="bottom"?s-=r+n:s-=r/2,s}function KI(t,e,n,s){const{caretSize:r,caretPadding:i,cornerRadius:o}=t,{xAlign:a,yAlign:l}=n,c=r+i,{topLeft:u,topRight:d,bottomLeft:h,bottomRight:f}=Zu(o);let p=SG(e,a);const m=IG(e,l,c);return l==="center"?a==="left"?p+=c:a==="right"&&(p-=c):a==="left"?p-=Math.max(u,h)+r:a==="right"&&(p+=Math.max(d,f)+r),{x:ir(p,0,s.width-e.width),y:ir(m,0,s.height-e.height)}}function tp(t,e,n){const s=Mr(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-s.right:t.x+s.left}function XI(t){return ei([],Ti(t))}function $G(t,e,n){return dl(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function qI(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const ER={beforeTitle:$i,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return n[e.dataIndex]}return""},afterTitle:$i,beforeBody:$i,beforeLabel:$i,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return $t(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:$i,afterBody:$i,beforeFooter:$i,footer:$i,afterFooter:$i};function gs(t,e,n,s){const r=t[e].call(n,s);return typeof r>"u"?ER[e].call(n,s):r}class Pb extends zo{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&n.options.animation&&s.animations,i=new fR(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=$G(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:s}=n,r=gs(s,"beforeTitle",this,e),i=gs(s,"title",this,e),o=gs(s,"afterTitle",this,e);let a=[];return a=ei(a,Ti(r)),a=ei(a,Ti(i)),a=ei(a,Ti(o)),a}getBeforeBody(e,n){return XI(gs(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:s}=n,r=[];return xt(e,i=>{const o={before:[],lines:[],after:[]},a=qI(s,i);ei(o.before,Ti(gs(a,"beforeLabel",this,i))),ei(o.lines,gs(a,"label",this,i)),ei(o.after,Ti(gs(a,"afterLabel",this,i))),r.push(o)}),r}getAfterBody(e,n){return XI(gs(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:s}=n,r=gs(s,"beforeFooter",this,e),i=gs(s,"footer",this,e),o=gs(s,"afterFooter",this,e);let a=[];return a=ei(a,Ti(r)),a=ei(a,Ti(i)),a=ei(a,Ti(o)),a}_createItems(e){const n=this._active,s=this.chart.data,r=[],i=[],o=[];let a=[],l,c;for(l=0,c=n.length;l<c;++l)a.push(vG(this.chart,n[l]));return e.filter&&(a=a.filter((u,d,h)=>e.filter(u,d,h,s))),e.itemSort&&(a=a.sort((u,d)=>e.itemSort(u,d,s))),xt(a,u=>{const d=qI(e.callbacks,u);r.push(gs(d,"labelColor",this,u)),i.push(gs(d,"labelPointStyle",this,u)),o.push(gs(d,"labelTextColor",this,u))}),this.labelColors=r,this.labelPointStyles=i,this.labelTextColors=o,this.dataPoints=a,a}update(e,n){const s=this.options.setContext(this.getContext()),r=this._active;let i,o=[];if(!r.length)this.opacity!==0&&(i={opacity:0});else{const a=Du[s.position].call(this,r,this._eventPosition);o=this._createItems(s),this.title=this.getTitle(o,s),this.beforeBody=this.getBeforeBody(o,s),this.body=this.getBody(o,s),this.afterBody=this.getAfterBody(o,s),this.footer=this.getFooter(o,s);const l=this._size=GI(this,s),c=Object.assign({},a,l),u=HI(this.chart,s,c),d=KI(s,c,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,i={opacity:1,x:d.x,y:d.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,s,r){const i=this.getCaretPosition(e,s,r);n.lineTo(i.x1,i.y1),n.lineTo(i.x2,i.y2),n.lineTo(i.x3,i.y3)}getCaretPosition(e,n,s){const{xAlign:r,yAlign:i}=this,{caretSize:o,cornerRadius:a}=s,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:d}=Zu(a),{x:h,y:f}=e,{width:p,height:m}=n;let g,x,b,v,w,C;return i==="center"?(w=f+m/2,r==="left"?(g=h,x=g-o,v=w+o,C=w-o):(g=h+p,x=g+o,v=w-o,C=w+o),b=g):(r==="left"?x=h+Math.max(l,u)+o:r==="right"?x=h+p-Math.max(c,d)-o:x=this.caretX,i==="top"?(v=f,w=v-o,g=x-o,b=x+o):(v=f+m,w=v+o,g=x+o,b=x-o),C=v),{x1:g,x2:x,x3:b,y1:v,y2:w,y3:C}}drawTitle(e,n,s){const r=this.title,i=r.length;let o,a,l;if(i){const c=tc(s.rtl,this.x,this.width);for(e.x=tp(this,s.titleAlign,s),n.textAlign=c.textAlign(s.titleAlign),n.textBaseline="middle",o=ks(s.titleFont),a=s.titleSpacing,n.fillStyle=s.titleColor,n.font=o.string,l=0;l<i;++l)n.fillText(r[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,l+1===i&&(e.y+=s.titleMarginBottom-a)}}_drawColorBox(e,n,s,r,i){const o=this.labelColors[s],a=this.labelPointStyles[s],{boxHeight:l,boxWidth:c}=i,u=ks(i.bodyFont),d=tp(this,"left",i),h=r.x(d),f=l<u.lineHeight?(u.lineHeight-l)/2:0,p=n.y+f;if(i.usePointStyle){const m={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},g=r.leftForLtr(h,c)+c/2,x=p+l/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,_b(e,m,g,x),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,_b(e,m,g,x)}else{e.lineWidth=at(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const m=r.leftForLtr(h,c),g=r.leftForLtr(r.xPlus(h,1),c-2),x=Zu(o.borderRadius);Object.values(x).some(b=>b!==0)?(e.beginPath(),e.fillStyle=i.multiKeyBackground,Rb(e,{x:m,y:p,w:c,h:l,radius:x}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),Rb(e,{x:g,y:p+1,w:c-2,h:l-2,radius:x}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(m,p,c,l),e.strokeRect(m,p,c,l),e.fillStyle=o.backgroundColor,e.fillRect(g,p+1,c-2,l-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,n,s){const{body:r}=this,{bodySpacing:i,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:u}=s,d=ks(s.bodyFont);let h=d.lineHeight,f=0;const p=tc(s.rtl,this.x,this.width),m=function(N){n.fillText(N,p.x(e.x+f),e.y+h/2),e.y+=h+i},g=p.textAlign(o);let x,b,v,w,C,$,T;for(n.textAlign=o,n.textBaseline="middle",n.font=d.string,e.x=tp(this,g,s),n.fillStyle=s.bodyColor,xt(this.beforeBody,m),f=a&&g!=="right"?o==="center"?c/2+u:c+2+u:0,w=0,$=r.length;w<$;++w){for(x=r[w],b=this.labelTextColors[w],n.fillStyle=b,xt(x.before,m),v=x.lines,a&&v.length&&(this._drawColorBox(n,e,w,p,s),h=Math.max(d.lineHeight,l)),C=0,T=v.length;C<T;++C)m(v[C]),h=d.lineHeight;xt(x.after,m)}f=0,h=d.lineHeight,xt(this.afterBody,m),e.y-=i}drawFooter(e,n,s){const r=this.footer,i=r.length;let o,a;if(i){const l=tc(s.rtl,this.x,this.width);for(e.x=tp(this,s.footerAlign,s),e.y+=s.footerMarginTop,n.textAlign=l.textAlign(s.footerAlign),n.textBaseline="middle",o=ks(s.footerFont),n.fillStyle=s.footerColor,n.font=o.string,a=0;a<i;++a)n.fillText(r[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+s.footerSpacing}}drawBackground(e,n,s,r){const{xAlign:i,yAlign:o}=this,{x:a,y:l}=e,{width:c,height:u}=s,{topLeft:d,topRight:h,bottomLeft:f,bottomRight:p}=Zu(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(a+d,l),o==="top"&&this.drawCaret(e,n,s,r),n.lineTo(a+c-h,l),n.quadraticCurveTo(a+c,l,a+c,l+h),o==="center"&&i==="right"&&this.drawCaret(e,n,s,r),n.lineTo(a+c,l+u-p),n.quadraticCurveTo(a+c,l+u,a+c-p,l+u),o==="bottom"&&this.drawCaret(e,n,s,r),n.lineTo(a+f,l+u),n.quadraticCurveTo(a,l+u,a,l+u-f),o==="center"&&i==="left"&&this.drawCaret(e,n,s,r),n.lineTo(a,l+d),n.quadraticCurveTo(a,l,a+d,l),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,s=this.$animations,r=s&&s.x,i=s&&s.y;if(r||i){const o=Du[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=GI(this,e),l=Object.assign({},o,this._size),c=HI(n,e,l),u=KI(e,l,c,n);(r._to!==u.x||i._to!==u.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},i={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const o=Mr(n.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&a&&(e.save(),e.globalAlpha=s,this.drawBackground(i,e,r,n),aR(e,n.textDirection),i.y+=o.top,this.drawTitle(i,e,n),this.drawBody(i,e,n),this.drawFooter(i,e,n),lR(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const s=this._active,r=e.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),i=!cm(s,r),o=this._positionChanged(r,n);(i||o)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,i=this._active||[],o=this._getActiveElements(e,i,n,s),a=this._positionChanged(o,e),l=n||!cm(o,i)||a;return l&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),l}_getActiveElements(e,n,s,r){const i=this.options;if(e.type==="mouseout")return[];if(!r)return n.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,i.mode,i,s);return i.reverse&&o.reverse(),o}_positionChanged(e,n){const{caretX:s,caretY:r,options:i}=this,o=Du[i.position].call(this,e,n);return o!==!1&&(s!==o.x||r!==o.y)}}qe(Pb,"positioners",Du);var NG={id:"tooltip",_element:Pb,positioners:Du,afterInit(t,e,n){n&&(t.tooltip=new Pb({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:ER},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const TG=(t,e,n,s)=>(typeof e=="string"?(n=t.push(e)-1,s.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function EG(t,e,n,s){const r=t.indexOf(e);if(r===-1)return TG(t,e,n,s);const i=t.lastIndexOf(e);return r!==i?n:r}const _G=(t,e)=>t===null?null:ir(Math.round(t),0,e);function YI(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class Lb extends Pc{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:r,label:i}of n)s[r]===i&&s.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,n){if($t(e))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===e?n:EG(s,e,st(n,e),this._addedLabels),_G(n,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),n||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const e=this.min,n=this.max,s=this.options.offset,r=[];let i=this.getLabels();i=e===0&&n===i.length-1?i:i.slice(e,n+1),this._valueRange=Math.max(i.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let o=e;o<=n;o++)r.push({value:o});return r}getLabelForValue(e){return YI.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}qe(Lb,"id","category"),qe(Lb,"defaults",{ticks:{callback:YI}});function RG(t,e){const n=[],{bounds:r,step:i,min:o,max:a,precision:l,count:c,maxTicks:u,maxDigits:d,includeBounds:h}=t,f=i||1,p=u-1,{min:m,max:g}=e,x=!$t(o),b=!$t(a),v=!$t(c),w=(g-m)/(d+1);let C=Y2((g-m)/p/f)*f,$,T,N,_;if(C<1e-14&&!x&&!b)return[{value:m},{value:g}];_=Math.ceil(g/C)-Math.floor(m/C),_>p&&(C=Y2(_*C/p/f)*f),$t(l)||($=Math.pow(10,l),C=Math.ceil(C*$)/$),r==="ticks"?(T=Math.floor(m/C)*C,N=Math.ceil(g/C)*C):(T=m,N=g),x&&b&&i&&tV((a-o)/i,C/1e3)?(_=Math.round(Math.min((a-o)/C,u)),C=(a-o)/_,T=o,N=a):v?(T=x?o:T,N=b?a:N,_=c-1,C=(N-T)/_):(_=(N-T)/C,Yu(_,Math.round(_),C/1e3)?_=Math.round(_):_=Math.ceil(_));const A=Math.max(Q2(C),Q2(T));$=Math.pow(10,$t(l)?A:l),T=Math.round(T*$)/$,N=Math.round(N*$)/$;let O=0;for(x&&(h&&T!==o?(n.push({value:o}),T<o&&O++,Yu(Math.round((T+O*C)*$)/$,o,QI(o,w,t))&&O++):T<o&&O++);O<_;++O){const W=Math.round((T+O*C)*$)/$;if(b&&W>a)break;n.push({value:W})}return b&&h&&N!==a?n.length&&Yu(n[n.length-1].value,a,QI(a,w,t))?n[n.length-1].value=a:n.push({value:a}):(!b||N===a)&&n.push({value:N}),n}function QI(t,e,{horizontal:n,minRotation:s}){const r=Na(s),i=(n?Math.sin(r):Math.cos(r))||.001,o=.75*e*(""+t).length;return Math.min(e/i,o)}class AG extends Pc{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return $t(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:r,max:i}=this;const o=l=>r=n?r:l,a=l=>i=s?i:l;if(e){const l=pc(r),c=pc(i);l<0&&c<0?a(0):l>0&&c>0&&o(0)}if(r===i){let l=i===0?1:Math.abs(i*.05);a(i+l),e||o(r-l)}this.min=r,this.max=i}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=e,r;return s?(r=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const r={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},i=this._range||this,o=RG(r,i);return e.bounds==="ticks"&&nV(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const r=(s-n)/Math.max(e.length-1,1)/2;n-=r,s+=r}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(e){return J_(e,this.chart.options.locale,this.options.ticks.format)}}class Mb extends AG{determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=Jn(e)?e:0,this.max=Jn(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,s=Na(this.options.ticks.minRotation),r=(e?Math.sin(s):Math.cos(s))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,i.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}qe(Mb,"id","linear"),qe(Mb,"defaults",{ticks:{callback:Z_.formatters.numeric}});const kg={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},bs=Object.keys(kg);function JI(t,e){return t-e}function ZI(t,e){if($t(e))return null;const n=t._adapter,{parser:s,round:r,isoWeekday:i}=t._parseOpts;let o=e;return typeof s=="function"&&(o=s(o)),Jn(o)||(o=typeof s=="string"?n.parse(o,s):n.parse(o)),o===null?null:(r&&(o=r==="week"&&(Id(i)||i===!0)?n.startOf(o,"isoWeek",i):n.startOf(o,r)),+o)}function e$(t,e,n,s){const r=bs.length;for(let i=bs.indexOf(t);i<r-1;++i){const o=kg[bs[i]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-e)/(a*o.size))<=s)return bs[i]}return bs[r-1]}function DG(t,e,n,s,r){for(let i=bs.length-1;i>=bs.indexOf(n);i--){const o=bs[i];if(kg[o].common&&t._adapter.diff(r,s,o)>=e-1)return o}return bs[n?bs.indexOf(n):0]}function FG(t){for(let e=bs.indexOf(t)+1,n=bs.length;e<n;++e)if(kg[bs[e]].common)return bs[e]}function t$(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:s,hi:r}=_v(n,e),i=n[s]>=e?n[s]:n[r];t[i]=!0}}function OG(t,e,n,s){const r=t._adapter,i=+r.startOf(e[0].value,s),o=e[e.length-1].value;let a,l;for(a=i;a<=o;a=+r.add(a,1,s))l=n[a],l>=0&&(e[l].major=!0);return e}function n$(t,e,n){const s=[],r={},i=e.length;let o,a;for(o=0;o<i;++o)a=e[o],r[a]=o,s.push({value:a,major:!1});return i===0||!n?s:OG(t,s,r,n)}class xm extends Pc{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const s=e.time||(e.time={}),r=this._adapter=new _U._date(e.adapters.date);r.init(n),qu(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:ZI(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,s=e.time.unit||"day";let{min:r,max:i,minDefined:o,maxDefined:a}=this.getUserBounds();function l(c){!o&&!isNaN(c.min)&&(r=Math.min(r,c.min)),!a&&!isNaN(c.max)&&(i=Math.max(i,c.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),r=Jn(r)&&!isNaN(r)?r:+n.startOf(Date.now(),s),i=Jn(i)&&!isNaN(i)?i:+n.endOf(Date.now(),s)+1,this.min=Math.min(r,i-1),this.max=Math.max(r+1,i)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],s=e[e.length-1]),{min:n,max:s}}buildTicks(){const e=this.options,n=e.time,s=e.ticks,r=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const i=this.min,o=this.max,a=lV(r,i,o);return this._unit=n.unit||(s.autoSkip?e$(n.minUnit,this.min,this.max,this._getLabelCapacity(i)):DG(this,a.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:FG(this._unit),this.initOffsets(r),e.reverse&&a.reverse(),n$(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,s=0,r,i;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?n=1-r:n=(this.getDecimalForValue(e[1])-r)/2,i=this.getDecimalForValue(e[e.length-1]),e.length===1?s=i:s=(i-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;n=ir(n,0,o),s=ir(s,0,o),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const e=this._adapter,n=this.min,s=this.max,r=this.options,i=r.time,o=i.unit||e$(i.minUnit,n,s,this._getLabelCapacity(n)),a=st(r.ticks.stepSize,1),l=o==="week"?i.isoWeekday:!1,c=Id(l)||l===!0,u={};let d=n,h,f;if(c&&(d=+e.startOf(d,"isoWeek",l)),d=+e.startOf(d,c?"day":o),e.diff(s,n,o)>1e5*a)throw new Error(n+" and "+s+" are too far apart with stepSize of "+a+" "+o);const p=r.ticks.source==="data"&&this.getDataTimestamps();for(h=d,f=0;h<s;h=+e.add(h,a,o),f++)t$(u,h,p);return(h===s||r.bounds==="ticks"||f===1)&&t$(u,h,p),Object.keys(u).sort(JI).map(m=>+m)}getLabelForValue(e){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(e,s.tooltipFormat):n.format(e,s.displayFormats.datetime)}format(e,n){const r=this.options.time.displayFormats,i=this._unit,o=n||r[i];return this._adapter.format(e,o)}_tickFormatFunction(e,n,s,r){const i=this.options,o=i.ticks.callback;if(o)return Ot(o,[e,n,s],this);const a=i.time.displayFormats,l=this._unit,c=this._majorUnit,u=l&&a[l],d=c&&a[c],h=s[n],f=c&&d&&h&&h.major;return this._adapter.format(e,r||(f?d:u))}generateTickLabels(e){let n,s,r;for(n=0,s=e.length;n<s;++n)r=e[n],r.label=this._tickFormatFunction(r.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,s=this.ctx.measureText(e).width,r=Na(this.isHorizontal()?n.maxRotation:n.minRotation),i=Math.cos(r),o=Math.sin(r),a=this._resolveTickFontOptions(0).size;return{w:s*i+a*o,h:s*o+a*i}}_getLabelCapacity(e){const n=this.options.time,s=n.displayFormats,r=s[n.unit]||s.millisecond,i=this._tickFormatFunction(e,0,n$(this,[e],this._majorUnit),r),o=this._getLabelSize(i),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],n,s;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,s=r.length;n<s;++n)e=e.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,s;if(e.length)return e;const r=this.getLabels();for(n=0,s=r.length;n<s;++n)e.push(ZI(this,r[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return uV(e.sort(JI))}}qe(xm,"id","time"),qe(xm,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function np(t,e,n){let s=0,r=t.length-1,i,o,a,l;n?(e>=t[s].pos&&e<=t[r].pos&&({lo:s,hi:r}=Ta(t,"pos",e)),{pos:i,time:a}=t[s],{pos:o,time:l}=t[r]):(e>=t[s].time&&e<=t[r].time&&({lo:s,hi:r}=Ta(t,"time",e)),{time:i,pos:a}=t[s],{time:o,pos:l}=t[r]);const c=o-i;return c?a+(l-a)*(e-i)/c:a}class s$ extends xm{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=np(n,this.min),this._tableRange=np(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:s}=this,r=[],i=[];let o,a,l,c,u;for(o=0,a=e.length;o<a;++o)c=e[o],c>=n&&c<=s&&r.push(c);if(r.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(o=0,a=r.length;o<a;++o)u=r[o+1],l=r[o-1],c=r[o],Math.round((u+l)/2)!==c&&i.push({time:c,pos:o/(a-1)});return i}_generate(){const e=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((r,i)=>r-i)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?e=this.normalize(n.concat(s)):e=n.length?n:s,e=this._cache.all=e,e}getDecimalForValue(e){return(np(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return np(this._table,s*this._tableRange+this._minPos,!0)}}qe(s$,"id","timeseries"),qe(s$,"defaults",xm.defaults);const _R="label";function r$(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function PG(t,e){const n=t.options;n&&e&&Object.assign(n,e)}function RR(t,e){t.labels=e}function AR(t,e,n=_R){const s=[];t.datasets=e.map(r=>{const i=t.datasets.find(o=>o[n]===r[n]);return!i||!r.data||s.includes(i)?{...r}:(s.push(i),Object.assign(i,r),i)})}function LG(t,e=_R){const n={labels:[],datasets:[]};return RR(n,t.labels),AR(n,t.datasets,e),n}function MG(t,e){const{height:n=150,width:s=300,redraw:r=!1,datasetIdKey:i,type:o,data:a,options:l,plugins:c=[],fallbackContent:u,updateMode:d,...h}=t,f=J.useRef(null),p=J.useRef(null),m=()=>{f.current&&(p.current=new vg(f.current,{type:o,data:LG(a,i),options:l&&{...l},plugins:c}),r$(e,p.current))},g=()=>{r$(e,null),p.current&&(p.current.destroy(),p.current=null)};return J.useEffect(()=>{!r&&p.current&&l&&PG(p.current,l)},[r,l]),J.useEffect(()=>{!r&&p.current&&RR(p.current.config.data,a.labels)},[r,a.labels]),J.useEffect(()=>{!r&&p.current&&a.datasets&&AR(p.current.config.data,a.datasets,i)},[r,a.datasets]),J.useEffect(()=>{p.current&&(r?(g(),setTimeout(m)):p.current.update(d))},[r,l,a.labels,a.datasets,d]),J.useEffect(()=>{p.current&&(g(),setTimeout(m))},[o]),J.useEffect(()=>(m(),()=>g()),[]),S.jsx("canvas",{ref:f,role:"img",height:n,width:s,...h,children:u})}const zG=J.forwardRef(MG);function BG(t,e){return vg.register(e),J.forwardRef((n,s)=>S.jsx(zG,{...n,ref:s,type:t}))}const WG=BG("line",_p);vg.register(Lb,Mb,Dp,yo,NG,bG,fG);function jG(){const{profile:t,progress:e,rec:n,loading:s,refetch:r}=mg(),[i,o]=J.useState(""),[a,l]=J.useState(""),c=async $=>{if($.preventDefault(),!i)return;const T=new Date().toLocaleString("en-US",{month:"short",year:"numeric"});try{await cn.post("/progress",{month:T,weight_kg:Number(i),notes:a}),r(),o(""),l("")}catch(N){console.error("Update error:",N)}};if(s)return S.jsx("div",{className:"loader-container",children:S.jsx("div",{className:"spinner"})});if(!t)return S.jsxs("div",{className:"error-state",children:["Profile not found. ",S.jsx(Pi,{to:"/intake",children:"Set it up here"})]});const u=t.lifestyle_level==="active"?30:45,d=e.map($=>$.month),h=t.height_cm/100,f=e.map($=>Number(($.weight_kg/(h*h)).toFixed(1))),m=Number((22*h*h).toFixed(1)),g=Number((t.weight_kg-m).toFixed(1)),x=Math.abs(g),b=x>.5,v=b?g>0?`Lose ${x} kg`:`Gain ${x} kg`:"At ideal weight",w={labels:d,datasets:[{label:"Weight (kg)",data:e.map($=>$.weight_kg),borderColor:"#6366f1",backgroundColor:"rgba(99, 102, 241, 0.05)",borderWidth:3,tension:.4,yAxisID:"y",fill:!0},{label:"BMI Score",data:f,borderColor:"#10b981",borderDash:[5,5],borderWidth:2,tension:.4,yAxisID:"y1",pointRadius:3}]},C={responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{display:!0,position:"top",align:"end",labels:{boxWidth:10,usePointStyle:!0}}},scales:{y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Weight (kg)"},grid:{color:"#f1f5f9"}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"BMI"},grid:{drawOnChartArea:!1}},x:{grid:{display:!1}}}};return S.jsxs("div",{className:"dashboard-wrapper",children:[S.jsx("style",{dangerouslySetInnerHTML:{__html:VG}}),S.jsxs("header",{className:"dash-header",children:[S.jsxs("div",{children:[S.jsxs("h1",{children:["Welcome back, ",t.name,"!"]}),S.jsx("p",{children:"Tracking your Weight and BMI trends over time."})]}),S.jsxs("div",{className:"bmi-badge",children:[S.jsx("span",{className:"bmi-val",children:t.bmi.toFixed(1)}),S.jsx("span",{className:"bmi-cat",children:t.bmi_category})]})]}),S.jsxs("div",{className:"stats-grid",children:[S.jsxs("div",{className:"stat-card",children:[S.jsx("span",{className:"stat-icon",children:""}),S.jsxs("div",{className:"stat-info",children:[S.jsx("h4",{children:"Water Goal"}),S.jsx("p",{children:n!=null&&n.water_l&&n.water_l>0?`${n.water_l}L`:""})]})]}),S.jsxs("div",{className:"stat-card",children:[S.jsx("span",{className:"stat-icon",children:""}),S.jsxs("div",{className:"stat-info",children:[S.jsx("h4",{children:"Est. Burn"}),S.jsxs("p",{children:[Math.round(t.weight_kg*5.5)," kcal"]})]})]}),S.jsxs("div",{className:"stat-card",children:[S.jsx("span",{className:"stat-icon",children:""}),S.jsxs("div",{className:"stat-info",children:[S.jsx("h4",{children:"Workout"}),S.jsxs("p",{children:[u,"m"]})]})]}),S.jsxs("div",{className:"stat-card",children:[S.jsx("span",{className:"stat-icon",children:""}),S.jsxs("div",{className:"stat-info",children:[S.jsx("h4",{children:"Weight"}),S.jsxs("p",{children:[t.weight_kg,"kg"]}),S.jsx("small",{style:{color:b?"#dc2626":"#16a34a",fontWeight:700},children:v})]})]}),S.jsxs("div",{className:"stat-card",children:[S.jsx("span",{className:"stat-icon",children:""}),S.jsxs("div",{className:"stat-info",children:[S.jsx("h4",{children:"Daily Calories"}),S.jsx("p",{children:n!=null&&n.daily_calories?`${Math.round(n.daily_calories)} kcal`:""})]})]})]}),S.jsxs("div",{className:"main-content",children:[S.jsxs("section",{className:"chart-section card",children:[S.jsxs("div",{className:"card-header",children:[S.jsx("h3",{children:"Health Progression"}),S.jsx("span",{className:"badge",children:"Dual Metric View"})]}),S.jsx("div",{className:"chart-container",children:e.length>0?S.jsx(WG,{data:w,options:C}):S.jsx("div",{className:"empty-chart",children:"No data points yet"})})]}),S.jsxs("section",{className:"update-section card",children:[S.jsx("h3",{children:"Log Daily Stats"}),!b&&S.jsxs("div",{className:"maintain-box",style:{marginBottom:12},children:[S.jsx("strong",{children:"You're at your ideal weight "}),S.jsx("p",{style:{margin:"8px 0 0",color:"var(--text-muted)"},children:"To stay fit: keep a balanced diet, maintain regular activity (150 mins/week), prioritize sleep, and hydrate regularly."})]}),S.jsxs("form",{onSubmit:c,children:[S.jsxs("div",{className:"input-group",children:[S.jsx("label",{children:"Weight (kg)"}),S.jsx("input",{type:"number",step:"0.1",value:i,onChange:$=>o($.target.value===""?"":Number($.target.value)),required:!0})]}),S.jsxs("div",{className:"input-group",children:[S.jsx("label",{children:"Notes"}),S.jsx("textarea",{value:a,onChange:$=>l($.target.value),placeholder:"How's your energy?",rows:3})]}),S.jsx("button",{type:"submit",className:"btn-primary",children:"Sync Progress"})]})]})]})]})}const VG=`
:root {
  --primary: #6366f1;
  --secondary: #10b981;
  --bg: #f8fafc;
  --text-main: #1e293b;
  --text-muted: #64748b;
  --card-bg: #ffffff;
}
.dashboard-wrapper { max-width: 1100px; margin: 0 auto; padding: 40px 20px; font-family: 'Inter', sans-serif; background-color: var(--bg); min-height: 100vh; }
.error-state { text-align: center; padding: 60px 20px; }
.error-state a { color: #6366f1; text-decoration: none; font-weight: 600; }
.error-state a:hover { text-decoration: underline; }
.dash-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px; }
.dash-header h1 { font-size: 1.8rem; font-weight: 800; letter-spacing: -0.03em; margin: 0; }
.dash-header p { color: var(--text-muted); margin: 4px 0 0; }
.bmi-badge { background: white; padding: 12px 24px; border-radius: 16px; border: 1px solid #e2e8f0; text-align: center; }
.bmi-val { display: block; font-size: 1.6rem; font-weight: 800; color: var(--secondary); }
.bmi-cat { font-size: 0.7rem; text-transform: uppercase; font-weight: 700; color: var(--text-muted); }
.stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px; margin-bottom: 24px; }
@media (max-width: 900px) { .stats-grid { grid-template-columns: repeat(2, 1fr); } }
.stat-card { background: var(--card-bg); padding: 16px; border-radius: 16px; display: flex; align-items: center; gap: 12px; border: 1px solid #e2e8f0; }
.stat-icon { font-size: 1.2rem; background: #f8fafc; padding: 8px; border-radius: 10px; }
.stat-info h4 { margin: 0; font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase; }
.stat-info p { margin: 2px 0 0; font-size: 1rem; font-weight: 700; }
.main-content { display: grid; grid-template-columns: 2.2fr 1fr; gap: 24px; }
@media (max-width: 850px) { .main-content { grid-template-columns: 1fr; } }
.card { background: var(--card-bg); border-radius: 24px; padding: 24px; border: 1px solid #e2e8f0; }
.card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
.badge { background: #f0fdf4; color: #166534; padding: 4px 12px; border-radius: 100px; font-size: 0.75rem; font-weight: 600; }
.chart-container { height: 350px; position: relative; }
.input-group { margin-bottom: 16px; }
.input-group label { display: block; font-size: 0.8rem; margin-bottom: 6px; font-weight: 700; }
.input-group input, .input-group textarea { width: 100%; padding: 12px; border-radius: 12px; border: 1px solid #cbd5e1; }
.btn-primary { width: 100%; background: #0f172a; color: white; border: none; padding: 14px; border-radius: 12px; font-weight: 700; cursor: pointer; }
.btn-primary:hover { background: #334155; }
.loader-container { height: 100vh; display: flex; align-items: center; justify-content: center; }
.spinner { width: 30px; height: 30px; border: 3px solid #e2e8f0; border-top: 3px solid var(--primary); border-radius: 50%; animation: spin 0.8s linear infinite; }
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
`;function UG(){const{updateProfile:t,refetch:e}=mg(),[n,s]=J.useState({name:"",age:"",gender:"",height_cm:"",weight_kg:"",lifestyle_level:"sedentary",diet_type:"vegetarian",water_consumption_l:"",junk_food_consumption:"low",healthy_food_consumption:"moderate",target_area:"full body",breakfast:"",lunch:"",snacks:"",dinner:"",motive:"remain fit and healthy",duration_weeks:"",food_allergies:"",health_diseases:""}),[r,i]=J.useState(""),[o,a]=J.useState(null),[l,c]=J.useState(null),u=ul();J.useEffect(()=>{const f=localStorage.getItem("token");f&&Ga(f),cn.get("/profile").then(p=>{const m=p.data;s({name:m.name||"",age:m.age?String(m.age):"",gender:m.gender||"",height_cm:m.height_cm?String(m.height_cm):"",weight_kg:m.weight_kg?String(m.weight_kg):"",lifestyle_level:m.lifestyle_level||"sedentary",diet_type:m.diet_type||"vegetarian",water_consumption_l:m.water_consumption_l?String(m.water_consumption_l):"",junk_food_consumption:m.junk_food_consumption||"low",healthy_food_consumption:m.healthy_food_consumption||"moderate",breakfast:m.breakfast||"",lunch:m.lunch||"",snacks:m.snacks||"",dinner:m.dinner||"",target_area:m.target_area||"full body",motive:m.motive||"remain fit and healthy",duration_weeks:m.duration_weeks?String(m.duration_weeks):"",food_allergies:m.food_allergies||"",health_diseases:m.health_diseases||""})}).catch(()=>{})},[]);function d(f,p){s(m=>({...m,[f]:p}))}async function h(f){var g,x;f.preventDefault(),i("");const p=["age","height_cm","weight_kg","water_consumption_l","duration_weeks"];for(const b of p)if(!n[b]){i("Please fill all required numeric fields");return}const m={...n,age:Number(n.age),height_cm:Number(n.height_cm),weight_kg:Number(n.weight_kg),water_consumption_l:Number(n.water_consumption_l),duration_weeks:Number(n.duration_weeks)};try{await cn.post("/profile",m),e(),u("/dashboard")}catch(b){i(((x=(g=b==null?void 0:b.response)==null?void 0:g.data)==null?void 0:x.detail)||"Failed to save profile")}}return S.jsxs("div",{className:"card",children:[S.jsx("div",{className:"title",children:" Health Profile"}),S.jsx("div",{className:"subtitle",children:"Provide details to personalize your fitness plan"}),o!==null&&l!==null&&S.jsxs("div",{className:"current-stats",children:[S.jsxs("div",{className:"stat",children:["Current BMI: ",o.toFixed(1)," (",n.weight_kg,"kg)"]}),S.jsxs("div",{className:"stat",children:["Daily Calories: ",Math.round(l)," kcal"]})]}),r&&S.jsx("div",{className:"status",children:r}),S.jsxs("form",{onSubmit:h,children:[S.jsxs("div",{className:"grid",children:[S.jsxs("div",{className:"field",children:[S.jsx("div",{className:"label",children:" Name"}),S.jsx("input",{className:"input",value:n.name,onChange:f=>d("name",f.target.value)})]}),S.jsxs("div",{className:"field",children:[S.jsx("div",{className:"label",children:" Age"}),S.jsx("input",{className:"input",type:"number",value:n.age,onChange:f=>d("age",f.target.value)})]}),S.jsxs("div",{className:"field",children:[S.jsx("div",{className:"label",children:" Gender"}),S.jsx("input",{className:"input",value:n.gender,onChange:f=>d("gender",f.target.value)})]}),S.jsxs("div",{className:"field",children:[S.jsx("div",{className:"label",children:" Height (cm)"}),S.jsx("input",{className:"input",type:"number",value:n.height_cm,onChange:f=>d("height_cm",f.target.value)})]}),S.jsxs("div",{className:"field",children:[S.jsx("div",{className:"label",children:" Weight (kg)"}),S.jsx("input",{className:"input",type:"number",value:n.weight_kg,onChange:f=>d("weight_kg",f.target.value)})]}),S.jsxs("div",{className:"field",children:[S.jsx("div",{className:"label",children:" Lifestyle"}),S.jsxs("select",{className:"select",value:n.lifestyle_level,onChange:f=>d("lifestyle_level",f.target.value),children:[S.jsx("option",{value:"sedentary",children:"Sedentary"}),S.jsx("option",{value:"lightly active",children:"Lightly Active"}),S.jsx("option",{value:"moderately active",children:"Moderately Active"}),S.jsx("option",{value:"very active",children:"Very Active"})]})]}),S.jsxs("div",{className:"field",children:[S.jsx("div",{className:"label",children:" Diet Type"}),S.jsxs("select",{className:"select",value:n.diet_type,onChange:f=>d("diet_type",f.target.value),children:[S.jsx("option",{value:"vegetarian",children:"Vegetarian"}),S.jsx("option",{value:"non vegetarian",children:"Non Vegetarian"}),S.jsx("option",{value:"vegan",children:"Vegan"})]})]}),S.jsxs("div",{className:"field",children:[S.jsx("div",{className:"label",children:" Water (L/day)"}),S.jsx("input",{className:"input",type:"number",value:n.water_consumption_l,onChange:f=>d("water_consumption_l",f.target.value)})]})]}),S.jsxs("div",{className:"grid section",children:[S.jsxs("div",{className:"field",children:[S.jsx("div",{className:"label",children:" Junk Food"}),S.jsxs("select",{className:"select",value:n.junk_food_consumption,onChange:f=>d("junk_food_consumption",f.target.value),children:[S.jsx("option",{value:"low",children:"Low"}),S.jsx("option",{value:"moderate",children:"Moderate"}),S.jsx("option",{value:"high",children:"High"})]})]}),S.jsxs("div",{className:"field",children:[S.jsx("div",{className:"label",children:" Healthy Food"}),S.jsxs("select",{className:"select",value:n.healthy_food_consumption,onChange:f=>d("healthy_food_consumption",f.target.value),children:[S.jsx("option",{value:"low",children:"Low"}),S.jsx("option",{value:"moderate",children:"Moderate"}),S.jsx("option",{value:"high",children:"High"})]})]})]}),S.jsxs("div",{className:"section",children:[S.jsx("div",{className:"title",children:" Regular Meals"}),S.jsxs("div",{className:"field",children:[S.jsx("div",{className:"label",children:" Breakfast"}),S.jsx("textarea",{className:"textarea",value:n.breakfast,onChange:f=>d("breakfast",f.target.value)})]}),S.jsxs("div",{className:"field",children:[S.jsx("div",{className:"label",children:" Lunch"}),S.jsx("textarea",{className:"textarea",value:n.lunch,onChange:f=>d("lunch",f.target.value)})]}),S.jsxs("div",{className:"field",children:[S.jsx("div",{className:"label",children:" Snacks"}),S.jsx("textarea",{className:"textarea",value:n.snacks,onChange:f=>d("snacks",f.target.value)})]}),S.jsxs("div",{className:"field",children:[S.jsx("div",{className:"label",children:" Dinner"}),S.jsx("textarea",{className:"textarea",value:n.dinner,onChange:f=>d("dinner",f.target.value)})]})]}),S.jsxs("div",{className:"grid section",children:[S.jsxs("div",{className:"field",children:[S.jsx("div",{className:"label",children:" Motive"}),S.jsxs("select",{className:"select",value:n.motive,onChange:f=>d("motive",f.target.value),children:[S.jsx("option",{value:"weight loss",children:"Weight Loss"}),S.jsx("option",{value:"weight gain",children:"Weight Gain"}),S.jsx("option",{value:"build muscle",children:"Build Muscle"}),S.jsx("option",{value:"remain fit and healthy",children:"Remain Fit & Healthy"})]})]}),S.jsxs("div",{className:"field",children:[S.jsx("div",{className:"label",children:" Target Area"}),S.jsxs("select",{className:"select",value:n.target_area,onChange:f=>d("target_area",f.target.value),children:[S.jsx("option",{value:"full body",children:"Full Body"}),S.jsx("option",{value:"upper body",children:"Upper Body"}),S.jsx("option",{value:"lower body",children:"Lower Body"}),S.jsx("option",{value:"core",children:"Core"}),S.jsx("option",{value:"arms",children:"Arms"}),S.jsx("option",{value:"legs",children:"Legs"}),S.jsx("option",{value:"back",children:"Back"}),S.jsx("option",{value:"chest",children:"Chest"}),S.jsx("option",{value:"shoulders",children:"Shoulders"})]})]}),S.jsxs("div",{className:"field",children:[S.jsx("div",{className:"label",children:" Duration (weeks)"}),S.jsx("input",{className:"input",type:"number",value:n.duration_weeks,onChange:f=>d("duration_weeks",f.target.value)})]}),S.jsxs("div",{className:"field",children:[S.jsx("div",{className:"label",children:" Food Allergies"}),S.jsx("input",{className:"input",value:n.food_allergies,onChange:f=>d("food_allergies",f.target.value)})]}),S.jsxs("div",{className:"field",children:[S.jsx("div",{className:"label",children:" Health Diseases"}),S.jsx("input",{className:"input",value:n.health_diseases,onChange:f=>d("health_diseases",f.target.value)})]})]}),S.jsx("div",{className:"section",style:{textAlign:"center"},children:S.jsx("button",{className:"button",type:"submit",children:" Save Profile"})})]}),S.jsx("style",{children:`
        .current-stats {
          display: flex;
          justify-content: space-around;
          margin-bottom: 20px;
          padding: 10px;
          background: #f0f9ff;
          border-radius: 8px;
        }
        .stat {
          font-weight: bold;
          color: #0369a1;
        }
      `})]})}function GG(){var c,u;const[t,e]=J.useState(null),[n,s]=J.useState("workout"),[r,i]=J.useState(null);if(J.useEffect(()=>{cn.get("/recommendations").then(d=>{console.log("Full recommendations response:",d.data),console.log("Test output:",d.data.test_output),e(d.data)})},[]),!t)return S.jsx("div",{className:"loading",children:"Designing your plan..."});const o=d=>{const h=d.toLowerCase();return h.includes("breakfast")?{bg:"#FFF4E6",text:"#FF922B",border:"#FFE8CC",icon:""}:h.includes("lunch")?{bg:"#EBFBEE",text:"#40C057",border:"#D3F9D8",icon:""}:h.includes("dinner")?{bg:"#F3F0FF",text:"#7950F2",border:"#E5DBFF",icon:""}:{bg:"#E7F5FF",text:"#228BE6",border:"#D0EBFF",icon:""}},a=d=>`https://workoutguru.fit/exercises/${d.toLowerCase().replace(/\s+/g,"-")}`,l=(d,h)=>{var x,b,v;const f=(t.workouts||[]).map(w=>({name:w.name||w.title||w.exercise||w,repetitions:w.repetitions||w.reps||"",gif_url:w.gif_url||w.gifUrl||""}));try{sessionStorage.setItem("workoutPlan",JSON.stringify(f))}catch{}const p=((x=f[d])==null?void 0:x.name)||"",m=((b=f[d])==null?void 0:b.repetitions)||"",g=((v=f[d])==null?void 0:v.gif_url)||"";window.location.href=`/trainer?name=${encodeURIComponent(p)}&reps=${encodeURIComponent(m)}&gif=${encodeURIComponent(g)}&idx=${d}`};return S.jsxs("div",{className:"app-container",children:[S.jsx("style",{children:`
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap');
        
        body { background: #f8fafc; margin: 0; }
        .app-container { max-width: 500px; margin: 0 auto; padding: 20px; font-family: 'Plus Jakarta Sans', sans-serif; color: #1e293b; }
        
        /* Hero Section */
        .hero { 
          background: linear-gradient(135deg, #4361ee 0%, #7209b7 100%);
          padding: 40px 30px; border-radius: 40px; color: white; margin-bottom: 25px;
          box-shadow: 0 20px 30px -10px rgba(67, 97, 238, 0.3);
          position: relative; overflow: hidden;
        }

        /* Glass Tabs */
        .tab-bar { display: flex; background: #e2e8f0; padding: 6px; border-radius: 20px; margin-bottom: 25px; }
        .tab { 
          flex: 1; border: none; padding: 14px; border-radius: 16px; font-weight: 800;
          cursor: pointer; transition: 0.2s; color: #64748b; font-size: 0.9rem;
        }
        .tab.active { background: white; color: #4361ee; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }

        /* Workout Cards */
        .card { background: white; border-radius: 28px; padding: 24px; margin-bottom: 16px; border: 1px solid #f1f5f9; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.02); }
        .guru-btn {
          display: flex; align-items: center; justify-content: center; gap: 8px;
          background: #f1f5f9; color: #4361ee; text-decoration: none;
          padding: 12px; border-radius: 14px; font-weight: 800; font-size: 0.85rem;
          margin-top: 15px; transition: 0.2s; border: 1px solid transparent;
        }
        .guru-btn:hover { background: #eef2ff; border-color: #4361ee; }

        /* Diet Styling */
        .food-card { 
          padding: 20px; border-radius: 22px; margin-bottom: 12px; 
          border: 1px solid transparent; transition: 0.3s;
        }
        .macro-pill { 
          font-size: 0.7rem; font-weight: 800; padding: 4px 10px; 
          border-radius: 8px; text-transform: uppercase; letter-spacing: 0.5px;
        }

        .water-card {
          background: #dbeafe; padding: 25px; border-radius: 30px;
          display: flex; justify-content: space-between; align-items: center;
          border: 2px solid #bfdbfe; color: #1e40af;
        }
      `}),S.jsxs("div",{className:"hero",children:[S.jsx("h4",{style:{margin:0,opacity:.8,fontSize:"0.9rem",letterSpacing:"1px"},children:"FUEL & FLOW"}),S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:20},children:[S.jsxs("div",{children:[S.jsx("h1",{style:{fontSize:"2.8rem",margin:"5px 0",fontWeight:800},children:t.daily_calories}),S.jsx("p",{style:{margin:"8px 0 0",fontWeight:600,fontSize:"0.95rem"},children:"Daily Calories"})]}),S.jsxs("div",{style:{textAlign:"right",borderLeft:"2px solid rgba(255,255,255,0.3)",paddingLeft:20},children:[S.jsx("h2",{style:{fontSize:"2.2rem",margin:"0",fontWeight:800},children:(c=t.daily_protein_g)==null?void 0:c.toFixed(0)}),S.jsx("p",{style:{margin:"8px 0 0",fontWeight:600,fontSize:"0.95rem"},children:"Daily Protein (g)"})]})]})]}),S.jsxs("div",{className:"tab-bar",children:[S.jsx("button",{className:`tab ${n==="workout"?"active":""}`,onClick:()=>s("workout"),children:"WORKOUTS"}),S.jsx("button",{className:`tab ${n==="diet"?"active":""}`,onClick:()=>s("diet"),children:"NUTRITION"})]}),S.jsxs("div",{className:"content",children:[n==="workout"&&t.workouts.map((d,h)=>{var m;const f=d.name||d.title||d.exercise||d,p=r===f;return S.jsxs("div",{className:"card",onClick:()=>i(p?null:f),style:{cursor:"pointer"},children:[S.jsxs("div",{style:{display:"flex",alignItems:"center",gap:18},children:[S.jsx("div",{style:{fontSize:"1.8rem",background:"#eef2ff",width:60,height:60,borderRadius:20,display:"flex",alignItems:"center",justifyContent:"center"},children:""}),S.jsxs("div",{style:{flex:1},children:[S.jsx("h3",{style:{margin:0,fontSize:"1.15rem",fontWeight:800},children:f}),S.jsx("p",{style:{margin:"4px 0 0 0",color:"#4361ee",fontWeight:700,fontSize:"0.85rem"},children:d.reps||d.repetitions||"Default Circuit"})]}),S.jsx("div",{style:{color:"#cbd5e1",fontSize:"1.2rem"},children:p?"":""})]}),p&&S.jsxs("div",{style:{marginTop:20,paddingTop:20,borderTop:"2px dashed #f1f5f9"},children:[S.jsx("p",{style:{fontWeight:800,fontSize:"0.8rem",color:"#94a3b8",marginBottom:12},children:"EXECUTION STEPS"}),(m=d.steps)==null?void 0:m.map((g,x)=>S.jsxs("div",{style:{display:"flex",gap:12,marginBottom:10,lineHeight:1.5},children:[S.jsx("span",{style:{color:"#4361ee",fontWeight:900},children:x+1}),S.jsx("span",{style:{color:"#475569",fontSize:"0.95rem"},children:g})]},x)),S.jsxs("a",{href:a(f),target:"_blank",rel:"noreferrer",className:"guru-btn",onClick:g=>g.stopPropagation(),children:[S.jsx("span",{children:"WATCH ON WORKOUT GURU"}),S.jsx("span",{style:{fontSize:"1.1rem"},children:""})]}),S.jsx("div",{style:{display:"flex",gap:10,marginTop:12},children:S.jsx("button",{onClick:g=>{g.stopPropagation(),l(h)},style:{display:"inline-flex",alignItems:"center",gap:8,background:"#10b981",color:"white",padding:"10px 14px",borderRadius:12,border:"none",fontWeight:800,cursor:"pointer"},children:"Start AI Trainer"})})]})]},h)}),n==="diet"&&t.diet.map((d,h)=>{var m,g,x,b,v,w;const f=o(d.meal_type),p=((m=t.diet_alternatives)==null?void 0:m[d.meal_type])||[];return S.jsxs("div",{style:{marginBottom:35},children:[S.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:15,paddingLeft:10},children:[S.jsx("span",{style:{fontSize:"1.4rem"},children:f.icon}),S.jsx("h2",{style:{margin:0,fontSize:"1.2rem",fontWeight:800,color:f.text,textTransform:"uppercase",letterSpacing:"1px"},children:d.meal_type})]}),S.jsxs("div",{style:{background:f.bg,padding:"18px",borderRadius:"20px",border:`2px solid ${f.border}`,marginBottom:15},children:[S.jsx("h5",{style:{margin:"0 0 10px",fontSize:"0.95rem",fontWeight:700,color:f.text},children:d.food_name}),S.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[S.jsxs("div",{style:{color:f.text,fontWeight:700,fontSize:"0.85rem"},children:[(g=d.calories)==null?void 0:g.toFixed(0)," ",S.jsx("span",{style:{fontSize:"0.6rem"},children:"KCAL"})]}),S.jsxs("div",{style:{color:"#94a3b8",fontWeight:600,fontSize:"0.75rem"},children:[(x=d.serving_g)==null?void 0:x.toFixed(0),"g"]})]}),S.jsxs("div",{style:{display:"flex",gap:4,fontSize:"0.7rem",fontWeight:600},children:[S.jsxs("span",{style:{color:"#ef4444",flex:1},children:["P:",(b=d.protein_g)==null?void 0:b.toFixed(0),"g"]}),S.jsxs("span",{style:{color:"#f59e0b",flex:1},children:["C:",(v=d.carbs_g)==null?void 0:v.toFixed(0),"g"]}),S.jsxs("span",{style:{color:"#ec4899",flex:1},children:["F:",(w=d.fat_g)==null?void 0:w.toFixed(0),"g"]})]})]}),d.salad_component&&S.jsxs("div",{style:{marginTop:12,paddingTop:12,borderTop:`1px solid ${f.border}`,color:f.text,fontSize:"0.85rem",fontWeight:600},children:[" ",S.jsx("strong",{children:"Add Salad:"})," ",d.salad_component]}),d.rice_portion&&S.jsxs("div",{style:{marginTop:8,color:f.text,fontSize:"0.85rem",fontWeight:600},children:[" ",S.jsx("strong",{children:"Rice/Curry:"})," ",d.rice_portion]}),d.pro_tip&&S.jsx("div",{style:{marginTop:12,paddingTop:12,borderTop:`1px solid ${f.border}`,color:"#059669",fontSize:"0.85rem",fontWeight:600,fontStyle:"italic"},children:d.pro_tip})]}),p.length>0&&S.jsxs("div",{children:[S.jsx("h6",{style:{margin:"10px 0",fontSize:"0.8rem",fontWeight:700,color:"#64748b",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Alternatives:"}),S.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:p.slice(1,5).map((C,$)=>{var T,N,_,A,O;return S.jsxs("div",{style:{background:f.bg,padding:"14px",borderRadius:"18px",border:`2px solid ${f.border}`},children:[S.jsx("h5",{style:{margin:"0 0 10px",fontSize:"0.85rem",fontWeight:700,color:f.text},children:C.food||C.food_name}),S.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[S.jsxs("div",{style:{color:f.text,fontWeight:700,fontSize:"0.75rem"},children:[(T=C.calories_serving||C.calories)==null?void 0:T.toFixed(0)," ",S.jsx("span",{style:{fontSize:"0.6rem"},children:"KCAL"})]}),S.jsxs("div",{style:{color:"#94a3b8",fontWeight:600,fontSize:"0.7rem"},children:[(N=C.serving_g)==null?void 0:N.toFixed(0),"g"]})]}),S.jsxs("div",{style:{display:"flex",gap:3,fontSize:"0.65rem",fontWeight:600},children:[S.jsxs("span",{style:{color:"#ef4444",flex:1},children:["P:",(_=C.protein_g)==null?void 0:_.toFixed(0),"g"]}),S.jsxs("span",{style:{color:"#f59e0b",flex:1},children:["C:",(A=C.carbs_g)==null?void 0:A.toFixed(0),"g"]}),S.jsxs("span",{style:{color:"#ec4899",flex:1},children:["F:",(O=C.fat_g)==null?void 0:O.toFixed(0),"g"]})]})]})]},$)})})]})]},h)}),n==="diet"&&t.alternative_meal_plans&&t.alternative_meal_plans.length>0&&S.jsxs("div",{style:{marginTop:40},children:[S.jsx("h2",{style:{margin:"20px 0 15px",fontSize:"1.3rem",fontWeight:800,color:"#4361ee",textTransform:"uppercase",letterSpacing:"1px"},children:" Alternative Complete Meal Plans"}),S.jsx("p",{style:{color:"#64748b",fontSize:"0.9rem",marginBottom:20},children:"Pick any plan that works for you - each includes complete meals with protein targets"}),t.alternative_meal_plans.map((d,h)=>{var f,p;return S.jsxs("div",{style:{background:"#f1f5f9",padding:20,borderRadius:25,marginBottom:25,border:"2px solid #cbd5e1"},children:[S.jsxs("h3",{style:{margin:"0 0 15px",fontSize:"1.1rem",fontWeight:800,color:"#4361ee"},children:["Option ",h+2]}),d.plan_meals.map((m,g)=>{var b,v;const x=o(m.meal_type);return S.jsxs("div",{style:{marginBottom:15,paddingBottom:15,borderBottom:"1px solid #e2e8f0"},children:[S.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:10},children:[S.jsx("span",{style:{fontSize:"1.1rem"},children:x.icon}),S.jsx("h4",{style:{margin:0,fontSize:"0.95rem",fontWeight:800,color:x.text,textTransform:"uppercase"},children:m.meal_type})]}),S.jsxs("div",{style:{background:x.bg,padding:"12px",borderRadius:"16px",border:`2px solid ${x.border}`,marginBottom:10},children:[S.jsx("h5",{style:{margin:"0 0 8px",fontSize:"0.85rem",fontWeight:700,color:x.text},children:m.food_name}),S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.75rem",fontWeight:600,color:"#64748b",marginBottom:6},children:[S.jsxs("span",{children:[(b=m.serving_g)==null?void 0:b.toFixed(0),"g"]}),S.jsxs("span",{children:["P:",(v=m.protein_g)==null?void 0:v.toFixed(1),"g"]})]})]}),m.salad_component&&S.jsxs("div",{style:{fontSize:"0.8rem",color:"#059669",fontWeight:600,marginBottom:6},children:[" ",m.salad_component]}),m.rice_portion&&S.jsxs("div",{style:{fontSize:"0.8rem",color:"#059669",fontWeight:600,marginBottom:6},children:[" ",m.rice_portion]})]},g)}),S.jsx("div",{style:{background:"white",padding:12,borderRadius:14,border:"2px solid #cbd5e1",marginTop:15},children:S.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[S.jsxs("div",{children:[S.jsx("p",{style:{margin:"0 0 6px",fontSize:"0.75rem",fontWeight:600,color:"#64748b",textTransform:"uppercase"},children:"Calories"}),S.jsx("p",{style:{margin:0,fontSize:"1.1rem",fontWeight:800,color:"#4361ee"},children:(f=d.daily_calories)==null?void 0:f.toFixed(0)})]}),S.jsxs("div",{children:[S.jsx("p",{style:{margin:"0 0 6px",fontSize:"0.75rem",fontWeight:600,color:"#64748b",textTransform:"uppercase"},children:"Protein"}),S.jsxs("p",{style:{margin:0,fontSize:"1.1rem",fontWeight:800,color:d.protein_met?"#059669":"#dc2626"},children:[(p=d.daily_protein_g)==null?void 0:p.toFixed(1),"g ",d.protein_met?"":""]})]})]})})]},h)})]})]}),n==="diet"&&S.jsxs("div",{style:{background:"#fef3c7",padding:20,borderRadius:25,border:"2px solid #fcd34d",marginBottom:20,color:"#92400e"},children:[S.jsx("h3",{style:{margin:"0 0 12px",fontWeight:800,fontSize:"1rem"},children:" Daily Protein Target"}),S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:15},children:[S.jsxs("div",{style:{flex:1},children:[S.jsx("p",{style:{margin:"0 0 8px",fontSize:"0.85rem",fontWeight:600,opacity:.8},children:"Recommended"}),S.jsxs("div",{style:{fontSize:"1.8rem",fontWeight:900},children:[(u=t.daily_protein_g)==null?void 0:u.toFixed(0),"g"]})]}),S.jsxs("div",{style:{flex:1},children:[S.jsx("p",{style:{margin:"0 0 8px",fontSize:"0.85rem",fontWeight:600,opacity:.8},children:"Your Plan"}),S.jsxs("div",{style:{fontSize:"1.8rem",fontWeight:900},children:[(t.diet||[]).reduce((d,h)=>d+(h.protein_g||0),0).toFixed(0),"g"]})]}),S.jsxs("div",{style:{flex:1,textAlign:"center"},children:[S.jsx("p",{style:{margin:"0 0 8px",fontSize:"0.85rem",fontWeight:600,opacity:.8},children:"Coverage"}),S.jsxs("div",{style:{fontSize:"1.8rem",fontWeight:900,color:(t.diet||[]).reduce((d,h)=>d+(h.protein_g||0),0)/t.daily_protein_g>=.95?"#16a34a":"#dc2626"},children:[((t.diet||[]).reduce((d,h)=>d+(h.protein_g||0),0)/t.daily_protein_g*100).toFixed(0),"%"]})]})]}),S.jsxs("div",{style:{marginTop:12,fontSize:"0.8rem",opacity:.7},children:["Breakdown:",(t.diet||[]).map(d=>{var h;return`${d.meal_type}: ${(h=d.protein_g)==null?void 0:h.toFixed(1)}g`}).join("  ")]})]}),n==="diet"&&S.jsxs("div",{style:{background:"#dcfce7",padding:20,borderRadius:25,border:"2px solid #86efac",marginBottom:20,color:"#166534"},children:[S.jsx("h3",{style:{margin:"0 0 12px",fontWeight:800,fontSize:"1rem"},children:" Balanced Meal Guide"}),S.jsxs("div",{style:{fontSize:"0.85rem",lineHeight:1.6},children:[S.jsxs("div",{style:{marginBottom:10},children:[S.jsx("strong",{children:"Include Fresh Salads:"}),S.jsx("div",{style:{fontSize:"0.8rem",opacity:.9,marginTop:4},children:"Add green salads, vegetable mixes, or sprouted salads to every meal for fiber, vitamins & minerals"})]}),S.jsxs("div",{style:{marginBottom:10},children:[S.jsx("strong",{children:"Rice & Curry Portions:"}),S.jsx("div",{style:{fontSize:"0.8rem",opacity:.9,marginTop:4},children:"Follow the quantities shown. Pair rice with dal or curry for balanced carbs + protein"})]}),S.jsxs("div",{children:[S.jsx("strong",{children:"Pro Tip:"}),S.jsx("div",{style:{fontSize:"0.8rem",opacity:.9,marginTop:4},children:"Start with main dish shown, then add salad side and moderate curry/rice to reach target calories"})]})]})]}),S.jsxs("div",{className:"water-card",children:[S.jsxs("div",{children:[S.jsx("h3",{style:{margin:0,fontWeight:800},children:"Stay Hydrated"}),S.jsxs("p",{style:{margin:"4px 0 0 0",fontSize:"1rem",fontWeight:600},children:["Target: ",t.water_l," Liters"]})]}),S.jsx("div",{style:{fontSize:"3rem"},children:""})]}),t.test_output&&S.jsxs("div",{style:{marginTop:30,padding:15,background:"#f1f5f9",borderRadius:20,border:"1px solid #cbd5e1",fontSize:"0.75rem",fontFamily:"monospace",whiteSpace:"pre-wrap",color:"#475569",maxHeight:200,overflowY:"auto"},children:[S.jsx("strong",{children:"Debug Info:"}),t.test_output]})]})}function HG(){var l;const[t,e]=J.useState([]),[n,s]=J.useState(!1);(l=cn.defaults.baseURL)!=null&&l.replace("/api",""),J.useEffect(()=>{r()},[]);const r=async()=>{try{const c=await cn.get("/reports");e(c.data)}catch(c){console.error("Failed to fetch reports",c)}},i=async c=>{var h;const u=(h=c.target.files)==null?void 0:h[0];if(!u)return;const d=new FormData;d.append("file",u);try{s(!0),await cn.post("/reports/upload",d,{headers:{"Content-Type":"multipart/form-data"}}),await r()}catch(f){console.error("Upload failed",f)}finally{s(!1),c.target&&(c.target.value="")}},o=async c=>{try{const u=c.url?c.url:`/reports/download/${c.id}`,d=await cn.get(u,{responseType:"blob"}),h=new Blob([d.data],{type:"application/pdf"}),f=window.URL.createObjectURL(h);window.open(f,"_blank"),setTimeout(()=>URL.revokeObjectURL(f),1e4)}catch(u){console.error("Failed to open PDF",u)}},a=c=>{if(!c)return null;try{return JSON.parse(c)}catch{return null}};return S.jsxs("div",{className:"reports-container",children:[S.jsxs("header",{className:"reports-header",children:[S.jsx("h2",{children:"Medical Records"}),S.jsx("p",{children:"Your secure health vault with AI-powered insights."})]}),S.jsx("div",{className:"upload-zone",children:S.jsxs("label",{className:`upload-card ${n?"processing":""}`,children:[S.jsx("div",{className:"upload-icon",children:n?"":""}),S.jsxs("div",{className:"upload-text",children:[S.jsx("strong",{children:n?"Processing PDF...":"Upload Medical Report"}),S.jsx("span",{children:"PDFs are analyzed for key health markers"})]}),S.jsx("input",{type:"file",onChange:i,accept:"application/pdf",disabled:n,style:{display:"none"}})]})}),S.jsx("div",{className:"reports-grid",children:t.length===0?S.jsxs("div",{className:"empty-state",children:[S.jsx("span",{style:{fontSize:"3rem"},children:""}),S.jsx("p",{children:"No reports found. Upload your first medical record."})]}):t.map(c=>S.jsxs("div",{className:"vault-card",children:[S.jsxs("div",{className:"vault-header",children:[S.jsx("div",{className:"file-icon",children:"PDF"}),S.jsxs("div",{className:"file-info",children:[S.jsx("a",{href:"#",onClick:u=>{u.preventDefault(),o(c)},className:"file-name",children:c.filename}),S.jsx("span",{className:"file-date",children:"Recently Uploaded"})]}),S.jsx("a",{href:"#",onClick:u=>{u.preventDefault(),o(c)},className:"view-btn",children:"View PDF"})]}),c.summary&&S.jsxs("div",{className:"summary-box",children:[S.jsxs("div",{className:"summary-label",children:[S.jsx("span",{className:"sparkle",children:""})," AI Health Summary"]}),(()=>{const u=a(c.summary);if(!u)return S.jsx("p",{children:c.summary});const d=u.conditions||[],h=u.foods_to_consume||[],f=u.foods_to_avoid||[],p=u.labs||{};return S.jsxs("div",{children:[d.length>0&&S.jsxs("div",{style:{marginBottom:10},children:[S.jsx("div",{style:{fontSize:"0.8rem",color:"#64748b",fontWeight:800,marginBottom:6},children:"Detected Conditions"}),S.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:d.map(m=>S.jsx("span",{style:{background:"#ecfeff",color:"#0891b2",padding:"4px 10px",borderRadius:999,fontWeight:800,fontSize:"0.8rem"},children:m},m))})]}),Object.keys(p).length>0&&S.jsxs("div",{style:{marginBottom:10},children:[S.jsx("div",{style:{fontSize:"0.8rem",color:"#64748b",fontWeight:800,marginBottom:6},children:"Key Labs"}),S.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:Object.entries(p).map(([m,g])=>S.jsxs("span",{style:{background:"#f1f5f9",color:"#0f172a",padding:"4px 10px",borderRadius:999,fontWeight:800,fontSize:"0.8rem"},children:[m.toUpperCase(),": ",String(g)]},m))})]}),S.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[S.jsxs("div",{style:{background:"#f0fdf4",border:"1px solid #dcfce7",borderRadius:10,padding:10},children:[S.jsx("div",{style:{fontSize:"0.8rem",fontWeight:900,color:"#16a34a",marginBottom:6},children:"Foods To Consume"}),h.length>0?S.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:h.slice(0,18).map(m=>S.jsx("span",{style:{background:"#ecfdf5",color:"#065f46",padding:"4px 10px",borderRadius:999,fontWeight:800,fontSize:"0.8rem"},children:m},m))}):S.jsx("div",{style:{color:"#16a34a",opacity:.8,fontWeight:700,fontSize:"0.9rem"},children:"Not available"})]}),S.jsxs("div",{style:{background:"#fef2f2",border:"1px solid #fee2e2",borderRadius:10,padding:10},children:[S.jsx("div",{style:{fontSize:"0.8rem",fontWeight:900,color:"#dc2626",marginBottom:6},children:"Foods To Avoid"}),f.length>0?S.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:f.slice(0,18).map(m=>S.jsx("span",{style:{background:"#fee2e2",color:"#7f1d1d",padding:"4px 10px",borderRadius:999,fontWeight:800,fontSize:"0.8rem"},children:m},m))}):S.jsx("div",{style:{color:"#dc2626",opacity:.8,fontWeight:700,fontSize:"0.9rem"},children:"Not available"})]})]})]})})()]})]},c.id))}),S.jsx("style",{children:`
        .reports-container { max-width: 800px; margin: 40px auto; padding: 0 20px; font-family: 'Inter', sans-serif; }
        .reports-header { text-align: center; margin-bottom: 32px; }
        .reports-header h2 { font-size: 2rem; color: #1e293b; font-weight: 800; margin-bottom: 8px; }
        .reports-header p { color: #64748b; }

        .upload-zone { margin-bottom: 40px; }
        .upload-card {
          display: flex; align-items: center; gap: 20px; background: #fff;
          border: 2px dashed #e2e8f0; padding: 24px; border-radius: 20px;
          cursor: pointer; transition: 0.3s;
        }
        .upload-card:hover { border-color: #10b981; background: #f0fdf4; }
        .upload-card.processing { opacity: 0.7; cursor: not-allowed; border-color: #f59e0b; }
        
        .upload-icon { 
          width: 56px; height: 56px; background: #f1f5f9; 
          border-radius: 14px; display: flex; align-items: center; 
          justify-content: center; font-size: 1.5rem; color: #10b981; 
        }
        .upload-text strong { display: block; font-size: 1.1rem; color: #1e293b; }
        .upload-text span { font-size: 0.85rem; color: #64748b; }

        .reports-grid { display: grid; gap: 20px; }
        .vault-card {
          background: #fff; border: 1px solid #f1f5f9;
          border-radius: 20px; padding: 20px;
          box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05);
        }
        .vault-header { display: flex; align-items: center; gap: 16px; margin-bottom: 16px; }
        .file-icon { 
          background: #fee2e2; color: #ef4444; font-size: 0.7rem; 
          font-weight: 900; padding: 10px 8px; border-radius: 8px; 
        }
        .file-info { flex-grow: 1; }
        .file-name { font-weight: 700; color: #1e293b; text-decoration: none; display: block; }
        .file-name:hover { color: #10b981; text-decoration: underline; }
        .file-date { font-size: 0.75rem; color: #94a3b8; }
        
        .view-btn {
          padding: 8px 16px; border: 1.5px solid #e2e8f0; border-radius: 10px;
          color: #10b981; font-size: 0.85rem; font-weight: 700; text-decoration: none;
          transition: 0.2s;
        }
        .view-btn:hover { background: #10b981; color: white; }

        .summary-box {
          background: #f8fafc; border-radius: 12px;
          padding: 16px; border-left: 4px solid #10b981;
        }
        .summary-label { 
          font-size: 0.7rem; font-weight: 800; color: #10b981; 
          text-transform: uppercase; margin-bottom: 8px; display: flex; align-items: center; gap: 6px;
        }
        .summary-box p { margin: 0; font-size: 0.9rem; color: #334155; line-height: 1.6; }
        
        .empty-state { text-align: center; padding: 60px 0; color: #94a3b8; }
        .sparkle { animation: rotate 3s linear infinite; display: inline-block; }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
      `})]})}var oy={};(function(){var t;function e(y){var k=0;return function(){return k<y.length?{done:!1,value:y[k++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(y,k,I){return y==Array.prototype||y==Object.prototype||(y[k]=I.value),y};function s(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof di=="object"&&di];for(var k=0;k<y.length;++k){var I=y[k];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var r=s(this);function i(y,k){if(k)e:{var I=r;y=y.split(".");for(var E=0;E<y.length-1;E++){var D=y[E];if(!(D in I))break e;I=I[D]}y=y[y.length-1],E=I[y],k=k(E),k!=E&&k!=null&&n(I,y,{configurable:!0,writable:!0,value:k})}}i("Symbol",function(y){function k(P){if(this instanceof k)throw new TypeError("Symbol is not a constructor");return new I(E+(P||"")+"_"+D++,P)}function I(P,F){this.h=P,n(this,"description",{configurable:!0,writable:!0,value:F})}if(y)return y;I.prototype.toString=function(){return this.h};var E="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",D=0;return k}),i("Symbol.iterator",function(y){if(y)return y;y=Symbol("Symbol.iterator");for(var k="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),I=0;I<k.length;I++){var E=r[k[I]];typeof E=="function"&&typeof E.prototype[y]!="function"&&n(E.prototype,y,{configurable:!0,writable:!0,value:function(){return o(e(this))}})}return y});function o(y){return y={next:y},y[Symbol.iterator]=function(){return this},y}function a(y){var k=typeof Symbol<"u"&&Symbol.iterator&&y[Symbol.iterator];return k?k.call(y):{next:e(y)}}function l(y){if(!(y instanceof Array)){y=a(y);for(var k,I=[];!(k=y.next()).done;)I.push(k.value);y=I}return y}var c=typeof Object.assign=="function"?Object.assign:function(y,k){for(var I=1;I<arguments.length;I++){var E=arguments[I];if(E)for(var D in E)Object.prototype.hasOwnProperty.call(E,D)&&(y[D]=E[D])}return y};i("Object.assign",function(y){return y||c});var u=typeof Object.create=="function"?Object.create:function(y){function k(){}return k.prototype=y,new k},d;if(typeof Object.setPrototypeOf=="function")d=Object.setPrototypeOf;else{var h;e:{var f={a:!0},p={};try{p.__proto__=f,h=p.a;break e}catch{}h=!1}d=h?function(y,k){if(y.__proto__=k,y.__proto__!==k)throw new TypeError(y+" is not extensible");return y}:null}var m=d;function g(y,k){if(y.prototype=u(k.prototype),y.prototype.constructor=y,m)m(y,k);else for(var I in k)if(I!="prototype")if(Object.defineProperties){var E=Object.getOwnPropertyDescriptor(k,I);E&&Object.defineProperty(y,I,E)}else y[I]=k[I];y.za=k.prototype}function x(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function b(y){if(y.m)throw new TypeError("Generator is already running");y.m=!0}x.prototype.u=function(y){this.i=y};function v(y,k){y.l={ma:k,na:!0},y.h=y.s||y.v}x.prototype.return=function(y){this.l={return:y},this.h=this.v};function w(y,k,I){return y.h=I,{value:k}}function C(y){this.h=new x,this.i=y}function $(y,k){b(y.h);var I=y.h.j;return I?T(y,"return"in I?I.return:function(E){return{value:E,done:!0}},k,y.h.return):(y.h.return(k),N(y))}function T(y,k,I,E){try{var D=k.call(y.h.j,I);if(!(D instanceof Object))throw new TypeError("Iterator result "+D+" is not an object");if(!D.done)return y.h.m=!1,D;var P=D.value}catch(F){return y.h.j=null,v(y.h,F),N(y)}return y.h.j=null,E.call(y.h,P),N(y)}function N(y){for(;y.h.h;)try{var k=y.i(y.h);if(k)return y.h.m=!1,{value:k.value,done:!1}}catch(I){y.h.i=void 0,v(y.h,I)}if(y.h.m=!1,y.h.l){if(k=y.h.l,y.h.l=null,k.na)throw k.ma;return{value:k.return,done:!0}}return{value:void 0,done:!0}}function _(y){this.next=function(k){return b(y.h),y.h.j?k=T(y,y.h.j.next,k,y.h.u):(y.h.u(k),k=N(y)),k},this.throw=function(k){return b(y.h),y.h.j?k=T(y,y.h.j.throw,k,y.h.u):(v(y.h,k),k=N(y)),k},this.return=function(k){return $(y,k)},this[Symbol.iterator]=function(){return this}}function A(y){function k(E){return y.next(E)}function I(E){return y.throw(E)}return new Promise(function(E,D){function P(F){F.done?E(F.value):Promise.resolve(F.value).then(k,I).then(P,D)}P(y.next())})}function O(y){return A(new _(new C(y)))}i("Promise",function(y){function k(F){this.i=0,this.j=void 0,this.h=[],this.u=!1;var j=this.l();try{F(j.resolve,j.reject)}catch(ne){j.reject(ne)}}function I(){this.h=null}function E(F){return F instanceof k?F:new k(function(j){j(F)})}if(y)return y;I.prototype.i=function(F){if(this.h==null){this.h=[];var j=this;this.j(function(){j.m()})}this.h.push(F)};var D=r.setTimeout;I.prototype.j=function(F){D(F,0)},I.prototype.m=function(){for(;this.h&&this.h.length;){var F=this.h;this.h=[];for(var j=0;j<F.length;++j){var ne=F[j];F[j]=null;try{ne()}catch(ge){this.l(ge)}}}this.h=null},I.prototype.l=function(F){this.j(function(){throw F})},k.prototype.l=function(){function F(ge){return function(we){ne||(ne=!0,ge.call(j,we))}}var j=this,ne=!1;return{resolve:F(this.I),reject:F(this.m)}},k.prototype.I=function(F){if(F===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(F instanceof k)this.L(F);else{e:switch(typeof F){case"object":var j=F!=null;break e;case"function":j=!0;break e;default:j=!1}j?this.F(F):this.s(F)}},k.prototype.F=function(F){var j=void 0;try{j=F.then}catch(ne){this.m(ne);return}typeof j=="function"?this.M(j,F):this.s(F)},k.prototype.m=function(F){this.v(2,F)},k.prototype.s=function(F){this.v(1,F)},k.prototype.v=function(F,j){if(this.i!=0)throw Error("Cannot settle("+F+", "+j+"): Promise already settled in state"+this.i);this.i=F,this.j=j,this.i===2&&this.K(),this.H()},k.prototype.K=function(){var F=this;D(function(){if(F.D()){var j=r.console;typeof j<"u"&&j.error(F.j)}},1)},k.prototype.D=function(){if(this.u)return!1;var F=r.CustomEvent,j=r.Event,ne=r.dispatchEvent;return typeof ne>"u"?!0:(typeof F=="function"?F=new F("unhandledrejection",{cancelable:!0}):typeof j=="function"?F=new j("unhandledrejection",{cancelable:!0}):(F=r.document.createEvent("CustomEvent"),F.initCustomEvent("unhandledrejection",!1,!0,F)),F.promise=this,F.reason=this.j,ne(F))},k.prototype.H=function(){if(this.h!=null){for(var F=0;F<this.h.length;++F)P.i(this.h[F]);this.h=null}};var P=new I;return k.prototype.L=function(F){var j=this.l();F.T(j.resolve,j.reject)},k.prototype.M=function(F,j){var ne=this.l();try{F.call(j,ne.resolve,ne.reject)}catch(ge){ne.reject(ge)}},k.prototype.then=function(F,j){function ne(Oe,Ie){return typeof Oe=="function"?function(Ue){try{ge(Oe(Ue))}catch(Ze){we(Ze)}}:Ie}var ge,we,Ve=new k(function(Oe,Ie){ge=Oe,we=Ie});return this.T(ne(F,ge),ne(j,we)),Ve},k.prototype.catch=function(F){return this.then(void 0,F)},k.prototype.T=function(F,j){function ne(){switch(ge.i){case 1:F(ge.j);break;case 2:j(ge.j);break;default:throw Error("Unexpected state: "+ge.i)}}var ge=this;this.h==null?P.i(ne):this.h.push(ne),this.u=!0},k.resolve=E,k.reject=function(F){return new k(function(j,ne){ne(F)})},k.race=function(F){return new k(function(j,ne){for(var ge=a(F),we=ge.next();!we.done;we=ge.next())E(we.value).T(j,ne)})},k.all=function(F){var j=a(F),ne=j.next();return ne.done?E([]):new k(function(ge,we){function Ve(Ue){return function(Ze){Oe[Ue]=Ze,Ie--,Ie==0&&ge(Oe)}}var Oe=[],Ie=0;do Oe.push(void 0),Ie++,E(ne.value).T(Ve(Oe.length-1),we),ne=j.next();while(!ne.done)})},k});function W(y,k){y instanceof String&&(y+="");var I=0,E=!1,D={next:function(){if(!E&&I<y.length){var P=I++;return{value:k(P,y[P]),done:!1}}return E=!0,{done:!0,value:void 0}}};return D[Symbol.iterator]=function(){return D},D}i("Array.prototype.keys",function(y){return y||function(){return W(this,function(k){return k})}}),i("Array.prototype.fill",function(y){return y||function(k,I,E){var D=this.length||0;for(0>I&&(I=Math.max(0,D+I)),(E==null||E>D)&&(E=D),E=Number(E),0>E&&(E=Math.max(0,D+E)),I=Number(I||0);I<E;I++)this[I]=k;return this}});function G(y){return y||Array.prototype.fill}i("Int8Array.prototype.fill",G),i("Uint8Array.prototype.fill",G),i("Uint8ClampedArray.prototype.fill",G),i("Int16Array.prototype.fill",G),i("Uint16Array.prototype.fill",G),i("Int32Array.prototype.fill",G),i("Uint32Array.prototype.fill",G),i("Float32Array.prototype.fill",G),i("Float64Array.prototype.fill",G),i("Object.is",function(y){return y||function(k,I){return k===I?k!==0||1/k===1/I:k!==k&&I!==I}}),i("Array.prototype.includes",function(y){return y||function(k,I){var E=this;E instanceof String&&(E=String(E));var D=E.length;for(I=I||0,0>I&&(I=Math.max(I+D,0));I<D;I++){var P=E[I];if(P===k||Object.is(P,k))return!0}return!1}}),i("String.prototype.includes",function(y){return y||function(k,I){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(k instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(k,I||0)!==-1}});var q=this||self;function U(y,k){y=y.split(".");var I=q;y[0]in I||typeof I.execScript>"u"||I.execScript("var "+y[0]);for(var E;y.length&&(E=y.shift());)y.length||k===void 0?I[E]&&I[E]!==Object.prototype[E]?I=I[E]:I=I[E]={}:I[E]=k}function Y(y){var k;e:{if((k=q.navigator)&&(k=k.userAgent))break e;k=""}return k.indexOf(y)!=-1}var te=Array.prototype.map?function(y,k){return Array.prototype.map.call(y,k,void 0)}:function(y,k){for(var I=y.length,E=Array(I),D=typeof y=="string"?y.split(""):y,P=0;P<I;P++)P in D&&(E[P]=k.call(void 0,D[P],P,y));return E},M={},X=null;function Z(y){var k=y.length,I=3*k/4;I%3?I=Math.floor(I):"=.".indexOf(y[k-1])!=-1&&(I="=.".indexOf(y[k-2])!=-1?I-2:I-1);var E=new Uint8Array(I),D=0;return oe(y,function(P){E[D++]=P}),D!==I?E.subarray(0,D):E}function oe(y,k){function I(ne){for(;E<y.length;){var ge=y.charAt(E++),we=X[ge];if(we!=null)return we;if(!/^[\s\xa0]*$/.test(ge))throw Error("Unknown base64 encoding at char: "+ge)}return ne}ae();for(var E=0;;){var D=I(-1),P=I(0),F=I(64),j=I(64);if(j===64&&D===-1)break;k(D<<2|P>>4),F!=64&&(k(P<<4&240|F>>2),j!=64&&k(F<<6&192|j))}}function ae(){if(!X){X={};for(var y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),k=["+/=","+/","-_=","-_.","-_"],I=0;5>I;I++){var E=y.concat(k[I].split(""));M[I]=E;for(var D=0;D<E.length;D++){var P=E[D];X[P]===void 0&&(X[P]=D)}}}}var ce=typeof Uint8Array<"u",pe=!(Y("Trident")||Y("MSIE"))&&typeof q.btoa=="function";function fe(y){if(!pe){var k;k===void 0&&(k=0),ae(),k=M[k];for(var I=Array(Math.floor(y.length/3)),E=k[64]||"",D=0,P=0;D<y.length-2;D+=3){var F=y[D],j=y[D+1],ne=y[D+2],ge=k[F>>2];F=k[(F&3)<<4|j>>4],j=k[(j&15)<<2|ne>>6],ne=k[ne&63],I[P++]=ge+F+j+ne}switch(ge=0,ne=E,y.length-D){case 2:ge=y[D+1],ne=k[(ge&15)<<2]||E;case 1:y=y[D],I[P]=k[y>>2]+k[(y&3)<<4|ge>>4]+ne+E}return I.join("")}for(k="";10240<y.length;)k+=String.fromCharCode.apply(null,y.subarray(0,10240)),y=y.subarray(10240);return k+=String.fromCharCode.apply(null,y),btoa(k)}var be=RegExp("[-_.]","g");function Ne(y){switch(y){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function Te(y){if(!pe)return Z(y);be.test(y)&&(y=y.replace(be,Ne)),y=atob(y);for(var k=new Uint8Array(y.length),I=0;I<y.length;I++)k[I]=y.charCodeAt(I);return k}var De;function je(){return De||(De=new Uint8Array(0))}var ue={},le=typeof Uint8Array.prototype.slice=="function",me=0,he=0;function $e(y){var k=0>y;y=Math.abs(y);var I=y>>>0;y=Math.floor((y-I)/4294967296),k&&(I=a(Re(I,y)),k=I.next().value,y=I.next().value,I=k),me=I>>>0,he=y>>>0}var Le=typeof BigInt=="function";function Re(y,k){return k=~k,y?y=~y+1:k+=1,[y,k]}function We(y,k){this.i=y>>>0,this.h=k>>>0}function nt(y){if(!y)return Ge||(Ge=new We(0,0));if(!/^-?\d+$/.test(y))return null;if(16>y.length)$e(Number(y));else if(Le)y=BigInt(y),me=Number(y&BigInt(4294967295))>>>0,he=Number(y>>BigInt(32)&BigInt(4294967295));else{var k=+(y[0]==="-");he=me=0;for(var I=y.length,E=k,D=(I-k)%6+k;D<=I;E=D,D+=6)E=Number(y.slice(E,D)),he*=1e6,me=1e6*me+E,4294967296<=me&&(he+=me/4294967296|0,me%=4294967296);k&&(k=a(Re(me,he)),y=k.next().value,k=k.next().value,me=y,he=k)}return new We(me,he)}var Ge;function on(y,k){return Error("Invalid wire type: "+y+" (at position "+k+")")}function pt(){return Error("Failed to read varint, encoding is invalid.")}function gn(y,k){return Error("Tried to read past the end of the data "+k+" > "+y)}function _t(){throw Error("Invalid UTF8")}function fs(y,k){return k=String.fromCharCode.apply(null,k),y==null?k:y+k}var ts=void 0,Xs,Gr=typeof TextDecoder<"u",Zi,eu=typeof TextEncoder<"u",Sl;function pf(y){if(y!==ue)throw Error("illegal external caller")}function Hr(y,k){if(pf(k),this.V=y,y!=null&&y.length===0)throw Error("ByteString should be constructed with non-empty values")}function tu(){return Sl||(Sl=new Hr(null,ue))}function mf(y){pf(ue);var k=y.V;return k=k==null||ce&&k!=null&&k instanceof Uint8Array?k:typeof k=="string"?Te(k):null,k==null?k:y.V=k}function wM(y){if(typeof y=="string")return{buffer:Te(y),C:!1};if(Array.isArray(y))return{buffer:new Uint8Array(y),C:!1};if(y.constructor===Uint8Array)return{buffer:y,C:!1};if(y.constructor===ArrayBuffer)return{buffer:new Uint8Array(y),C:!1};if(y.constructor===Hr)return{buffer:mf(y)||je(),C:!0};if(y instanceof Uint8Array)return{buffer:new Uint8Array(y.buffer,y.byteOffset,y.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function NC(y,k){this.i=null,this.m=!1,this.h=this.j=this.l=0,Zx(this,y,k)}function Zx(y,k,I){I=I===void 0?{}:I,y.S=I.S===void 0?!1:I.S,k&&(k=wM(k),y.i=k.buffer,y.m=k.C,y.l=0,y.j=y.i.length,y.h=y.l)}NC.prototype.reset=function(){this.h=this.l};function aa(y,k){if(y.h=k,k>y.j)throw gn(y.j,k)}function nu(y){var k=y.i,I=y.h,E=k[I++],D=E&127;if(E&128&&(E=k[I++],D|=(E&127)<<7,E&128&&(E=k[I++],D|=(E&127)<<14,E&128&&(E=k[I++],D|=(E&127)<<21,E&128&&(E=k[I++],D|=E<<28,E&128&&k[I++]&128&&k[I++]&128&&k[I++]&128&&k[I++]&128&&k[I++]&128)))))throw pt();return aa(y,I),D}function TC(y,k){if(0>k)throw Error("Tried to read a negative byte length: "+k);var I=y.h,E=I+k;if(E>y.j)throw gn(k,y.j-I);return y.h=E,I}var EC=[];function e0(){this.h=[]}e0.prototype.length=function(){return this.h.length},e0.prototype.end=function(){var y=this.h;return this.h=[],y};function _C(y,k,I){for(;0<I||127<k;)y.h.push(k&127|128),k=(k>>>7|I<<25)>>>0,I>>>=7;y.h.push(k)}function la(y,k){for(;127<k;)y.h.push(k&127|128),k>>>=7;y.h.push(k)}function t0(y,k){if(EC.length){var I=EC.pop();Zx(I,y,k),y=I}else y=new NC(y,k);this.h=y,this.j=this.h.h,this.i=this.l=-1,this.setOptions(k)}t0.prototype.setOptions=function(y){y=y===void 0?{}:y,this.ca=y.ca===void 0?!1:y.ca},t0.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function RC(y){var k=y.h;if(k.h==k.j)return!1;y.j=y.h.h;var I=nu(y.h)>>>0;if(k=I>>>3,I&=7,!(0<=I&&5>=I))throw on(I,y.j);if(1>k)throw Error("Invalid field number: "+k+" (at position "+y.j+")");return y.l=k,y.i=I,!0}function gf(y){switch(y.i){case 0:if(y.i!=0)gf(y);else e:{y=y.h;for(var k=y.h,I=k+10,E=y.i;k<I;)if(!(E[k++]&128)){aa(y,k);break e}throw pt()}break;case 1:y=y.h,aa(y,y.h+8);break;case 2:y.i!=2?gf(y):(k=nu(y.h)>>>0,y=y.h,aa(y,y.h+k));break;case 5:y=y.h,aa(y,y.h+4);break;case 3:k=y.l;do{if(!RC(y))throw Error("Unmatched start-group tag: stream EOF");if(y.i==4){if(y.l!=k)throw Error("Unmatched end-group tag");break}gf(y)}while(!0);break;default:throw on(y.i,y.j)}}var xf=[];function kM(){this.j=[],this.i=0,this.h=new e0}function Il(y,k){k.length!==0&&(y.j.push(k),y.i+=k.length)}function CM(y,k){if(k=k.R){Il(y,y.h.end());for(var I=0;I<k.length;I++)Il(y,mf(k[I])||je())}}var Ii=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function ca(y,k){return Ii?y[Ii]|=k:y.A!==void 0?y.A|=k:(Object.defineProperties(y,{A:{value:k,configurable:!0,writable:!0,enumerable:!1}}),k)}function AC(y,k){Ii?y[Ii]&&(y[Ii]&=~k):y.A!==void 0&&(y.A&=~k)}function Jt(y){var k;return Ii?k=y[Ii]:k=y.A,k??0}function Kr(y,k){Ii?y[Ii]=k:y.A!==void 0?y.A=k:Object.defineProperties(y,{A:{value:k,configurable:!0,writable:!0,enumerable:!1}})}function n0(y){return ca(y,1),y}function SM(y,k){Kr(k,(y|0)&-51)}function yf(y,k){Kr(k,(y|18)&-41)}var s0={};function bf(y){return y!==null&&typeof y=="object"&&!Array.isArray(y)&&y.constructor===Object}var su,DC=[];Kr(DC,23),su=Object.freeze(DC);function r0(y){if(Jt(y.o)&2)throw Error("Cannot mutate an immutable Message")}function i0(y){var k=y.length;(k=k?y[k-1]:void 0)&&bf(k)?k.g=1:(k={},y.push((k.g=1,k)))}function FC(y){var k=y.i+y.G;return y.B||(y.B=y.o[k]={})}function br(y,k){return k===-1?null:k>=y.i?y.B?y.B[k]:void 0:y.o[k+y.G]}function Xr(y,k,I,E){r0(y),ru(y,k,I,E)}function ru(y,k,I,E){y.j&&(y.j=void 0),k>=y.i||E?FC(y)[k]=I:(y.o[k+y.G]=I,(y=y.B)&&k in y&&delete y[k])}function o0(y,k,I,E){var D=br(y,k);Array.isArray(D)||(D=su);var P=Jt(D);if(P&1||n0(D),E)P&2||ca(D,2),I&1||Object.freeze(D);else{E=!(I&2);var F=P&2;I&1||!F?E&&P&16&&!F&&AC(D,16):(D=n0(Array.prototype.slice.call(D)),ru(y,k,D))}return D}function a0(y,k){var I=br(y,k),E=I==null?I:typeof I=="number"||I==="NaN"||I==="Infinity"||I==="-Infinity"?Number(I):void 0;return E!=null&&E!==I&&ru(y,k,E),E}function OC(y,k,I,E,D){y.h||(y.h={});var P=y.h[I],F=o0(y,I,3,D);if(!P){var j=F;P=[];var ne=!!(Jt(y.o)&16);F=!!(Jt(j)&2);var ge=j;!D&&F&&(j=Array.prototype.slice.call(j));for(var we=F,Ve=0;Ve<j.length;Ve++){var Oe=j[Ve],Ie=k,Ue=!1;if(Ue=Ue===void 0?!1:Ue,Oe=Array.isArray(Oe)?new Ie(Oe):Ue?new Ie:void 0,Oe!==void 0){Ie=Oe.o;var Ze=Ue=Jt(Ie);F&&(Ze|=2),ne&&(Ze|=16),Ze!=Ue&&Kr(Ie,Ze),Ie=Ze,we=we||!!(2&Ie),P.push(Oe)}}return y.h[I]=P,ne=Jt(j),k=ne|33,k=we?k&-9:k|8,ne!=k&&(we=j,Object.isFrozen(we)&&(we=Array.prototype.slice.call(we)),Kr(we,k),j=we),ge!==j&&ru(y,I,j),(D||E&&F)&&ca(P,2),E&&Object.freeze(P),P}return D||(D=Object.isFrozen(P),E&&!D?Object.freeze(P):!E&&D&&(P=Array.prototype.slice.call(P),y.h[I]=P)),P}function l0(y,k,I){var E=!!(Jt(y.o)&2);if(k=OC(y,k,I,E,E),y=o0(y,I,3,E),!(E||Jt(y)&8)){for(E=0;E<k.length;E++){if(I=k[E],Jt(I.o)&2){var D=WC(I,!1);D.j=I}else D=I;I!==D&&(k[E]=D,y[E]=D.o)}ca(y,8)}return k}function qr(y,k,I){if(I!=null&&typeof I!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof I+": "+I);Xr(y,k,I)}function PC(y,k,I,E,D){r0(y);var P=OC(y,I,k,!1,!1);return I=E??new I,y=o0(y,k,2,!1),D!=null?(P.splice(D,0,I),y.splice(D,0,I.o)):(P.push(I),y.push(I.o)),I.C()&&AC(y,8),I}function vf(y,k){return y??k}function Yr(y,k,I){return I=I===void 0?0:I,vf(a0(y,k),I)}var wf;function IM(y){switch(typeof y){case"number":return isFinite(y)?y:String(y);case"object":if(y)if(Array.isArray(y)){if(Jt(y)&128)return y=Array.prototype.slice.call(y),i0(y),y}else{if(ce&&y!=null&&y instanceof Uint8Array)return fe(y);if(y instanceof Hr){var k=y.V;return k==null?"":typeof k=="string"?k:y.V=fe(k)}}}return y}function LC(y,k,I,E){if(y!=null){if(Array.isArray(y))y=c0(y,k,I,E!==void 0);else if(bf(y)){var D={},P;for(P in y)D[P]=LC(y[P],k,I,E);y=D}else y=k(y,E);return y}}function c0(y,k,I,E){var D=Jt(y);E=E?!!(D&16):void 0,y=Array.prototype.slice.call(y);for(var P=0;P<y.length;P++)y[P]=LC(y[P],k,I,E);return I(D,y),y}function $M(y){return y.ja===s0?y.toJSON():IM(y)}function NM(y,k){y&128&&i0(k)}function MC(y,k,I){if(I=I===void 0?yf:I,y!=null){if(ce&&y instanceof Uint8Array)return y.length?new Hr(new Uint8Array(y),ue):tu();if(Array.isArray(y)){var E=Jt(y);return E&2?y:k&&!(E&32)&&(E&16||E===0)?(Kr(y,E|2),y):(y=c0(y,MC,E&4?yf:I,!0),k=Jt(y),k&4&&k&2&&Object.freeze(y),y)}return y.ja===s0?BC(y):y}}function zC(y,k,I,E,D,P,F){if(y=y.h&&y.h[I]){if(E=Jt(y),E&2?E=y:(P=te(y,BC),yf(E,P),Object.freeze(P),E=P),r0(k),F=E==null?su:n0([]),E!=null){for(P=!!E.length,y=0;y<E.length;y++){var j=E[y];P=P&&!(Jt(j.o)&2),F[y]=j.o}P=(P?8:0)|1,y=Jt(F),(y&P)!==P&&(Object.isFrozen(F)&&(F=Array.prototype.slice.call(F)),Kr(F,y|P)),k.h||(k.h={}),k.h[I]=E}else k.h&&(k.h[I]=void 0);ru(k,I,F,D)}else Xr(k,I,MC(E,P,F),D)}function BC(y){return Jt(y.o)&2||(y=WC(y,!0),ca(y.o,2)),y}function WC(y,k){var I=y.o,E=[];ca(E,16);var D=y.constructor.h;if(D&&E.push(D),D=y.B,D){E.length=I.length,E.fill(void 0,E.length,I.length);var P={};E[E.length-1]=P}Jt(I)&128&&i0(E),k=k||y.C()?yf:SM,P=y.constructor,wf=E,E=new P(E),wf=void 0,y.R&&(E.R=y.R.slice()),P=!!(Jt(I)&16);for(var F=D?I.length-1:I.length,j=0;j<F;j++)zC(y,E,j-y.G,I[j],!1,P,k);if(D)for(var ne in D)zC(y,E,+ne,D[ne],!0,P,k);return E}function ps(y,k,I){y==null&&(y=wf),wf=void 0;var E=this.constructor.i||0,D=0<E,P=this.constructor.h,F=!1;if(y==null){y=P?[P]:[];var j=48,ne=!0;D&&(E=0,j|=128),Kr(y,j)}else{if(!Array.isArray(y)||P&&P!==y[0])throw Error();var ge=j=ca(y,0);if((ne=(16&ge)!==0)&&((F=(32&ge)!==0)||(ge|=32)),D){if(128&ge)E=0;else if(0<y.length){var we=y[y.length-1];if(bf(we)&&"g"in we){E=0,ge|=128,delete we.g;var Ve=!0,Oe;for(Oe in we){Ve=!1;break}Ve&&y.pop()}}}else if(128&ge)throw Error();j!==ge&&Kr(y,ge)}this.G=(P?0:-1)-E,this.h=void 0,this.o=y;e:{if(P=this.o.length,E=P-1,P&&(P=this.o[E],bf(P))){this.B=P,this.i=E-this.G;break e}k!==void 0&&-1<k?(this.i=Math.max(k,E+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!D&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(I){k=ne&&!F&&!0,D=this.i;var Ie;for(ne=0;ne<I.length;ne++)F=I[ne],F<D?(F+=this.G,(E=y[F])?jC(E,k):y[F]=su):(Ie||(Ie=FC(this)),(E=Ie[F])?jC(E,k):Ie[F]=su)}}ps.prototype.toJSON=function(){return c0(this.o,$M,NM)},ps.prototype.C=function(){return!!(Jt(this.o)&2)};function jC(y,k){if(Array.isArray(y)){var I=Jt(y),E=1;!k||I&2||(E|=16),(I&E)!==E&&Kr(y,I|E)}}ps.prototype.ja=s0,ps.prototype.toString=function(){return this.o.toString()};function VC(y,k,I){if(I){var E={},D;for(D in I){var P=I[D],F=P.ra;F||(E.J=P.xa||P.oa.W,P.ia?(E.aa=XC(P.ia),F=function(j){return function(ne,ge,we){return j.J(ne,ge,we,j.aa)}}(E)):P.ka?(E.Z=qC(P.da.P,P.ka),F=function(j){return function(ne,ge,we){return j.J(ne,ge,we,j.Z)}}(E)):F=E.J,P.ra=F),F(k,y,P.da),E={J:E.J,aa:E.aa,Z:E.Z}}}CM(k,y)}var kf=Symbol();function UC(y,k,I){return y[kf]||(y[kf]=function(E,D){return k(E,D,I)})}function GC(y){var k=y[kf];if(!k){var I=d0(y);k=function(E,D){return YC(E,D,I)},y[kf]=k}return k}function TM(y){var k=y.ia;if(k)return GC(k);if(k=y.wa)return UC(y.da.P,k,y.ka)}function EM(y){var k=TM(y),I=y.da,E=y.oa.U;return k?function(D,P){return E(D,P,I,k)}:function(D,P){return E(D,P,I)}}function HC(y,k){var I=y[k];return typeof I=="function"&&I.length===0&&(I=I(),y[k]=I),Array.isArray(I)&&(ou in I||iu in I||0<I.length&&typeof I[0]=="function")?I:void 0}function KC(y,k,I,E,D,P){k.P=y[0];var F=1;if(y.length>F&&typeof y[F]!="number"){var j=y[F++];I(k,j)}for(;F<y.length;){I=y[F++];for(var ne=F+1;ne<y.length&&typeof y[ne]!="number";)ne++;switch(j=y[F++],ne-=F,ne){case 0:E(k,I,j);break;case 1:(ne=HC(y,F))?(F++,D(k,I,j,ne)):E(k,I,j,y[F++]);break;case 2:ne=F++,ne=HC(y,ne),D(k,I,j,ne,y[F++]);break;case 3:P(k,I,j,y[F++],y[F++],y[F++]);break;case 4:P(k,I,j,y[F++],y[F++],y[F++],y[F++]);break;default:throw Error("unexpected number of binary field arguments: "+ne)}}return k}var Cf=Symbol();function XC(y){var k=y[Cf];if(!k){var I=u0(y);k=function(E,D){return QC(E,D,I)},y[Cf]=k}return k}function qC(y,k){var I=y[Cf];return I||(I=function(E,D){return VC(E,D,k)},y[Cf]=I),I}var iu=Symbol();function _M(y,k){y.push(k)}function RM(y,k,I){y.push(k,I.W)}function AM(y,k,I,E){var D=XC(E),P=u0(E).P,F=I.W;y.push(k,function(j,ne,ge){return F(j,ne,ge,P,D)})}function DM(y,k,I,E,D,P){var F=qC(E,P),j=I.W;y.push(k,function(ne,ge,we){return j(ne,ge,we,E,F)})}function u0(y){var k=y[iu];return k||(k=KC(y,y[iu]=[],_M,RM,AM,DM),ou in y&&iu in y&&(y.length=0),k)}var ou=Symbol();function FM(y,k){y[0]=k}function OM(y,k,I,E){var D=I.U;y[k]=E?function(P,F,j){return D(P,F,j,E)}:D}function PM(y,k,I,E,D){var P=I.U,F=GC(E),j=d0(E).P;y[k]=function(ne,ge,we){return P(ne,ge,we,j,F,D)}}function LM(y,k,I,E,D,P,F){var j=I.U,ne=UC(E,D,P);y[k]=function(ge,we,Ve){return j(ge,we,Ve,E,ne,F)}}function d0(y){var k=y[ou];return k||(k=KC(y,y[ou]={},FM,OM,PM,LM),ou in y&&iu in y&&(y.length=0),k)}function YC(y,k,I){for(;RC(k)&&k.i!=4;){var E=k.l,D=I[E];if(!D){var P=I[0];P&&(P=P[E])&&(D=I[E]=EM(P))}if(!D||!D(k,y,E)){D=k,E=y,P=D.j,gf(D);var F=D;if(!F.ca){if(D=F.h.h-P,F.h.h=P,F=F.h,D==0)D=tu();else{if(P=TC(F,D),F.S&&F.m)D=F.i.subarray(P,P+D);else{F=F.i;var j=P;D=P+D,D=j===D?je():le?F.slice(j,D):new Uint8Array(F.subarray(j,D))}D=D.length==0?tu():new Hr(D,ue)}(P=E.R)?P.push(D):E.R=[D]}}}return y}function QC(y,k,I){for(var E=I.length,D=E%2==1,P=D?1:0;P<E;P+=2)(0,I[P+1])(k,y,I[P]);VC(y,k,D?I[0]:void 0)}function au(y,k){return{U:y,W:k}}var vr=au(function(y,k,I){if(y.i!==5)return!1;y=y.h;var E=y.i,D=y.h,P=E[D],F=E[D+1],j=E[D+2];return E=E[D+3],aa(y,y.h+4),F=(P<<0|F<<8|j<<16|E<<24)>>>0,y=2*(F>>31)+1,P=F>>>23&255,F&=8388607,Xr(k,I,P==255?F?NaN:1/0*y:P==0?y*Math.pow(2,-149)*F:y*Math.pow(2,P-150)*(F+Math.pow(2,23))),!0},function(y,k,I){if(k=a0(k,I),k!=null){la(y.h,8*I+5),y=y.h;var E=+k;E===0?0<1/E?me=he=0:(he=0,me=2147483648):isNaN(E)?(he=0,me=2147483647):(E=(I=0>E?-2147483648:0)?-E:E,34028234663852886e22<E?(he=0,me=(I|2139095040)>>>0):11754943508222875e-54>E?(E=Math.round(E/Math.pow(2,-149)),he=0,me=(I|E)>>>0):(k=Math.floor(Math.log(E)/Math.LN2),E*=Math.pow(2,-k),E=Math.round(8388608*E),16777216<=E&&++k,he=0,me=(I|k+127<<23|E&8388607)>>>0)),I=me,y.h.push(I>>>0&255),y.h.push(I>>>8&255),y.h.push(I>>>16&255),y.h.push(I>>>24&255)}}),MM=au(function(y,k,I){if(y.i!==0)return!1;var E=y.h,D=0,P=y=0,F=E.i,j=E.h;do{var ne=F[j++];D|=(ne&127)<<P,P+=7}while(32>P&&ne&128);for(32<P&&(y|=(ne&127)>>4),P=3;32>P&&ne&128;P+=7)ne=F[j++],y|=(ne&127)<<P;if(aa(E,j),128>ne)E=D>>>0,ne=y>>>0,(y=ne&2147483648)&&(E=~E+1>>>0,ne=~ne>>>0,E==0&&(ne=ne+1>>>0)),E=4294967296*ne+(E>>>0);else throw pt();return Xr(k,I,y?-E:E),!0},function(y,k,I){k=br(k,I),k!=null&&(typeof k=="string"&&nt(k),k!=null&&(la(y.h,8*I),typeof k=="number"?(y=y.h,$e(k),_C(y,me,he)):(I=nt(k),_C(y.h,I.i,I.h))))}),zM=au(function(y,k,I){return y.i!==0?!1:(Xr(k,I,nu(y.h)),!0)},function(y,k,I){if(k=br(k,I),k!=null&&k!=null)if(la(y.h,8*I),y=y.h,I=k,0<=I)la(y,I);else{for(k=0;9>k;k++)y.h.push(I&127|128),I>>=7;y.h.push(1)}}),JC=au(function(y,k,I){if(y.i!==2)return!1;var E=nu(y.h)>>>0;y=y.h;var D=TC(y,E);if(y=y.i,Gr){var P=y,F;(F=Xs)||(F=Xs=new TextDecoder("utf-8",{fatal:!0})),y=D+E,P=D===0&&y===P.length?P:P.subarray(D,y);try{var j=F.decode(P)}catch(Ve){if(ts===void 0){try{F.decode(new Uint8Array([128]))}catch{}try{F.decode(new Uint8Array([97])),ts=!0}catch{ts=!1}}throw!ts&&(Xs=void 0),Ve}}else{j=D,E=j+E,D=[];for(var ne=null,ge,we;j<E;)ge=y[j++],128>ge?D.push(ge):224>ge?j>=E?_t():(we=y[j++],194>ge||(we&192)!==128?(j--,_t()):D.push((ge&31)<<6|we&63)):240>ge?j>=E-1?_t():(we=y[j++],(we&192)!==128||ge===224&&160>we||ge===237&&160<=we||((P=y[j++])&192)!==128?(j--,_t()):D.push((ge&15)<<12|(we&63)<<6|P&63)):244>=ge?j>=E-2?_t():(we=y[j++],(we&192)!==128||(ge<<28)+(we-144)>>30||((P=y[j++])&192)!==128||((F=y[j++])&192)!==128?(j--,_t()):(ge=(ge&7)<<18|(we&63)<<12|(P&63)<<6|F&63,ge-=65536,D.push((ge>>10&1023)+55296,(ge&1023)+56320))):_t(),8192<=D.length&&(ne=fs(ne,D),D.length=0);j=fs(ne,D)}return Xr(k,I,j),!0},function(y,k,I){if(k=br(k,I),k!=null){var E=!1;if(E=E===void 0?!1:E,eu){if(E&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(k))throw Error("Found an unpaired surrogate");k=(Zi||(Zi=new TextEncoder)).encode(k)}else{for(var D=0,P=new Uint8Array(3*k.length),F=0;F<k.length;F++){var j=k.charCodeAt(F);if(128>j)P[D++]=j;else{if(2048>j)P[D++]=j>>6|192;else{if(55296<=j&&57343>=j){if(56319>=j&&F<k.length){var ne=k.charCodeAt(++F);if(56320<=ne&&57343>=ne){j=1024*(j-55296)+ne-56320+65536,P[D++]=j>>18|240,P[D++]=j>>12&63|128,P[D++]=j>>6&63|128,P[D++]=j&63|128;continue}else F--}if(E)throw Error("Found an unpaired surrogate");j=65533}P[D++]=j>>12|224,P[D++]=j>>6&63|128}P[D++]=j&63|128}}k=D===P.length?P:P.subarray(0,D)}la(y.h,8*I+2),la(y.h,k.length),Il(y,y.h.end()),Il(y,k)}}),ZC=au(function(y,k,I,E,D){if(y.i!==2)return!1;k=PC(k,I,E),I=y.h.j,E=nu(y.h)>>>0;var P=y.h.h+E,F=P-I;if(0>=F&&(y.h.j=P,D(k,y,void 0,void 0,void 0),F=P-y.h.h),F)throw Error("Message parsing ended unexpectedly. Expected to read "+(E+" bytes, instead read "+(E-F)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return y.h.h=P,y.h.j=I,!0},function(y,k,I,E,D){if(k=l0(k,E,I),k!=null)for(E=0;E<k.length;E++){var P=y;la(P.h,8*I+2);var F=P.h.end();Il(P,F),F.push(P.i),P=F,D(k[E],y),F=y;var j=P.pop();for(j=F.i+F.h.length()-j;127<j;)P.push(j&127|128),j>>>=7,F.i++;P.push(j),F.i++}});function h0(y){return function(k,I){e:{if(xf.length){var E=xf.pop();E.setOptions(I),Zx(E.h,k,I),k=E}else k=new t0(k,I);try{var D=d0(y),P=YC(new D.P,k,D);break e}finally{D=k.h,D.i=null,D.m=!1,D.l=0,D.j=0,D.h=0,D.S=!1,k.l=-1,k.i=-1,100>xf.length&&xf.push(k)}P=void 0}return P}}function f0(y){return function(){var k=new kM;QC(this,k,u0(y)),Il(k,k.h.end());for(var I=new Uint8Array(k.i),E=k.j,D=E.length,P=0,F=0;F<D;F++){var j=E[F];I.set(j,P),P+=j.length}return k.j=[I],I}}function $l(y){ps.call(this,y)}g($l,ps);var eS=[$l,1,zM,2,vr,3,JC,4,JC];$l.prototype.l=f0(eS);function p0(y){ps.call(this,y,-1,BM)}g(p0,ps),p0.prototype.addClassification=function(y,k){return PC(this,1,$l,y,k),this};var BM=[1],WM=h0([p0,1,ZC,eS]);function lu(y){ps.call(this,y)}g(lu,ps);var tS=[lu,1,vr,2,vr,3,vr,4,vr,5,vr];lu.prototype.l=f0(tS);function nS(y){ps.call(this,y,-1,jM)}g(nS,ps);var jM=[1],VM=h0([nS,1,ZC,tS]);function Sf(y){ps.call(this,y)}g(Sf,ps);var sS=[Sf,1,vr,2,vr,3,vr,4,vr,5,vr,6,MM],UM=h0(sS);Sf.prototype.l=f0(sS);function rS(y,k,I){if(I=y.createShader(I===0?y.VERTEX_SHADER:y.FRAGMENT_SHADER),y.shaderSource(I,k),y.compileShader(I),!y.getShaderParameter(I,y.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+y.getShaderInfoLog(I));return I}function GM(y){return l0(y,$l,1).map(function(k){var I=br(k,1);return{index:I??0,qa:Yr(k,2),label:br(k,3)!=null?vf(br(k,3),""):void 0,displayName:br(k,4)!=null?vf(br(k,4),""):void 0}})}function HM(y){return{x:Yr(y,1),y:Yr(y,2),z:Yr(y,3),visibility:a0(y,4)!=null?Yr(y,4):void 0}}function m0(y){return l0(VM(y),lu,1).map(HM)}function g0(y,k){this.i=y,this.h=k,this.m=0}function iS(y,k,I){return KM(y,k),typeof y.h.canvas.transferToImageBitmap=="function"?Promise.resolve(y.h.canvas.transferToImageBitmap()):I?Promise.resolve(y.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(y.h.canvas):(y.j===void 0&&(y.j=document.createElement("canvas")),new Promise(function(E){y.j.height=y.h.canvas.height,y.j.width=y.h.canvas.width,y.j.getContext("2d",{}).drawImage(y.h.canvas,0,0,y.h.canvas.width,y.h.canvas.height),E(y.j)}))}function KM(y,k){var I=y.h;if(y.s===void 0){var E=rS(I,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),D=rS(I,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),P=I.createProgram();if(I.attachShader(P,E),I.attachShader(P,D),I.linkProgram(P),!I.getProgramParameter(P,I.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+I.getProgramInfoLog(P));E=y.s=P,I.useProgram(E),D=I.getUniformLocation(E,"sampler0"),y.l={O:I.getAttribLocation(E,"aVertex"),N:I.getAttribLocation(E,"aTex"),ya:D},y.v=I.createBuffer(),I.bindBuffer(I.ARRAY_BUFFER,y.v),I.enableVertexAttribArray(y.l.O),I.vertexAttribPointer(y.l.O,2,I.FLOAT,!1,0,0),I.bufferData(I.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),I.STATIC_DRAW),I.bindBuffer(I.ARRAY_BUFFER,null),y.u=I.createBuffer(),I.bindBuffer(I.ARRAY_BUFFER,y.u),I.enableVertexAttribArray(y.l.N),I.vertexAttribPointer(y.l.N,2,I.FLOAT,!1,0,0),I.bufferData(I.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),I.STATIC_DRAW),I.bindBuffer(I.ARRAY_BUFFER,null),I.uniform1i(D,0)}E=y.l,I.useProgram(y.s),I.canvas.width=k.width,I.canvas.height=k.height,I.viewport(0,0,k.width,k.height),I.activeTexture(I.TEXTURE0),y.i.bindTexture2d(k.glName),I.enableVertexAttribArray(E.O),I.bindBuffer(I.ARRAY_BUFFER,y.v),I.vertexAttribPointer(E.O,2,I.FLOAT,!1,0,0),I.enableVertexAttribArray(E.N),I.bindBuffer(I.ARRAY_BUFFER,y.u),I.vertexAttribPointer(E.N,2,I.FLOAT,!1,0,0),I.bindFramebuffer(I.DRAW_FRAMEBUFFER?I.DRAW_FRAMEBUFFER:I.FRAMEBUFFER,null),I.clearColor(0,0,0,0),I.clear(I.COLOR_BUFFER_BIT),I.colorMask(!0,!0,!0,!0),I.drawArrays(I.TRIANGLE_FAN,0,4),I.disableVertexAttribArray(E.O),I.disableVertexAttribArray(E.N),I.bindBuffer(I.ARRAY_BUFFER,null),y.i.bindTexture2d(0)}function XM(y){this.h=y}var qM=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function YM(y,k){return k+y}function oS(y,k){window[y]=k}function QM(y){var k=document.createElement("script");return k.setAttribute("src",y),k.setAttribute("crossorigin","anonymous"),new Promise(function(I){k.addEventListener("load",function(){I()},!1),k.addEventListener("error",function(){I()},!1),document.body.appendChild(k)})}function JM(){return O(function(y){switch(y.h){case 1:return y.s=2,w(y,WebAssembly.instantiate(qM),4);case 4:y.h=3,y.s=0;break;case 2:return y.s=0,y.l=null,y.return(!1);case 3:return y.return(!0)}})}function x0(y){if(this.h=y,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=y&&y.locateFile||YM,typeof window=="object")var k=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")k=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=k,y.options){k=a(Object.keys(y.options));for(var I=k.next();!I.done;I=k.next()){I=I.value;var E=y.options[I].default;E!==void 0&&(this.l[I]=typeof E=="function"?E():E)}}}t=x0.prototype,t.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function ZM(y){var k,I,E,D,P,F,j,ne,ge,we,Ve;return O(function(Oe){switch(Oe.h){case 1:return y.ga?(k=y.h.files===void 0?[]:typeof y.h.files=="function"?y.h.files(y.l):y.h.files,w(Oe,JM(),2)):Oe.return();case 2:if(I=Oe.i,typeof window=="object")return oS("createMediapipeSolutionsWasm",{locateFile:y.locateFile}),oS("createMediapipeSolutionsPackedAssets",{locateFile:y.locateFile}),F=k.filter(function(Ie){return Ie.data!==void 0}),j=k.filter(function(Ie){return Ie.data===void 0}),ne=Promise.all(F.map(function(Ie){var Ue=If(y,Ie.url);if(Ie.path!==void 0){var Ze=Ie.path;Ue=Ue.then(function(Rt){return y.overrideFile(Ze,Rt),Promise.resolve(Rt)})}return Ue})),ge=Promise.all(j.map(function(Ie){return Ie.simd===void 0||Ie.simd&&I||!Ie.simd&&!I?QM(y.locateFile(Ie.url,y.ha)):Promise.resolve()})).then(function(){var Ie,Ue,Ze;return O(function(Rt){if(Rt.h==1)return Ie=window.createMediapipeSolutionsWasm,Ue=window.createMediapipeSolutionsPackedAssets,Ze=y,w(Rt,Ie(Ue),2);Ze.i=Rt.i,Rt.h=0})}),we=function(){return O(function(Ie){return y.h.graph&&y.h.graph.url?Ie=w(Ie,If(y,y.h.graph.url),0):(Ie.h=0,Ie=void 0),Ie})}(),w(Oe,Promise.all([ge,ne,we]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return E=k.filter(function(Ie){return Ie.simd===void 0||Ie.simd&&I||!Ie.simd&&!I}).map(function(Ie){return y.locateFile(Ie.url,y.ha)}),importScripts.apply(null,l(E)),D=y,w(Oe,createMediapipeSolutionsWasm(Module),6);case 6:D.i=Oe.i,y.m=new OffscreenCanvas(1,1),y.i.canvas=y.m,P=y.i.GL.createContext(y.m,{antialias:!1,alpha:!1,va:typeof WebGL2RenderingContext<"u"?2:1}),y.i.GL.makeContextCurrent(P),Oe.h=4;break;case 7:if(y.m=document.createElement("canvas"),Ve=y.m.getContext("webgl2",{}),!Ve&&(Ve=y.m.getContext("webgl",{}),!Ve))return alert("Failed to create WebGL canvas context when passing video frame."),Oe.return();y.K=Ve,y.i.canvas=y.m,y.i.createContext(y.m,!0,!0,{});case 4:y.j=new y.i.SolutionWasm,y.ga=!1,Oe.h=0}})}function e3(y){var k,I,E,D,P,F,j,ne;return O(function(ge){if(ge.h==1){if(y.h.graph&&y.h.graph.url&&y.fa===y.h.graph.url)return ge.return();if(y.u=!0,!y.h.graph||!y.h.graph.url){ge.h=2;return}return y.fa=y.h.graph.url,w(ge,If(y,y.h.graph.url),3)}for(ge.h!=2&&(k=ge.i,y.j.loadGraph(k)),I=a(Object.keys(y.D)),E=I.next();!E.done;E=I.next())D=E.value,y.j.overrideFile(D,y.D[D]);if(y.D={},y.h.listeners)for(P=a(y.h.listeners),F=P.next();!F.done;F=P.next())j=F.value,r3(y,j);ne=y.l,y.l={},y.setOptions(ne),ge.h=0})}t.reset=function(){var y=this;return O(function(k){y.j&&(y.j.reset(),y.s={},y.v={}),k.h=0})},t.setOptions=function(y,k){var I=this;if(k=k||this.h.options){for(var E=[],D=[],P={},F=a(Object.keys(y)),j=F.next();!j.done;P={X:P.X,Y:P.Y},j=F.next())if(j=j.value,!(j in this.l&&this.l[j]===y[j])){this.l[j]=y[j];var ne=k[j];ne!==void 0&&(ne.onChange&&(P.X=ne.onChange,P.Y=y[j],E.push(function(ge){return function(){var we;return O(function(Ve){if(Ve.h==1)return w(Ve,ge.X(ge.Y),2);we=Ve.i,we===!0&&(I.u=!0),Ve.h=0})}}(P))),ne.graphOptionXref&&(j=Object.assign({},{calculatorName:"",calculatorIndex:0},ne.graphOptionXref,{valueNumber:ne.type===1?y[j]:0,valueBoolean:ne.type===0?y[j]:!1,valueString:ne.type===2?y[j]:""}),D.push(j)))}(E.length!==0||D.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(D),this.F=(this.F===void 0?[]:this.F).concat(E))}};function t3(y){var k,I,E,D,P,F,j;return O(function(ne){switch(ne.h){case 1:if(!y.u)return ne.return();if(!y.F){ne.h=2;break}k=a(y.F),I=k.next();case 3:if(I.done){ne.h=5;break}return E=I.value,w(ne,E(),4);case 4:I=k.next(),ne.h=3;break;case 5:y.F=void 0;case 2:if(y.H){for(D=new y.i.GraphOptionChangeRequestList,P=a(y.H),F=P.next();!F.done;F=P.next())j=F.value,D.push_back(j);y.j.changeOptions(D),D.delete(),y.H=void 0}y.u=!1,ne.h=0}})}t.initialize=function(){var y=this;return O(function(k){return k.h==1?w(k,ZM(y),2):k.h!=3?w(k,e3(y),3):w(k,t3(y),0)})};function If(y,k){var I,E;return O(function(D){return k in y.L?D.return(y.L[k]):(I=y.locateFile(k,""),E=fetch(I).then(function(P){return P.arrayBuffer()}),y.L[k]=E,D.return(E))})}t.overrideFile=function(y,k){this.j?this.j.overrideFile(y,k):this.D[y]=k},t.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},t.send=function(y,k){var I=this,E,D,P,F,j,ne,ge,we,Ve;return O(function(Oe){switch(Oe.h){case 1:return I.h.inputs?(E=1e3*(k??performance.now()),w(Oe,I.I,2)):Oe.return();case 2:return w(Oe,I.initialize(),3);case 3:for(D=new I.i.PacketDataList,P=a(Object.keys(y)),F=P.next();!F.done;F=P.next())if(j=F.value,ne=I.h.inputs[j]){e:{var Ie=y[j];switch(ne.type){case"video":var Ue=I.s[ne.stream];if(Ue||(Ue=new g0(I.i,I.K),I.s[ne.stream]=Ue),Ue.m===0&&(Ue.m=Ue.i.createTexture()),typeof HTMLVideoElement<"u"&&Ie instanceof HTMLVideoElement)var Ze=Ie.videoWidth,Rt=Ie.videoHeight;else typeof HTMLImageElement<"u"&&Ie instanceof HTMLImageElement?(Ze=Ie.naturalWidth,Rt=Ie.naturalHeight):(Ze=Ie.width,Rt=Ie.height);Rt={glName:Ue.m,width:Ze,height:Rt},Ze=Ue.h,Ze.canvas.width=Rt.width,Ze.canvas.height=Rt.height,Ze.activeTexture(Ze.TEXTURE0),Ue.i.bindTexture2d(Ue.m),Ze.texImage2D(Ze.TEXTURE_2D,0,Ze.RGBA,Ze.RGBA,Ze.UNSIGNED_BYTE,Ie),Ue.i.bindTexture2d(0),Ue=Rt;break e;case"detections":for(Ue=I.s[ne.stream],Ue||(Ue=new XM(I.i),I.s[ne.stream]=Ue),Ue.data||(Ue.data=new Ue.h.DetectionListData),Ue.data.reset(Ie.length),Rt=0;Rt<Ie.length;++Rt){Ze=Ie[Rt];var St=Ue.data,Rn=St.setBoundingBox,qs=Rt,ms=Ze.la,ut=new Sf;if(qr(ut,1,ms.sa),qr(ut,2,ms.ta),qr(ut,3,ms.height),qr(ut,4,ms.width),qr(ut,5,ms.rotation),Xr(ut,6,ms.pa),ms=ut.l(),Rn.call(St,qs,ms),Ze.ea)for(St=0;St<Ze.ea.length;++St){ut=Ze.ea[St],Rn=Ue.data,qs=Rn.addNormalizedLandmark,ms=Rt,ut=Object.assign({},ut,{visibility:ut.visibility?ut.visibility:0});var An=new lu;qr(An,1,ut.x),qr(An,2,ut.y),qr(An,3,ut.z),ut.visibility&&qr(An,4,ut.visibility),ut=An.l(),qs.call(Rn,ms,ut)}if(Ze.ba)for(St=0;St<Ze.ba.length;++St)Rn=Ue.data,qs=Rn.addClassification,ms=Rt,ut=Ze.ba[St],An=new $l,qr(An,2,ut.qa),ut.index&&Xr(An,1,ut.index),ut.label&&Xr(An,3,ut.label),ut.displayName&&Xr(An,4,ut.displayName),ut=An.l(),qs.call(Rn,ms,ut)}Ue=Ue.data;break e;default:Ue={}}}switch(ge=Ue,we=ne.stream,ne.type){case"video":D.pushTexture2d(Object.assign({},ge,{stream:we,timestamp:E}));break;case"detections":Ve=ge,Ve.stream=we,Ve.timestamp=E,D.pushDetectionList(Ve);break;default:throw Error("Unknown input config type: '"+ne.type+"'")}}return I.j.send(D),w(Oe,I.I,4);case 4:D.delete(),Oe.h=0}})};function n3(y,k,I){var E,D,P,F,j,ne,ge,we,Ve,Oe,Ie,Ue,Ze,Rt;return O(function(St){switch(St.h){case 1:if(!I)return St.return(k);for(E={},D=0,P=a(Object.keys(I)),F=P.next();!F.done;F=P.next())j=F.value,ne=I[j],typeof ne!="string"&&ne.type==="texture"&&k[ne.stream]!==void 0&&++D;1<D&&(y.M=!1),ge=a(Object.keys(I)),F=ge.next();case 2:if(F.done){St.h=4;break}if(we=F.value,Ve=I[we],typeof Ve=="string")return Ze=E,Rt=we,w(St,s3(y,we,k[Ve]),14);if(Oe=k[Ve.stream],Ve.type==="detection_list"){if(Oe){for(var Rn=Oe.getRectList(),qs=Oe.getLandmarksList(),ms=Oe.getClassificationsList(),ut=[],An=0;An<Rn.size();++An){var eo=UM(Rn.get(An)),i3=Yr(eo,1),o3=Yr(eo,2),a3=Yr(eo,3),l3=Yr(eo,4),c3=Yr(eo,5,0),$f=void 0;$f=$f===void 0?0:$f,eo={la:{sa:i3,ta:o3,height:a3,width:l3,rotation:c3,pa:vf(br(eo,6),$f)},ea:m0(qs.get(An)),ba:GM(WM(ms.get(An)))},ut.push(eo)}Rn=ut}else Rn=[];E[we]=Rn,St.h=7;break}if(Ve.type==="proto_list"){if(Oe){for(Rn=Array(Oe.size()),qs=0;qs<Oe.size();qs++)Rn[qs]=Oe.get(qs);Oe.delete()}else Rn=[];E[we]=Rn,St.h=7;break}if(Oe===void 0){St.h=3;break}if(Ve.type==="float_list"){E[we]=Oe,St.h=7;break}if(Ve.type==="proto"){E[we]=Oe,St.h=7;break}if(Ve.type!=="texture")throw Error("Unknown output config type: '"+Ve.type+"'");return Ie=y.v[we],Ie||(Ie=new g0(y.i,y.K),y.v[we]=Ie),w(St,iS(Ie,Oe,y.M),13);case 13:Ue=St.i,E[we]=Ue;case 7:Ve.transform&&E[we]&&(E[we]=Ve.transform(E[we])),St.h=3;break;case 14:Ze[Rt]=St.i;case 3:F=ge.next(),St.h=2;break;case 4:return St.return(E)}})}function s3(y,k,I){var E;return O(function(D){return typeof I=="number"||I instanceof Uint8Array||I instanceof y.i.Uint8BlobList?D.return(I):I instanceof y.i.Texture2dDataOut?(E=y.v[k],E||(E=new g0(y.i,y.K),y.v[k]=E),D.return(iS(E,I,y.M))):D.return(void 0)})}function r3(y,k){for(var I=k.name||"$",E=[].concat(l(k.wants)),D=new y.i.StringList,P=a(k.wants),F=P.next();!F.done;F=P.next())D.push_back(F.value);P=y.i.PacketListener.implement({onResults:function(j){for(var ne={},ge=0;ge<k.wants.length;++ge)ne[E[ge]]=j.get(ge);var we=y.listeners[I];we&&(y.I=n3(y,ne,k.outs).then(function(Ve){Ve=we(Ve);for(var Oe=0;Oe<k.wants.length;++Oe){var Ie=ne[E[Oe]];typeof Ie=="object"&&Ie.hasOwnProperty&&Ie.hasOwnProperty("delete")&&Ie.delete()}Ve&&(y.I=Ve)}))}}),y.j.attachMultiListener(D,P),D.delete()}t.onResults=function(y,k){this.listeners[k||"$"]=y},U("Solution",x0),U("OptionType",{BOOL:0,NUMBER:1,ua:2,0:"BOOL",1:"NUMBER",2:"STRING"});function aS(y){switch(y===void 0&&(y=0),y){case 1:return"pose_landmark_full.tflite";case 2:return"pose_landmark_heavy.tflite";default:return"pose_landmark_lite.tflite"}}function lS(y){var k=this;y=y||{},this.h=new x0({locateFile:y.locateFile,files:function(I){return[{url:"pose_solution_packed_assets_loader.js"},{simd:!1,url:"pose_solution_wasm_bin.js"},{simd:!0,url:"pose_solution_simd_wasm_bin.js"},{data:!0,url:aS(I.modelComplexity)}]},graph:{url:"pose_web.binarypb"},listeners:[{wants:["pose_landmarks","world_landmarks","segmentation_mask","image_transformed"],outs:{image:{type:"texture",stream:"image_transformed"},poseLandmarks:{type:"proto",stream:"pose_landmarks",transform:m0},poseWorldLandmarks:{type:"proto",stream:"world_landmarks",transform:m0},segmentationMask:{type:"texture",stream:"segmentation_mask"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(I){var E,D,P;return O(function(F){return F.h==1?(E=aS(I),D="third_party/mediapipe/modules/pose_landmark/"+E,w(F,If(k.h,E),2)):(P=F.i,k.h.overrideFile(D,P),F.return(!0))})}},smoothLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothLandmarks",fieldName:"bool_value"}},enableSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorEnableSegmentation",fieldName:"bool_value"}},smoothSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothSegmentation",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"poselandmarkgpu__posedetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"poselandmarkgpu__poselandmarkbyroigpu__tensorstoposelandmarksandsegmentation__ThresholdingCalculator",fieldName:"threshold"}}}})}t=lS.prototype,t.reset=function(){this.h.reset()},t.close=function(){return this.h.close(),Promise.resolve()},t.onResults=function(y){this.h.onResults(y)},t.initialize=function(){var y=this;return O(function(k){return w(k,y.h.initialize(),0)})},t.send=function(y,k){var I=this;return O(function(E){return w(E,I.h.send(y,k),0)})},t.setOptions=function(y){this.h.setOptions(y)},U("Pose",lS),U("POSE_CONNECTIONS",[[0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]]),U("POSE_LANDMARKS",{NOSE:0,LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,LEFT_EAR:7,RIGHT_EAR:8,LEFT_RIGHT:9,RIGHT_LEFT:10,LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_PINKY:17,RIGHT_PINKY:18,LEFT_INDEX:19,RIGHT_INDEX:20,LEFT_THUMB:21,RIGHT_THUMB:22,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28,LEFT_HEEL:29,RIGHT_HEEL:30,LEFT_FOOT_INDEX:31,RIGHT_FOOT_INDEX:32}),U("POSE_LANDMARKS_LEFT",{LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,LEFT_EAR:7,LEFT_RIGHT:9,LEFT_SHOULDER:11,LEFT_ELBOW:13,LEFT_WRIST:15,LEFT_PINKY:17,LEFT_INDEX:19,LEFT_THUMB:21,LEFT_HIP:23,LEFT_KNEE:25,LEFT_ANKLE:27,LEFT_HEEL:29,LEFT_FOOT_INDEX:31}),U("POSE_LANDMARKS_RIGHT",{RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,RIGHT_EAR:8,RIGHT_LEFT:10,RIGHT_SHOULDER:12,RIGHT_ELBOW:14,RIGHT_WRIST:16,RIGHT_PINKY:18,RIGHT_INDEX:20,RIGHT_THUMB:22,RIGHT_HIP:24,RIGHT_KNEE:26,RIGHT_ANKLE:28,RIGHT_HEEL:30,RIGHT_FOOT_INDEX:32}),U("POSE_LANDMARKS_NEUTRAL",{NOSE:0}),U("VERSION","0.5.1675469404")}).call(di);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KG=1e-7,XG=1e-4;class DR{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class Mv{refCount(e){return xs("refCount")}incRef(e){return xs("incRef")}timerAvailable(){return!0}time(e){return xs("time")}read(e){return xs("read")}readSync(e){return xs("readSync")}readToGPU(e,n){return xs("readToGPU")}numDataIds(){return xs("numDataIds")}disposeData(e,n){return xs("disposeData")}write(e,n,s){return xs("write")}move(e,n,s,r,i){return xs("move")}createTensorFromGPUData(e,n,s){return xs("createTensorFromGPUData")}memory(){return xs("memory")}floatPrecision(){return xs("floatPrecision")}epsilon(){return this.floatPrecision()===32?KG:XG}dispose(){return xs("dispose")}}function xs(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qG(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,Al(t,e,n)}function Ka(t,e,n){return Math.max(t,Math.min(e,n))}function zv(t){return t%2===0?t:t+1}function Al(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}function YG(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function R(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Bv(t,e,n=""){R(ft(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function FR(t){R(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function re(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function ft(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function xc(t){return t%1===0}function zb(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function nc(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function i$(t,e=r=>0,n,s){return new Promise((r,i)=>{let o=0;const a=()=>{if(t()){r();return}o++;const l=e(o);if(n!=null&&o>=n){i();return}s!=null?s(a,l):setTimeout(a,l)};a()})}function OR(t,e){let n=1,s=-1;for(let i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(t[i]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${i}`);s=i}else if(t[i]<0)throw Error(`Shapes can not be < 0. Found ${t[i]} at dim ${i}`);if(s===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const r=t.slice();return r[s]=e/n,r}function Qe(t,e){const n=e.length;return t=t==null?e.map((s,r)=>r):[].concat(t),R(t.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),R(t.every(s=>xc(s)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(s=>s<0?n+s:s)}function Qo(t,e){const n=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||r?null:Qe(e,t).sort();let o=0;for(let a=0;a<t.length;++a){if(i!=null){if(i[o]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(i[o]==null||i[o]>a)&&t[a]===1&&(n.push(t[a]),s.push(a)),i[o]<=a&&o++}t[a]!==1&&(n.push(t[a]),s.push(a))}return{newShape:n,keptDims:s}}function Pn(t,e){return Ht(t,e)}function Ht(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function QG(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function JG(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function PR(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function ym(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function ZG(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function qd(t){return typeof t=="string"||t instanceof String}function eH(t){return typeof t=="boolean"}function Bb(t){return typeof t=="number"}function Lc(t){return Array.isArray(t)?Lc(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":Bb(t)?"float32":qd(t)?"string":eH(t)?"bool":"float32"}function Wb(t){return!!(t&&t.constructor&&t.call&&t.apply)}function jb(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function Fe(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let s=e-3;s>=0;--s)n[s]=n[s+1]*t[s+1];return n}function LR(t,e,n,s=!1){const r=new Array;if(e.length===1){const i=e[0]*(s?2:1);for(let o=0;o<i;o++)r[o]=n[t+o]}else{const i=e[0],o=e.slice(1),a=o.reduce((l,c)=>l*c)*(s?2:1);for(let l=0;l<i;l++)r[l]=LR(t+l*a,o,n,s)}return r}function Fr(t,e,n=!1){if(t.length===0)return e[0];const s=t.reduce((r,i)=>r*i)*(n?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return LR(0,t,e,n)}function tH(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function Wv(t,e){const n=Ln(t,e);for(let s=0;s<n.length;s++)n[s]=1;return n}function Ln(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function MR(t,e){const n=t.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return Fr(t,new Float32Array(n));if(e==="int32")return Fr(t,new Int32Array(n));if(e==="bool")return Fr(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function qi(t){t.forEach(e=>{R(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function pi(t,e,n){if(e===0)return 0;if(e===1)return t[0];let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=n[r]*t[r];return s}function Mc(t,e,n){if(e===0)return[];if(e===1)return[t];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(t/n[r]),t-=s[r]*n[r];return s[s.length-1]=t,s}function jv(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o$="tfjsflags";class nH{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=sH,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(ee().getBool("IS_TEST")||ee().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,s){if(this.flagRegistry[e]={evaluationFn:n,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];ee().getBool("IS_TEST")||ee().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(jv(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);o$ in e&&e[o$].split(",").forEach(s=>{const[r,i]=s.split(":");this.urlFlags[r]=iH(r,i)})}}function sH(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(rH(e,s[0],s[1]),s.join("="))),e}function rH(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function iH(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function ee(){return zR}let zR=null;function oH(t){zR=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ay;function BR(){if(ay==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");ay=t}return ay}function aH(){const t=BR();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function Vv(t,e){const n=aH();if(n.has(t))return n.get(t);{const s=e();return n.set(t,s),n.get(t)}}const Cg="Abs",Yd="Acos",Qd="Acosh",zc="Add",Uv="AddN",Gv="All",Hv="Any",Sg="ArgMax",Ig="ArgMin",Jd="Asin",Zd="Asinh",eh="Atan",th="Atanh",nh="Atan2",$g="AvgPool",Kv="AvgPoolGrad",Ng="AvgPool3D",Xv="AvgPool3DGrad",Tg="BatchMatMul",Eg="BatchToSpaceND",qv="Bincount",Yv="BitwiseAnd",lH="BroadcastTo",WR="BroadcastArgs",sh="Cast",rh="Ceil",ih="ClipByValue",Qv="Complex",_g="ComplexAbs",Rg="Concat",Ag="Conv2D",Jv="Conv2DBackpropFilter",Dg="Conv2DBackpropInput",Fg="Conv3D",Zv="Conv3DBackpropFilterV2",ew="Conv3DBackpropInputV2",oh="Cos",ah="Cosh",tw="Cumprod",Og="Cumsum",nw="CropAndResize",sw="DenseBincount",rw="DepthToSpace",Pg="DepthwiseConv2dNative",iw="DepthwiseConv2dNativeBackpropFilter",ow="DepthwiseConv2dNativeBackpropInput",jR="Diag",Lg="Dilation2D",Vb="Dilation2DBackpropInput",Ub="Dilation2DBackpropFilter",cH="Draw",lh="RealDiv",aw="Einsum",ch="Elu",lw="EluGrad",uh="Erf",Mg="Equal",dh="Exp",zg="ExpandDims",hh="Expm1",cw="FFT",uw="Fill",dw="FlipLeftRight",fh="Floor",ph="FloorDiv",Bg="FusedBatchNorm",Wg="GatherV2",VR="GatherNd",jg="Greater",mh="GreaterEqual",gh="Identity",hw="IFFT",fw="Imag",xh="IsFinite",yh="IsInf",bh="IsNan",Vg="LeakyRelu",Ug="Less",Gg="LessEqual",UR="LinSpace",vh="Log",wh="Log1p",Hg="LogicalAnd",Kg="LogicalNot",Xg="LogicalOr",uH="LogSoftmax",qg="LRN",pw="LRNGrad",Yg="Max",kh="Maximum",Qg="MaxPool",mw="MaxPoolGrad",Jg="MaxPool3D",gw="MaxPool3DGrad",GR="MaxPoolWithArgmax",Zg="Mean",ex="Min",Ch="Minimum",tx="MirrorPad",Sh="Mod",HR="Multinomial",Ih="Multiply",nx="Neg",sx="NotEqual",xw="NonMaxSuppressionV3",yw="NonMaxSuppressionV4",bw="NonMaxSuppressionV5",rx="OnesLike",ix="OneHot",ox="Pack",ax="PadV2",$h="Pow",lx="Prelu",cx="Prod",KR="RaggedGather",XR="RaggedRange",qR="RaggedTensorToTensor",vw="Range",ww="Real",Nh="Reciprocal",Th="Relu",ux="Reshape",dx="ResizeNearestNeighbor",kw="ResizeNearestNeighborGrad",hx="ResizeBilinear",Cw="ResizeBilinearGrad",Eh="Relu6",fx="Reverse",_h="Round",Rh="Rsqrt",YR="ScatterNd",QR="TensorScatterUpdate",JR="SearchSorted",px="Select",Ah="Selu",mx="Slice",Dh="Sin",Fh="Sinh",Oh="Sign",Ph="Sigmoid",Lh="Softplus",Mh="Sqrt",gx="Sum",xx="SpaceToBatchND",yx="SplitV",bx="Softmax",ZR="SparseFillEmptyRows",eA="SparseReshape",tA="SparseSegmentMean",nA="SparseSegmentSum",sA="SparseToDense",zh="SquaredDifference",Sw="Square",Iw="StaticRegexReplace",$w="StridedSlice",rA="StringNGrams",iA="StringSplit",oA="StringToHashBucketFast",Bh="Sub",Wh="Tan",jh="Tanh",Vh="Tile",Nw="TopK",Tw="Transform",sc="Transpose",Ew="Unique",vx="Unpack",wx="UnsortedSegmentSum",kx="ZerosLike",Uh="Step",dH="FromPixels",_w="RotateWithOffset",bm="_FusedMatMul",vm="FusedConv2D",aA="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ps(...t){ee().getBool("IS_TEST")||ee().getBool("PROD")||console.warn(...t)}function hH(...t){ee().getBool("IS_TEST")||ee().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wm=Vv("kernelRegistry",()=>new Map),Gb=Vv("gradRegistry",()=>new Map);function a$(t,e){const n=cA(t,e);return wm.get(n)}function l$(t){return Gb.get(t)}function c$(t){const e=wm.entries(),n=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[i,o]=r,[a]=i.split("_");a===t&&n.push(o)}return n}function lA(t){const{kernelName:e,backendName:n}=t,s=cA(e,n);wm.has(s)&&Ps(`The kernel '${e}' for backend '${n}' is already registered`),wm.set(s,t)}function fH(t){const{kernelName:e}=t;Gb.has(e)&&ee().getBool("DEBUG")&&Ps(`Overriding the gradient for '${e}'`),Gb.set(e,t)}function cA(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uA(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var dA=Tt,or=null;try{or=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Tt(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Tt.prototype.__isLong__;Object.defineProperty(Tt.prototype,"__isLong__",{value:!0});function Ds(t){return(t&&t.__isLong__)===!0}Tt.isLong=Ds;var u$={},d$={};function hl(t,e){var n,s,r;return e?(t>>>=0,(r=0<=t&&t<256)&&(s=d$[t],s)?s:(n=Et(t,(t|0)<0?-1:0,!0),r&&(d$[t]=n),n)):(t|=0,(r=-128<=t&&t<128)&&(s=u$[t],s)?s:(n=Et(t,t<0?-1:0,!1),r&&(u$[t]=n),n))}Tt.fromInt=hl;function ar(t,e){if(isNaN(t))return e?Ea:lr;if(e){if(t<0)return Ea;if(t>=hA)return mA}else{if(t<=-f$)return Cs;if(t+1>=f$)return pA}return t<0?ar(-t,e).neg():Et(t%yc|0,t/yc|0,e)}Tt.fromNumber=ar;function Et(t,e,n){return new Tt(t,e,n)}Tt.fromBits=Et;var km=Math.pow;function Rw(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return lr;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=t.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return Rw(t.substring(1),e,n).neg();for(var r=ar(km(n,8)),i=lr,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),l=parseInt(t.substring(o,o+a),n);if(a<8){var c=ar(km(n,a));i=i.mul(c).add(ar(l))}else i=i.mul(r),i=i.add(ar(l))}return i.unsigned=e,i}Tt.fromString=Rw;function Vr(t,e){return typeof t=="number"?ar(t,e):typeof t=="string"?Rw(t,e):Et(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Tt.fromValue=Vr;var h$=65536,pH=1<<24,yc=h$*h$,hA=yc*yc,f$=hA/2,p$=hl(pH),lr=hl(0);Tt.ZERO=lr;var Ea=hl(0,!0);Tt.UZERO=Ea;var Xl=hl(1);Tt.ONE=Xl;var fA=hl(1,!0);Tt.UONE=fA;var Hb=hl(-1);Tt.NEG_ONE=Hb;var pA=Et(-1,2147483647,!1);Tt.MAX_VALUE=pA;var mA=Et(-1,-1,!0);Tt.MAX_UNSIGNED_VALUE=mA;var Cs=Et(0,-2147483648,!1);Tt.MIN_VALUE=Cs;var ke=Tt.prototype;ke.toInt=function(){return this.unsigned?this.low>>>0:this.low};ke.toNumber=function(){return this.unsigned?(this.high>>>0)*yc+(this.low>>>0):this.high*yc+(this.low>>>0)};ke.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Cs)){var n=ar(e),s=this.div(n),r=s.mul(n).sub(this);return s.toString(e)+r.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=ar(km(e,6),this.unsigned),o=this,a="";;){var l=o.div(i),c=o.sub(l.mul(i)).toInt()>>>0,u=c.toString(e);if(o=l,o.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};ke.getHighBits=function(){return this.high};ke.getHighBitsUnsigned=function(){return this.high>>>0};ke.getLowBits=function(){return this.low};ke.getLowBitsUnsigned=function(){return this.low>>>0};ke.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Cs)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};ke.isZero=function(){return this.high===0&&this.low===0};ke.eqz=ke.isZero;ke.isNegative=function(){return!this.unsigned&&this.high<0};ke.isPositive=function(){return this.unsigned||this.high>=0};ke.isOdd=function(){return(this.low&1)===1};ke.isEven=function(){return(this.low&1)===0};ke.equals=function(e){return Ds(e)||(e=Vr(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};ke.eq=ke.equals;ke.notEquals=function(e){return!this.eq(e)};ke.neq=ke.notEquals;ke.ne=ke.notEquals;ke.lessThan=function(e){return this.comp(e)<0};ke.lt=ke.lessThan;ke.lessThanOrEqual=function(e){return this.comp(e)<=0};ke.lte=ke.lessThanOrEqual;ke.le=ke.lessThanOrEqual;ke.greaterThan=function(e){return this.comp(e)>0};ke.gt=ke.greaterThan;ke.greaterThanOrEqual=function(e){return this.comp(e)>=0};ke.gte=ke.greaterThanOrEqual;ke.ge=ke.greaterThanOrEqual;ke.compare=function(e){if(Ds(e)||(e=Vr(e)),this.eq(e))return 0;var n=this.isNegative(),s=e.isNegative();return n&&!s?-1:!n&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};ke.comp=ke.compare;ke.negate=function(){return!this.unsigned&&this.eq(Cs)?Cs:this.not().add(Xl)};ke.neg=ke.negate;ke.add=function(e){Ds(e)||(e=Vr(e));var n=this.high>>>16,s=this.high&65535,r=this.low>>>16,i=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,u=0,d=0,h=0,f=0;return f+=i+c,h+=f>>>16,f&=65535,h+=r+l,d+=h>>>16,h&=65535,d+=s+a,u+=d>>>16,d&=65535,u+=n+o,u&=65535,Et(h<<16|f,u<<16|d,this.unsigned)};ke.subtract=function(e){return Ds(e)||(e=Vr(e)),this.add(e.neg())};ke.sub=ke.subtract;ke.multiply=function(e){if(this.isZero())return lr;if(Ds(e)||(e=Vr(e)),or){var n=or.mul(this.low,this.high,e.low,e.high);return Et(n,or.get_high(),this.unsigned)}if(e.isZero())return lr;if(this.eq(Cs))return e.isOdd()?Cs:lr;if(e.eq(Cs))return this.isOdd()?Cs:lr;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(p$)&&e.lt(p$))return ar(this.toNumber()*e.toNumber(),this.unsigned);var s=this.high>>>16,r=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,d=0,h=0,f=0,p=0;return p+=o*u,f+=p>>>16,p&=65535,f+=i*u,h+=f>>>16,f&=65535,f+=o*c,h+=f>>>16,f&=65535,h+=r*u,d+=h>>>16,h&=65535,h+=i*c,d+=h>>>16,h&=65535,h+=o*l,d+=h>>>16,h&=65535,d+=s*u+r*c+i*l+o*a,d&=65535,Et(f<<16|p,d<<16|h,this.unsigned)};ke.mul=ke.multiply;ke.divide=function(e){if(Ds(e)||(e=Vr(e)),e.isZero())throw Error("division by zero");if(or){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?or.div_u:or.div_s)(this.low,this.high,e.low,e.high);return Et(n,or.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Ea:lr;var s,r,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Ea;if(e.gt(this.shru(1)))return fA;i=Ea}else{if(this.eq(Cs)){if(e.eq(Xl)||e.eq(Hb))return Cs;if(e.eq(Cs))return Xl;var o=this.shr(1);return s=o.div(e).shl(1),s.eq(lr)?e.isNegative()?Xl:Hb:(r=this.sub(e.mul(s)),i=s.add(r.div(e)),i)}else if(e.eq(Cs))return this.unsigned?Ea:lr;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=lr}for(r=this;r.gte(e);){s=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(s)/Math.LN2),l=a<=48?1:km(2,a-48),c=ar(s),u=c.mul(e);u.isNegative()||u.gt(r);)s-=l,c=ar(s,this.unsigned),u=c.mul(e);c.isZero()&&(c=Xl),i=i.add(c),r=r.sub(u)}return i};ke.div=ke.divide;ke.modulo=function(e){if(Ds(e)||(e=Vr(e)),or){var n=(this.unsigned?or.rem_u:or.rem_s)(this.low,this.high,e.low,e.high);return Et(n,or.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};ke.mod=ke.modulo;ke.rem=ke.modulo;ke.not=function(){return Et(~this.low,~this.high,this.unsigned)};ke.and=function(e){return Ds(e)||(e=Vr(e)),Et(this.low&e.low,this.high&e.high,this.unsigned)};ke.or=function(e){return Ds(e)||(e=Vr(e)),Et(this.low|e.low,this.high|e.high,this.unsigned)};ke.xor=function(e){return Ds(e)||(e=Vr(e)),Et(this.low^e.low,this.high^e.high,this.unsigned)};ke.shiftLeft=function(e){return Ds(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Et(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Et(0,this.low<<e-32,this.unsigned)};ke.shl=ke.shiftLeft;ke.shiftRight=function(e){return Ds(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Et(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Et(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};ke.shr=ke.shiftRight;ke.shiftRightUnsigned=function(e){if(Ds(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var s=this.low;return Et(s>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?Et(n,0,this.unsigned):Et(n>>>e-32,0,this.unsigned)};ke.shru=ke.shiftRightUnsigned;ke.shr_u=ke.shiftRightUnsigned;ke.toSigned=function(){return this.unsigned?Et(this.low,this.high,!1):this};ke.toUnsigned=function(){return this.unsigned?this:Et(this.low,this.high,!0)};ke.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};ke.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};ke.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Tt.fromBytes=function(e,n,s){return s?Tt.fromBytesLE(e,n):Tt.fromBytesBE(e,n)};Tt.fromBytesLE=function(e,n){return new Tt(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Tt.fromBytesBE=function(e,n){return new Tt(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const gA=GN(dA),mH=UN({__proto__:null,default:gA},[dA]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const va=gA||mH;function Cx(t){return va.fromString(t,!0,16)}const xA=Cx("c3a5c85c97cb3127"),ba=Cx("b492b66fbe98f273"),Kn=Cx("9ae16a3b2f90404f");function Kb(t){return t.xor(t.shru(47))}function yA(t,e,n){const s=t.slice(e,e+n);return va.fromBytes(Array.from(s),!0,!0)}function wt(t,e){return yA(t,e,8)}function m$(t,e){return yA(t,e,4)}function yn(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function Ao(t,e,n=Cx("9ddfea08eb382d69")){let s=t.xor(e).mul(n);s=s.xor(s.shru(47));let r=e.xor(s).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function gH(t,e,n,s,r,i){r=r.add(t),i=yn(i.add(r).add(s),21);const o=r;return r=r.add(e),r=r.add(n),i=i.add(yn(r,44)),[r.add(s),i.add(o)]}function sp(t,e,n,s){return gH(wt(t,e),wt(t,e+8),wt(t,e+16),wt(t,e+24),n,s)}function xH(t,e=t.length){if(e>=8){const n=Kn.add(e*2),s=wt(t,0).add(Kn),r=wt(t,e-8),i=yn(r,37).mul(n).add(s),o=yn(s,25).add(r).mul(n);return Ao(i,o,n)}if(e>=4){const n=Kn.add(e*2),s=m$(t,0);return Ao(s.shl(3).add(e),m$(t,e-4),n)}if(e>0){const n=t[0],s=t[e>>1],r=t[e-1],i=n+(s<<8),o=e+(r<<2);return Kb(Kn.mul(i).xor(xA.mul(o))).mul(Kn)}return Kn}function yH(t,e=t.length){const n=Kn.add(e*2),s=wt(t,0).mul(ba),r=wt(t,8),i=wt(t,e-8).mul(n),o=wt(t,e-16).mul(Kn);return Ao(yn(s.add(r),43).add(yn(i,30)).add(o),s.add(yn(r.add(Kn),18)).add(i),n)}function bH(t,e=t.length){const n=Kn.add(e*2),s=wt(t,0).mul(Kn),r=wt(t,8),i=wt(t,e-8).mul(n),o=wt(t,e-16).mul(Kn),a=yn(s.add(r),43).add(yn(i,30)).add(o),l=Ao(a,s.add(yn(r.add(Kn),18)).add(i),n),c=wt(t,16).mul(n),u=wt(t,24),d=a.add(wt(t,e-32)).mul(n),h=l.add(wt(t,e-24)).mul(n);return Ao(yn(c.add(u),43).add(yn(d,30)).add(h),c.add(yn(u.add(s),18)).add(d),n)}function vH(t,e=t.length){const n=va.fromNumber(81,!0);if(e<=32)return e<=16?xH(t,e):yH(t,e);if(e<=64)return bH(t,e);let s=n,r=n.mul(ba).add(113),i=Kb(r.mul(Kn).add(113)).mul(Kn),o=[va.UZERO,va.UZERO],a=[va.UZERO,va.UZERO];s=s.mul(Kn).add(wt(t,0));let l=0;const c=(e-1>>6)*64,u=c+(e-1&63)-63;do s=yn(s.add(r).add(o[0]).add(wt(t,l+8)),37).mul(ba),r=yn(r.add(o[1]).add(wt(t,l+48)),42).mul(ba),s=s.xor(a[1]),r=r.add(o[0]).add(wt(t,l+40)),i=yn(i.add(a[0]),33).mul(ba),o=sp(t,l,o[1].mul(ba),s.add(a[0])),a=sp(t,l+32,i.add(a[1]),r.add(wt(t,l+16))),[i,s]=[s,i],l+=64;while(l!==c);const d=ba.add(i.and(255).shl(1));return l=u,a[0]=a[0].add(e-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),s=yn(s.add(r).add(o[0]).add(wt(t,l+8)),37).mul(d),r=yn(r.add(o[1]).add(wt(t,l+48)),42).mul(d),s=s.xor(a[1].mul(9)),r=r.add(o[0].mul(9).add(wt(t,l+40))),i=yn(i.add(a[0]),33).mul(d),o=sp(t,l,o[1].mul(d),s.add(a[0])),a=sp(t,l+32,i.add(a[1]),r.add(wt(t,l+16))),[i,s]=[s,i],Ao(Ao(o[0],a[0],d).add(Kb(r).mul(xA)).add(i),Ao(o[1],a[1],d).add(s),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jo(t,e){return e==="string"?Do(t):fl([t],e)}function wH(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function fl(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Xa(t)),ee().getBool("DEBUG")&&QG(t,e),wH(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let s=0;s<n.length;++s)Math.round(t[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${e}`)}function ss(){return ee().platform.now()}function Do(t,e="utf-8"){return e=e||"utf-8",ee().platform.encode(t,e)}function Bo(t,e="utf-8"){return e=e||"utf-8",ee().platform.decode(t,e)}function pr(t){return ee().platform.isTypedArray!=null?ee().platform.isTypedArray(t):uA(t)}function Xa(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||jv(t)||t==null||pr(t)&&n)e.push(t);else if(Array.isArray(t)||pr(t))for(let s=0;s<t.length;++s)Xa(t[s],e,n);else{let s=-1;for(const r of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)Xa(t[r],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kH{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new SH)}profileKernel(e,n,s){let r;const i=()=>{r=s()};let o;const a=ss();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const c of r)c.dataSync();o=Promise.resolve({kernelMs:ss()-a})}if(ee().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<r.length;c++){const u=r[c];u.data().then(d=>{CH(d,u.dtype,e)})}return{kernelName:e,outputs:r,inputs:n,timeMs:o.then(c=>c.kernelMs),extraInfo:o.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:s,timeMs:r,inputs:i,extraInfo:o}=e;s.forEach(a=>{Promise.all([a.data(),r,o]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],i,l[2])})})}}function CH(t,e,n){if(e!=="float32")return!1;for(let s=0;s<t.length;s++){const r=t[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class SH{logKernelProfile(e,n,s,r,i,o){const a=typeof r=="number"?nc(`${r}ms`,9):r.error,l=nc(e,25),c=n.rank,u=n.size,d=nc(n.shape.toString(),14);let h="";for(const f in i){const p=i[f];if(p!=null){const m=p.shape||n.shape,g=m.length;h+=`${f}: ${g}D ${g>0?m:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${d}	%c${u}	%c${h}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IH(t,e,n){const s={},r={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<t.length;l++){const c=t[l],u=c.inputs;for(const d in u){const h=u[d];let f=!1;for(let p=0;p<e.length;p++)if(s[h.id]){c.outputs.forEach(m=>s[m.id]=!0),f=!0,r[c.id]=!0;break}if(f)break}}const i={};i[n.id]=!0;const o={};for(let l=t.length-1;l>=0;l--){const c=t[l],u=c.inputs;for(let d=0;d<c.outputs.length;d++)if(i[c.outputs[d].id]){for(const h in u)i[u[h].id]=!0,o[c.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const c=t[l];if(r[c.id]&&o[c.id]){const u={};for(const h in c.inputs){const f=c.inputs[h];s[f.id]&&(u[h]=f)}const d=Object.assign({},c);d.inputs=u,d.outputs=c.outputs,a.push(d)}}return a}function $H(t,e,n,s){for(let r=e.length-1;r>=0;r--){const i=e[r],o=[];if(i.outputs.forEach(l=>{const c=t[l.id];c!=null?o.push(c):o.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const a=i.gradient(o);for(const l in i.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const c=n(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=i.inputs[l];if(!ft(c.shape,u.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(t[u.id]==null)t[u.id]=c;else{const d=t[u.id];t[u.id]=s(d,c),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g$=20,Cu=3,ly=7;function NH(t,e,n,s){const r=Fe(e),i=TH(t,e,n,r),o=e.length,a=Fp(t,e,n,r,i),l=["Tensor"];return s&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${o}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function TH(t,e,n,s){const r=re(e),i=s[s.length-1],o=new Array(i).fill(0),a=e.length,l=n==="complex64"?Ou(t):t;if(a>1)for(let c=0;c<r/i;c++){const u=c*i;for(let d=0;d<i;d++)o[d]=Math.max(o[d],Fu(l[u+d],0,n).length)}return o}function Fu(t,e,n){let s;return Array.isArray(t)?s=`${parseFloat(t[0].toFixed(ly))} + ${parseFloat(t[1].toFixed(ly))}j`:qd(t)?s=`'${t}'`:n==="bool"?s=bA(t):s=parseFloat(t.toFixed(ly)).toString(),nc(s,e)}function bA(t){return t===0?"false":"true"}function Fp(t,e,n,s,r,i=!0){const o=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const m=Ou(t);return[Fu(m[0],0,n)]}return n==="bool"?[bA(t[0])]:[t[0].toString()]}if(l===1){if(a>g$){const g=Cu*o;let x=Array.from(t.slice(0,g)),b=Array.from(t.slice((a-Cu)*o,a*o));return n==="complex64"&&(x=Ou(x),b=Ou(b)),["["+x.map((v,w)=>Fu(v,r[w],n)).join(", ")+", ..., "+b.map((v,w)=>Fu(v,r[a-Cu+w],n)).join(", ")+"]"]}return["["+(n==="complex64"?Ou(t):Array.from(t)).map((g,x)=>Fu(g,r[x],n)).join(", ")+"]"]}const c=e.slice(1),u=s.slice(1),d=s[0]*o,h=[];if(a>g$){for(let m=0;m<Cu;m++){const g=m*d,x=g+d;h.push(...Fp(t.slice(g,x),c,n,u,r,!1))}h.push("...");for(let m=a-Cu;m<a;m++){const g=m*d,x=g+d;h.push(...Fp(t.slice(g,x),c,n,u,r,m===a-1))}}else for(let m=0;m<a;m++){const g=m*d,x=g+d;h.push(...Fp(t.slice(g,x),c,n,u,r,m===a-1))}const f=l===2?",":"";h[0]="["+(a>0?h[0]+f:"");for(let m=1;m<h.length-1;m++)h[m]=" "+h[m]+f;let p=`,
`;for(let m=2;m<l;m++)p+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(i?"":p),h}function Ou(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nn{constructor(e,n,s){if(this.dtype=n,this.shape=e.slice(),this.size=re(e),s!=null){const r=s.length;R(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||Ht(n,this.size),this.strides=Fe(e)}set(e,...n){n.length===0&&(n=[0]),R(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const r of e){if(r<0||r>=this.shape[n]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}n++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let s=0;s<e.length-1;++s)n+=this.strides[s]*e[s];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(e/this.strides[s]),e-=n[s]*this.strides[s];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return Nr().makeTensor(this.values,this.shape,this.dtype)}}let Nr=null,Dl=null;function EH(t){Nr=t}function _H(t){Dl=t}class an{constructor(e,n,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=re(e),this.strides=Fe(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Dl.buffer(this.shape,this.dtype,e)}bufferSync(){return Dl.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Fr(this.shape,e,this.dtype==="complex64")}arraySync(){return Fr(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Nr().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(s=>Bo(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Nr().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Nr().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>Bo(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Nr().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Nr().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Dl.print(this,e)}clone(){return this.throwIfDisposed(),Dl.clone(this)}toString(e=!1){const n=this.dataSync();return NH(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Dl.cast(this,e)}variable(e=!0,n,s){return this.throwIfDisposed(),Nr().makeVariable(this,e,n,s)}}Object.defineProperty(an,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function se(){return Vv("Tensor",()=>an)}se();class Cm extends an{constructor(e,n,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=n,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!ft(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Nr().disposeTensor(this),this.dataId=e.dataId,Nr().incRef(this,null)}dispose(){Nr().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Cm,Symbol.hasInstance,{value:t=>t instanceof an&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var x$;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(x$||(x$={}));var Xb;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(Xb||(Xb={}));var qb;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(qb||(qb={}));var Yb;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(Yb||(Yb={}));var Qb;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(Qb||(Qb={}));const RH={float32:Yb,int32:Xb,bool:qb,complex64:Qb};function _s(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return RH[t][e]}function Aw(t){return _s(t,"int32")}function vA(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function wA(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xt(t,e){if(t.dtype===e.dtype)return[t,e];const n=_s(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function kA(t){const e=[];return CA(t,e,new Set),e}function CA(t,e,n){if(t==null)return;if(t instanceof an){e.push(t);return}if(!AH(t))return;const s=t;for(const r in s){const i=s[r];n.has(i)||(n.add(i),CA(i,e,n))}}function AH(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cy(t){return t.kernelName!=null}class y${constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class bc{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new y$}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,s=1){return e in this.registryFactory?(Ps(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(e);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new kH(this.backendInstance),!0}setupRegisteredKernels(){c$(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){c$(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof Mv)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,i=s.then(o=>r<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,Ps(`Initialization of backend ${e} failed`),Ps(o.stack||o.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return Ps(`Initialization of backend ${e} failed`),Ps(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n],{success:r,asyncInit:i}=this.initializeBackend(s);if(i||r)return{name:s,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const s=this.state.tensorInfo.get(n),r=s.backend,i=this.readSync(n),o=r.refCount(n);r.disposeData(n,!0),s.backend=e,e.move(n,i,s.shape,s.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let s=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=n(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,n,s){e();try{const r=s();return n(),r}catch(r){throw n(),r}}nextTensorId(){return bc.nextTensorId++}nextVariableId(){return bc.nextVariableId++}clone(e){const n=V.runKernel(gh,{x:e}),s={x:e},r=o=>({x:()=>{const a="float32",l={x:o},c={dtype:a};return V.runKernel(sh,l,c)}}),i=[];return this.addTapeNode(this.state.activeScope.name,s,[n],r,i,{}),n}runKernel(e,n,s){if(this.backendName==null&&this.backend,!(a$(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,s){const r=this.backend.numDataIds();let i=0;s.forEach(l=>{i+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-n-i-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,s=[];const r=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const c=cy(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(cy(e)){const{kernelName:p,inputs:m,attrs:g}=e;this.backendName==null&&this.backend;const x=a$(p,this.backendName);R(x!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const b=this.backend.numDataIds();l=x.kernelFunc({inputs:m,attrs:g,backend:this.backend});const v=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,b,v);const w=v.map(C=>C.rank!=null?C:this.makeTensorFromTensorInfo(C));if(r){const C=this.getTensorsForGradient(p,m,w);s=this.saveTensorsForBackwardMode(C)}return w}}else{const{forwardFunc:p}=e,m=g=>{r&&(s=g.map(x=>this.keep(this.clone(x))))};a=()=>{const g=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,m));const x=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,g,x),x}}const{inputs:u,attrs:d}=e,h=cy(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(f=this.profiler.profileKernel(c,u,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),r&&this.addTapeNode(c,u,n,h,s,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(p=>u[p]!=null?u[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,n,s){const r=l$(e);if(r!=null){const i=r.inputsToSave||[],o=r.outputsToSave||[];let a;r.saveAllInputs?(R(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(c=>n[c])):a=i.map(c=>n[c]);const l=s.filter((c,u)=>o[u]);return a.concat(l)}return[]}makeTensor(e,n,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let i=e;s==="string"&&qd(e[0])&&(i=e.map(l=>Do(l)));const o=r.write(i,n,s),a=new an(n,s,o,this.nextTensorId());if(this.trackTensor(a,r),s==="string"){const l=this.state.tensorInfo.get(o),c=ZG(i);this.state.numBytes+=c-l.bytes,l.bytes=c}return a}makeTensorFromDataId(e,n,s,r){s=s||"float32";const i={dataId:e,shape:n,dtype:s};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(e,n){const{dataId:s,shape:r,dtype:i}=e,o=new an(r,i,s,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(e,n=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const i=new Cm(e,n,s,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*ym(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof Cm||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*ym(e.dtype);this.state.numBytes-=s}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,s,r,i,o){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:s,saved:i},l=l$(e);l!=null&&(r=l.gradFunc),r!=null&&(a.gradient=c=>(c=c.map((u,d)=>{if(u==null){const h=s[d],f=Ln(h.size,h.dtype);return this.makeTensor(f,h.shape,h.dtype)}return u}),r(c.length>1?c:c[0],i,o))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=kA(e),s=new Set(n.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const o=this.state.activeScope.track[i];!o.kept&&!s.has(o.id)&&o.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(i=>{!i.kept&&i.scopeId===r.id&&this.track(i)})}gradients(e,n,s,r=!1){if(R(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));R(i instanceof an,()=>"The result y returned by f() must be a tensor.");const o=IH(this.state.activeTape,n,i);if(!r&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[i.id]=s??DH(i.shape),$H(a,o,c=>this.tidy(c),FH);const l=n.map(c=>a[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const u of c.saved)u.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return R(Wb(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{R(n.every(a=>a instanceof an),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};n.forEach((a,l)=>{r[l]=a});const i=(a,l)=>(s=e(...n,l),R(s.value instanceof an,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),R(Wb(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),o=(a,l)=>{const c=s.gradFunc(a,l),u=Array.isArray(c)?c:[c];R(u.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),R(u.every(h=>h instanceof an),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return u.forEach((h,f)=>{d[f]=()=>h}),d};return this.runKernelFunc({forwardFunc:i,backwardsFunc:o,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=ss(),s=await this.backend.time(e);return s.wallMs=ss()-n,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new y$;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}bc.nextTensorId=0;bc.nextVariableId=0;function DH(t){const e=Wv(re(t),"float32");return V.makeTensor(e,t,"float32")}function SA(){const t=BR();if(t._tfengine==null){const e=new nH(t);t._tfengine=new bc(e)}return oH(t._tfengine.ENV),EH(()=>t._tfengine),t._tfengine}const V=SA();function FH(t,e){const n={a:t,b:e};return V.runKernel(zc,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OH(){return typeof navigator<"u"&&navigator!=null}function IA(t){if(t||OH()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function $A(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ls=ee();ls.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});ls.registerFlag("IS_BROWSER",()=>$A());ls.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");ls.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));ls.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));ls.registerFlag("PROD",()=>!1);ls.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>ls.getBool("DEBUG"));ls.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);ls.registerFlag("IS_TEST",()=>!1);ls.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>ls.getBool("DEBUG"));ls.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);ls.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);ls.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sx(t,e){let n=t;if(pr(t))return e==="string"?[]:[t.length];if(vA(t)){const r=t.channels||"RGBA";return[t.height,t.width*r.length]}else if(wA(t))return[t.buffer.size/(e==null?4:ym(e))];if(!Array.isArray(t))return[];const s=[];for(;Array.isArray(n)||pr(n)&&e!=="string";)s.push(n.length),n=n[0];return Array.isArray(t)&&ee().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&NA(t,s,[]),s}function NA(t,e,n){if(n=n||[],!Array.isArray(t)&&!pr(t)){R(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}R(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),R(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const s=e.slice(1);for(let r=0;r<t.length;++r)NA(t[r],s,n.concat(r))}function b$(t,e,n,s){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${t} tensor, but got ${e} tensor`)}}function L(t,e,n,s="numeric"){if(t instanceof se())return b$(s,t.dtype,e,n),t;let r=Lc(t);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),b$(s,r,e,n),t==null||!pr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const i=Sx(t,r);!pr(t)&&!Array.isArray(t)&&(t=[t]);const a=r!=="string"?fl(t,r):Xa(t,[],!0);return V.makeTensor(a,i,r)}function TA(t,e,n,s="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((i,o)=>L(i,`${e}[${o}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PH="__op";function K(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const s=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+PH;const r=(...i)=>{V.startScope(n);try{const o=s(...i);return jv(o)&&console.error("Cannot return a Promise inside of tidy."),V.endScope(o),o}catch(o){throw V.endScope(null),o}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LH(t,e){const n=L(t,"real","complex"),s=L(e,"imag","complex");Bv(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:n,imag:s};return V.runKernel(Qv,r)}const vc=K({complex_:LH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ix(t,e,n,s){if(s==null)s=Lc(t);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(wA(t)||vA(t)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return V.backend.createTensorFromGPUData(t,e||n,s)}if(!pr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){qi(e);const r=re(e),i=re(n);R(r===i,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${i}`);for(let o=0;o<n.length;++o){const a=n[o],l=o===n.length-1?a!==re(e.slice(o)):!0;R(n[o]===e[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!pr(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=s!=="string"?fl(t,s):Xa(t,[],!0),V.makeTensor(t,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EA(t,e,n){const s=Sx(t,n);return Ix(t,e,s,n)}class Bc{static join(e){return new Bc(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>pr(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let s=0;s<e.length;s++){const r=e[s];s!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=n+r.byteLength;this.shards.push({buffer:r,start:n,end:i}),n=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const r=n-e,i=new ArrayBuffer(r),o=new Uint8Array(i);let a=0;for(let l=s;l<this.shards.length;l++){const c=this.shards[l],d=e+a-c.start,h=a,p=Math.min(n,c.end)-c.start,m=new Uint8Array(c.buffer,d,p-d);if(o.set(m,h),a+=m.length,n<c.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(r){return e<r.start?-1:e>=r.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=MH(this.shards,n);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function MH(t,e){let n=0,s=t.length;for(;n<=s;){const r=Math.floor((s-n)/2)+n,i=e(t[r]);if(i===0)return r;i<0?s=r:n=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function si(){return V}function v$(){return V.memory()}function Q(t,e){return V.tidy(t,e)}function et(t){kA(t).forEach(n=>n.dispose())}function mi(t){return V.keep(t)}function _A(t,e,n=1){return V.registerBackend(t,e,n)}function zH(){return V.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w$=4;async function k$(t,e){const n=[],s=[],r=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);for(let o=0;o<r.length;++o){const a=r[o],l=Array.isArray(t)?t[o].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const c={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const u=new Promise(async d=>{const h=await l.bytes(),f=h.reduce((g,x)=>g+x.length,0)+w$*h.length,p=new Uint8Array(f);let m=0;for(let g=0;g<h.length;g++){const x=h[g],b=new Uint8Array(new Uint32Array([x.length]).buffer);p.set(b,m),m+=w$,p.set(x,m),m+=x.length}d(p)});s.push(u)}else s.push(l.data());e!=null&&(c.group=e),n.push(c)}const i=await Promise.all(s);return{data:BH(i),specs:n}}function BH(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(i=>{if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const s=new Uint8Array(e);let r=0;return n.forEach(i=>{s.set(new Uint8Array(i.buffer),r),r+=i.byteLength}),s.buffer}const Dw=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function C$(t){return Dw?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function WH(t){if(Dw)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let s=0,r=e.length;s<r;s++)n+=String.fromCharCode(e[s]);return btoa(n)}function jH(t){if(Dw){const s=Buffer.from(t,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;++s)n.set([e.charCodeAt(s)],s);return n.buffer}function VH(t){return Bc.join(t)}function RA(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:C$(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:C$(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new Bc(t.weightData).byteLength}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Un{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Un.instance==null&&(Un.instance=new Un),Un.instance}static registerSaveRouter(e){Un.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Un.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Un.getHandlers(e,"save")}static getLoadHandlers(e,n){return Un.getHandlers(e,"load",n)}static getHandlers(e,n,s){const r=[];return(n==="load"?Un.getInstance().loadRouters:Un.getInstance().saveRouters).forEach(o=>{const a=o(e,s);a!==null&&r.push(a)}),r}}const UH=t=>Un.getSaveHandlers(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jb="tensorflowjs",Zb=1,_a="models_store",bo="model_info_store";function AA(){if(!ee().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function e1(t){const e=t.result;e.createObjectStore(_a,{keyPath:"modelPath"}),e.createObjectStore(bo,{keyPath:"modelPath"})}class qa{constructor(e){if(this.indexedDB=AA(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((s,r)=>{const i=this.indexedDB.open(Jb,Zb);i.onupgradeneeded=()=>e1(i),i.onsuccess=()=>{const o=i.result;if(n==null){const a=o.transaction(_a,"readonly"),c=a.objectStore(_a).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return o.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=u=>(o.close(),r(c.error)),a.oncomplete=()=>o.close()}else{n.weightData=Bc.join(n.weightData);const a=RA(n),l=o.transaction(bo,"readwrite");let c=l.objectStore(bo),u;try{u=c.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(h){return r(h)}let d;u.onsuccess=()=>{d=o.transaction(_a,"readwrite");const h=d.objectStore(_a);let f;try{f=h.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(p){return r(p)}f.onsuccess=()=>s({modelArtifactsInfo:a}),f.onerror=p=>{c=l.objectStore(bo);const m=c.delete(this.modelPath);m.onsuccess=()=>(o.close(),r(f.error)),m.onerror=g=>(o.close(),r(f.error))}},u.onerror=h=>(o.close(),r(u.error)),l.oncomplete=()=>{d==null?o.close():d.oncomplete=()=>o.close()}}},i.onerror=o=>r(i.error)})}}qa.URL_SCHEME="indexeddb://";const DA=t=>ee().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(qa.URL_SCHEME)?GH(t.slice(qa.URL_SCHEME.length)):null;Un.registerSaveRouter(DA);Un.registerLoadRouter(DA);function GH(t){return new qa(t)}function HH(t){return t.startsWith(qa.URL_SCHEME)?t.slice(qa.URL_SCHEME.length):t}class KH{constructor(){this.indexedDB=AA()}async listModels(){return new Promise((e,n)=>{const s=this.indexedDB.open(Jb,Zb);s.onupgradeneeded=()=>e1(s),s.onsuccess=()=>{const r=s.result,i=r.transaction(bo,"readonly"),a=i.objectStore(bo).getAll();a.onsuccess=()=>{const l={};for(const c of a.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},a.onerror=l=>(r.close(),n(a.error)),i.oncomplete=()=>r.close()},s.onerror=r=>n(s.error)})}async removeModel(e){return e=HH(e),new Promise((n,s)=>{const r=this.indexedDB.open(Jb,Zb);r.onupgradeneeded=()=>e1(r),r.onsuccess=()=>{const i=r.result,o=i.transaction(bo,"readwrite"),a=o.objectStore(bo),l=a.get(e);let c;l.onsuccess=()=>{if(l.result==null)return i.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const u=a.delete(e),d=()=>{c=i.transaction(_a,"readwrite");const f=c.objectStore(_a).delete(e);f.onsuccess=()=>n(l.result.modelArtifactsInfo),f.onerror=p=>s(l.error)};u.onsuccess=d,u.onerror=h=>(d(),i.close(),s(l.error))}},l.onerror=u=>(i.close(),s(l.error)),o.oncomplete=()=>{c==null?i.close():c.oncomplete=()=>i.close()}},r.onerror=i=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Di="/",Fl="tensorflowjs_models",FA="info",XH="model_topology",qH="weight_specs",YH="weight_data",QH="model_metadata";function OA(t){return{info:[Fl,t,FA].join(Di),topology:[Fl,t,XH].join(Di),weightSpecs:[Fl,t,qH].join(Di),weightData:[Fl,t,YH].join(Di),modelMetadata:[Fl,t,QH].join(Di)}}function PA(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function JH(t){const e=t.split(Di);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(Di)}function ZH(t){return t.startsWith(Ya.URL_SCHEME)?t.slice(Ya.URL_SCHEME.length):t}class Ya{constructor(e){if(!ee().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=OA(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=RA(e),i=Bc.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,WH(i));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:r}}catch{throw PA(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const a=JSON.parse(i);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=jH(o),n}}Ya.URL_SCHEME="localstorage://";const LA=t=>ee().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Ya.URL_SCHEME)?e6(t.slice(Ya.URL_SCHEME.length)):null;Un.registerSaveRouter(LA);Un.registerLoadRouter(LA);function e6(t){return new Ya(t)}class t6{constructor(){R(ee().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),R(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=Fl+Di,s=Di+FA;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);if(i.startsWith(n)&&i.endsWith(s)){const o=JH(i);e[o]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=ZH(e);const n=OA(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(n.info));return PA(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S$="://";class ii{constructor(){this.managers={}}static getInstance(){return ii.instance==null&&(ii.instance=new ii),ii.instance}static registerManager(e,n){R(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(S$)&&(e=e.slice(0,e.indexOf(S$))),R(e.length>0,()=>"scheme must not be an empty string.");const s=ii.getInstance();R(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=n}static getManager(e){const n=ii.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(ii.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class n6{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!ee().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return uA(e)}}if(ee().get("IS_BROWSER")){ee().setPlatform("browser",new n6);try{ii.registerManager(Ya.URL_SCHEME,new t6)}catch{}try{ii.registerManager(qa.URL_SCHEME,new KH)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s6={importFetch:()=>require("node-fetch")};let uy;class r6{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return ee().global.fetch!=null?ee().global.fetch(e,n):(uy==null&&(uy=s6.importFetch()),uy(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}ee().get("IS_NODE")&&!ee().get("IS_BROWSER")&&ee().setPlatform("node",new r6);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ye(t,e="float32",n){return e=e||"float32",qi(t),new Nn(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i6(t,e){const n=L(t,"x","cast");if(!JG(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},r={dtype:e};return V.runKernel(sh,s,r)}const Se=K({cast_:i6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o6(t){const n={x:L(t,"x","clone","string_or_numeric")};return V.runKernel(gh,n)}const Pa=K({clone_:o6});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a6(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */SA();const l6={buffer:Ye,cast:Se,clone:Pa,print:a6};_H(l6);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c6(t,e){let n=L(t,"a","add"),s=L(e,"b","add");[n,s]=Xt(n,s);const r={a:n,b:s};return V.runKernel(zc,r)}const xe=K({add_:c6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u6(t,e){let n=L(t,"a","floorDiv"),s=L(e,"b","floorDiv");[n,s]=Xt(n,s);const r={a:n,b:s};return V.runKernel(ph,r)}const MA=K({floorDiv_:u6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d6(t,e){let n=L(t,"a","div"),s=L(e,"b","div");if([n,s]=Xt(n,s),n.dtype==="int32"&&s.dtype==="int32")return MA(n,s);const r={a:n,b:s},i={};return V.runKernel(lh,r,i)}const Me=K({div_:d6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h6(t,e){let n=L(t,"a","mul"),s=L(e,"b","mul");[n,s]=Xt(n,s);const r={a:n,b:s};return V.runKernel(Ih,r)}const B=K({mul_:h6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f6(t){const e=L(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return V.runKernel(_g,n)}else{const n={x:e};return V.runKernel(Cg,n)}}const Gn=K({abs_:f6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p6(t){const n={x:L(t,"x","acos")};return V.runKernel(Yd,n)}const m6=K({acos_:p6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g6(t){const n={x:L(t,"x","acosh")};return V.runKernel(Qd,n)}const x6=K({acosh_:g6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y6(t,e=null,n=!1){const r={x:L(t,"x","all","bool")},i={axis:e,keepDims:n};return V.runKernel(Gv,r,i)}const zA=K({all_:y6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b6(t,e=null,n=!1){const r={x:L(t,"x","any","bool")},i={axis:e,keepDims:n};return V.runKernel(Hv,r,i)}const t1=K({any_:b6});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v6(t,e=0){const s={x:L(t,"x","argMax")},r={axis:e};return V.runKernel(Sg,s,r)}const Td=K({argMax_:v6});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w6(t,e=0){const s={x:L(t,"x","argMin")},r={axis:e};return V.runKernel(Ig,s,r)}const k6=K({argMin_:w6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C6(t){const n={x:L(t,"x","asin")};return V.runKernel(Jd,n)}const S6=K({asin_:C6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I6(t){const n={x:L(t,"x","asinh")};return V.runKernel(Zd,n)}const $6=K({asinh_:I6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N6(t){const n={x:L(t,"x","atan")};return V.runKernel(eh,n)}const T6=K({atan_:N6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E6(t,e){let n=L(t,"a","atan2"),s=L(e,"b","atan2");[n,s]=Xt(n,s);const r={a:n,b:s};return V.runKernel(nh,r)}const _6=K({atan2_:E6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R6(t){const n={x:L(t,"x","atanh")};return V.runKernel(th,n)}const A6=K({atanh_:R6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gh(t,e,n,s,r="NHWC",i){const o=t[3],a=[...e,o],l=Qi(r);return Tn(t,a,n,i,s,null,null,l)}function gr(t,e,n,s,r,i,o="channelsLast"){const[a,l]=Ed(e);let c;if(o==="channelsLast")c=[a,l,t[3],t[3]];else if(o==="channelsFirst")c=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return Tn(t,c,n,s,r,i,!1,o)}function Yi(t,e,n,s,r,i,o="NDHWC"){const[a,l,c]=n1(e);let u,d;if(o==="NDHWC")d="channelsLast",u=[a,l,c,t[4],t[4]];else if(o==="NCDHW")d="channelsFirst",u=[a,l,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return Zo(t,u,n,s,r,!1,d,i)}function Tn(t,e,n,s,r,i,o=!1,a="channelsLast"){let[l,c,u,d]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,d]=t;else if(a==="channelsFirst")[l,d,c,u]=t;else throw new Error(`Unknown dataFormat ${a}`);const[h,f,,p]=e,[m,g]=Ed(n),[x,b]=Ed(s),v=rc(h,x),w=rc(f,b),{padInfo:C,outHeight:$,outWidth:T}=O6(r,c,u,m,g,v,w,i,a),N=o?p*d:p;let _;return a==="channelsFirst"?_=[l,N,$,T]:a==="channelsLast"&&(_=[l,$,T,N]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:d,outHeight:$,outWidth:T,outChannels:N,padInfo:C,strideHeight:m,strideWidth:g,filterHeight:h,filterWidth:f,effectiveFilterHeight:v,effectiveFilterWidth:w,dilationHeight:x,dilationWidth:b,inShape:t,outShape:_,filterShape:e}}function Zo(t,e,n,s,r,i=!1,o="channelsLast",a){let[l,c,u,d,h]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,c,u,d,h]=t;else if(o==="channelsFirst")[l,h,c,u,d]=t;else throw new Error(`Unknown dataFormat ${o}`);const[f,p,m,,g]=e,[x,b,v]=n1(n),[w,C,$]=n1(s),T=rc(f,w),N=rc(p,C),_=rc(m,$),{padInfo:A,outDepth:O,outHeight:W,outWidth:G}=P6(r,c,u,d,x,b,v,T,N,_,a),q=i?g*h:g;let U;return o==="channelsFirst"?U=[l,q,O,W,G]:o==="channelsLast"&&(U=[l,O,W,G,q]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:u,inWidth:d,inChannels:h,outDepth:O,outHeight:W,outWidth:G,outChannels:q,padInfo:A,strideDepth:x,strideHeight:b,strideWidth:v,filterDepth:f,filterHeight:p,filterWidth:m,effectiveFilterDepth:T,effectiveFilterHeight:N,effectiveFilterWidth:_,dilationDepth:w,dilationHeight:C,dilationWidth:$,inShape:t,outShape:U,filterShape:e}}function D6(t,e,n,s,r){s==null&&(s=Fw(t,e,n));const i=t[0],o=t[1],a=_d((i-e+2*s)/n+1,r),l=_d((o-e+2*s)/n+1,r);return[a,l]}function F6(t,e,n,s,r,i){r==null&&(r=Fw(t,e[0],s[0]));const o=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*r>=e[a]&&(o[a]=_d((t[a]-e[a]+2*r)/s[a]+1,i));return o}function Fw(t,e,n,s=1){const r=rc(e,s);return Math.floor((t[0]*(n-1)-n+r)/2)}function Ed(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function n1(t){return typeof t=="number"?[t,t,t]:t}function rc(t,e){return e<=1?t:t+(t-1)*(e-1)}function O6(t,e,n,s,r,i,o,a,l){let c,u,d;if(typeof t=="number"){c={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const f=D6([e,n],i,s,t,a);u=f[0],d=f[1]}else if(t==="same"){u=Math.ceil(e/s),d=Math.ceil(n/r);const h=Math.max(0,(u-1)*s+i-e),f=Math.max(0,(d-1)*r+o-n),p=Math.floor(h/2),m=h-p,g=Math.floor(f/2),x=f-g;c={top:p,bottom:m,left:g,right:x,type:"SAME"}}else if(t==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-i+1)/s),d=Math.ceil((n-o+1)/r);else if(typeof t=="object"){const h=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],p=l==="channelsLast"?t[2][0]:t[3][0],m=l==="channelsLast"?t[2][1]:t[3][1];c={top:h,bottom:f,left:p,right:m,type:h===0&&f===0&&p===0&&m===0?"VALID":"EXPLICIT"},u=_d((e-i+h+f)/s+1,a),d=_d((n-o+p+m)/r+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:c,outHeight:u,outWidth:d}}function P6(t,e,n,s,r,i,o,a,l,c,u){let d,h,f,p;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const g=F6([e,n,s,1],[a,l,c],1,[r,i,o],t,u);h=g[0],f=g[1],p=g[2]}else if(t==="same"){h=Math.ceil(e/r),f=Math.ceil(n/i),p=Math.ceil(s/o);const m=(h-1)*r+a-e,g=(f-1)*i+l-n,x=(p-1)*o+c-s,b=Math.floor(m/2),v=m-b,w=Math.floor(g/2),C=g-w,$=Math.floor(x/2),T=x-$;d={top:w,bottom:C,left:$,right:T,front:b,back:v,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:h,outHeight:f,outWidth:p}}function _d(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function Qa(t){const[e,n,s]=Ed(t);return e===1&&n===1&&s===1}function zn(t,e){return Qa(t)||Qa(e)}function Ja(t){return Ed(t).every(e=>e>0)}function Qi(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function hs(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")R(xc(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{R(xc(r),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${r}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L6(t,e){const s={x:L(t,"x","reshape","string_or_numeric")},r={shape:e};return V.runKernel(ux,s,r)}const H=K({reshape_:L6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M6(t,e,n,s,r){const i=L(t,"x","avgPool","float32"),o=1;R(zn(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let a=i,l=!1;i.rank===3&&(l=!0,a=H(i,[1,i.shape[0],i.shape[1],i.shape[2]])),R(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),hs("avgPool",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r};let d=V.runKernel($g,c,u);return d=Se(d,i.dtype),l?H(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Ow=K({avgPool_:M6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z6(t,e,n,s,r,i="NDHWC"){const o=L(t,"x","avgPool3d","float32");let a=o,l=!1;o.rank===4&&(l=!0,a=H(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),R(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),R(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),R(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),hs("avgPool3d",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:i};let d=V.runKernel(Ng,c,u);return d=Se(d,a.dtype),l?H(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const B6=K({avgPool3d_:z6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W6(t,e=0){R(t.length>=1,()=>"Pass at least one tensor to concat");const n=TA(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),n.length===1)return Pa(n[0]);const s=n,r={axis:e};return V.runKernel(Rg,s,r)}const as=K({concat_:W6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j6(t,e,n=!1,s=!1){let r=L(t,"a","matMul"),i=L(e,"b","matMul");[r,i]=Xt(r,i);const o={a:r,b:i},a={transposeA:n,transposeB:s};return V.runKernel(Tg,o,a)}const dt=K({matMul_:j6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V6(t){const n={x:L(t,"x","sigmoid","float32")};return V.runKernel(Ph,n)}const Wc=K({sigmoid_:V6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U6(t,e,n){const s=L(t,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},i={begin:e,size:n};return V.runKernel(mx,r,i)}const kt=K({slice_:U6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G6(t){const n={x:L(t,"x","tanh","float32")};return V.runKernel(jh,n)}const $x=K({tanh_:G6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H6(t,e,n){const s=L(t,"x","batchToSpaceND"),r=e.reduce((a,l)=>a*l);R(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),R(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),R(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const i={x:s},o={blockShape:e,crops:n};return V.runKernel(Eg,i,o)}const Pw=K({batchToSpaceND_:H6});function K6(t){let e;return t.rank===0||t.rank===1?e=H(t,[1,1,1,t.size]):t.rank===2?e=H(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=H(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X6(t,e,n,s,r,i){i==null&&(i=.001);const o=L(t,"x","batchNorm"),a=L(e,"mean","batchNorm"),l=L(n,"variance","batchNorm");let c;r!=null&&(c=L(r,"scale","batchNorm"));let u;s!=null&&(u=L(s,"offset","batchNorm")),R(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),R(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),R(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:K6(o),scale:c,offset:u,mean:a,variance:l},f={varianceEpsilon:i},p=V.runKernel(Bg,h,f);return H(p,o.shape)}const Nx=K({batchNorm_:X6});function q6(t,e,n,s,r,i){const o=L(t,"x","batchNorm"),a=L(e,"mean","batchNorm"),l=L(n,"variance","batchNorm");let c;r!=null&&(c=L(r,"scale","batchNorm"));let u;return s!=null&&(u=L(s,"offset","batchNorm")),R(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),R(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),R(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&R(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&R(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),Nx(o,a,l,u,c,i)}const Y6=K({batchNorm2d_:q6});function Q6(t,e,n,s,r,i){const o=L(t,"x","batchNorm"),a=L(e,"mean","batchNorm"),l=L(n,"variance","batchNorm");let c;r!=null&&(c=L(r,"scale","batchNorm"));let u;return s!=null&&(u=L(s,"offset","batchNorm")),R(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),R(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),R(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&R(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&R(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),Nx(o,a,l,u,c,i)}const J6=K({batchNorm3d_:Q6});function Z6(t,e,n,s,r,i){const o=L(t,"x","batchNorm"),a=L(e,"mean","batchNorm"),l=L(n,"variance","batchNorm");let c;r!=null&&(c=L(r,"scale","batchNorm"));let u;return s!=null&&(u=L(s,"offset","batchNorm")),R(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),R(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),R(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&R(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&R(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),Nx(o,a,l,u,c,i)}const e8=K({batchNorm4d_:Z6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t8(t,e,n){const s=L(t,"x","bincount"),r=L(e,"weights","bincount");R(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),R(n>=0,()=>`size must be non-negative, but got ${n}.`),R(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const i={x:s,weights:r},o={size:n};return V.runKernel(qv,i,o)}const n8=K({bincount_:t8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s8(t,e){let n=L(t,"broadcastTo","x");const s=n.shape;if(qi(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const c=n.shape.slice();for(;c.length<e.length;)c.unshift(1);n=H(n,c)}const r=n.shape,i=Array.from(e);for(let c=e.length-1;c>=0;c--)if(r[c]===e[c])i[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(i.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return Pa(n);const a={x:n},l={reps:i};return V.runKernel(Vh,a,l)}const td=K({broadcastTo_:s8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r8(t){const n={x:L(t,"x","ceil","float32")};return V.runKernel(rh,n)}const i8=K({ceil_:r8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tx(t,e,n){qi(t),n=n||Lc(e);const s={shape:t,value:e,dtype:n};return V.runKernel(uw,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o8(t,e,n){const s=L(t,"x","clipByValue");if(R(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Tx(s.shape,e,s.dtype);const r={x:s},i={clipValueMin:e,clipValueMax:n};return V.runKernel(ih,r,i)}const Vs=K({clipByValue_:o8});function a8(t){return as(t,0)}const l8=K({concat1d_:a8});function c8(t,e){return as(t,e)}const u8=K({concat2d_:c8});function d8(t,e){return as(t,e)}const h8=K({concat3d_:d8});function f8(t,e){return as(t,e)}const p8=K({concat4d_:f8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m8(t,e,n,s,r="NHWC",i=[1,1],o){const a=L(t,"x","conv2d","float32"),l=L(e,"filter","conv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=H(a,[1,a.shape[0],a.shape[1],a.shape[2]])),R(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),R(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),hs("conv2d",s,o);const d=r==="NHWC"?c.shape[3]:c.shape[1];R(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),R(zn(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),R(Ja(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),R(Ja(n),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o},p=V.runKernel(Ag,h,f);return u?H(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Za=K({conv2d_:m8});function g8(t,e,n,s,r="NWC",i=1,o){const a=L(t,"x","conv1d"),l=L(e,"filter","conv1d");let c=a,u=!1;a.rank===2&&(u=!0,c=H(a,[1,a.shape[0],a.shape[1]])),R(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),R(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),hs("conv1d",s,o),R(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),R(zn(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),R(Ja(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),R(Ja(n),()=>"Error in conv1D: Stride should be larger than 0."),R(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const d=H(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=H(c,[c.shape[0],1,c.shape[1],c.shape[2]]),g=Za(h,d,[1,n],s,"NHWC",[1,i],o);return u?H(g,[g.shape[2],g.shape[3]]):H(g,[g.shape[0],g.shape[2],g.shape[3]])}const BA=K({conv1d_:g8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x8(t,e,n,s,r,i="NHWC",o){R(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,c=!1;e.rank===3&&(c=!0,l=H(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),R(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),R(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),R(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const u=i==="NHWC"?a[3]:a[1],d=i==="NHWC"?l.shape[3]:l.shape[1];R(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),R(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),hs("conv2dDerInput",r,o);const h={dy:l,filter:n},f={strides:s,pad:r,dataFormat:i,dimRoundingMode:o,inputShape:a},p=V.runKernel(Dg,h,f);return c?H(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Lw=K({conv2DBackpropInput_:x8});function y8(t,e,n,s,r,i){const o=L(t,"x","conv2dTranspose"),a=L(e,"filter","conv2dTranspose");return Lw(n,o,a,s,r,"NHWC",i)}const WA=K({conv2dTranspose_:y8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b8(t,e,n,s,r="NDHWC",i=[1,1,1]){const o=L(t,"x","conv3d"),a=L(e,"filter","conv3d");let l=o,c=!1;o.rank===4&&(c=!0,l=H(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),R(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),R(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),R(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),R(zn(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),R(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),R(Ja(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),R(Ja(n),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:l,filter:a},d={strides:n,pad:s,dataFormat:r,dilations:i},h=V.runKernel(Fg,u,d);return c?H(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const v8=K({conv3d_:b8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w8(t,e,n,s,r){R(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,o=e,a=!1;e.rank===4&&(a=!0,o=H(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,t[0],t[1],t[2],t[3]]);const l=i[4],c=o.shape[4];R(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),R(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),R(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),R(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),R(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const u={dy:o,filter:n},d={pad:r,strides:s,inputShape:i},h=V.runKernel(ew,u,d);return a?H(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const jA=K({conv3DBackpropInput_:w8});function k8(t,e,n,s,r){const i=L(t,"x","conv3dTranspose"),o=L(e,"filter","conv3dTranspose");return jA(n,i,o,s,r)}const C8=K({conv3dTranspose_:k8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S8(t){const n={x:L(t,"x","cos","float32")};return V.runKernel(oh,n)}const Mw=K({cos_:S8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I8(t){const n={x:L(t,"x","cosh","float32")};return V.runKernel(ah,n)}const VA=K({cosh_:I8});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $8(t,e=0,n=!1,s=!1){const i={x:L(t,"x","cumprod")},o={axis:e,exclusive:n,reverse:s};return V.runKernel(tw,i,o)}const s1=K({cumprod_:$8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N8(t,e=0,n=!1,s=!1){const i={x:L(t,"x","cumsum")},o={axis:e,exclusive:n,reverse:s};return V.runKernel(Og,i,o)}const UA=K({cumsum_:N8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T8(t,e,n,s=!1){const r=L(t,"x","denseBincount"),i=L(e,"weights","denseBincount");R(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),R(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),R(n>=0,()=>`size must be non-negative, but got ${n}.`),R(i.size===r.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${i.shape}.`);const o={x:r,weights:i},a={size:n,binaryOutput:s};return V.runKernel(sw,o,a)}const I$=K({denseBincount_:T8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E8(t,e,n="NHWC"){const s=L(t,"x","depthToSpace","float32"),r=n==="NHWC"?s.shape[1]:s.shape[2],i=n==="NHWC"?s.shape[2]:s.shape[3],o=n==="NHWC"?s.shape[3]:s.shape[1];R(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),R(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),R(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${s.shape}`),R(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${s.shape}`);const a={x:s},l={blockSize:e,dataFormat:n};return V.runKernel(rw,a,l)}const _8=K({depthToSpace_:E8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R8(t,e,n,s,r="NHWC",i=[1,1],o){const a=L(t,"x","depthwiseConv2d","float32"),l=L(e,"filter","depthwiseConv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=H(a,[1,a.shape[0],a.shape[1],a.shape[2]])),R(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),R(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=r==="NHWC"?c.shape[3]:c.shape[1];R(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),hs("depthwiseConv2d",s,o);const h={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o},p=V.runKernel(Pg,h,f);return u?H(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const zw=K({depthwiseConv2d_:R8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A8(t,e,n,s,r=[1,1],i="NHWC"){const o=L(t,"x","dilation2d"),a=L(e,"filter","dilation2d");R(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),R(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),R(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=o,c=!1;o.rank===3&&(l=H(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),R(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const u={x:l,filter:a},d={strides:n,pad:s,dilations:r},h=V.runKernel(Lg,u,d);return c?H(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const D8=K({dilation2d_:A8});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wc(t,e){const n=t.length,s=[];for(let r=0;r<n;r++){const i=n-1-r,o=t[i]||1;(e[e.length-1-r]||1)>1&&o===1&&s.unshift(i)}return s}function pn(t,e){const n=[];for(let s=0;s<e.length;s++){const r=t[t.length-s-1],i=e.length-s-1,o=e[i];(r==null||r===1&&o>1)&&n.unshift(i)}return n}function He(t,e){const n=Math.max(t.length,e.length),s=new Array(n);for(let r=0;r<n;r++){let i=t[t.length-r-1];i==null&&(i=1);let o=e[e.length-r-1];if(o==null&&(o=1),i===1)s[n-r-1]=o;else if(o===1)s[n-r-1]=i;else if(i!==o){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else s[n-r-1]=i}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F8(t,e){let n=L(t,"a","equal","string_or_numeric"),s=L(e,"b","equal","string_or_numeric");[n,s]=Xt(n,s),He(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Mg,r)}const bi=K({equal_:F8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O8(t,e,n){const s=L(e,"a","where"),r=L(n,"b","where"),i=L(t,"condition","where","bool"),o=He(He(i.shape,s.shape),r.shape),a=td(i,o),l=td(s,o),c=td(r,o),u={condition:a,t:l,e:c};return V.runKernel(px,u)}const Yn=K({where_:O8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P8(t){const n={x:L(t,"x","zerosLike")};return V.runKernel(kx,n)}const it=K({zerosLike_:P8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L8(t,e){let n=L(t,"a","div"),s=L(e,"b","div");[n,s]=Xt(n,s);const r=Me(n,s),i=it(r),o=bi(s,i);return Yn(o,i,r)}const M8=K({divNoNan_:L8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z8(t,e){const n=L(t,"t1","dot"),s=L(e,"t2","dot");R((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const r=n.rank===1?n.size:n.shape[1],i=s.rank===1?s.size:s.shape[0];if(R(r===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${i}.`),n.rank===1&&s.rank===1){const o=H(n,[1,-1]),a=H(s,[-1,1]),l=dt(o,a);return H(l,[])}else if(n.rank===1&&s.rank===2){const o=H(n,[1,-1]),a=H(s,[s.shape[0],s.shape[1]]),l=dt(o,a);return H(l,[l.size])}else if(n.rank===2&&s.rank===1){const o=H(s,[-1,1]),a=dt(n,o);return H(a,[a.size])}else{const o=H(s,[s.shape[0],s.shape[1]]);return dt(n,o)}}const B8=K({dot_:z8});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W8(t,...e){const n=e.map((r,i)=>L(r,`tensors${i}`,"einsum")),s={equation:t};return V.runKernel(aw,n,s)}const Su=K({einsum_:W8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j8(t){const n={x:L(t,"x","elu","float32")};return V.runKernel(ch,n)}const Ex=K({elu_:j8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V8(t){let e=L(t,"x","erf");R(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=Se(e,"float32"));const n={x:e};return V.runKernel(uh,n)}const GA=K({erf_:V8});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bw(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function HA(t,e,n){const s=t.length+e.length,r=[];let i=0,o=0;for(let a=0;a<s;a++)n.indexOf(a)===-1?r.push(t[i++]):r.push(e[o++]);return r}function kn(t,e){const n=[],s=t.length;for(let i=0;i<s;i++)e.indexOf(i)===-1&&n.push(t[i]);const r=e.map(i=>t[i]);return[n,r]}function rn(t,e){const n=e.map(s=>1);return HA(t,n,e)}function En(t,e,n){R(Bw(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function Wt(t,e){if(Bw(t,e))return null;const n=[];for(let s=0;s<e;++s)t.indexOf(s)===-1&&n.push(s);return t.forEach(s=>n.push(s)),n}function ea(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function qt(t,e){const n=[];for(let s=e-t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U8(t,e=null,n=!1){const r={x:L(t,"x","max")},i={reductionIndices:e,keepDims:n};return V.runKernel(Yg,r,i)}const Or=K({max_:U8});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G8(t,e=null,n=!1){const r={x:L(t,"x","min")},i={axis:e,keepDims:n};return V.runKernel(ex,r,i)}const Sm=K({min_:G8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H8(t,e){let n=L(t,"base","pow"),s=L(e,"exp","pow");[n,s]=Xt(n,s);const r={a:n,b:s};return V.runKernel($h,r)}const el=K({pow_:H8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ht(t,e){if((pr(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&pr(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Ix(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K8(t){const n={x:L(t,"x","sqrt","float32")};return V.runKernel(Mh,n)}const Mn=K({sqrt_:K8});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X8(t){const e=L(t,"x","square"),n={};return V.runKernel("Square",{x:e},n)}const Nt=K({square_:X8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q8(t,e=null,n=!1){let s=L(t,"x","sum");s.dtype==="bool"&&(s=Se(s,"int32"));const r={x:s},i={axis:e,keepDims:n};return V.runKernel(gx,r,i)}const Pe=K({sum_:q8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y8(t,e="euclidean",n=null,s=!1){t=L(t,"x","norm");const r=KA(t,e,n);let i=r.shape;if(s){const o=Qe(n,t.shape);i=rn(r.shape,o)}return H(r,i)}function KA(t,e,n=null){if(t.rank===0)return Gn(t);if(t.rank!==1&&n===null)return KA(H(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return Pe(Gn(t),n);if(e===1/0)return Or(Gn(t),n);if(e===-1/0)return Sm(Gn(t),n);if(e==="euclidean"||e===2)return Mn(Pe(el(Gn(t),ht(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return Or(Pe(Gn(t),n[0]),n[1]-1);if(e===1/0)return Or(Pe(Gn(t),n[1]),n[0]);if(e===-1/0)return Sm(Pe(Gn(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Mn(Pe(Nt(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const _x=K({norm_:Y8});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q8(t,e=null,n=!1){return _x(t,"euclidean",e,n)}const J8=K({euclideanNorm_:Q8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z8(t){const n={x:L(t,"x","exp")};return V.runKernel(dh,n)}const vi=K({exp_:Z8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eK(t,e=0){const n=L(t,"x","expandDims","string_or_numeric");R(e<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},r={dim:e};return V.runKernel(zg,s,r)}const rs=K({expandDims_:eK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tK(t){const n={x:L(t,"x","expm1")};return V.runKernel(hh,n)}const nK=K({expm1_:tK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sK(t,e){const n=L(t,"x","tile","string_or_numeric");R(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const s={x:n},r={reps:e};return V.runKernel(Vh,s,r)}const _r=K({tile_:sK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rK(t,e,n,s="float32"){e==null&&(e=t);const r=Ye([t,e],s),i=t<=e?t:e;for(let a=0;a<i;++a)r.set(1,a,a);const o=H(r.toTensor(),[t,e]);if(n==null)return o;if(n.length===1)return _r(rs(o,0),[n[0],1,1]);if(n.length===2)return _r(rs(rs(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return _r(rs(rs(rs(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const XA=K({eye_:rK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iK(t){const n={x:L(t,"x","floor","float32")};return V.runKernel(fh,n)}const Rx=K({floor_:iK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oK(t,e,n=0,s=0){const r=L(t,"x","gather"),i=L(e,"indices","gather","int32"),o={x:r,indices:i},a={axis:n,batchDims:s};return V.runKernel(Wg,o,a)}const Ww=K({gather_:oK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aK(t,e){let n=L(t,"a","greater","string_or_numeric"),s=L(e,"b","greater","string_or_numeric");[n,s]=Xt(n,s),He(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(jg,r)}const Hs=K({greater_:aK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lK(t,e){let n=L(t,"a","greaterEqual","string_or_numeric"),s=L(e,"b","greaterEqual","string_or_numeric");[n,s]=Xt(n,s),He(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(mh,r)}const pl=K({greaterEqual_:lK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cK(t){const n={input:L(t,"input","imag")};return V.runKernel(fw,n)}const jw=K({imag_:cK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uK(t){const n={x:L(t,"x","isFinite")};return V.runKernel(xh,n)}const dK=K({isFinite_:uK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hK(t){const n={x:L(t,"x","isInf")};return V.runKernel(yh,n)}const fK=K({isInf_:hK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pK(t){const n={x:L(t,"x","isNaN")};return V.runKernel(bh,n)}const mK=K({isNaN_:pK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gK(t,e=.2){const s={x:L(t,"x","leakyRelu")},r={alpha:e};return V.runKernel(Vg,s,r)}const Vw=K({leakyRelu_:gK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xK(t,e){let n=L(t,"a","less","string_or_numeric"),s=L(e,"b","less","string_or_numeric");[n,s]=Xt(n,s),He(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Ug,r)}const Im=K({less_:xK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yK(t,e){let n=L(t,"a","lessEqual","string_or_numeric"),s=L(e,"b","lessEqual","string_or_numeric");[n,s]=Xt(n,s),He(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Gg,r)}const jc=K({lessEqual_:yK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bK(t,e=5,n=1,s=1,r=.5){const i=L(t,"x","localResponseNormalization");R(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),R(xc(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=i,a=!1;i.rank===3&&(a=!0,o=H(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:o},c={depthRadius:e,bias:n,alpha:s,beta:r},u=V.runKernel(qg,l,c);return a?H(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const vK=K({localResponseNormalization_:bK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wK(t){const n={x:L(t,"x","log","float32")};return V.runKernel(vh,n)}const wi=K({log_:wK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kK(t){const n={x:L(t,"x","log1p")};return V.runKernel(wh,n)}const qA=K({log1p_:kK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CK(t,e){R(Wb(t),()=>"The f passed in variableGrads(f) must be a function"),R(e==null||Array.isArray(e)&&e.every(c=>c instanceof Cm),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const c in V.registeredVariables)e.push(V.registeredVariables[c])}const s=n?e.filter(c=>!c.trainable):null,r=e.length;e=e.filter(c=>c.trainable),R(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const i=!0,{value:o,grads:a}=V.gradients(t,e,null,i);R(a.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),R(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return e.forEach((c,u)=>{a[u]!=null&&(l[c.name]=a[u])}),s!=null&&s.forEach(c=>l[c.name]=null),{value:o,grads:l}}function kc(t){return V.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SK(t){const n={x:L(t,"x","neg")};return V.runKernel(nx,n)}const Kt=K({neg_:SK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IK(t){const n={x:L(t,"x","softplus")};return V.runKernel(Lh,n)}const Hh=K({softplus_:IK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $K(t){const e=L(t,"x","logSigmoid");return kc(s=>({value:Kt(Hh(Kt(s))),gradFunc:o=>B(o,Wc(Kt(s)))}))(e)}const NK=K({logSigmoid_:$K});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TK(t,e){let n=L(t,"a","sub"),s=L(e,"b","sub");[n,s]=Xt(n,s);const r={a:n,b:s};return V.runKernel(Bh,r)}const ze=K({sub_:TK});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EK(t,e=-1){const n=L(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return kc((r,i)=>{const a=Or(r,e,!0),l=ze(r,a),c=ze(Se(l,"float32"),wi(Pe(vi(l),e,!0)));return i([c]),{value:c,gradFunc:(d,h)=>{const[f]=h,p=!0,m=vi(f);return ze(d,B(Pe(d,e,p),m))}}})(n)}const YA=K({logSoftmax_:EK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _K(t,e=null,n=!1){const s=L(t,"x","logSumExp"),r=Qe(e,s.shape),i=Or(s,r,!0),o=ze(s,i),a=vi(o),l=Pe(a,r),c=wi(l),u=xe(H(i,c.shape),c);if(n){const d=rn(u.shape,r);return H(u,d)}return u}const QA=K({logSumExp_:_K});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RK(t,e){const n=L(t,"a","logicalAnd","bool"),s=L(e,"b","logicalAnd","bool");He(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Hg,r)}const Ui=K({logicalAnd_:RK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AK(t){const n={x:L(t,"x","logicalNot","bool")};return V.runKernel(Kg,n)}const Uw=K({logicalNot_:AK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DK(t,e){const n=L(t,"a","logicalOr","bool"),s=L(e,"b","logicalOr","bool");He(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Xg,r)}const JA=K({logicalOr_:DK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FK(t,e){const n=L(t,"a","logicalXor","bool"),s=L(e,"b","logicalXor","bool");return He(n.shape,s.shape),Ui(JA(t,e),Uw(Ui(t,e)))}const OK=K({logicalXor_:FK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PK(t,e,n,s,r){const i=L(t,"x","maxPool"),o=1;let a=i,l=!1;i.rank===3&&(l=!0,a=H(i,[1,i.shape[0],i.shape[1],i.shape[2]])),R(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),R(zn(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),hs("maxPool",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r},d=V.runKernel(Qg,c,u);return l?H(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Gw=K({maxPool_:PK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LK(t,e=[1,1,1],n,s,r,i="NDHWC"){const o=L(t,"x","maxPool3d");let a=o,l=!1;o.rank===4&&(l=!0,a=H(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),R(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),R(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),hs("maxPool3d",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:i},d=V.runKernel(Jg,c,u);return l?H(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const MK=K({maxPool3d_:LK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zK(t,e){let n=L(t,"a","maximum"),s=L(e,"b","maximum");[n,s]=Xt(n,s),n.dtype==="bool"&&(n=Se(n,"int32"),s=Se(s,"int32")),He(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(kh,r)}const ta=K({maximum_:zK});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BK(t,e=null,n=!1){const r={x:L(t,"x","mean")},i={axis:e,keepDims:n};return V.runKernel(Zg,r,i)}const en=K({mean_:BK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bn(t,e="float32"){if(qi(t),e==="complex64"){const s=bn(t,"float32"),r=bn(t,"float32");return vc(s,r)}const n=Ln(re(t),e);return V.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function na(t,e="float32"){if(qi(t),e==="complex64"){const s=na(t,"float32"),r=bn(t,"float32");return vc(s,r)}const n=Wv(re(t),e);return V.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WK(t,e){let n=L(t,"a","minimum"),s=L(e,"b","minimum");[n,s]=Xt(n,s),n.dtype==="bool"&&(n=Se(n,"int32"),s=Se(s,"int32")),He(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Ch,r)}const Rd=K({minimum_:WK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jK(t,e,n){R(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=L(t,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");R(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=n==="reflect"?1:0;for(let a=0;a<s.rank;a++)R(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),R(e[a][0]>=0&&e[a][0]<=s.shape[a]-r&&e[a][1]>=0&&e[a][1]<=s.shape[a]-r,()=>`Padding in dimension ${a} cannot be greater than or equal to ${s.shape[a]-r} or less than 0 for input of shape ${s.shape}`);const i={paddings:e,mode:n},o={x:s};return V.runKernel(tx,o,i)}const VK=K({mirrorPad_:jK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UK(t,e){let n=L(t,"a","mod"),s=L(e,"b","mod");[n,s]=Xt(n,s);const r={a:n,b:s};return V.runKernel(Sh,r)}const GK=K({mod_:UK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HK(t,e=null,n=!1){t=L(t,"x","moments");const s=Qe(e,t.shape),r=en(t,s,n);let i=r.shape;n||(i=rn(r.shape,s));const o=Nt(ze(Se(t,"float32"),H(r,i))),a=en(o,s,n);return{mean:r,variance:a}}const Hw=K({moments_:HK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KK(t,e){let n=L(t,"a","notEqual","string_or_numeric"),s=L(e,"b","notEqual","string_or_numeric");[n,s]=Xt(n,s),He(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(sx,r)}const $m=K({notEqual_:KK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XK(t,e,n=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:L(t,"indices","oneHot","int32")},a={dtype:r,depth:e,onValue:n,offValue:s};return V.runKernel(ix,o,a)}const ZA=K({oneHot_:XK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qK(t){const n={x:L(t,"x","onesLike")};return V.runKernel(rx,n)}const mr=K({onesLike_:qK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YK(t,e,n=0){const s=L(t,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:n},i={x:s};return V.runKernel(ax,i,r)}const Kw=K({pad_:YK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QK(t,e,n){const s=L(t,"x","spaceToBatchND");R(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),R(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),R(s.shape.reduce((o,a,l)=>l>0&&l<=e.length?o&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:o,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},i={blockShape:e,paddings:n};return V.runKernel(xx,r,i)}const Xw=K({spaceToBatchND_:QK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JK(t,e,n,s,r,i,o){r==null&&(r=[1,1]),i==null&&(i=1),s===0&&(s="valid");const a=L(t,"x","maxPool");let l=a,c=!1;a.rank===3&&(c=!0,l=H(a,[1,a.shape[0],a.shape[1],a.shape[2]])),R(zn(i,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${r}'`);const u=gr(l.shape,e,i,r,s),d=[u.dilationHeight,u.dilationWidth];let h;s==="same"?h=e7([u.filterHeight,u.filterWidth],d):h=[[0,0],[0,0]];const f=d[0]===1&&d[1]===1,[p,m]=ZK([u.inHeight,u.inWidth],d,h),g=f?s:"valid",x=f?l:Xw(l,d,p),v=(n==="avg"?()=>Ow(x,e,i,g,o):()=>Gw(x,e,i,g,o))(),w=f?v:Pw(v,d,m);return c?H(w,[w.shape[1],w.shape[2],w.shape[3]]):w}function ZK(t,e,n){const s=n.map(u=>u[0]),r=n.map(u=>u[1]),i=t.concat(s,r),o=e.map((u,d)=>(u-i[d]%u)%u),a=r.map((u,d)=>u+o[d]),l=e.map((u,d)=>[s[d],a[d]]),c=e.map((u,d)=>[0,o[d]]);return[l,c]}function e7(t,e){const s=t.map((o,a)=>o+(o-1)*(e[a]-1)).map(o=>o-1),r=s.map(o=>Math.floor(o/2)),i=s.map((o,a)=>o-r[a]);return s.map((o,a)=>[r[a],i[a]])}const t7=K({pool_:JK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n7(t,e){const n=L(t,"x","prelu"),s=L(e,"alpha","prelu"),r={x:n,alpha:s};return V.runKernel(lx,r)}const qw=K({prelu_:n7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s7(t,e=null,n=!1){let s=L(t,"x","prod");s.dtype==="bool"&&(s=Se(s,"int32"));const r={x:s},i={axis:e,keepDims:n};return V.runKernel(cx,r,i)}const r7=K({prod_:s7});var Yw={exports:{}};Yw.exports;(function(t){(function(e,n,s){function r(l){var c=this,u=a();c.next=function(){var d=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=d|0)},c.c=1,c.s0=u(" "),c.s1=u(" "),c.s2=u(" "),c.s0-=u(l),c.s0<0&&(c.s0+=1),c.s1-=u(l),c.s1<0&&(c.s1+=1),c.s2-=u(l),c.s2<0&&(c.s2+=1),u=null}function i(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function o(l,c){var u=new r(l),d=c&&c.state,h=u.next;return h.int32=function(){return u.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,d&&(typeof d=="object"&&i(d,u),h.state=function(){return i(u,{})}),h}function a(){var l=4022871197,c=function(u){u=String(u);for(var d=0;d<u.length;d++){l+=u.charCodeAt(d);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=o:this.alea=o})(di,t)})(Yw);var i7=Yw.exports,Qw={exports:{}};Qw.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function o(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.xor128=o})(di,t)})(Qw);var o7=Qw.exports,Jw={exports:{}};Jw.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,u==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function o(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.xorwow=o})(di,t)})(Jw);var a7=Jw.exports,Zw={exports:{}};Zw.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var u=l.x,d=l.i,h,f;return h=u[d],h^=h>>>7,f=h^h<<24,h=u[d+1&7],f^=h^h>>>10,h=u[d+3&7],f^=h^h>>>3,h=u[d+4&7],f^=h^h<<7,h=u[d+7&7],h=h^h<<13,f^=h^h<<9,u[d]=f,l.i=d+1&7,f};function c(u,d){var h,f=[];if(d===(d|0))f[0]=d;else for(d=""+d,h=0;h<d.length;++h)f[h&7]=f[h&7]<<15^d.charCodeAt(h)+f[h+1&7]<<13;for(;f.length<8;)f.push(0);for(h=0;h<8&&f[h]===0;++h);for(h==8?f[7]=-1:f[h],u.x=f,u.i=0,h=256;h>0;--h)u.next()}c(l,a)}function i(a,l){return l.x=a.x.slice(),l.i=a.i,l}function o(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(u.x&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.xorshift7=o})(di,t)})(Zw);var l7=Zw.exports,ek={exports:{}};ek.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var u=l.w,d=l.X,h=l.i,f,p;return l.w=u=u+1640531527|0,p=d[h+34&127],f=d[h=h+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=d[h]=p^f,l.i=h,p+(u^u>>>16)|0};function c(u,d){var h,f,p,m,g,x=[],b=128;for(d===(d|0)?(f=d,d=null):(d=d+"\0",f=0,b=Math.max(b,d.length)),p=0,m=-32;m<b;++m)d&&(f^=d.charCodeAt((m+32)%d.length)),m===0&&(g=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,m>=0&&(g=g+1640531527|0,h=x[m&127]^=f+g,p=h==0?p+1:0);for(p>=128&&(x[(d&&d.length||0)&127]=-1),p=127,m=4*128;m>0;--m)f=x[p+34&127],h=x[p=p+1&127],f^=f<<13,h^=h<<17,f^=f>>>15,h^=h>>>12,x[p]=f^h;u.w=g,u.X=x,u.i=p}c(l,a)}function i(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function o(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(u.X&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.xor4096=o})(di,t)})(ek);var c7=ek.exports,tk={exports:{}};tk.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.next=function(){var d=l.b,h=l.c,f=l.d,p=l.a;return d=d<<25^d>>>7^h,h=h-f|0,f=f<<24^f>>>8^p,p=p-d|0,l.b=d=d<<20^d>>>12^h,l.c=h=h-f|0,l.d=f<<16^h>>>16^p,l.a=p-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):c+=a;for(var u=0;u<c.length+20;u++)l.b^=c.charCodeAt(u)|0,l.next()}function i(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function o(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.tychei=o})(di,t)})(tk);var u7=tk.exports,eD={exports:{}};const d7={},h7=Object.freeze(Object.defineProperty({__proto__:null,default:d7},Symbol.toStringTag,{value:"Module"})),f7=h3(h7);(function(t){(function(e,n,s){var r=256,i=6,o=52,a="random",l=s.pow(r,i),c=s.pow(2,o),u=c*2,d=r-1,h;function f(w,C,$){var T=[];C=C==!0?{entropy:!0}:C||{};var N=x(g(C.entropy?[w,v(n)]:w??b(),3),T),_=new p(T),A=function(){for(var O=_.g(i),W=l,G=0;O<c;)O=(O+G)*r,W*=r,G=_.g(1);for(;O>=u;)O/=2,W/=2,G>>>=1;return(O+G)/W};return A.int32=function(){return _.g(4)|0},A.quick=function(){return _.g(4)/4294967296},A.double=A,x(v(_.S),n),(C.pass||$||function(O,W,G,q){return q&&(q.S&&m(q,_),O.state=function(){return m(_,{})}),G?(s[a]=O,W):O})(A,N,"global"in C?C.global:this==s,C.state)}function p(w){var C,$=w.length,T=this,N=0,_=T.i=T.j=0,A=T.S=[];for($||(w=[$++]);N<r;)A[N]=N++;for(N=0;N<r;N++)A[N]=A[_=d&_+w[N%$]+(C=A[N])],A[_]=C;(T.g=function(O){for(var W,G=0,q=T.i,U=T.j,Y=T.S;O--;)W=Y[q=d&q+1],G=G*r+Y[d&(Y[q]=Y[U=d&U+W])+(Y[U]=W)];return T.i=q,T.j=U,G})(r)}function m(w,C){return C.i=w.i,C.j=w.j,C.S=w.S.slice(),C}function g(w,C){var $=[],T=typeof w,N;if(C&&T=="object")for(N in w)try{$.push(g(w[N],C-1))}catch{}return $.length?$:T=="string"?w:w+"\0"}function x(w,C){for(var $=w+"",T,N=0;N<$.length;)C[d&N]=d&(T^=C[d&N]*19)+$.charCodeAt(N++);return v(C)}function b(){try{var w;return h&&(w=h.randomBytes)?w=w(r):(w=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(w)),v(w)}catch{var C=e.navigator,$=C&&C.plugins;return[+new Date,e,$,e.screen,v(n)]}}function v(w){return String.fromCharCode.apply(0,w)}if(x(s.random(),n),t.exports){t.exports=f;try{h=f7}catch{}}else s["seed"+a]=f})(typeof self<"u"?self:di,[],Math)})(eD);var p7=eD.exports,m7=i7,g7=o7,x7=a7,y7=l7,b7=c7,v7=u7,ml=p7;ml.alea=m7;ml.xor128=g7;ml.xorwow=x7;ml.xorshift7=y7;ml.xor4096=b7;ml.tychei=v7;var nk=ml;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tD{constructor(e,n,s,r,i){this.mean=e,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=i||Math.random();this.random=nk.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,n,s=!1;for(;!s;){let r,i,o;do r=2*this.random()-1,i=2*this.random()-1,o=r*r+i*i;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*r*a,n=this.mean+this.stdDev*i*a,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class w7{constructor(e=0,n=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=nk.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k7(t,e=0,n=1,s,r){if(qi(t),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const i=new tD(e,n,s,!1,r),o=Ye(t,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const C7=K({randomNormal_:k7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S7(t,e=0,n=1,s="float32",r){qi(t);const i=Ye(t,s),o=new w7(e,n,null,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const Kh=K({randomUniform_:S7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ad(t,e,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const r={start:t,stop:e,step:n,dtype:s};return V.runKernel(vw,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I7(t){const n={input:L(t,"input","real")};return V.runKernel(ww,n)}const Nm=K({real_:I7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $7(t){const n={x:L(t,"x","reciprocal")};return V.runKernel(Nh,n)}const N7=K({reciprocal_:$7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T7(t){const n={x:L(t,"x","relu")};return V.runKernel(Th,n)}const gl=K({relu_:T7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E7(t){const n={x:L(t,"x","relu6")};return V.runKernel(Eh,n)}const nD=K({relu6_:E7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _7(t,e){const s={x:L(t,"x","reverse")},r={dims:e};return V.runKernel(fx,s,r)}const tl=K({reverse_:_7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R7(t){const n={x:L(t,"x","round")};return V.runKernel(_h,n)}const sD=K({round_:R7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A7(t){const n={x:L(t,"x","rsqrt","float32")};return V.runKernel(Rh,n)}const rD=K({rsqrt_:A7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D7(t){const n={x:L(t,"x","selu")};return V.runKernel(Ah,n)}const iD=K({selu_:D7});function F7(t,e,n,s,r,i=[1,1],o="NHWC"){const a=L(t,"x","separableConv2d"),l=L(e,"depthwiseFilter","separableConv2d"),c=L(n,"pointwiseFilter","separableConv2d");let u=a,d=!1;if(a.rank===3&&(d=!0,u=H(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");R(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),R(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),R(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),R(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),R(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const h=l.shape[2],f=l.shape[3];R(c.shape[2]===h*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*f}, but got ${c.shape[2]}.`);const p=zw(u,l,s,r,o,i),g=Za(p,c,1,"valid",o);return d?H(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const oD=K({separableConv2d_:F7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O7(t){const n={x:L(t,"x","sign")};return V.runKernel(Oh,n)}const P7=K({sign_:O7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L7(t){const n={x:L(t,"x","sin","float32")};return V.runKernel(Dh,n)}const aD=K({sin_:L7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M7(t){const n={x:L(t,"x","sinh")};return V.runKernel(Fh,n)}const lD=K({sinh_:M7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z7(t,e,n){const s=L(t,"x","slice1d");return R(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),kt(s,[e],[n])}const sk=K({slice1d_:z7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B7(t,e,n){const s=L(t,"x","slice2d");return R(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),kt(s,e,n)}const cD=K({slice2d_:B7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W7(t,e,n){const s=L(t,"x","slice3d");return R(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),kt(s,e,n)}const rk=K({slice3d_:W7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j7(t,e,n){const s=L(t,"x","slice4d");return R(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),kt(s,e,n)}const Tm=K({slice4d_:j7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V7(t,e=-1){const n=L(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const s={logits:n},r={dim:e};return V.runKernel(bx,s,r)}const ik=K({softmax_:V7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U7(t){R(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return V.runKernel(cw,e)}const uD=K({fft_:U7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G7(t){R(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return V.runKernel(hw,e)}const r1=K({ifft_:G7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H7(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const r=H(t,[n,e]);s=r1(r)}else{const r=[n,2*(e-1)],i=H(Nm(t),[n,e]),o=H(jw(t),[n,e]),a=tl(kt(i,[0,1],[n,e-2]),1),l=B(tl(kt(o,[0,1],[n,e-2]),1),ht(-1)),c=as([i,a],1),u=as([o,l],1),d=H(vc(c,u),[r[0],r[1]]);s=r1(d)}if(s=Nm(s),t.rank===3&&t.shape[0]!==0){const r=s,i=t.shape[0];s=H(s,[i,s.shape[0]/i,s.shape[1]]),r.dispose()}return s}const K7=K({irfft_:H7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X7(t,e,n=0){const r={x:L(t,"x","split")},i={numOrSizeSplits:e,axis:n};return V.runKernel(yx,r,i)}const Ws=K({split_:X7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q7(t,e){R(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const s=t.size/n;let r;if(e!=null&&e<n){const p=t.shape.map(g=>0),m=t.shape.map(g=>g);m[t.shape.length-1]=e,r=kt(t,p,m),n=e}else if(e!=null&&e>n){const p=t.shape.map(m=>m);p[t.shape.length-1]=e-n,r=as([t,bn(p)],t.shape.length-1),n=e}else r=t;const i=it(r),o=H(vc(r,i),[s,n]),a=uD(o),l=Math.floor(n/2)+1,c=Nm(a),u=jw(a),d=Ws(c,[l,n-l],c.shape.length-1),h=Ws(u,[l,n-l],u.shape.length-1),f=r.shape.slice();return f[r.shape.length-1]=l,H(vc(d[0],h[0]),f)}const Y7=K({rfft_:q7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q7(t,e){let n=L(t,"a","squaredDifference"),s=L(e,"b","squaredDifference");[n,s]=Xt(n,s),He(n.shape,s.shape);const r={a:n,b:s},i={};return V.runKernel(zh,r,i)}const J7=K({squaredDifference_:Q7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z7(t,e){const n=L(t,"x","squeeze","string_or_numeric");return H(n,Qo(n.shape,e).newShape)}const Xh=K({squeeze_:Z7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e9(t,e=0){const n=TA(t,"tensors","stack","string_or_numeric");R(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&R(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,r={axis:e};return V.runKernel(ox,s,r)}const Gi=K({stack_:e9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t9(t,e=0){const s={x:L(t,"x","step")},r={alpha:e};return V.runKernel(Uh,s,r)}const qh=K({step_:t9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n9(t,e,n,s,r=0,i=0,o=0,a=0,l=0){const u={x:L(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:s,beginMask:r,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};return V.runKernel($w,u,d)}const s9=K({stridedSlice_:n9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r9(t){const n={x:L(t,"x","tan","float32")};return V.runKernel(Wh,n)}const i9=K({tan_:r9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ss(t,e){FR(t);const n=Sx(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Ix(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dy(t,e,n){if(FR(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Sx(t,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Ix(t,e,s,n)}function dD(t,e,n){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${s}, and batchDim: ${r}.`;if(n.rank<r)throw new Error(i+` update.rank < ${r}. `);if(t.length<s+(n.rank-r))throw new Error(i+` Output shape length < ${s+(n.rank-r)}`);if(n.rank!==r+t.length-s)throw new Error(i+` update.rank != ${r+t.length-s}`);for(let o=0;o<r;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-r;++o)if(n.shape[o+r]!==t[o+s])throw new Error(i+` updates.shape[${o+r}] (${n.shape[o+r]}) != shape[${o+r}] (${t[o+r]})`)}function o9(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}dD(n,e,t)}function xl(t,e,n){const s=e.shape.length,r=s>1?e.shape[s-1]:1,i=n.length;let o=1;for(let d=r;d<i;++d)o*=n[d];const a=r<1?1:r,l=re(e.shape)/a,c=[...Fe(n.slice(0,r)),1],u=re(n);return{sliceRank:r,numUpdates:l,sliceSize:o,strides:c,outputSize:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a9(t,e=1,n=!0){const s=L(t,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const i={x:s},o={k:e,sorted:n},[a,l]=V.runKernel(Nw,i,o);return{values:a,indices:l}}const l9=K({topk_:a9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c9(t,e=0,n=1,s,r){if(qi(t),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new tD(e,n,s,!0,r),o=Ye(t,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const hD=K({truncatedNormal_:c9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u9(t,e=0){const n=L(t,"x","unique","string_or_numeric");R(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},r={axis:e},[i,o]=V.runKernel(Ew,s,r);return{values:i,indices:o}}const d9=K({unique_:u9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h9(t,e,n){const s=L(t,"x","unsortedSegmentSum"),r=L(e,"segmentIds","unsortedSegmentSum","int32");R(xc(n),()=>"numSegments must be of dtype int");const i={x:s,segmentIds:r},o={numSegments:n};return V.runKernel(wx,i,o)}const fD=K({unsortedSegmentSum_:h9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f9(t,e=0){const n=L(t,"x","unstack","string_or_numeric");R(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},r={axis:e};return V.runKernel(vx,s,r)}const nl=K({unstack_:f9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p9(t,e=!0,n,s){return V.makeVariable(t,e,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pD(t,e){const n=[];for(let i=0;i<e.length;i++)e[i]&&n.push(i);const s=Ye(t,"int32"),r=Ye([n.length,t.length],"int32");for(let i=0;i<n.length;i++){const o=s.indexToLoc(n[i]),a=i*t.length;r.values.set(o,a)}return r.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m9(t,e,n){const s=L(t,"x","transpose");if(e==null&&(e=s.shape.map((o,a)=>a).reverse()),R(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(o=>{R(o>=0&&o<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},i={perm:e};return s.dtype==="complex64"?Q(()=>{let o=Nm(s),a=jw(s);return o=V.runKernel(sc,{x:o},i),a=V.runKernel(sc,{x:a},i),n&&(a=Kt(a)),vc(o,a)}):V.runKernel(sc,r,i)}const rt=K({transpose_:m9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g9(t,e){if(e==null)return t.shape.slice();if(ft(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let s=0;s<t.shape.length;s++)e[s]==null&&t.shape[s]!=null?n.push(t.shape[s]):n.push(e[s]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x9(t,e,n,s){const r=L(t,"x","dropout");if(R(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),R(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof an?r.clone():r;const i=g9(r,n),o=1-e,a=Me(Rx(xe(Kh(i,0,1,"float32",s),o)),o);return B(r,a)}const y9=K({dropout_:x9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b9(t,e,n,s,r,i="NHWC",o){let a=t;t.rank===3&&(a=H(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=H(e,[1,e.shape[0],e.shape[1],e.shape[2]])),R(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),R(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),R(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=i==="NHWC"?a.shape[3]:a.shape[1],u=i==="NHWC"?l.shape[3]:l.shape[1];R(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),R(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),hs("conv2dDerFilter",r,o);const d={x:a,dy:l},h={strides:s,pad:r,dataFormat:i,dimRoundingMode:o,filterShape:n};return V.runKernel(Jv,d,h)}const ok=K({conv2DBackpropFilter_:b9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ak(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return B(t,qh(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function lk(t,e){let n=e;const s=pn(t.shape,e.shape);return s.length>0&&(n=Pe(n,s)),H(n,t.shape)}function ck(t,e,n,s){if(e==="linear")return t;if(e==="relu")return gl(t);if(e==="elu")return Ex(t);if(e==="relu6")return nD(t);if(e==="prelu")return qw(t,n);if(e==="leakyrelu")return Vw(t,s);if(e==="sigmoid")return Wc(t);throw new Error(`Unknown fused activation ${e}.`)}const uk=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v9({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",uk(V.state.gradientDepth,l)===!1){R(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let $=Za(t,e,n,s,r,i,o);return a!=null&&($=xe($,a)),ck($,l,c,u)}const d=L(t,"x","conv2d","float32"),h=L(e,"filter","conv2d","float32");let f=d,p=!1;d.rank===3&&(p=!0,f=H(d,[1,d.shape[0],d.shape[1],d.shape[2]])),R(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),R(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),hs("fused conv2d",s,o);const m=r==="NHWC"?f.shape[3]:f.shape[1];R(h.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${h.shape[2]}.`),R(zn(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const g=Tn(f.shape,h.shape,n,i,s,o);let x;a!=null&&(x=L(a,"bias","fused conv2d"),[x]=Xt(x,d),r==="NHWC"?He(g.outShape,x.shape):(R(x.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${x.shape.length}.`),R(x.shape.length===0||x.shape[0]===g.outChannels||x.shape[0]===1,()=>`Error in fused conv2d: bias shape (${x.shape}) is not compatible with the number of output channels (${g.outChannels})`)));let b;if(c!=null){const $=c.shape;if(R($.length<=1||$.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${$.length}.`),$.length===1)R($[0]===1||$[0]===g.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${$}) is not compatible with the number of output channels (${g.outChannels}).`);else if($.length===3)try{He($,g.outShape)}catch{const N=`Error in fused conv2d: PReLU activation weights (${$}) is not compatible with the output shape of the conv2d (${g.outShape}).`;throw Error(N)}b=L(c,"prelu weights","fused conv2d")}const v=($,T)=>{R(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[N,_,A,O]=T,W=ak($,A,l);R(Qa(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const G=Lw(_.shape,W,N,n,s),q=ok(_,W,N.shape,n,s),U=[G,q];if(O!=null){const Y=lk(O,W);U.push(Y)}return U},w={x:f,filter:h,bias:x,preluActivationWeights:b},C={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:u};return a==null?kc((T,N,_)=>{let A=V.runKernel(vm,w,C);return _([N,T,A]),p&&(A=H(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:v}})(f,h):kc((T,N,_,A)=>{let O=V.runKernel(vm,w,C);return A([N,T,O,_]),p&&(O=H(O,[O.shape[1],O.shape[2],O.shape[3]])),{value:O,gradFunc:v}})(f,h,x)}const w9=K({fusedConv2d_:v9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k9(t,e,n,s,r,i=[1,1],o){let a=t;t.rank===3&&(a=H(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=H(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:a,dy:l},u={strides:s,pad:r,dimRoundingMode:o,dilations:i,filterShape:n};return V.runKernel(iw,c,u)}const C9=K({depthwiseConv2dNativeBackpropFilter_:k9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S9(t,e,n,s,r,i=[1,1],o){let a=e,l=!1;e.rank===3&&(l=!0,a=H(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:a,filter:n},u={strides:s,pad:r,dimRoundingMode:o,dilations:i,inputShape:t},d=V.runKernel(ow,c,u);return l?H(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const I9=K({depthwiseConv2dNativeBackpropInput_:S9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $9({a:t,b:e,transposeA:n=!1,transposeB:s=!1,bias:r,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(uk(V.state.gradientDepth,i)===!1){let O=dt(t,e,n,s);return r!=null&&(O=xe(O,r)),ck(O,i,o,a)}let l=L(t,"a","fused matMul"),c=L(e,"b","fused matMul");[l,c]=Xt(l,c);const u=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=s?c.shape[c.rank-1]:c.shape[c.rank-2],h=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=s?c.shape[c.rank-2]:c.shape[c.rank-1],p=l.shape.slice(0,-2),m=c.shape.slice(0,-2),g=re(p),x=re(m);R(u===d,()=>`Error in fused matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${s} must match.`);const v=He(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([h,f]),w=n?H(l,[g,u,h]):H(l,[g,h,u]),C=s?H(c,[x,f,d]):H(c,[x,d,f]);let $;r!=null&&($=L(r,"bias","fused matMul"),[$]=Xt($,l),He(v,$.shape));let T;o!=null&&(T=L(o,"prelu weights","fused matMul"));const N=(O,W)=>{const[G,q,U,Y]=W,te=ak(H(O,U.shape),U,i);let M,X;if(!n&&!s?(M=dt(te,q,!1,!0),X=dt(G,te,!0,!1)):!n&&s?(M=dt(te,q,!1,!1),X=dt(te,G,!0,!1)):n&&!s?(M=dt(q,te,!1,!0),X=dt(G,te,!1,!1)):(M=dt(q,te,!0,!0),X=dt(te,G,!0,!0)),r!=null){const Z=lk(Y,te);return[M,X,Z]}else return[M,X]},_={a:w,b:C,bias:$,preluActivationWeights:T},A={transposeA:n,transposeB:s,activation:i,leakyreluAlpha:a};return r==null?kc((W,G,q)=>{const U=V.runKernel(bm,_,A);return q([W,G,U]),{value:H(U,v),gradFunc:N}})(w,C):kc((W,G,q,U)=>{const Y=V.runKernel(bm,_,A);return U([W,G,Y,q]),{value:H(Y,v),gradFunc:N}})(w,C,$)}const $$=K({fusedMatMul_:$9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N9(t,e,n,s,r="bilinear",i=0){const o=L(t,"image","cropAndResize"),a=L(e,"boxes","cropAndResize","float32"),l=L(n,"boxInd","cropAndResize","int32"),c=a.shape[0];R(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),R(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),R(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),R(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),R(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),R(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const u={image:o,boxes:a,boxInd:l},d={method:r,extrapolationValue:i,cropSize:s};return V.runKernel(nw,u,d)}const T9=K({cropAndResize_:N9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E9(t){const e=L(t,"image","flipLeftRight","float32");R(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return V.runKernel(dw,n,{})}const _9=K({flipLeftRight_:E9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R9(t){const e=L(t,"image","grayscaleToRGB"),n=e.rank-1,s=e.shape[n];R(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),R(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,n),r[n]=3,_r(e,r)}const A9=K({grayscaleToRGB_:R9});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D9(t){const e=L(t,"image","RGBToGrayscale"),n=e.rank-1,s=e.shape[n];R(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),R(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=e.dtype,i=Se(e,"float32"),o=Ss([.2989,.587,.114]);let a;switch(e.rank){case 2:a=Su("ij,j->i",i,o);break;case 3:a=Su("ijk,k->ij",i,o);break;case 4:a=Su("ijkl,l->ijk",i,o);break;case 5:a=Su("ijklm,m->ijkl",i,o);break;case 6:a=Su("ijklmn,n->ijklm",i,o);break;default:throw new Error("Not a valid tensor rank.")}return a=rs(a,-1),Se(a,r)}const F9=K({rgbToGrayscale_:D9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O9(t,e,n=0,s=.5){const r=L(t,"image","rotateWithOffset","float32");R(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const i={image:r},o={radians:e,fillValue:n,center:s};return V.runKernel(_w,i,o)}const P9=K({rotateWithOffset_:O9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vc(t,e,n,s,r,i){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),i==null&&(i=0);const o=t.shape[0];return n=Math.min(n,o),R(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),R(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),R(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),R(e.rank===1,()=>"scores must be a 1D tensor"),R(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),R(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L9(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const i=L(t,"boxes","nonMaxSuppression","float32"),o=L(e,"scores","nonMaxSuppression","float32"),a=Vc(i,o,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:s,scoreThreshold:r};return V.runKernel(xw,{boxes:i,scores:o},l)}const M9=K({nonMaxSuppression_:L9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z9(t,e,n){const s=B9(t,e,n),r=s<0?-(s+1):s;t.splice(r,0,e)}function B9(t,e,n){return j9(t,e,n||W9)}function W9(t,e){return t>e?1:t<e?-1:0}function j9(t,e,n){let s=0,r=t.length,i=0,o=!1;for(;s<r;){i=s+(r-s>>>1);const a=n(e,t[i]);a>0?s=i+1:(r=i,o=!a)}return o?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dk(t,e,n,s,r){return pk(t,e,n,s,r,0)}function hk(t,e,n,s,r,i){return pk(t,e,n,s,r,0,!1,i,!0)}function fk(t,e,n,s,r,i){return pk(t,e,n,s,r,i,!0)}function pk(t,e,n,s,r,i,o=!1,a=!1,l=!1){const c=[];for(let g=0;g<e.length;g++)e[g]>r&&c.push({score:e[g],boxIndex:g,suppressBeginIndex:0});c.sort(N$);const u=i>0?-.5/i:0,d=[],h=[];for(;d.length<n&&c.length>0;){const g=c.pop(),{score:x,boxIndex:b,suppressBeginIndex:v}=g;if(x<r)break;let w=!1;for(let C=d.length-1;C>=v;--C){const $=V9(t,b,d[C]);if($>=s){w=!0;break}if(g.score=g.score*U9(s,u,$),g.score<=r)break}g.suppressBeginIndex=d.length,w||(g.score===x?(d.push(b),h.push(g.score)):g.score>r&&z9(c,g,N$))}const f=d.length,p=n-f;a&&p>0&&(d.push(...new Array(p).fill(0)),h.push(...new Array(p).fill(0)));const m={selectedIndices:d};return o&&(m.selectedScores=h),l&&(m.validOutputs=f),m}function V9(t,e,n){const s=t.subarray(e*4,e*4+4),r=t.subarray(n*4,n*4+4),i=Math.min(s[0],s[2]),o=Math.min(s[1],s[3]),a=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(r[0],r[2]),u=Math.min(r[1],r[3]),d=Math.max(r[0],r[2]),h=Math.max(r[1],r[3]),f=(a-i)*(l-o),p=(d-c)*(h-u);if(f<=0||p<=0)return 0;const m=Math.max(i,c),g=Math.max(o,u),x=Math.min(a,d),b=Math.min(l,h),v=Math.max(x-m,0)*Math.max(b-g,0);return v/(f+p-v)}function U9(t,e,n){const s=Math.exp(e*n*n);return n<=t?s:0}function N$(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function G9(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const i=L(t,"boxes","nonMaxSuppressionAsync"),o=L(e,"scores","nonMaxSuppressionAsync"),a=Vc(i,o,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l=await Promise.all([i.data(),o.data()]),c=l[0],u=l[1],{selectedIndices:d}=dk(c,u,n,s,r);return i!==t&&i.dispose(),o!==e&&o.dispose(),Ss(d,"int32")}const H9=G9;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K9(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const o=L(t,"boxes","nonMaxSuppression"),a=L(e,"scores","nonMaxSuppression"),l=Vc(o,a,n,s,r,i);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c={boxes:o,scores:a},u={maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:i},d=V.runKernel(bw,c,u);return{selectedIndices:d[0],selectedScores:d[1]}}const X9=K({nonMaxSuppressionWithScore_:K9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function q9(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const o=L(t,"boxes","nonMaxSuppressionAsync"),a=L(e,"scores","nonMaxSuppressionAsync"),l=Vc(o,a,n,s,r,i);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c=await Promise.all([o.data(),a.data()]),u=c[0],d=c[1],{selectedIndices:h,selectedScores:f}=fk(u,d,n,s,r,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:Ss(h,"int32"),selectedScores:Ss(f)}}const Y9=q9;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q9(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const o=L(t,"boxes","nonMaxSuppression"),a=L(e,"scores","nonMaxSuppression"),l=Vc(o,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,h={boxes:o,scores:a},f={maxOutputSize:c,iouThreshold:u,scoreThreshold:d,padToMaxOutputSize:i},p=V.runKernel(yw,h,f);return{selectedIndices:p[0],validOutputs:p[1]}}const J9=K({nonMaxSuppressionPadded_:Q9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Z9(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const o=L(t,"boxes","nonMaxSuppressionAsync"),a=L(e,"scores","nonMaxSuppressionAsync"),l=Vc(o,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,[h,f]=await Promise.all([o.data(),a.data()]),{selectedIndices:p,validOutputs:m}=hk(h,f,c,u,d,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:Ss(p,"int32"),validOutputs:ht(m,"int32")}}const eX=Z9;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tX(t,e,n=!1,s=!1){const r=L(t,"images","resizeBilinear");R(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),R(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),R(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=r,o=!1;r.rank===3&&(o=!0,i=H(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:s,size:e},c=V.runKernel(hx,a,l);return o?H(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const mD=K({resizeBilinear_:tX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nX(t,e,n=!1,s=!1){const r=L(t,"images","resizeNearestNeighbor");R(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),R(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),R(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),R(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=r,o=!1;r.rank===3&&(o=!0,i=H(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:s,size:e},c=V.runKernel(dx,a,l);return o?H(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const gD=K({resizeNearestNeighbor_:nX});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sX(t,e="binary",n=!1,s=.5){const r=L(t,"image","threshold"),i=.2989,o=.587,a=.114,l=r.shape[0]*r.shape[1];let c=B(Ss([s]),255),u,d,h,f;if(R(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),R(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),R(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),R(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[u,d,h]=Ws(r,[1,1,1],-1);const g=B(u,i),x=B(d,o),b=B(h,a);f=xe(xe(g,x),b)}else f=t;if(e==="otsu"){const g=n8(Se(sD(f),"int32"),EA([]),256);c=rX(g,l)}const p=n?jc(f,c):Hs(f,c);return Se(B(p,255),"int32")}function rX(t,e){let n=Ss([-1]),s=Ss([0]),r=Ss([0]),i,o,a,l,c,u;for(let d=0;d<t.size-1;d++){i=kt(t,0,d+1),o=kt(t,d+1),c=Me(Pe(i),e),u=Me(Pe(o),e);const h=Pe(B(i,Ad(0,i.size)));a=Me(h,Pe(i));const f=Tx(o.shape,i.size),p=xe(Ad(0,o.size),f),m=B(o,p);l=Me(Pe(m),Pe(o));const g=ze(a,l),x=ze(a,l),b=B(c,u);r=B(B(b,g),x);const v=Hs(r,s);s=Yn(v,r,s),n=Yn(v,Ss([d]),n)}return n}const iX=K({threshold_:sX});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oX(t,e,n="nearest",s="constant",r=0,i){const o=L(t,"image","transform","float32"),a=L(e,"transforms","transform","float32");R(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),R(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),R(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:o,transforms:a},c={interpolation:n,fillMode:s,fillValue:r,outputShape:i};return V.runKernel(Tw,l,c)}const aX=K({transform_:oX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lX(t,e,n){const s=L(t,"a","bandPart");R(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[i,o]=s.shape.slice(-2);let a,l;typeof e=="number"?(R(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),R(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),a=L(e<0?i:e,"numLower","bandPart")):(R(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Yn(Im(e,0),i,Rd(e,i))),typeof n=="number"?(R(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),R(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),l=L(n<0?o:n,"numUpper","bandPart")):(R(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Yn(Im(n,0),o,Rd(n,o)));const c=H(Ad(0,i,1,"int32"),[-1,1]),u=Ad(0,o,1,"int32"),d=ze(c,u),h=Ui(jc(d,a),pl(d,Kt(l))),f=bn([i,o],s.dtype);return H(Gi(nl(H(s,[-1,i,o])).map(p=>Yn(h,p,f))),r)}const cX=K({bandPart_:lX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uX(t){let e;if(Array.isArray(t)){e=!1,R(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=t[0].shape[0];for(let i=1;i<t.length;++i)R(t[i].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[i].shape[0]} vs. ${r})`)}else e=!0,t=Ws(t,t.shape[0],0).map(r=>Xh(r,[0]));R(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],s=t;for(let r=0;r<t.length;++r)n.push(V.tidy(()=>{let i=s[r];if(r>0)for(let o=0;o<r;++o){const a=B(Pe(B(n[o],i)),n[o]);i=ze(i,a)}return Me(i,_x(i,"euclidean"))}));return e?Gi(n,0):n}const dX=K({gramSchmidt_:uX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hX(t,e=!1){if(R(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return T$(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,c)=>l*c),s=nl(H(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),r=[],i=[];s.forEach(l=>{const[c,u]=T$(l,e);r.push(c),i.push(u)});const o=H(Gi(r,0),t.shape),a=H(Gi(i,0),t.shape);return[o,a]}}function T$(t,e=!1){return V.tidy(()=>{R(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],s=t.shape[1];let r=XA(n),i=Pa(t);const o=dy([[1]],[1,1]);let a=Pa(o);const l=n>=s?s:n;for(let c=0;c<l;++c){const u=i,d=a,h=r;[a,i,r]=V.tidy(()=>{const f=kt(i,[c,c],[n-c,1]),p=_x(f),m=kt(i,[c,c],[1,1]),g=Yn(Hs(m,0),dy([[-1]]),dy([[1]])),x=ze(m,B(g,p)),b=Me(f,x);b.shape[0]===1?a=Pa(o):a=as([o,kt(b,[1,0],[b.shape[0]-1,b.shape[1]])],0);const v=Kt(Me(dt(g,x),p)),w=kt(i,[c,0],[n-c,s]),C=B(v,a),$=rt(a);if(c===0)i=ze(w,dt(C,dt($,w)));else{const _=ze(w,dt(C,dt($,w)));i=as([kt(i,[0,0],[c,s]),_],0)}const T=rt(C),N=kt(r,[0,c],[n,r.shape[1]-c]);if(c===0)r=ze(N,dt(dt(N,a),T));else{const _=ze(N,dt(dt(N,a),T));r=as([kt(r,[0,0],[n,c]),_],1)}return[a,i,r]}),et([u,d,h])}return!e&&n>s&&(r=kt(r,[0,0],[n,s]),i=kt(i,[0,0],[s,s])),[r,i]})}const fX=K({qr_:hX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Li={flipLeftRight:_9,grayscaleToRGB:A9,resizeNearestNeighbor:gD,resizeBilinear:mD,rgbToGrayscale:F9,rotateWithOffset:P9,cropAndResize:T9,nonMaxSuppression:M9,nonMaxSuppressionAsync:H9,nonMaxSuppressionWithScore:X9,nonMaxSuppressionWithScoreAsync:Y9,nonMaxSuppressionPadded:J9,nonMaxSuppressionPaddedAsync:eX,threshold:iX,transform:aX},pX={bandPart:cX,gramSchmidt:dX,qr:fX};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mX=new Map,gX=new Map;class Uc{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class sr{constructor(){this.classNameMap={}}static getMap(){return sr.instance==null&&(sr.instance=new sr),sr.instance}static register(e){sr.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function de(t,e,n){R(t.className!=null,()=>"Class being registered does not have the static className property defined."),R(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),R(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const s=n,r=e+">"+s;return sr.register(t),mX.set(r,t),gX.set(t,r),t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sa extends Uc{minimize(e,n=!1,s){const{value:r,grads:i}=this.computeGradients(e,s);if(s!=null){const o=s.map(a=>({name:a.name,tensor:i[a.name]}));this.applyGradients(o)}else this.applyGradients(i);return et(i),n?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return CK(e,n)}dispose(){this.iterations_!=null&&et(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:ht(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(sa,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xD extends sa{static get className(){return"Adadelta"}constructor(e,n,s=null){super(),this.learningRate=e,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=V.registeredVariables[s],o=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:Q(()=>it(i).variable(o))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:Q(()=>it(i).variable(o))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedGrads[r].variable,c=this.accumulatedUpdates[r].variable;Q(()=>{const u=xe(B(l,this.rho),B(Nt(a),1-this.rho)),d=B(Me(Mn(xe(c,this.epsilon)),Mn(xe(l,this.epsilon))),a),h=xe(B(c,this.rho),B(Nt(d),1-this.rho));l.assign(u),c.assign(h);const f=xe(B(d,-this.learningRate),i);i.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(et(this.accumulatedGrads.map(e=>e.variable)),et(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yD extends sa{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=V.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:Q(()=>Tx(i.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const a=this.accumulatedGrads[r].variable;Q(()=>{const l=xe(a,Nt(o));a.assign(l);const c=xe(B(Me(o,Mn(xe(l,V.backend.epsilon()))),-this.learningRate),i);i.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&et(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bD extends sa{static get className(){return"Adam"}constructor(e,n,s,r=null){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Q(()=>{this.accBeta1=ht(n).variable(),this.accBeta2=ht(s).variable()}),r==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);Q(()=>{const s=ze(1,this.accBeta1),r=ze(1,this.accBeta2);n.forEach((i,o)=>{const a=V.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:Q(()=>it(a).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${i}/v`,variable:Q(()=>it(a).variable(l))});const c=Array.isArray(e)?e[o].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,d=this.accumulatedSecondMoment[o].variable,h=xe(B(u,this.beta1),B(c,1-this.beta1)),f=xe(B(d,this.beta2),B(Nt(c),1-this.beta2)),p=Me(h,s),m=Me(f,r);u.assign(h),d.assign(f);const g=xe(B(Me(p,xe(Mn(m),this.epsilon)),-this.learningRate),a);a.assign(g)}),this.accBeta1.assign(B(this.accBeta1,this.beta1)),this.accBeta2.assign(B(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&et(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&et(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),Q(()=>{this.accBeta1.assign(el(this.beta1,this.iterations_+1)),this.accBeta2.assign(el(this.beta2,this.iterations_+1))});const n=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vD extends sa{static get className(){return"Adamax"}constructor(e,n,s,r=null,i=0){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Q(()=>{this.iteration=ht(0).variable(),this.accBeta1=ht(n).variable()}),r==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);Q(()=>{const s=ze(1,this.accBeta1),r=Me(-this.learningRate,xe(B(this.iteration,this.decay),1));n.forEach((i,o)=>{const a=V.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:it(a).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${i}/v`,variable:it(a).variable(l)});const c=Array.isArray(e)?e[o].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,d=this.accumulatedWeightedInfNorm[o].variable,h=xe(B(u,this.beta1),B(c,1-this.beta1)),f=B(d,this.beta2),p=Gn(c),m=ta(f,p);u.assign(h),d.assign(m);const g=xe(B(Me(r,s),Me(h,xe(m,this.epsilon))),a);a.assign(g)}),this.iteration.assign(xe(this.iteration,1)),this.accBeta1.assign(B(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&et(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&et(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mk extends sa{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=Array.isArray(e)?e[r].tensor:e[s];if(i==null)return;const o=V.registeredVariables[s];Q(()=>{const a=xe(B(this.c,i),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=mi(ht(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wD extends mk{static get className(){return"Momentum"}constructor(e,n,s=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=ht(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=V.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:Q(()=>it(i).variable(!1))});const o=this.accumulations[r].variable,a=Array.isArray(e)?e[r].tensor:e[s];a!=null&&Q(()=>{let l;const c=xe(B(this.m,o),a);this.useNesterov?l=xe(B(this.c,xe(a,B(c,this.m))),i):l=xe(B(this.c,c),i),o.assign(c),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&et(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kD extends sa{static get className(){return"RMSProp"}constructor(e,n=.9,s=0,r=null,i=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,r==null&&(this.epsilon=V.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=V.registeredVariables[s],o=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:Q(()=>it(i).variable(o))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:Q(()=>it(i).variable(o))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:Q(()=>it(i).variable(o))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedMeanSquares[r].variable,c=this.accumulatedMoments[r].variable;Q(()=>{const u=xe(B(l,this.decay),B(Nt(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[r].variable,h=xe(B(d,this.decay),B(a,1-this.decay)),f=Me(B(a,this.learningRate),Mn(ze(u,xe(Nt(h),this.epsilon)))),p=xe(B(c,this.momentum),f);l.assign(u),d.assign(h),c.assign(p);const m=ze(i,p);i.assign(m)}else{const d=xe(B(l,this.decay),B(Nt(a),1-this.decay)),h=xe(B(c,this.momentum),Me(B(a,this.learningRate),Mn(xe(d,this.epsilon))));l.assign(d),c.assign(h);const f=ze(i,h);i.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&et(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&et(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&et(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xX=[xD,yD,bD,vD,wD,kD,mk];function yX(){for(const t of xX)de(t)}function gk(t,e){const n=t.shape.length,s=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${n}`);if(re(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const r=e.shape,i=r[r.length-1];let o=1;for(let d=0;d<r.length-1;++d)o*=r[d];const a=t.shape,l=r.slice();l.pop();let c=1;for(let d=i;d<n;++d)c*=a[d],l.push(a[d]);const u=[...Fe(t.shape).map(d=>d/c),1].slice(0,i);return[l,o,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i1=-2,bX=-1;function xk(t,e,n){const s=t.shape.length;R(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),R(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)R(e[r]+n[r]<=t.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+n[r]}) would overflow input.shape[${r}] (${t.shape[r]})`)}function vX(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function yk(t,e,n){const s=[];for(let r=0;r<t.length;r++)s[r]=Math.ceil((e[r]-t[r])/n[r]);return s}function CD(t,e,n,s){const r=[...t];for(let i=r.length;i<s.length;i++)r.push(1);for(let i=0;i<n;i++)i===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function SD(t,e,n){return n<=t?n:n-(e-1)}function ID(t,e){const n=[];for(let s=0;s<t;s++)n.push(e+s);return n}function wX(t,e,n,s,r,i,o,a,l){const c=t.length;let u=new Array(c),d=new Array(c),h=new Array(c);if(e.length&&n>0){const f=e[0],p=n+1;u=$D(o,f,p,s,t),d=ND(a,f,p,r,t),h=CD(i,f,p,t)}else for(let f=0;f<c;f++)u[f]=ED(o,s,i,t,f,l),d[f]=_D(a,r,i,t,f,l),h[f]=TD(i,f,l);return{begin:u,end:d,strides:h}}function $D(t,e,n,s,r){const i=[...r],o=ID(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=0;else{const l=SD(e,n,a);let c=s[l];t&1<<l&&(c=0),i[a]=c}return i}function ND(t,e,n,s,r){const i=[...r],o=ID(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=Number.MAX_SAFE_INTEGER;else{const l=SD(e,n,a);let c=s[l];t&1<<l&&(c=Number.MAX_SAFE_INTEGER),i[a]=c}for(let a=0;a<i.length;a++){const l=r[a];i[a]<0&&(i[a]+=l),i[a]=Ka(0,i[a],r[a])}return i}function TD(t,e,n){let s=t[e];return(n&1<<e||s==null)&&(s=1),s}function ED(t,e,n,s,r,i){let o=e[r];const a=n[r]||1;(t&1<<r||i&1<<r||o==null)&&(a>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const l=s[r];return o<0&&(o+=l),o=Ka(0,o,l-1),o}function _D(t,e,n,s,r,i){let o=e[r];const a=n[r]||1;(t&1<<r||i&1<<r||o==null)&&(a>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const l=s[r];return o<0&&(o+=l),a>0?o=Ka(0,o,l):o=Ka(-1,o,l-1),o}function bk(t,e,n){let s=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){s=r;break}for(let r=s+1;r<n.length;r++)if(e[r]>0||n[r]!==t[r])return!1;return!0}function vk(t,e){let n=t.length>0?t[t.length-1]:1;for(let s=0;s<t.length-1;s++)n+=t[s]*e[s];return n}function Ax(t,e,n){let s;const r=t.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(o=>{R(o!==-1,()=>"slice() does not support negative begin indexing.")});let i;return n==null?i=new Array(r).fill(-1):typeof n=="number"?i=[n,...new Array(r-1).fill(-1)]:n.length<r?i=n.concat(new Array(r-n.length).fill(-1)):i=n,i=i.map((o,a)=>o>=0?o:(R(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),t.shape[a]-s[a])),[s,i]}function wk(t,e,n,s,r,i,o,a,l){let c;if(s==null?(c=new Array(e.length),c.fill(1)):c=s,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const d={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:c.slice(),beginMask:r,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};for(let v=0;v<d.dims;v++)u&&1<<v&a&&d.numAddAxisAfterEllipsis++,1<<v&o&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};kX(d,h);let f=!0,p=!0,m=!0;const g=[],x=[];for(let v=0;v<t.length;++v){if(h.strides[v]===0)throw Error(`strides[${v}] must be non-zero`);const w=!!(h.shrinkAxisMask&1<<v),C=t[v];if(C===-1){g.push(w?1:-1);continue}const $=[h.beginMask&1<<v,h.endMask&1<<v],T=[h.strides[v]>0?0:-1,h.strides[v]>0?C:C-1];if(w&&h.strides[v]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&h.strides[v]===1;const N=!!(h.beginMask&1<<v&&h.endMask&1<<v);if(h.beginValid&&h.endValid){if(w){const W=h.begin[v]<0?C+h.begin[v]:h.begin[v];if(h.begin[v]=W,h.end[v]=h.begin[v]+1,W<0||W>=C)throw Error(`slice index ${h.begin[v]} of dimension ${v} out of bounds.`)}else h.begin[v]=E$(h.begin[v],0,h.strides[v],C,$,T),h.end[v]=E$(h.end[v],1,h.strides[v],C,$,T);const O=h.strides[v]===1&&h.begin[v]===0&&h.end[v]===C;f=f&&O,p=p&&(v===0&&h.strides[v]===1||O)}else f=f&&h.strides[v]===1&&N,p=p&&(v===0&&h.strides[v]===1||N);let _,A=!1;if(h.beginValid&&h.endValid?(_=h.end[v]-h.begin[v],A=!0):w?(_=1,A=!0):N&&C>=0&&(h.strides[v]<0?_=-C:_=C,A=!0),A){let O;_===0||_<0!=h.strides[v]<0?O=0:O=Math.trunc(_/h.strides[v])+(_%h.strides[v]!==0?1:0),g.push(O)}else g.push(-1)}for(let v=0;v<h.finalShapeGatherIndices.length;++v){const w=h.finalShapeGatherIndices[v];w>=0?x.push(g[w]):w===i1&&x.push(1)}return{finalShapeSparse:x.filter((v,w)=>h.finalShapeGatherIndices[w]!==i1),finalShape:x,isIdentity:f,sliceDim0:p,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function kX(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<t.dims;s++)if(1<<s&t.ellipsisMask){const r=Math.min(e.dims-(t.dims-s)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<r;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&t.newAxisMask)e.finalShapeGatherIndices.push(i1),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[s]),t.end!=null&&(e.end[n]=t.end[s]),e.strides[n]=t.strides[s],t.beginMask&1<<s&&(e.beginMask|=1<<n),t.endMask&1<<s&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(bX),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[n]=s,n++}}function E$(t,e,n,s,r,i){if(r[e])return n>0?i[e]:i[e+1&1];{const o=t<0?s+t:t;return o<i[0]?i[0]:o>i[1]?i[1]:o}}const CX=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:xk,computeFlatOffset:vk,computeOutShape:yk,getNormalizedAxes:wX,isSliceContinous:bk,maskToAxes:vX,parseSliceParams:Ax,sliceInfo:wk,startForAxis:ED,startIndicesWithElidedDims:$D,stopForAxis:_D,stopIndicesWithElidedDims:ND,stridesForAxis:TD,stridesWithElidedDims:CD},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SX{static sgd(e){return new mk(e)}static momentum(e,n,s=!1){return new wD(e,n,s)}static rmsprop(e,n=.9,s=0,r=null,i=!1){return new kD(e,n,s,r,i)}static adam(e=.001,n=.9,s=.999,r=null){return new bD(e,n,s,r)}static adadelta(e=.001,n=.95,s=null){return new xD(e,n,s)}static adamax(e=.002,n=.9,s=.999,r=null,i=0){return new vD(e,n,s,r,i)}static adagrad(e,n=.1){return new yD(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const El=SX;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IX=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function RD(){return new Promise(t=>IX(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kk(t,e){const n=t[0].length;t.forEach((r,i)=>{R(r.length===n,()=>`Error in concat${n}D: rank of tensors[${i}] must be the same as the rank of the rest (${n})`)}),R(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=t[0];t.forEach((r,i)=>{for(let o=0;o<n;o++)R(o===e||r[o]===s[o],()=>`Error in concat${n}D: Shape of tensors[${i}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${i}.`)})}function gi(t,e){const n=t[0].slice();for(let s=1;s<t.length;s++)n[e]+=t[s][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Tr;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(Tr||(Tr={}));function AD(t,e,n){let s=new Array;if(n==null&&e==null)return s;if(e==null)for(;s.length<t+n.length;)s.push(-1);else s=e.slice();if(n==null)return s;if(t+n.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${s.length}`);for(let r=1;r<n.length;++r){const i=n[r],o=s[s.length-n.length+r],a=s[o];if(i>=0)if(a>=0){if(a!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+t}] = ${i} but shape[${r+t}] = ${a}`)}else s[o]=i}return s}function DD(t){const e={FIRST_DIM_SIZE:Tr.FIRST_DIM_SIZE,VALUE_ROWIDS:Tr.VALUE_ROWIDS,ROW_LENGTHS:Tr.ROW_LENGTHS,ROW_SPLITS:Tr.ROW_SPLITS,ROW_LIMITS:Tr.ROW_LIMITS,ROW_STARTS:Tr.ROW_STARTS},n=[];for(const s of t)if(s in e)n.push(e[s]);else break;return n}function FD(t){return t.length===0?0:t[0]===Tr.FIRST_DIM_SIZE?t.length-1:t.length}function OD(t,e){if(t==null||e==null)return;const n=t.length,s=e.length;if(n>=s)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(n,s-1);++r){const i=t[r],o=e[r+1];if(i>=0&&o>=0&&i!==1&&i!==o)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-t.length}] = ${i} but ragged tensor input.flatValues.shape[${r-t.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ck=30;function Dx(t){return t<=Ck?t:jb(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sk(t,e,n){const s=n*(typeof t=="number"?t:t[0]),r=e*(typeof t=="number"?t:t[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yh(t,e,n,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(t[0]/n),r=r.concat(t.slice(1));else{r=r.concat(t[0]);const i=e.length;for(let o=0;o<i;++o)r=r.concat([t[o+1]/e[o],e[o]]);r=r.concat(t.slice(i+1))}return r}function Qh(t,e,n=!0){const s=[];if(n){s.push(e);for(let r=e+1;r<t;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],i=[];for(let o=1;o<t;++o)o>=e*2+1||o%2===1?i.push(o):r.push(o);s.push(...r),s.push(0),s.push(...i)}return s}function Jh(t,e,n,s=!0){const r=[];s?r.push(t[0]/n):r.push(t[0]*n);for(let i=1;i<t.length;++i)i<=e.length?s?r.push(e[i-1]*t[i]):r.push(t[i]/e[i-1]):r.push(t[i]);return r}function Ik(t,e){const n=[0];for(let s=0;s<e;++s)n.push(t[s][0]);return n}function $k(t,e,n){const s=t.slice(0,1);for(let r=0;r<n;++r)s.push(t[r+1]-e[r][0]-e[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fx=1.7580993408473768,Ox=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nk=.3275911,Tk=.254829592,Ek=-.284496736,_k=1.421413741,Rk=-1.453152027,Ak=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hi(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let s=0;s<n.length;s+=2)n[s]=t[s/2],n[s+1]=e[s/2];return n}function PD(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let s=0;s<t.length;s+=2)e[s/2]=t[s],n[s/2]=t[s+1];return{real:e,imag:n}}function LD(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function MD(t){const e=Math.floor(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function Dk(t,e){const n=t[e*2],s=t[e*2+1];return{real:n,imag:s}}function zD(t,e,n,s){t[s*2]=e,t[s*2+1]=n}function BD(t,e){const n=new Float32Array(t/2),s=new Float32Array(t/2);for(let r=0;r<Math.ceil(t/2);r++){const i=(e?2:-2)*Math.PI*(r/t);n[r]=Math.cos(i),s[r]=Math.sin(i)}return{real:n,imag:s}}function WD(t,e,n){const s=(n?2:-2)*Math.PI*(t/e),r=Math.cos(s),i=Math.sin(s);return{real:r,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hy="->",$X=/->/g,_$=",",R$="...";function Fk(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace($X,"").length)/hy.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${hy}").`);const[s,r]=t.split(hy);R(s.indexOf(R$)===-1,()=>`The ellipsis notation ("${R$}") is not supported yet.`);const i=s.split(_$),o=i.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let h=0;h<r.length;++h){const f=r[h];if(!i.some(p=>p.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let h=0;h<s.length;++h){const f=s[h];a.indexOf(f)===-1&&f!==_$&&a.push(f)}const l=new Array(i.length);for(let h=0;h<o;++h){if(new Set(i[h].split("")).size!==i[h].length)throw new Error(`Found duplicate axes in input component ${i[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let f=0;f<i[h].length;++f)l[h].push(a.indexOf(i[h][f]))}const c=a.length,u=r.length,d=[];for(let h=u;h<c;++h)d.push(h);return{allDims:a,summedDims:d,idDims:l}}function Ok(t,e){let n=new Array(t);n.fill(-1);for(let r=0;r<e.length;++r)n[e[r]]=r;const s=[];for(let r=0;r<t;++r)n[r]===-1&&s.push(r);return n=n.filter(r=>r!==-1),{permutationIndices:n,expandDims:s}}function Pk(t,e,n){const s=new Array(t);for(let r=0;r<n.length;++r){const i=n[r].shape;for(let o=0;o<e[r].length;++o)s[e[r][o]]===void 0?s[e[r][o]]=i[o]:R(s[e[r][o]]===i[o],()=>`Expected dimension ${s[e[r][o]]} at axis ${o} of input shaped ${JSON.stringify(i)}, but got dimension ${i[o]}`)}}function Lk(t,e){const n=t,s=[];let r=0;t.length===0&&n.push(-1),r=t.length+1;for(let o=0;o<r;++o)s.push([]);const i=[];for(let o=0;o<n.length;++o){const a=n[o],l=NX(e,a);for(const c of l)i.indexOf(c)===-1&&(s[o].push(c),i.push(c))}return{path:n,steps:s}}function Mk(t){return t.every((e,n)=>e===n)}function NX(t,e){const n=[];for(let s=0;s<t.length;++s)(t[s].length===0||t[s].indexOf(e)!==-1||e===-1)&&n.push(s);return n}function zk(t,e,n=0){let s=[];if(typeof e=="number")R(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(t.shape[n]/e);else{const r=e.reduce((o,a)=>(a===-1&&(o+=1),o),0);R(r<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const o=e.reduce((a,l)=>l>0?a+l:a);e[i]=t.shape[n]-o}R(t.shape[n]===e.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jD(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function VD(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function UD(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GD(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function HD(t,e){return`size ${t} must be non-negative, not ${e}`}function KD(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function XD(t,e){const n=re(t),s=re(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${t} outputShape= ${e}`}function qD(t,e){const n=re(t),s=re(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o1(){return"segment ids must be >= 0"}function YD(){return"segment ids are not increasing"}function QD(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function JD(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZD(t,e){let n=!1,s;for(t<=Ck?(s=t,n=!0):s=jb(t,Math.floor(Math.sqrt(t)));!n;)s>e||s===t?n=!0:s=jb(t,s+1);return s}function eF(t,e,n){const s=[],r=t.length;for(let i=0;i<r;i++)i!==e?s.push(t[i]):s.push(n);return s}function Bk(t,e,n,s){const r=e.shape.length,i=t.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>i)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${i}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let d=0;d<s;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const o=t.shape[n],a=[];let l=1,c=1,u=1;for(let d=0;d<s;++d)a.push(t.shape[d]),l*=t.shape[d];for(let d=s;d<n;d++)a.push(t.shape[d]),c*=t.shape[d];for(let d=s;d<r;d++)a.push(e.shape[d]);for(let d=n+1;d<i;d++)a.push(t.shape[d]),u*=t.shape[d];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:o,outputShape:a}}const TX=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:Bk,computeOutShape:eF,segOpComputeOptimalWindowSize:ZD},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ki(t){try{return t.map(e=>Bo(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function tF(t){return t.map(e=>Do(e))}const EX=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:Tk,ERF_A2:Ek,ERF_A3:_k,ERF_A4:Rk,ERF_A5:Ak,ERF_P:Nk,PARALLELIZE_THRESHOLD:Ck,get RowPartitionType(){return Tr},SELU_SCALE:Ox,SELU_SCALEALPHA:Fx,applyActivation:ck,assertAndGetBroadcastShape:He,assertAxesAreInnerMostDims:En,assertParamsConsistent:kk,assignToTypedArray:zD,axesAreInnerMostDims:Bw,calculateShapes:xl,checkEinsumDimSizes:Pk,checkPadOnDimRoundingMode:hs,combineLocations:HA,combineRaggedTensorToTensorShapes:AD,complexWithEvenIndex:LD,complexWithOddIndex:MD,computeConv2DInfo:Tn,computeConv3DInfo:Zo,computeDefaultPad:Fw,computeDilation2DInfo:Gh,computeOptimalWindowSize:Dx,computeOutAndReduceShapes:kn,computeOutShape:gi,computePool2DInfo:gr,computePool3DInfo:Yi,convertConv2DDataFormat:Qi,decodeEinsumEquation:Fk,eitherStridesOrDilationsAreOne:zn,expandShapeToKeepDim:rn,exponent:WD,exponents:BD,fromStringArrayToUint8:tF,fromUint8ToStringArray:Ki,getAxesPermutation:Wt,getBroadcastDims:wc,getComplexWithIndex:Dk,getEinsumComputePath:Lk,getEinsumPermutation:Ok,getFusedBiasGradient:lk,getFusedDyActivation:ak,getImageCenter:Sk,getInnerMostAxes:qt,getPermuted:Qh,getRaggedRank:FD,getReductionAxes:pn,getReshaped:Yh,getReshapedPermuted:Jh,getRowPartitionTypesHelper:DD,getSliceBeginCoords:Ik,getSliceSize:$k,getSparseFillEmptyRowsIndicesDenseShapeMismatch:jD,getSparseFillEmptyRowsNegativeIndexErrorMessage:VD,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:UD,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:KD,getSparseReshapeInputOutputMismatchErrorMessage:qD,getSparseReshapeInputOutputMultipleErrorMessage:XD,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:GD,getSparseReshapeNegativeOutputDimErrorMessage:HD,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:JD,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:o1,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:YD,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:QD,getUndoAxesPermutation:ea,isIdentityPermutation:Mk,log:hH,mergeRealAndImagArrays:Hi,prepareAndValidate:gk,prepareSplitSize:zk,segment_util:TX,shouldFuse:uk,slice_util:CX,splitRealAndImagArrays:PD,stridesOrDilationsArePositive:Ja,tupleValuesAreOne:Qa,upcastType:_s,validateDefaultValueShape:OD,validateInput:o9,validateUpdateShape:dD,warn:Ps},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */yX();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nF={kernelName:Cg,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,qh(Se(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _X={kernelName:Yd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Nt(Se(n,"float32")),r=Mn(ze(ht(1),s));return Kt(Me(t,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RX={kernelName:Qd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Mn(ze(Nt(Se(n,"float32")),1));return Me(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AX={kernelName:zc,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=He(n.shape,s.shape);return{a:()=>{let a=t;const l=pn(n.shape,r);return l.length>0&&(a=Pe(a,l)),H(a,n.shape)},b:()=>{let a=t;const l=pn(s.shape,r);return l.length>0&&(a=Pe(a,l)),H(a,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DX={kernelName:Uv,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((s,r)=>{n[r]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FX={kernelName:Sg,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>it(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OX={kernelName:Ig,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>it(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PX={kernelName:Jd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Me(t,Mn(ze(ht(1),Nt(Se(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LX={kernelName:Zd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Mn(xe(ht(1),Nt(Se(n,"float32"))));return Me(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MX={kernelName:nh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=He(n.shape,s.shape);return{a:()=>{const a=xe(Nt(n),Nt(s));let l=B(t,Me(s,a));const c=pn(n.shape,r);return c.length>0&&(l=Pe(l,c)),H(l,n.shape)},b:()=>{const a=xe(Nt(n),Nt(s));let l=Kt(B(t,Me(n,a)));const c=pn(s.shape,r);return c.length>0&&(l=Pe(l,c)),H(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zX={kernelName:eh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Me(t,xe(Nt(Se(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BX={kernelName:th,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Me(t,ze(ht(1),Nt(Se(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WX(t,e,n,s,r,i){const o=L(t,"dy","avgPool3dGrad"),a=L(e,"input","avgPool3dGrad");let l=o,c=a,u=!1;a.rank===4&&(u=!0,l=H(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=H(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),R(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),R(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),hs("avgPool3dGrad",r,i);const d={dy:l,input:c},h={filterSize:n,strides:s,pad:r,dimRoundingMode:i},f=V.runKernel(Xv,d,h);return u?H(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const jX=K({avgPool3dGrad_:WX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VX={kernelName:Ng,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:i,pad:o,dimRoundingMode:a}=n;return{x:()=>jX(t,s,r,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UX(t,e,n,s,r){const i=L(t,"dy","avgPoolGrad"),o=L(e,"input","avgPoolGrad");R(o.rank===i.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${i.rank})`);let a=o,l=i,c=!1;o.rank===3&&(c=!0,a=H(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=H(i,[1,i.shape[0],i.shape[1],i.shape[2]])),R(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),R(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const u={dy:l,input:a},d={filterSize:n,strides:s,pad:r},h=V.runKernel(Kv,u,d);return c?H(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const GX=K({avgPoolGrad_:UX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HX={kernelName:$g,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:i,pad:o}=n;return{x:()=>GX(t,s,r,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KX={kernelName:Tg,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[s,r]=e,{transposeA:i,transposeB:o}=n;return!i&&!o?{a:()=>dt(t,r,!1,!0),b:()=>dt(s,t,!0,!1)}:!i&&o?{a:()=>dt(t,r,!1,!1),b:()=>dt(t,s,!0,!1)}:i&&!o?{a:()=>dt(r,t,!1,!0),b:()=>dt(s,t,!1,!1)}:{a:()=>dt(r,t,!0,!0),b:()=>dt(t,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XX={kernelName:Eg,gradFunc:(t,e,n)=>{const{blockShape:s,crops:r}=n;return{x:()=>Xw(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qX={kernelName:lH,gradFunc:(t,e,n)=>{const s=n,r=s.inputShape,i=s.shape,o=Array.from(i);for(let l=r.length-1;l>=0;l--)if(r[l]===i[l])o[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${i}].`);const a=[];for(let l=0;l<o.length;l++)o[l]>1&&a.push(l);return{x:()=>Pe(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YX={kernelName:sh,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QX={kernelName:rh,gradFunc:t=>({x:()=>it(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JX={kernelName:ih,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{clipValueMin:r,clipValueMax:i}=n;return{x:()=>Yn(Ui(pl(s,r),jc(s,i)),t,it(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZX={kernelName:_g,inputsToSave:["x"],gradFunc:nF.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eq={kernelName:Rg,saveAllInputs:!0,gradFunc:(t,e,n)=>{const s=e.map(l=>l.shape),{axis:r}=n,i=Qe(r,e[0].shape)[0],o=s.map(l=>l[i]);return Ws(t,o,i).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tq={kernelName:Ag,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{dilations:i,strides:o,pad:a,dataFormat:l}=n;return R(Qa(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>Lw(s.shape,t,r,o,a,l),filter:()=>ok(s,t,r.shape,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nq={kernelName:Dg,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{strides:i,pad:o,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>Za(t,r,i,o,a,1,l),filter:()=>ok(t,s,r.shape,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sq(t,e,n,s,r){let i=t;t.rank===4&&(i=H(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;o.rank===4&&(o=H(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),R(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),R(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),R(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),R(i.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${n[3]}.`),R(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:i,dy:o},l={strides:s,pad:r,filterShape:n};return V.runKernel(Zv,a,l)}const rq=K({conv3DBackpropFilter_:sq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iq={kernelName:Fg,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:i}=n;R(Qa(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[o,a]=e;return{x:()=>jA(o.shape,t,a,r,i),filter:()=>rq(o,t,a.shape,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oq={kernelName:oh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(Kt(aD(Se(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aq={kernelName:ah,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(lD(Se(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lq={kernelName:Og,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r,exclusive:i,reverse:o}=n;return{x:()=>{const a=Wt([r],s.rank);let l=UA(t,r,i,!o);return a!=null&&(l=rt(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cq={kernelName:Pg,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:i,dimRoundingMode:o}=n,a=s??[1,1];R(Qa(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,c]=e;return R(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),R(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),R(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),R(zn(r,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${a}'.`),hs("depthwiseConv2d",i,o),{x:()=>I9(l.shape,t,c,r,i,a,o),filter:()=>C9(l,t,c.shape,r,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uq={kernelName:Lg,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,i={x:s,filter:r,dy:t},o={x:s,filter:r,dy:t};return{x:()=>V.runKernel(Vb,i,n),filter:()=>V.runKernel(Ub,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dq={kernelName:ch,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,s={dy:t,y:n};return{x:()=>V.runKernel(lw,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hq={kernelName:uh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=B(vi(Kt(Nt(n))),2/Math.sqrt(Math.PI));return{x:()=>B(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fq={kernelName:dh,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pq={kernelName:zg,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>H(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mq={kernelName:hh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,vi(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gq={kernelName:fh,gradFunc:t=>({x:()=>it(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xq={kernelName:ph,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=He(n.shape,s.shape);return{a:()=>{const a=Me(t,Se(s,"float32")),l=pn(n.shape,r);return l.length>0?H(Pe(a,l),n.shape):a},b:()=>{let a=B(t,Se(n,"float32"));const l=pn(s.shape,r);l.length>0&&(a=H(Pe(a,l),s.shape));const c=Nt(s);return Kt(Me(a,Se(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yq={kernelName:Bg,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:s}=n,[r,i,o,a]=e,l=a??ht(1),c=pn(i.shape,r.shape),u=[];if(i.rank===1){for(let w=0;w<r.shape.length-1;++w)u.push(r.shape[w]);u.push(1)}const d=ze(r,i),h=B(t,l),f=rD(xe(o,ht(s))),p=B(B(B(f,f),f),ht(-.5));return{x:()=>i.rank===1?H(B(B(t,_r(H(f,[1,1,1,i.shape[0]]),u)),l),r.shape):H(B(B(t,f),l),r.shape),mean:()=>{let w=B(B(f,ht(-1)),h);return i.rank===1&&(w=Pe(w,c)),H(w,i.shape)},variance:()=>{let w=B(B(p,d),h);return i.rank===1&&(w=Pe(w,c)),H(w,i.shape)},scale:()=>{const w=B(d,f);let C=B(t,w);return i.rank===1&&(C=Pe(C,c)),H(C,i.shape)},offset:()=>{let w=t;return i.rank===1&&(w=Pe(w,c)),H(w,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bq={kernelName:Wg,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[s,r]=e,{axis:i,batchDims:o}=n,a=Qe(i,s.shape)[0],l=(c,u,d)=>()=>{const h=c.shape,f=u.size,p=h.slice(0,a),m=p.length,g=h.slice(i,h.length).slice(1),x=g.length,b=A$(0,m),v=A$(m+1,m+1+x),w=D$([p,[f],g]),C=H(d,w),$=H(u,[f]),T=D$([[m],b,v]),N=rt(C,T);let _=fD(N,$,c.shape[a]);const A=ea(T);return _=rt(_,A),_};if(o===1){const c=s.shape[0],u=s.split(c,0);return{x:()=>Gi(u.map((f,p)=>l(f,r.slice(p,1),t.slice(p,1))())).reshape(s.shape),indices:()=>r}}else return{x:l(s,r,t),indices:()=>r}}};function A$(t,e){const n=[];for(let s=t;s<e;++s)n.push(s);return n}function D$(t){const e=[];for(let n=0;n<t.length;++n)for(let s=0;s<t[n].length;++s)e.push(t[n][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vq={kernelName:mh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>it(n),b:()=>it(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wq={kernelName:gh,gradFunc:t=>({x:()=>Se(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kq={kernelName:xh,gradFunc:t=>({x:()=>it(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cq={kernelName:yh,gradFunc:t=>({x:()=>it(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sq={kernelName:bh,gradFunc:t=>({x:()=>it(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iq={kernelName:Vg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{alpha:r}=n,i=Hs(s,0);return{x:()=>Yn(i,t,B(t,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $q={kernelName:wh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Me(t,xe(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nq={kernelName:vh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Me(t,Se(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tq={kernelName:uH,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;return{logits:()=>{const o=vi(s);return ze(t,B(Pe(t,r,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eq(t,e,n,s=5,r=1,i=1,o=.5){const a={x:t,y:e,dy:n},l={depthRadius:s,bias:r,alpha:i,beta:o};return V.runKernel(pw,a,l)}const _q=K({localResponseNormalizationBackprop_:Eq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rq={kernelName:qg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{depthRadius:i,bias:o,alpha:a,beta:l}=n;return{x:()=>_q(s,r,t,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sF(t,e,n,s){return e.rank<n.rank&&(e=H(e,rn(e.shape,s))),t.rank<n.rank&&(t=H(t,rn(t.shape,s))),{x:()=>B(t,Se(bi(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F$={kernelName:Yg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{reductionIndices:r}=s,i=e[0],o=e[1],a=Qe(r,i.shape),l=sF(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aq={kernelName:kh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>B(t,Se(pl(n,s),"float32")),b:()=>B(t,Se(Im(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dq(t,e,n,s,r,i,o){const a=L(t,"dy","maxPool3dGrad"),l=L(e,"input","maxPool3dGrad"),c=L(n,"output","maxPool3dGrad");let u=a,d=l,h=c,f=!1;l.rank===4&&(f=!0,u=H(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),d=H(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),h=H(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),R(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),R(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),R(h.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`),hs("maxPool3dGrad",i,o);const p={dy:u,input:d,output:h},m={filterSize:s,strides:r,pad:i,dimRoundingMode:o},g=V.runKernel(gw,p,m);return f?H(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const Fq=K({maxPool3dGrad_:Dq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oq={kernelName:Jg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=n;return{x:()=>Fq(t,s,r,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pq(t,e,n,s,r,i,o){const a=L(t,"dy","maxPoolGrad"),l=L(e,"input","maxPoolGrad"),c=L(n,"output","maxPoolGrad");R(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),R(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),R(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),hs("maxPoolGrad",i,o);const u={dy:a,input:l,output:c},d={filterSize:s,strides:r,pad:i,dimRoundingMode:o};return V.runKernel(mw,u,d)}const Lq=K({maxPoolGrad_:Pq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mq={kernelName:Qg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:i,strides:o,pad:a}=n;return{x:()=>Lq(t,s,r,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zq={kernelName:Zg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n,i=Qe(r,s.shape),a=kn(s.shape,i)[1],l=re(a);return{x:()=>{const u=s.shape.slice();i.forEach(f=>{u[f]=1});const d=H(t,u);return Me(B(d,na(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bq={kernelName:ex,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{axis:r}=s,[i,o]=e,a=Qe(r,i.shape),l=sF(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wq={kernelName:Ch,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>B(t,Se(jc(n,s),"float32")),b:()=>B(t,Se(Hs(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jq={kernelName:tx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,i=r.map(o=>o[0]);return{x:()=>kt(t,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vq={kernelName:Sh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=He(n.shape,s.shape);return{a:()=>{const a=pn(n.shape,r);return a.length>0?H(Pe(t,a),n.shape):t},b:()=>{const a=B(t,Kt(Rx(Me(n,s)))),l=pn(s.shape,r);return l.length>0?H(Pe(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uq={kernelName:Ih,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=He(n.shape,s.shape);return{a:()=>{const a=B(t,Se(s,"float32")),l=pn(n.shape,r);return l.length>0?H(Pe(a,l),n.shape):a},b:()=>{const a=B(t,Se(n,"float32")),l=pn(s.shape,r);return l.length>0?H(Pe(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gq={kernelName:nx,gradFunc:t=>({x:()=>Kt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hq={kernelName:ix,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>bn(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kq={kernelName:rx,gradFunc:t=>({x:()=>it(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xq={kernelName:ox,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:s}=n;return nl(t,s).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O$={kernelName:ax,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,i=r.map(o=>o[0]);return{x:()=>kt(t,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qq={kernelName:$h,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,s,r]=e,i=n,o=s,a=He(i.shape,o.shape);return{a:()=>{const u=Se(o,"float32");let d=B(t,B(u,el(i,ze(u,ht(1)))));const h=pn(i.shape,a);return h.length>0&&(d=Pe(d,h)),H(d,i.shape)},b:()=>{const u=Hs(i,0),d=Yn(u,wi(i),it(i));let h=B(t,B(r,d));const f=pn(o.shape,a);return f.length>0&&(h=Pe(h,f)),H(h,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yq={kernelName:lx,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,s]=e,r=Hs(n,0);return{x:()=>Yn(r,t,B(t,s)),alpha:()=>{let i=Yn(r,it(t),B(t,n));const o=pn(s.shape,t.shape);return o.length>0&&(i=Pe(i,o)),H(i,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qq(t,e,n){const s=t.shape.slice();s[n]=1;const r=H(e,s),i=s1(t,n,!0,!1),o=s1(t,n,!0,!0),a=B(i,o);return B(r,a)}function Jq(t,e,n){const s=t.shape.length,r=s-n.length,i=Wt(n,s);let o=t;i!=null&&(o=rt(t,i));const a=o.shape.slice(),c=a.splice(s-n.length,n.length).reduce((h,f)=>h*f,1);a.push(c);const u=o.reshape(a);let d=Qq(u,e,r);if(d=d.reshape(o.shape),i!=null){const h=ea(i);d=rt(d,h)}return d}const Zq={kernelName:cx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;let i=[];return r==null?i=s.shape.map((o,a)=>a):typeof r=="number"?i=[r]:i=r,{x:()=>Jq(s,t,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eY={kernelName:lh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=He(n.shape,s.shape);return{a:()=>{const a=Me(t,Se(s,"float32")),l=pn(n.shape,r);return l.length>0?H(Pe(a,l),n.shape):a},b:()=>{let a=B(t,Se(n,"float32"));const l=pn(s.shape,r);l.length>0&&(a=H(Pe(a,l),s.shape));const c=Nt(s);return Kt(Me(a,Se(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tY={kernelName:Nh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Me(t,Kt(Nt(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nY={kernelName:Eh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=B(jc(n,6),qh(n));return{x:()=>B(t,Se(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sY={kernelName:Th,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,Se(qh(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rY={kernelName:ux,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>H(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iY={kernelName:hx,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>V.runKernel(Cw,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oY={kernelName:dx,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>V.runKernel(kw,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aY={kernelName:fx,gradFunc:(t,e,n)=>{const{dims:s}=n,r=Qe(s,t.shape);return{x:()=>tl(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lY={kernelName:_h,gradFunc:t=>({x:()=>it(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cY={kernelName:Rh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Kt(Me(t,B(el(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uY={kernelName:px,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>Se(it(n),"float32"),t:()=>B(t,Se(n,t.dtype)),e:()=>B(t,Se(Uw(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dY={kernelName:Ah,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Hs(n,ht(0)),r=ht(Fx),i=ht(Ox),o=B(t,i),a=B(B(t,r),vi(Se(n,"float32")));return Yn(s,o,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hY={kernelName:Ph,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,B(n,ze(ht(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fY={kernelName:Oh,gradFunc:t=>({x:()=>it(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pY={kernelName:Dh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(Mw(Se(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mY={kernelName:Fh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(VA(Se(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gY={kernelName:mx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{begin:r,size:i}=n,o=s.shape,[a,l]=Ax(s,r,i),c=[];for(let u=0;u<t.rank;u++)c.push([a[u],o[u]-a[u]-l[u]]);return{x:()=>Kw(t,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xY={kernelName:bx,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{dim:r}=n,i=!0,o=B(t,s);return{logits:()=>ze(o,B(Pe(o,[r],i),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yY={kernelName:Lh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,Wc(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P$={kernelName:xx,gradFunc:(t,e,n)=>{const{blockShape:s,paddings:r}=n;return{x:()=>Pw(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L$={kernelName:yx,gradFunc:(t,e,n)=>{const{axis:s}=n;return{x:()=>as(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bY={kernelName:Mh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Me(t,B(Mn(Se(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vY={kernelName:Sw,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,B(Se(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wY={kernelName:zh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=ht(2);return{a:()=>B(t,B(r,ze(n,s))),b:()=>B(t,B(r,ze(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kY={kernelName:Uh,gradFunc:t=>({x:()=>it(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CY={kernelName:Bh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=He(n.shape,s.shape);return{a:()=>{let a=t;const l=pn(n.shape,r);return l.length>0&&(a=Pe(a,l)),H(a,n.shape)},b:()=>{let a=t;const l=pn(s.shape,r);return l.length>0&&(a=Pe(a,l)),H(Kt(a),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SY={kernelName:gx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,r=s.shape.slice(),{axis:i}=n;Qe(i,s.shape).forEach(c=>{r[c]=1});const a=H(t,r),l=B(a,na(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IY={kernelName:Wh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Me(t,Nt(Mw(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Y={kernelName:jh,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(ze(ht(1),Nt(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NY={kernelName:Vh,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{reps:r}=n;return{x:()=>{let o=it(s);if(s.rank===1)for(let a=0;a<r[0];++a)o=xe(o,kt(t,[a*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)o=xe(o,kt(t,[a*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)o=xe(o,kt(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)for(let u=0;u<r[3];++u)o=xe(o,kt(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2],u*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TY={kernelName:sc,gradFunc:(t,e,n)=>{const s=n,{perm:r}=s,i=ea(r);return{x:()=>rt(t,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EY={kernelName:vx,gradFunc:(t,e,n)=>{const s=n,{axis:r}=s;return{value:()=>Gi(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Y={kernelName:wx,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>RY(t,n)}}};function RY(t,e){const n=ta(e,it(e)),s=Ww(t,n);let r=pl(e,ht(0,"int32"));const i=s.rank-r.rank;for(let a=0;a<i;++a)r=rs(r,a+1);r=Ui(r,na(s.shape,"bool"));const o=it(s);return Yn(r,s,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AY={kernelName:kx,gradFunc:t=>({x:()=>it(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DY=[nF,_X,RX,AX,DX,FX,OX,PX,LX,MX,zX,BX,VX,HX,KX,XX,qX,YX,QX,JX,ZX,eq,nq,tq,iq,oq,aq,lq,cq,uq,eY,dq,hq,fq,pq,mq,xq,gq,yq,bq,vq,wq,kq,Cq,Sq,Iq,$q,Nq,Tq,Rq,F$,F$,Aq,Oq,Mq,zq,Bq,Wq,jq,Vq,Uq,Gq,Hq,Kq,Xq,O$,O$,qq,Yq,Zq,tY,nY,sY,rY,iY,oY,aY,lY,cY,uY,dY,hY,fY,pY,mY,gY,xY,yY,P$,P$,L$,L$,bY,wY,vY,kY,CY,SY,IY,$Y,NY,TY,EY,_Y,AY];for(const t of DY)fH(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.abs=function(){return this.throwIfDisposed(),Gn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.acos=function(){return this.throwIfDisposed(),m6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.acosh=function(){return this.throwIfDisposed(),x6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.add=function(t){return this.throwIfDisposed(),xe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.all=function(t,e){return this.throwIfDisposed(),zA(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.any=function(t,e){return this.throwIfDisposed(),t1(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.argMax=function(t){return this.throwIfDisposed(),Td(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.argMin=function(t){return this.throwIfDisposed(),k6(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.asScalar=function(){return this.throwIfDisposed(),R(this.size===1,()=>"The array must have only 1 element."),H(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.asType=function(t){return this.throwIfDisposed(),Se(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.as1D=function(){return this.throwIfDisposed(),H(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.as2D=function(t,e){return this.throwIfDisposed(),H(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),H(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.as4D=function(t,e,n,s){return this.throwIfDisposed(),H(this,[t,e,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.as5D=function(t,e,n,s,r){return this.throwIfDisposed(),H(this,[t,e,n,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.asin=function(){return this.throwIfDisposed(),S6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.asinh=function(){return this.throwIfDisposed(),$6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.atan=function(){return this.throwIfDisposed(),T6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.atan2=function(t){return this.throwIfDisposed(),_6(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.atanh=function(){return this.throwIfDisposed(),A6(this)};se().prototype.avgPool=function(t,e,n,s){return this.throwIfDisposed(),Ow(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),Pw(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.batchNorm=function(t,e,n,s,r){return this.throwIfDisposed(),Nx(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.broadcastTo=function(t){return this.throwIfDisposed(),td(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.cast=function(t){return this.throwIfDisposed(),Se(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.ceil=function(){return this.throwIfDisposed(),i8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Vs(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof an&&(t=[t]),as([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.conv1d=function(t,e,n,s,r,i){return this.throwIfDisposed(),BA(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.conv2dTranspose=function(t,e,n,s,r){return this.throwIfDisposed(),WA(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.conv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),Za(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.cos=function(){return this.throwIfDisposed(),Mw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.cosh=function(){return this.throwIfDisposed(),VA(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),s1(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),UA(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),_8(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.depthwiseConv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),zw(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.dilation2d=function(t,e,n,s,r){return this.throwIfDisposed(),D8(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.divNoNan=function(t){return this.throwIfDisposed(),M8(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.div=function(t){return this.throwIfDisposed(),Me(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.dot=function(t){return this.throwIfDisposed(),B8(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.elu=function(){return this.throwIfDisposed(),Ex(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.equal=function(t){return this.throwIfDisposed(),bi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.erf=function(){return this.throwIfDisposed(),GA(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),J8(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.exp=function(){return this.throwIfDisposed(),vi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.expandDims=function(t){return this.throwIfDisposed(),rs(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.expm1=function(){return this.throwIfDisposed(),nK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.fft=function(){return this.throwIfDisposed(),uD(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.flatten=function(){return this.throwIfDisposed(),H(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.floor=function(){return this.throwIfDisposed(),Rx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.floorDiv=function(t){return this.throwIfDisposed(),MA(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.gather=function(t,e,n){return this.throwIfDisposed(),Ww(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.greaterEqual=function(t){return this.throwIfDisposed(),pl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.greater=function(t){return this.throwIfDisposed(),Hs(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.ifft=function(){return this.throwIfDisposed(),r1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.irfft=function(){return this.throwIfDisposed(),K7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.isFinite=function(){return this.throwIfDisposed(),dK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.isInf=function(){return this.throwIfDisposed(),fK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.isNaN=function(){return this.throwIfDisposed(),mK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.leakyRelu=function(t){return this.throwIfDisposed(),Vw(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.lessEqual=function(t){return this.throwIfDisposed(),jc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.less=function(t){return this.throwIfDisposed(),Im(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.localResponseNormalization=function(t,e,n,s){return this.throwIfDisposed(),vK(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.logSigmoid=function(){return this.throwIfDisposed(),NK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.logSoftmax=function(t){return this.throwIfDisposed(),YA(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),QA(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.log=function(){return this.throwIfDisposed(),wi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.log1p=function(){return this.throwIfDisposed(),qA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.logicalAnd=function(t){return this.throwIfDisposed(),Ui(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.logicalNot=function(){return this.throwIfDisposed(),Uw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.logicalOr=function(t){return this.throwIfDisposed(),JA(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.logicalXor=function(t){return this.throwIfDisposed(),OK(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),dt(this,t,e,n)};se().prototype.maxPool=function(t,e,n,s){return this.throwIfDisposed(),Gw(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.max=function(t,e){return this.throwIfDisposed(),Or(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.maximum=function(t){return this.throwIfDisposed(),ta(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.mean=function(t,e){return this.throwIfDisposed(),en(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.min=function(t,e){return this.throwIfDisposed(),Sm(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.minimum=function(t){return this.throwIfDisposed(),Rd(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),VK(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.mod=function(t){return this.throwIfDisposed(),GK(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.mul=function(t){return this.throwIfDisposed(),B(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.neg=function(){return this.throwIfDisposed(),Kt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.norm=function(t,e,n){return this.throwIfDisposed(),_x(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.notEqual=function(t){return this.throwIfDisposed(),$m(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),ZA(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.onesLike=function(){return this.throwIfDisposed(),mr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.pad=function(t,e){return this.throwIfDisposed(),Kw(this,t,e)};se().prototype.pool=function(t,e,n,s,r,i){return this.throwIfDisposed(),t7(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.pow=function(t){return this.throwIfDisposed(),el(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.prelu=function(t){return this.throwIfDisposed(),qw(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.prod=function(t,e){return this.throwIfDisposed(),r7(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.reciprocal=function(){return this.throwIfDisposed(),N7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.relu=function(){return this.throwIfDisposed(),gl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.relu6=function(){return this.throwIfDisposed(),nD(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.reshapeAs=function(t){return this.throwIfDisposed(),H(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.reshape=function(t){return this.throwIfDisposed(),H(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),mD(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),gD(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.reverse=function(t){return this.throwIfDisposed(),tl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.rfft=function(){return this.throwIfDisposed(),Y7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.round=function(){return this.throwIfDisposed(),sD(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.rsqrt=function(){return this.throwIfDisposed(),rD(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.selu=function(){return this.throwIfDisposed(),iD(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.separableConv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),oD(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.sigmoid=function(){return this.throwIfDisposed(),Wc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.sign=function(){return this.throwIfDisposed(),P7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.sin=function(){return this.throwIfDisposed(),aD(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.sinh=function(){return this.throwIfDisposed(),lD(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.slice=function(t,e){return this.throwIfDisposed(),kt(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.softmax=function(t){return this.throwIfDisposed(),ik(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.softplus=function(){return this.throwIfDisposed(),Hh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),Xw(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.split=function(t,e){return this.throwIfDisposed(),Ws(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.sqrt=function(){return this.throwIfDisposed(),Mn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.square=function(){return this.throwIfDisposed(),Nt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.squaredDifference=function(t){return this.throwIfDisposed(),J7(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.squeeze=function(t){return this.throwIfDisposed(),Xh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof an?[this,t]:[this,...t];return Gi(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.step=function(t){return this.throwIfDisposed(),qh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.stridedSlice=function(t,e,n,s,r,i,o,a){return this.throwIfDisposed(),s9(this,t,e,n,s,r,i,o,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.sub=function(t){return this.throwIfDisposed(),ze(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.sum=function(t,e){return this.throwIfDisposed(),Pe(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.tan=function(){return this.throwIfDisposed(),i9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.tanh=function(){return this.throwIfDisposed(),$x(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.tile=function(t){return this.throwIfDisposed(),_r(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.toBool=function(){return this.throwIfDisposed(),Se(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.toFloat=function(){return this.throwIfDisposed(),Se(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.toInt=function(){return this.throwIfDisposed(),Se(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.topk=function(t,e){return this.throwIfDisposed(),l9(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.transpose=function(t){return this.throwIfDisposed(),rt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.unique=function(t){return this.throwIfDisposed(),d9(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),fD(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.unstack=function(t){return this.throwIfDisposed(),nl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.where=function(t,e){return this.throwIfDisposed(),Yn(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */se().prototype.zerosLike=function(){return this.throwIfDisposed(),it(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class oi extends Error{constructor(e){super(e),Object.setPrototypeOf(this,oi.prototype)}}class cr extends Error{constructor(e){super(e),Object.setPrototypeOf(this,cr.prototype)}}class z extends Error{constructor(e){super(e),Object.setPrototypeOf(this,z.prototype)}}class Xe extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Xe.prototype)}}class Wk extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Wk.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class rF{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sl(t,e){if(Array.isArray(t)){let n=[];for(let s=0;s<e;s++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function ai(t,e){if(!t)throw new Wk(e)}function M$(t,e){let n=0;for(const s of t)s===e&&n++;return n}function is(t){return t.length===1?t[0]:t}function mt(t){return Array.isArray(t)?t:[t]}function Ai(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function wa(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let Qs={};function jk(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function a1(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>a1(e));else{const e=Object.keys(t);for(const n of e){const s=t[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?t[n]=s.value:a1(s))}}}function Zh(t,e={},n={},s="object",r=!1){if(typeof t=="string"){const i=t;let o;if(i in n)o=n[i];else if(i in Qs)o=Qs[i];else if(o=e[i],o==null)throw new z(`Unknown ${s}: ${t}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const i=t;if(i.className==null||i.config==null)throw new z(`${s}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const o=i.className;let a,l;if(o in n?[a,l]=n[o]:o in Qs?[a,l]=Qs.className:o in e&&([a,l]=e[o]),a==null)throw new z(`Unknown ${s}: ${o}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const f of Object.keys(Qs))c[f]=Qs[f];for(const f of Object.keys(n))c[f]=n[f];const u=i.config;u.customObjects=c;const d=Object.assign({},Qs);for(const f of Object.keys(n))Qs[f]=n[f];a1(i.config);const h=l(a,i.config,n,r);return Qs=Object.assign({},d),h}else{const c=Object.assign({},Qs);for(const d of Object.keys(n))Qs[d]=n[d];const u=new a(i.config);return Qs=Object.assign({},c),u}}}function FY(t,e){return t<e?-1:t>e?1:0}function rp(t,e){return-1*FY(t,e)}function Fo(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function OY(t){if(t==null)throw new z(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function yl(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new z(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function Vk(t,e,n=0,s=1/0){return ai(n>=0),ai(s>=n),Array.isArray(t)&&t.length>=n&&t.length<=s&&t.every(r=>typeof r===e)}function wn(t,e){Array.isArray(t)?(R(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,s)=>wn(n,`element ${s+1} of ${e}`))):R(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${iF(t)}.`)}function iF(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>iF(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function PY(t,e,n){let s=n!=null?n():ss(),r;return(...o)=>{const a=n!=null?n():ss();return a-s<e||(s=a,r=t(...o)),r}}function oF(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let LY=0;function aF(){return LY++}const ip={};function Px(t=""){return t in ip||(ip[t]=0),ip[t]+=1,t+ip[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const MY=["channelsFirst","channelsLast"],zY=["nearest","bilinear"],BY=["valid","same","causal"],WY=["max","avg"],jY=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const _l=new Map;function Yt(t){yl(MY,"DataFormat",t)}function VY(t){yl(zY,"InterpolationFormat",t)}function Ks(t){yl(BY,"PaddingMode",t)}function lF(t){yl(WY,"PoolMode",t)}const nd=[],z$="/";function La(t,e){nd.push(t);try{const n=e();return nd.pop(),n}catch(n){throw nd.pop(),n}}function UY(){return nd.length===0?"":nd.join(z$)+z$}function cF(t){if(!dF(t))throw new Error("Not a valid tensor name: '"+t+"'");return UY()+t}function uF(t){if(!dF(t))throw new Error("Not a valid tensor name: '"+t+"'");_l.has(t)||_l.set(t,0);const e=_l.get(t);if(_l.set(t,_l.get(t)+1),e>0){const n=`${t}_${e}`;return _l.set(n,1),n}else return t}const GY=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function dF(t){return!!t.match(GY)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function HY(t){return t===parseInt(t.toString(),10)}function Oo(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let s=1;for(let r=e;r<n;++r)s*=t[r];return s}function Cc(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s<e&&(e=s)}return e}function Wo(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s>e&&(e=s)}return e}function zr(t,e){if(e<t)throw new z(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let s=t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let fy;function un(){return fy==null&&(fy=zH().epsilon()),fy}function Br(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function xi(t,e){return Se(t,e)}function ef(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),H(t,n)}function KY(t,e){return Q(()=>{if(t.shape.length!==2)throw new z(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=ef(t,1);return l1(n,[1,e,1])})}function XY(t){const e=[Oo(t.shape)];return H(t,e)}function qY(t){if(t.rank<=1)throw new z(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],Oo(t.shape,1)];return H(t,e)}function Ma(t,e,n){return Q(()=>{switch(t.rank){case 1:return sk(t,e,n);case 2:return cD(t,[e,0],[n,t.shape[1]]);case 3:return rk(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return Tm(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return kt(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return kt(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new z(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function py(t,e,n){return Q(()=>{switch(t.rank){case 1:return sk(t,e,n);case 2:return cD(t,[0,e],[t.shape[0],n]);case 3:return rk(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return Tm(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new z(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function op(t,e,n,s){return Q(()=>{switch(t.rank){case 1:return sk(t,e,n);case 2:switch(s){case 1:return Ma(t,e,n);case 2:return py(t,e,n);default:throw new z(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return Ma(t,e,n);case 2:return rk(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return py(t,e,n);default:throw new z(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return Ma(t,e,n);case 2:return Tm(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return Tm(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return py(t,e,n);default:throw new z(`The axis is not within the rank of the tensor ${s}`)}default:throw new z(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Uk(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),as(t,e)}function B$(t,e){switch(t.rank){case 1:return l8([t,e]);case 2:return u8([t,e],0);case 3:return h8([t,e],0);case 4:return p8([t,e],0);default:throw new z(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function l1(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new z(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return _r(t,e)}function Lx(t,e=0,n=1,s,r){return C7(t,e,n,s,r)}function yi(t,e,n,s){if(t.rank<2||e.rank<2)throw new Xe(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=t.shape.slice(-1)[0],i=e.shape.slice(-2)[0];if(r!==i)throw new Xe(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return $$({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?c1(t.rank,s,Br()):null,activation:n});{const r=t.shape.slice(),i=r.pop();t=H(t,[-1,i]);const o=e.shape.slice(),a=o.pop(),l=o.pop(),c=[...o,a],u=Array.from({length:e.rank},(p,m)=>m===0?e.rank-2:m<=e.rank-2?m-1:m);e=H(rt(e,u),[l,-1]);const d=[...r,...c];return H($$({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?c1(t.rank,s,Br()):null,activation:n}),d)}}function hF(t,e,n){return Q(()=>(Array.isArray(e)?e=Ss(e,"int32"):e=Se(e,"int32"),Ww(t,e,n)))}function tf(t){return B(t,t)}function c1(t,e,n){const s=e.shape;if(e.rank!==1&&e.rank!==t)throw new z(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return s.length===1?H(e,[1,s[0],1,1,1]):H(e,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?H(e,[1,1,1,1,s[0]]):H(e,[1].concat(s))}else if(t===4){if(n==="channelsFirst")return s.length===1?H(e,[1,s[0],1,1]):H(e,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?H(e,[1,1,1,s[0]]):H(e,[1].concat(s))}else if(t===3){if(n==="channelsFirst")return s.length===1?H(e,[1,s[0],1]):H(e,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?H(e,[1,1,s[0]]):H(e,[1].concat(s))}else if(t<3)return e;throw new z(`Unsupported input rank by biasAdd: ${e.rank}`)}function Ur(t,e,n){return Q(()=>(n==null&&(n=Br()),Yt(n),xe(t,c1(t.rank,e,n))))}function YY(t,e=1){if(e!==1)throw new Xe(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return Ex(t)}function QY(t){return Q(()=>Me(t,xe(Gn(t),1)))}function fF(t,e,n,s){return Q(()=>y9(t,e,n,s))}function JY(t){return Q(()=>{const e=xe(.5,B(.2,t));return Vs(e,0,1)})}function nf(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const ZY=["fanIn","fanOut","fanAvg"],eQ=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tQ(t){yl(ZY,"FanMode",t)}function nQ(t){yl(eQ,"Distribution",t)}class xr extends Uc{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class pF extends xr{apply(e,n){return bn(e,n)}}pF.className="Zeros";de(pF);class Gk extends xr{apply(e,n){return na(e,n)}}Gk.className="Ones";de(Gk);class mF extends xr{constructor(e){if(super(),typeof e!="object")throw new z(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new z(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return Q(()=>B(ht(this.value),na(e,n)))}getConfig(){return{value:this.value}}}mF.className="Constant";de(mF);class gF extends xr{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return Kh(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}gF.className="RandomUniform";de(gF);class xF extends xr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Xe(`randomNormal does not support dType ${n}.`);return Lx(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}xF.className="RandomNormal";de(xF);class yF extends xr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Xe(`truncatedNormal does not support dType ${n}.`);return hD(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}yF.className="TruncatedNormal";de(yF);class bF extends xr{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return Q(()=>{if(e.length!==2||e[0]!==e[1])throw new z("Identity matrix initializer can only be used for 2D square matrices.");return B(this.gain,XA(e[0]))})}getConfig(){return{gain:this.gain}}}bF.className="Identity";de(bF);function sQ(t,e="channelsLast"){let n,s;if(Yt(e),t.length===2)n=t[0],s=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const r=Oo(t,2);n=t[1]*r,s=t[0]*r}else if(e==="channelsLast"){const r=Oo(t,0,t.length-2);n=t[t.length-2]*r,s=t[t.length-1]*r}}else{const r=Oo(t);n=Math.sqrt(r),s=Math.sqrt(r)}return[n,s]}class Rs extends xr{constructor(e){if(super(),e.scale<0)throw new z(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,tQ(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,nQ(this.distribution),this.seed=e.seed}apply(e,n){const s=sQ(e),r=s[0],i=s[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,r):this.mode==="fanOut"?o/=Math.max(1,i):o/=Math.max(1,(r+i)/2),this.distribution==="normal"){const a=Math.sqrt(o);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Xe(`${this.getClassName()} does not support dType ${n}.`);return hD(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*o);return Kh(e,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Rs.className="VarianceScaling";de(Rs);class Hk extends Rs{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Rs.className}}Hk.className="GlorotUniform";de(Hk);class Kk extends Rs{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Rs.className}}Kk.className="GlorotNormal";de(Kk);class Xk extends Rs{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Rs.className}}Xk.className="HeNormal";de(Xk);class qk extends Rs{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Rs.className}}qk.className="HeUniform";de(qk);class Yk extends Rs{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Rs.className}}Yk.className="LeCunNormal";de(Yk);class Qk extends Rs{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Rs.className}}Qk.className="LeCunUniform";de(Qk);class vF extends xr{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return Q(()=>{if(e.length<2)throw new Xe("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const s=re(e.slice(0,-1)),r=e[e.length-1],i=s*r;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const o=[Math.max(r,s),Math.min(r,s)],a=Lx(o,0,1,n,this.seed),l=pX.qr(a,!1);let c=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return c=B(c,d.sign()),s<r&&(c=c.transpose()),B(ht(this.gain),c.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}vF.className="Orthogonal";de(vF);const W$={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function j$(t,e={}){return Zh(t,sr.getMap().classNameMap,e,"initializer")}function Bt(t){return jk(t)}function Lt(t){if(typeof t=="string"){const e=t in W$?W$[t]:t;if(e==="GlorotNormal")return new Kk;if(e==="GlorotUniform")return new Hk;if(e==="HeNormal")return new Xk;if(e==="HeUniform")return new qk;if(e==="LeCunNormal")return new Yk;if(e==="LeCunUniform")return new Qk;{const n={};return n.className=e,n.config={},j$(n)}}else return t instanceof xr?t:j$(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function u1(t){return Array.isArray(t)&&Array.isArray(t[0])}function Em(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function Be(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new z(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function lt(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new z(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _m(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((s,r)=>s*r);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const V$="Variable";class rQ{constructor(e,n="float32",s=V$,r=!0,i=null){this.dtype=n??"float32",this.shape=e.shape,this.id=aF(),s=s??V$,this.originalName=cF(s),this.name=uF(this.originalName),this.trainable_=r,this.constraint=i,this.val=p9(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),iQ(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function iQ(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function d1(t){return t.map(e=>e.read())}function Jk(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class dn{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class ki{constructor(e,n,s,r,i,o,a){this.dtype=e,this.shape=n,this.sourceLayer=s,this.inputs=r,this.callArgs=i,this.outputTensorIndex=a,this.id=aF(),o!=null&&(this.originalName=cF(o),this.name=uF(this.originalName)),this.rank=n.length}}let oQ=0;class Mx{constructor(e,n){this.callArgs=n,this.id=oQ++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let aQ=0;class Je extends Uc{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=aQ++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const s=this.getClassName();n=Ai(s)+"_"+Px(s)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),s=[i].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new cr(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new z(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return is(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return is(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new oi(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new oi(`Layer ${this.name} is not connected, no input to return.`);return is(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new oi(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new oi(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return is(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=mt(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=mt(this.inputSpec);if(n.length!==s.length)throw new z(`Layer ${this.name} expects ${s.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let r=0;r<n.length;r++){const i=n[r],o=s[r];if(o==null)continue;const a=i.rank;if(o.ndim!=null&&a!==o.ndim)throw new z(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${a}`);if(o.maxNDim!=null&&a>o.maxNDim)throw new z(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${a}`);if(o.minNDim!=null&&a<o.minNDim)throw new z(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${a}.`);if(o.dtype!=null&&i.dtype!==o.dtype)throw new z(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${i.dtype}.`);if(o.axes){const l=i.shape;for(const c in o.axes){const u=Number(c),d=o.axes[c],h=u>=0?l[u]:l[l.length+u];if(d!=null&&[d,null].indexOf(h)===-1)throw new z(`Input ${r} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${d} but got shape ${l}.`)}}if(o.shape!=null)for(let l=0;l<o.shape.length;++l){const c=o.shape[l],u=i.shape[l];if(c!=null&&u!=null&&c!==u)throw new z(`Input ${r} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${i.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const s=mt(e),r=uQ(e),i=dQ(e);if(r===i)throw new z("Arguments to apply() must be all SymbolicTensors or all Tensors");return La(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const o=[];for(const a of mt(e))o.push(a.shape);this.build(is(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let o=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,o);const a=mt(o),l=[];for(let c of a)s.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(o=is(l),this.activityRegularizer!=null)throw new Xe("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=lQ(e),a=this.computeOutputShape(o);let l;const c=cQ(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?o[0]:o),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((u,d)=>new ki(c,u,this,mt(e),n,this.name,d)):l=new ki(c,a,this,mt(e),n,this.name),this.addInboundNode(e,l,null,null,o,a,n),this._refCount++,this.activityRegularizer!=null)throw new Xe("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new oi(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new oi(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new cr(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return _m(this.weights)}build(e){this.built=!0}getWeights(e=!1){return d1(e?this.trainableWeights:this.weights)}setWeights(e){Q(()=>{const n=this.weights;if(n.length!==e.length)throw new z(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const s=[],r=d1(n);for(let i=0;i<r.length;++i){const o=r[i],a=n[i],l=e[i];if(!ft(o.shape,l.shape))throw new z(`Layer weight shape ${o.shape} not compatible with provided weight shape ${l.shape}`);s.push([a,l])}Jk(s)})}addWeight(e,n,s,r,i,o,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new z(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():Lt("zeros"));const c=r.apply(n,s),u=new rQ(c,s,e,o,a);return c.dispose(),i!=null&&this.addLoss(()=>i.apply(u.read())),o==null&&(o=!0),o?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=mt(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,s){if(!this.supportsMasking)return;const r=this.computeMask(e,s),i=mt(n),o=mt(r);if(i.length!==o.length)throw new Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let a=0;a<i.length;a++)i[a].kerasMask=o[a]}addInboundNode(e,n,s,r,i,o,a=null){const l=mt(e);n=mt(n),s=mt(s),r=mt(r),i=Em(i),o=Em(o);const c=[],u=[],d=[];for(const h of l)c.push(h.sourceLayer),u.push(h.nodeIndex),d.push(h.tensorIndex);new Mx({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:d,inputTensors:l,outputTensors:n,inputMasks:s,outputMasks:r,inputShapes:i,outputShapes:o},a);for(let h=0;h<n.length;h++)n[h].sourceLayer=this,n[h].nodeIndex=this.inboundNodes.length-1,n[h].tensorIndex=h}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function lQ(t){t=mt(t);const e=[];for(const n of t)e.push(n.shape);return is(e)}function cQ(t){return"float32"}function wF(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const s=e.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let i=0;i<s.inboundLayers.length;i++){const o=s.inputTensors[i],a=s.inboundLayers[i],l=s.nodeIndices[i],c=wF(o,a,l);for(const u of c)r.indexOf(u)===-1&&r.push(u)}return r}}}function uQ(t){let e=!0;for(const n of mt(t))if(!(n instanceof ki)){e=!1;break}return e}function dQ(t){let e=!0;for(const n of mt(t))if(n instanceof ki){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class sf extends Je{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:Px("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new z("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new z("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new z("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const r=new ki(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new Mx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new z(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}sf.className="InputLayer";de(sf);function hQ(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new z("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new sf({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function fQ(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return Se(e,t.dtype)}catch{throw new z(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class vo{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof vo)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=fQ(e,n),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new z(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof ki){if(this.id2Value[e.id]==null)throw new z(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new z(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof ki){if(this.id2Value[e.id]==null)throw new z(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new z(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&et(this.id2Mask)}}const Rm=new rF,Am=new rF;function pQ(t){Rm!=null&&Rm.setMaxEntries(t),Am!=null&&Am.setMaxEntries(t)}function Pu(t,e,n,s){const r=n==null?!1:n.training,i=Array.isArray(t),o=i?t:[t],a=o.map(p=>p.name),l=[],c=e.names();for(const p of a)c.indexOf(p)!==-1?l.push(e.getValue(p)):l.push(null);const u=a.join(",")+"|"+e.names().sort().join(",");let d=Rm.get(u),h;if(d==null){const p=mQ(o,e);d=p.sorted,h=p.recipientCounts,Rm.put(u,d),Am.put(u,h)}h={},r||Object.assign(h,Am.get(u));const f=new vo(e);for(let p=0;p<d.length;++p){const m=d[p],g=m.sourceLayer;if(g instanceof sf)continue;const x=[],b=[],v=[];let w=!1;for(const _ of m.inputs){const A=f.getValue(_),O=f.getMask(_);x.push(A),b.push(O),O!=null&&(w=!0),r||(h[_.name]--,h[_.name]===0&&!e.hasKey(_)&&a.indexOf(_.name)===-1&&!A.isDisposed&&_.sourceLayer.stateful!==!0&&v.push(A))}w&&(n=n||{},n.mask=b[0]);const C=mt(g.apply(x,n));let $=null;g.supportsMasking&&($=g.computeMask(x,b));const T=xQ(m),N=Array.isArray(T)?T:[T];for(let _=0;_<N.length;++_){f.hasKey(N[_])||f.add(N[_],C[_],Array.isArray($)?$[0]:$);const A=a.indexOf(N[_].name);A!==-1&&(l[A]=C[_])}r||et(v)}return f.disposeMasks(),i?l:l[0]}function mQ(t,e){R(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(t.length===1){const r=U$(t[0],e);n=r.sorted,s=r.recipientMap}else{const r=new Set;for(const i of t){const{sorted:o,recipientMap:a}=U$(i,e);for(const l of o)r.has(l.name)||(n.push(l),r.add(l.name));for(const l in a)s[l]==null&&(s[l]=new Set),a[l].forEach(c=>s[l].add(c))}}return{sorted:n,recipientCounts:gQ(s)}}function gQ(t){const e={};for(const n in t)e[n]=t[n].size;return e}function U$(t,e){const n=new Set,s=[],r={};for(const a of e.names())n.add(a);const i=[],o=[];for(i.push(t);i.length>0;){const a=i[i.length-1];if(n.has(a.name)){i.pop();continue}const l=o[o.length-1]===i.length-1;if(a.inputs.length===0||l)i.pop(),s.push(a),n.add(a.name),l&&o.pop();else{o.push(i.length-1);for(const c of a.inputs)r[c.name]==null&&(r[c.name]=new Set),r[c.name].add(a.name),!n.has(c.name)&&i.push(c)}}return{sorted:s,recipientMap:r}}function xQ(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let s=0;s<t.sourceLayer.inboundNodes.length;++s)for(const r of t.sourceLayer.inboundNodes[s].outputTensors)if(r.id===t.id){n=s;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yQ=ee();yQ.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,pQ);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Zk(t,e){return Q(()=>Mn(Pe(B(t,t),e,!0)))}class rf extends Uc{getConfig(){return{}}}class kF extends rf{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return Q(()=>{const n=Zk(e,this.axis),s=Vs(n,0,this.maxValue);return B(e,Me(s,xe(un(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}kF.className="MaxNorm";de(kF);class CF extends rf{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return Q(()=>Me(e,xe(un(),Zk(e,this.axis))))}getConfig(){return{axis:this.axis}}}CF.className="UnitNorm";de(CF);class SF extends rf{apply(e){return gl(e)}}SF.className="NonNeg";de(SF);class IF extends rf{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return Q(()=>{const n=Zk(e,this.axis),s=xe(B(this.rate,Vs(n,this.minValue,this.maxValue)),B(1-this.rate,n));return B(e,Me(s,xe(un(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}IF.className="MinMaxNorm";de(IF);const G$={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function hn(t){return jk(t)}function H$(t,e={}){return Zh(t,sr.getMap().classNameMap,e,"constraint")}function fn(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in G$?G$[t]:t,config:{}};return H$(n)}else return t instanceof rf?t:H$(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function fa(t){if(t==null)return;const e=[],n=[],s=[];for(const r in t){const i=t[r];if(typeof i!="number"){const o=i;e.push(o.data()),n.push(r),s.push(o)}}if(e.length>0){const r=await Promise.all(e);for(let i=0;i<r.length;++i)t[n[i]]=r[i][0];et(s)}}function $F(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var K$;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(K$||(K$={}));const bQ=125;class Dd{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class vQ{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class wQ extends Dd{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const r in n){const i=n[r];if(typeof i=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+i*s;else{let o;r in this.totals?o=this.totals[r]:this.totals[r]=0;const a=Q(()=>xe(this.totals[r],B(i,s)));this.totals[r]=a,o!=null&&o.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:Q(()=>{const r=B(Me(1,this.seen),this.totals[s]);n[s]=r,this.totals[s].dispose(),mi(n[s])}))}}class kQ extends Dd{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const e=[],n=[],s=[];for(const i in this.history){const o=this.history[i];for(let a=0;a<o.length;++a)if(typeof o[a]!="number"){const l=o[a];e.push(l.data()),n.push(i),s.push(a)}}const r=await Promise.all(e);for(let i=0;i<r.length;++i)this.history[n[i]][s[i]].dispose(),this.history[n[i]][s[i]]=r[i][0]}}class CQ extends Dd{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||RD,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=bQ),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");Bb(this.yieldEvery)&&(this.maybeWait=PY(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,s){const r=[];this.yield!=null&&(await fa(s),r.push(this.yield(e,n,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await fa(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const s=[];this.epochEnd!=null&&(await fa(n),s.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,n){this.batchBegin!=null&&(await fa(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const s=[];this.batchEnd!=null&&(await fa(n),s.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):Bb(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await fa(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await fa(e),await this.trainEnd(e))}}function NF(t,e){return t==null&&(t={}),t instanceof Dd?[t]:Array.isArray(t)&&t[0]instanceof Dd?t:mt(t).map(s=>new CQ(s,e))}class er{constructor(){}static registerCallbackConstructor(e,n){R(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),er.checkForDuplicate(n),er.constructors[e]==null&&(er.constructors[e]=[]),er.constructors[e].push(n)}static checkForDuplicate(e){for(const n in er.constructors)er.constructors[+n].forEach(r=>{if(r===e)throw new z("Duplicate callback constructor.")})}static clear(){er.constructors={}}static createCallbacks(e){const n=[];for(const s in er.constructors){const r=+s;e>=r&&n.push(...er.constructors[r])}return n.map(s=>new s)}}er.constructors={};function TF(t,e,n,s,r,i,o,a,l){const c=new kQ,u=[new wQ,...er.createCallbacks(e)];t!=null&&u.push(...t),u.push(c);const d=new vQ(u);return d.setParams({epochs:n,initialEpoch:s,samples:r,steps:i,batchSize:o,verbose:e,doValidation:a,metrics:l}),{callbackList:d,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function zi(t,e={},n=!1){return Zh(t,sr.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Dm(t,e){return Q(()=>{t.dtype!=="float32"&&(t=Se(t,"float32"));const n=Pe(tf(t),e,!0),s=Tx(n.shape,un()),r=Mn(ta(n,s));return Me(t,r)})}function zx(t,e){return Q(()=>en(tf(ze(e,t)),-1))}function eC(t,e){return Q(()=>en(Gn(ze(e,t)),-1))}function tC(t,e){return Q(()=>{const n=ze(t,e),s=Vs(Gn(t),un(),Number.MAX_VALUE),r=Gn(Me(n,s));return B(100,en(r,-1))})}function SQ(t,e){return Q(()=>{const n=Vs(e,un(),Number.MAX_VALUE),s=wi(xe(1,n)),r=Vs(t,un(),Number.MAX_VALUE),i=wi(xe(1,r));return en(tf(ze(s,i)),-1)})}function IQ(t,e){return Q(()=>{const n=ta(0,ze(1,B(t,e)));return en(tf(n),-1)})}function $Q(t,e){return Q(()=>{const n=ta(0,ze(1,B(t,e)));return en(n,-1)})}function NQ(t,e){return Q(()=>{const n=Pe(B(t,e),-1),s=Or(B(ze(1,t),e),-1);return ta(0,xe(1,ze(s,n)))})}function TQ(t,e){return Q(()=>{const n=Math.log(2),s=ze(e,t),r=ze(xe(s,Hh(B(-2,s))),n);return en(r,-1)})}function Fd(t,e,n=!1){return Q(()=>{if(n)e=ik(e);else{const s=Pe(e,e.shape.length-1,!0);e=Me(e,s)}return e=Vs(e,un(),1-un()),Kt(Pe(B(Se(t,"float32"),wi(e)),e.shape.length-1))})}function Fm(t,e,n=!1){return Q(()=>{const s=Se(Rx(XY(t)),"int32");e=Vs(e,un(),1-un());const r=e.shape,i=H(ZA(s,r[r.length-1]),r);return Fd(i,e,n)})}function EQ(t,e){if(!ft(t.shape,e.shape))throw new z(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return Q(()=>{const n=gl(e),s=Kt(Gn(e));return xe(ze(n,B(e,t)),qA(vi(s)))})}function Bx(t,e){return Q(()=>{let n;return n=Vs(e,un(),1-un()),n=wi(Me(n,ze(1,n))),en(EQ(t,n),-1)})}function _Q(t,e){return Q(()=>{const n=Vs(t,un(),1),s=Vs(e,un(),1);return Pe(B(t,wi(Me(n,s))),-1)})}function RQ(t,e){return Q(()=>{const n=wi(xe(un(),e));return en(ze(e,B(t,n)),-1)})}function EF(t,e){return Q(()=>{const n=Dm(t,-1),s=Dm(e,-1),r=B(n,s);return Kt(Pe(r,-1))})}const Om={meanSquaredError:zx,meanAbsoluteError:eC,meanAbsolutePercentageError:tC,meanSquaredLogarithmicError:SQ,squaredHinge:IQ,hinge:$Q,categoricalHinge:NQ,logcosh:TQ,categoricalCrossentropy:Fd,sparseCategoricalCrossentropy:Fm,binaryCrossentropy:Bx,kullbackLeiblerDivergence:_Q,poisson:RQ,cosineProximity:EF};function my(t){if(typeof t=="string"){if(t in Om)return Om[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new z(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _F(t,e){return Q(()=>{const n=B(.5,mr(e)),s=xi(Hs(e,n),t.dtype);return en(bi(t,s),-1)})}function RF(t,e){return Q(()=>xi(bi(Td(t,-1),Td(e,-1)),"float32"))}function AQ(t,e){return Q(()=>Se(Pe(Ui(bi(t,1),bi(e,1))),"float32"))}function DQ(t,e){return Q(()=>Se(Pe(Ui(bi(t,0),bi(e,1))),"float32"))}function FQ(t,e){return Q(()=>{const n=AQ(t,e),s=DQ(t,e),r=xe(n,s);return Se(Yn(Hs(r,0),Me(n,r),0),"float32")})}function OQ(t,e){return Bx(t,e)}function PQ(t,e){return t.rank===e.rank&&(t=Xh(t,[t.rank-1])),e=Td(e,-1),e.dtype!==t.dtype&&(e=Se(e,t.dtype)),Se(bi(t,e),"float32")}const LQ=zx,MQ=zx,zQ=eC,BQ=eC,WQ=tC,jQ=tC,AF=Fd,VQ=EF,DF=Fm,Pm={binaryAccuracy:_F,categoricalAccuracy:RF,precision:FQ,categoricalCrossentropy:AF,sparseCategoricalCrossentropy:DF,mse:LQ,MSE:MQ,mae:zQ,MAE:BQ,mape:WQ,MAPE:jQ,cosine:VQ};function UQ(t){if(typeof t=="string"&&t in Pm)return Pm[t];if(typeof t!="string"&&t!=null)return t;throw new z(`Unknown metric ${t}`)}function ap(t){if(ai(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(Om))if(Om[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(Pm))if(Pm[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function GQ(t){const e={Adagrad:()=>El.adagrad(.01),Adadelta:()=>El.adadelta(1,.95,un()),Adam:()=>El.adam(.001,.9,.999,un()),Adamax:()=>El.adamax(.002,.9,.999,un(),0),RMSProp:()=>El.rmsprop(.001,.9,0,un()),SGD:()=>El.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new z(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const X$=1*1024*1024;function q$(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!h1(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(t);s.length>X$&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${X$}.`)}}function h1(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!h1(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!h1(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function HQ(t,e,n,s=console.log){const r=XQ(t),i=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(e*u)));let o;if(!r){i.push("Receives inputs"),o=[];for(const u in t.nodesByDepth)o.push(...t.nodesByDepth[u])}s("_".repeat(e)),Lm(i,n,s),s("=".repeat(e));const a=t.layers;for(let u=0;u<a.length;++u)r?qQ(a[u],n,s):YQ(a[u],n,o,s),s((u===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=KQ(t),c=_m(t.nonTrainableWeights);s(`Total params: ${l+c}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${c}`),s("_".repeat(e))}function KQ(t){let e;return t.collectedTrainableWeights!=null?e=_m(t.collectedTrainableWeights):e=_m(t.trainableWeights),e}function XQ(t){let e=!0;const n=[],s=[];for(const r in t.nodesByDepth)n.push(t.nodesByDepth[r]);for(const r of n){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of t.layers){let i=!1;for(const o of r.inboundNodes)if(s.indexOf(o)!==-1)if(i){e=!1;break}else i=!0;if(!e)break}return e}function Lm(t,e,n=console.log){let s="";for(let r=0;r<t.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=t[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);n(s)}function qQ(t,e,n){let s,r;try{r=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const i=t.name,o=t.getClassName(),a=[`${i} (${o})`,r,s,t.countParams().toString()];Lm(a,e,n)}function YQ(t,e,n,s){let r,i;try{i=t.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{i="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const o=[];for(const d of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let h=0;h<d.inboundLayers.length;++h){const f=d.inboundLayers[h].name,p=d.nodeIndices[h],m=d.tensorIndices[h];o.push(`${f}[${p}][${m}]`)}const a=t.name,l=t.getClassName(),c=o.length===0?"":o[0],u=[`${a} (${l})`,i,r,t.countParams().toString(),c];Lm(u,e,s);for(let d=1;d<o.length;++d)Lm(["","","","",o[d]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function FF(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function f1(t,e){if(t===null)return null;if(typeof t=="string")return wa(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const i=t[r];FF(e,r,i)?n.push(i):n.push(f1(i,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s];if(s==="name"&&typeof r=="string")n[s]=r;else{const i=wa(s);n[i]=f1(r,i)}}return n}}function p1(t,e){if(t==null)return null;if(typeof t=="string")return Ai(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const i=t[r];FF(e,r,i)?n.push(i):n.push(p1(i,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s],i=Ai(s);(s==="name"||s==="className")&&typeof r=="string"?n[i]=r:n[i]=p1(r,s)}return n}}/** @license See the LICENSE file. */const OF="4.20.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const QQ=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class Cr extends Je{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const b=this.getClassName().toLowerCase();this.name=Px(b)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Fo(this.inputs).length!==this.inputs.length)throw new z(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(b=>b.name)}`);Fo(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(b=>b.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const b of this.outputs){const v=b.sourceLayer,w=b.nodeIndex,C=b.tensorIndex;this.outputLayers.push(v),this.outputLayersNodeIndices.push(w),this.outputLayersTensorIndices.push(C)}for(const b of this.inputs){const v=b.sourceLayer,w=b.nodeIndex,C=b.tensorIndex;ai(w===0,"input layer has >1 nodes"),ai(C===0,"input layer has >1 tensors"),this.inputLayers.push(v),this.inputLayersNodeIndices.push(w),this.inputLayersTensorIndices.push(C)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let b=0;b<this.inputLayers.length;b++){const v=this.inputLayers[b];if(!(v instanceof sf))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${b} (0-based) originates from layer type ${v.getClassName()}.`);this.inputNames.push(v.name),this.feedInputShapes.push(v.batchInputShape),this.feedInputNames.push(v.name)}for(const b of this.outputLayers)this.outputNames.push(b.name);this.internalInputShapes=this.inputs.map(b=>b.shape),this.internalOutputShapes=this.outputs.map(b=>b.shape);const n={},s={},r={},i={},o={},a=[],l=(b,v,w,C,$,T)=>{(C==null||$==null||T==null)&&(C=b.sourceLayer,$=b.nodeIndex,T=b.tensorIndex);const N=C.inboundNodes[$];if(w.indexOf(N)!==-1)throw new cr(`The tensor ${b.name} at layer "${C.name}" is part of a cycle.`);if(v.indexOf(N)!==-1)return;this.containerNodes.add(Cr.nodeKey(C,$)),C.id in o||(o[C.id]=Object.keys(o).length),w.indexOf(N)===-1&&w.push(N);const _=N.inboundLayers.length;for(let A=0;A<_;A++){const O=N.inputTensors[A],W=N.inboundLayers[A],G=N.nodeIndices[A],q=N.tensorIndices[A];l(O,v,w,W,G,q)}for(v.push(N);w.indexOf(N)>=0;)w.splice(w.indexOf(N),1);a.push(N)},c=[],u=[];for(const b of this.outputs)l(b,c,u);const d=a.slice().reverse();for(const b of d){s[b.id]=b,b.id in n||(n[b.id]=0);let v=n[b.id];const w=r[b.outboundLayer.id]==null?0:r[b.outboundLayer.id];v=Math.max(v,w),r[b.outboundLayer.id]=v,i[b.outboundLayer.id]=b.outboundLayer,n[b.id]=v;for(let C=0;C<b.inboundLayers.length;C++){const $=b.inboundLayers[C],T=b.nodeIndices[C],N=$.inboundNodes[T],_=n[N.id]==null?0:n[N.id];n[N.id]=Math.max(v+1,_),s[N.id]=N}}const h={};for(const b in n){const v=n[b];v in h||(h[v]=[]),h[v].push(s[b])}const f={};for(const b in r){const v=r[b];v in f||(f[v]=[]),f[v].push(i[b])}let p=Object.keys(f).map(b=>parseInt(b,10)).sort(rp);this.layers=[];for(const b of p){const v=f[b];v.sort((w,C)=>{const $=o[w.id],T=o[C.id];return $<T?-1:$>T?1:0});for(const w of v)w instanceof Cr&&this.internalContainerRefs.push(w),this.layers.push(w)}this.layersByDepth=f,p=Object.keys(h).map(b=>parseInt(b,10)).sort(rp);const m=this.inputs.slice(),g=[];for(const b of p)for(const v of h[b]){const w=v.outboundLayer;if(w!=null){for(const C of v.inputTensors)if(m.indexOf(C)===-1)throw new cr(`Graph disconnected: cannot obtain value for tensor ${C} at layer "${w.name}". The following previous layers were accessed without issue: ${g}`);for(const C of v.outputTensors)m.push(C);g.push(w.name)}}this.nodesByDepth=h;const x=this.layers.map(b=>b.name);for(const b of x){const v=x.filter(w=>w===b).length;if(v!==1)throw new cr(`The name "${b}" is used ${v} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(x))}this.outboundNodes=[],this.inboundNodes=[],new Mx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(b=>null),outputMasks:this.outputs.map(b=>null),inputShapes:this.inputs.map(b=>b.shape),outputShapes:this.outputs.map(b=>b.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new z("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const s={};let r=0;const i=QQ(e);i&&this.parseWeights(e);for(const a of this.layers)for(const[l,c]of a.weights.entries()){const u=i?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(s[u]!=null)throw new z(`Duplicate weight name: ${u}`);s[u]=c,r++}const o=[];for(const a in e){let l=a;if(s[a]==null){const c=a.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(s[l]!=null)o.push([s[l],e[a]]);else if(n)throw new z(`Provided weight data has no target variable: ${a}`);delete s[l]}if(n){const a=[];for(const l in s)a.push(l);if(a.length>0)throw new z(`${a.length} of ${r} weights are not set: ${a}`)}Jk(o)}parseWeights(e){for(const n in Object.keys(e)){const s=n.split("/"),r=["vars","layer_checkpoint_dependencies"],i=s.map(o=>o.startsWith("_")?o.slice(1):o).filter(o=>!r.includes(o)).join("/");i!==n&&(e[i]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${OF}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const s=p1(this.updatedConfig());return n?JSON.stringify(s):s}call(e,n){return Q(()=>{e=mt(e);const s=new vo;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return Pu(this.outputs,s,n)})}computeMask(e,n){return Q(()=>{e=mt(e);let s;return n==null?s=sl(null,e.length):s=mt(n),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const n=Em(e);if(n.length!==this.inputLayers.length)throw new z(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],c=n[a],u=l.name+"_0_0";s[u]=c}const r=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(rp);if(r.length>1)for(const a of r){const l=this.nodesByDepth[a];for(const c of l){const u=c.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(u.id)!==-1)continue;const d=[];for(let m=0;m<c.inboundLayers.length;m++){const g=c.inboundLayers[m],x=c.nodeIndices[m],b=c.tensorIndices[m],v=`${g.name}_${x}_${b}`,w=s[v];d.push(w)}const h=u.computeOutputShape(is(d)),f=Em(h),p=u.inboundNodes.indexOf(c);for(let m=0;m<f.length;m++){const g=`${u.name}_${p}_${m}`;s[g]=f[m]}}}const i=[],o=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],c=this.outputLayersNodeIndices[a],u=this.outputLayersTensorIndices[a],d=`${l.name}_${c}_${u}`;o.push(d)}for(let a=0;a<o.length;a++){const l=o[a];ai(l in s),i.push(s[l])}return is(i)}runInternalGraph(e,n){n==null&&(n=sl(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],u=e[l],d=n[l];s[c.id]=[u,d]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(rp);for(const l of r){const c=this.nodesByDepth[l];for(const u of c){const d=u.outboundLayer,h=u.inputTensors,f=u.outputTensors,p=new Array;for(const m of h)m.id in s&&p.push(s[m.id]);if(p.length===h.length){let m={},g,x,b,v;if(u.callArgs!=null&&(m=u.callArgs),p.length===1){const[w,C]=p[0];m.mask==null&&(m.mask=C),b=mt(d.call(w,m)),v=mt(d.computeMask(w,C)),g=[w],x=[C]}else g=p.map(w=>w[0]),x=p.map(w=>w[1]),m.mask==null&&(m.mask=x),b=mt(d.call(g,m)),v=mt(d.computeMask(g,x));if(d.activityRegularizer)throw new Xe("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let w=0;w<f.length;++w){const C=f[w],$=b[w],T=v[w];s[C.id]=[$,T]}}}}const i=[],o=[],a=[];for(const l of this.outputs){ai(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[c,u]=s[l.id];a.push(c.shape),i.push(c),o.push(u)}return[i,o,a]}buildNodeConversionMap(e){const n={};let s;for(const r of this.layers){s=r instanceof Cr?1:0;for(let i=0;i<r.inboundNodes.length;i++){const o=Cr.nodeKey(r,i);this.containerNodes.has(o)&&(n[o]=s,s+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new z("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new z(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new z(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return Q(()=>{const e=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const r=Cr.nodeKey(n,s);this.containerNodes.has(r)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const o of this.layers){const a=o.getClassName(),l=o.getConfig(),c=[];for(let d=0;d<o.inboundNodes.length;d++){const h=o.inboundNodes[d],f=Cr.nodeKey(o,d);let p={};if(this.containerNodes.has(f)){if(h.callArgs)try{JSON.stringify(h.callArgs),p=h.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${h.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(h.inboundLayers.length>0){const m=[];for(let g=0;g<h.inboundLayers.length;g++){const x=h.inboundLayers[g],b=h.nodeIndices[g],v=h.tensorIndices[g],w=Cr.nodeKey(x,b);let C=n[w];C==null&&(C=0),m.push([x.name,C,v,p])}c.push(m)}}}const u={};u.name=o.name,u.className=a,u.config=l,u.inboundNodes=c,s.push(u)}e.layers=s;const r=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],l=this.inputLayersNodeIndices[o],c=Cr.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.inputLayersTensorIndices[o];r.push([a.name,u,d])}e.inputLayers=r;const i=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],l=this.outputLayersNodeIndices[o],c=Cr.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.outputLayersTensorIndices[o];i.push([a.name,u,d])}return e.outputLayers=i,e}static fromConfig(e,n,s={},r=!1){const i={},o={};function a(g,x){g.name in o?o[g.name].push(x):o[g.name]=[x]}function l(g,x){const b=[];let v;for(const w of x){const C=w[0],$=w[1],T=w[2];if(v=w[3]==null?{}:w[3],!(C in i)){a(g,x);return}const N=i[C];if(N.inboundNodes.length<=$){a(g,x);return}const _=N.inboundNodes[$];b.push(_.outputTensors[T])}b.length>0&&g.apply(is(b),v)}function c(g){const x=g.name,b=zi(g,n.customObjects!=null?n.customObjects:{});b.setFastWeightInitDuringBuild(r),i[x]=b,g.inboundNodes.forEach(w=>{if(!(w instanceof Array))throw new z(`Corrupted configuration, expected array for nodeData: ${w}`);a(b,w)})}const u=n.name,d=n.layers;for(const g of d)c(g);for(;!OY(o);)for(const g of d){const x=i[g.name];if(x.name in o){const b=o[x.name];delete o[x.name];for(const v of b)l(x,v)}}const h=[],f=[],p=n.inputLayers;for(const g of p){const x=g[0],b=g[1],v=g[2];ai(x in i);const C=i[x].inboundNodes[b].outputTensors;h.push(C[v])}const m=n.outputLayers;for(const g of m){const x=g[0],b=g[1],v=g[2];ai(x in i);const C=i[x].inboundNodes[b].outputTensors;f.push(C[v])}return new e({inputs:h,outputs:f,name:u})}get stateful(){if(this._stateful)throw new z("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){Q(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function JQ(t,e,n){const s=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>null);if(s===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==s)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const r=[];return e.forEach(i=>{i in t?r.push(t[i]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function PF(t,e){return JQ(t,e,"classWeight")}async function LF(t,e,n,s){if(n!=null){const r=Q(()=>{if(t.shape.length===1)return Pa(t);if(t.shape.length===2){if(t.shape[1]>1)return Td(t,1);if(t.shape[1]===1)return H(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await r.data());et(r);const o=[];return i.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(n[a])}),Ss(o,"float32")}else return null}function ZQ(t,e){return B(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const eJ=32;function MF(t,e){let n,s;const r=e;n=r.xs,s=r.ys,R(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const i=Y$("input",t.inputNames,n),o=Y$("output",t.outputNames,s),a=i[0].shape[0];R(i.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),R(o.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<i.length;l++)R(i[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<o.length;l++)R(o[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:i,ys:o}}function Y$(t,e,n){if(n instanceof an)return[n];if(Array.isArray(n))return R(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const s=[];for(const r of e){if(n[r]==null)throw new z(`The feature data generated by the dataset lacks the required ${t} key '${r}'.`);s.push(n[r])}return s}}function tJ(t){if(t.length===3)throw new Xe("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function nJ(t,e,n){const s=n.batchesPerEpoch!=null;if(R(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),R(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),R(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),R(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),R(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const r=n.validationData!=null;let i,o;if(r)if(Q$(n.validationData))R(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const g=tJ(n.validationData);i=g.xs,o=g.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let c;r?c=l.slice().concat(l.map(g=>"val_"+g)):c=l.slice();const u=NF(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:h,history:f}=TF(u,d,n.epochs,null,null,sJ(e,n),null,r,c);h.setModel(t),t.history=f,await h.onTrainBegin(),t.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,m=await e.iterator();for(;p<n.epochs;){const g={};await h.onEpochBegin(p);let x=0,b=0;for(s||(m=await e.iterator());!s||x<n.batchesPerEpoch;){const v=await m.next();if(s&&v.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${x} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(v.value!=null){const{xs:w,ys:C}=MF(t,v.value),$={};$.batch=b,$.size=w[0].shape[0],await h.onBatchBegin(b,$);const T=[];if(n.classWeight!=null){const A=PF(n.classWeight,t.outputNames);for(let O=0;O<A.length;++O)T.push(await LF(C[O],null,A[O]))}const N=w.concat(C).concat(T),_=a(N);et(N);for(let A=0;A<l.length;++A){const O=l[A],W=_[A];$[O]=W,mi(W)}await h.onBatchEnd(b,$),$F($),b++,x++}if(s?x>=n.batchesPerEpoch:v.done){if(r){let w;Q$(n.validationData)?w=mt(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):w=mt(t.evaluate(i,o,{batchSize:n.validationBatchSize==null?eJ:n.validationBatchSize,verbose:0}));for(let C=0;C<t.metricsNames.length;++C)g[`val_${t.metricsNames[C]}`]=w[C]}break}if(t.stopTraining_)break}if(await h.onEpochEnd(p,g),p++,t.stopTraining_)break}return await h.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function sJ(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function Q$(t){return typeof t.iterator=="function"}function rJ(t){return typeof t.next=="function"}async function iJ(t,e,n){n=n||{};const s=n.batches!=null,r=t.testFunction;let i=[];if(n.verbose>0)throw new Xe("Verbose mode is not implemented yet.");R(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const o=rJ(e)?e:await e.iterator();let a=0,l=0;for(;!s||l<n.batches;){const c=await o.next();if(i=Q(()=>{if(c.value){const{xs:u,ys:d}=MF(t,c.value),h=u.concat(d),f=Q(()=>r(h));if(et(h),l===0)for(let m=0;m<f.length;++m)i.push(ht(0));const p=h[0].shape[0];for(let m=0;m<f.length;++m){const g=f[m],x=i[m];i[m]=Q(()=>xe(i[m],B(p,g))),l>0&&et(x)}et(f),a+=p,++l}return i}),c.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<i.length;++c){const u=i[c];i[c]=Me(i[c],a),et(u)}return is(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gy(t){R(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function Iu(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(s=>Ma(s,e,n-e)):Ma(t,e,n-e)}function m1(t,e){return Q(()=>t==null?null:Array.isArray(t)?t.map(n=>m1(n,e)):hF(t,e.dtype==="int32"?e:Se(e,"int32")))}function xy(t,e){const n=[];let s=0,r=null;for(;s<t;)r=s+e,r>=t&&(r=t),n.push([s,r]),s=r;return n}function zF(t){const e=[];t instanceof an&&(t=[t]);for(let n=0;n<t.length;++n){const s=t[n];if(s.rank===1)e.push(ef(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function kr(t,e){if(t==null)return;const n=[];if(e instanceof an)n.push(e.id);else if(Array.isArray(e))e.forEach(r=>n.push(r.id));else if(e!=null)for(const r in e){const i=e[r];n.push(i.id)}const s=[];if(t instanceof an)n.indexOf(t.id)===-1&&s.push(t);else if(Array.isArray(t))t.forEach(r=>{n.indexOf(r.id)===-1&&s.push(r)});else if(t!=null)for(const r in t){const i=t[r];n.indexOf(i.id)===-1&&s.push(i)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function oJ(t){return t instanceof an}function g1(t){return Array.isArray(t)}function J$(t){return!oJ(t)&&!g1(t)}function Z$(t,e,n,s=!0,r=""){if(e==null||e.length===0){if(t!=null){let o=!1;if(g1(t)&&t.length>0)o=!0;else if(J$(t)){for(const a in t)if(t.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new z(`Error when checking model ${r} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(o=>null);let i;if(J$(t)){t=t,i=[];for(const o of e){if(t[o]==null)throw new z(`No data provided for "${o}". Need data for each key in: ${e}`);i.push(t[o])}}else if(g1(t)){if(t=t,t.length!==e.length)throw new z(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);i=t}else{if(t=t,e.length>1)throw new z(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);i=[t]}if(i=zF(i),n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new z(`Error when checking ${r}: expected ${e[o]} to have ${n[o].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[o].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[o][l];if(u!=null&&u>=0&&c!==u)throw new z(`${r} expected a batch of elements where each example has shape [${n[o].slice(1,n[o].length)}] (i.e.,tensor shape [*,${n[o].slice(1,n[o].length)}]) but the ${r} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return i}function aJ(t,e,n){const s=Fo(t.map(i=>i.shape[0]));s.sort();const r=Fo(e.map(i=>i.shape[0]));if(r.sort(),s.length>1)throw new z(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(i=>i.shape))}`);if(r.length>1)throw new z(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(s.length>0&&r.length>0&&!ft(s,r))throw new z(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function lJ(t,e,n){const s=[zx,Bx,Fd];for(let r=0;r<t.length;++r){const i=t[r],o=e[r],a=n[r];if(o!=null){if(o===Fd&&i.shape[i.shape.length-1]===1)throw new z(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(o)!==-1){const l=i.shape.slice(1),c=a.slice(1);for(let u=0;u<l.length;++u){const d=l[u],h=c[u];if(h!=null&&d!==h)throw new z(`A target Tensor with shape ${i.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function eN(t,e,n,s=!0,r=""){let i;if(Array.isArray(t)){if(t.length!==e.length)throw new z(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);i=t}else{if(e.length>1)throw new z(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);i=[t]}if(n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new z(`Error when checking ${r}: expected ${e[o]} to have ${n[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[o].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[o][l];if(u!=null&&u!==c)throw new z(`Error when checking ${r}: expected ${e[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function cJ(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(s=>n);{const s=[];for(const r of e){let i=n.hasOwnProperty(r)?n[r]:[];Array.isArray(i)||(i=[i]),s.push(i)}return s}}const uJ="layers-model";class ic extends Cr{constructor(e){super(e),this.isTraining=!1}summary(e,n,s=console.log){if(!this.built)throw new z("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");HQ(this,e,n,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=GQ(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof sa))throw new z("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const o in e.loss)if(this.outputNames.indexOf(o)===-1)throw new z(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)e.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),n.push(my(e.loss[o]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new z(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>my(a))}else{const o=my(e.loss);this.outputs.forEach(a=>{n.push(o)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const a=this.internalOutputShapes[o],l=this.outputNames[o];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[o])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],La("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const a=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([a,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const r=cJ(e.metrics,this.outputNames),i=(o,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[o]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,o])};La("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const a=r[o];(c=>{const u="";let d,h,f;for(const p of c){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const g=this.internalOutputShapes[o];g[g.length-1]===1||this.lossFunctions[o]===Bx?["accuracy","acc"].indexOf(p)!==-1?h=_F:["crossentropy","ce"].indexOf(p)!==-1&&(h=OQ):this.lossFunctions[o]===Fm?["accuracy","acc"].indexOf(p)!==-1?h=PQ:["crossentropy","ce"].indexOf(p)!==-1&&(h=DF):["accuracy","acc"].indexOf(p)!==-1?h=RF:["crossentropy","ce"].indexOf(p)!==-1&&(h=AF);let x;["accuracy","acc"].indexOf(p)!==-1?x="acc":["crossentropy","ce"].indexOf(p)!==-1&&(x="ce"),f=h,d=u+x}else f=UQ(p),d=u+ap(p);let m;La(d,()=>{m=f}),i(o,d,m)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,s={}){const r=s.batchSize==null?32:s.batchSize;gy(r);const o=this.standardizeUserDataXY(e,n,!0,r);try{const a=o[0].concat(o[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,a,r,s.verbose,s.steps);return is(c)}finally{kr(o[0],e),kr(o[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),iJ(this,e,n)}checkNumSamples(e,n,s,r="steps"){let i;if(s!=null){if(i=null,n!=null)throw new z(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new z(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return i}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new z("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),r=s?n:[n],i=this.retrieveSymbolicTensors(r),o=new vo;if(e instanceof an&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new z(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)o.add(this.inputs[l],e[l])}else for(const l of this.inputs){const c=e[l.name];if(c==null)throw new z(`No value is provided for the model's input ${l.name}`);o.add(l,c)}const a=Pu(i,o);return s?a:a[0]}retrieveSymbolicTensors(e){const n=sl(null,e.length);let s=e.length;for(const r of this.layers){const i=Array.isArray(r.output)?r.output:[r.output],o=i.map(a=>a.name);for(let a=0;a<e.length;++a){const l=o.indexOf(e[a]);if(l!==-1&&(n[a]=i[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw n.forEach((i,o)=>{i==null&&r.push(e[o])}),new z(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return n}predictLoop(e,n=32,s=!1){return Q(()=>{const r=this.checkNumSamples(e);if(s)throw new Xe("Verbose predictLoop() is not implemented yet.");const i=xy(r,n),o=this.outputs.map(a=>[]);for(let a=0;a<i.length;++a)Q(()=>{const c=i[a][0],u=i[a][1],d=Iu(e,c,u),h=[];if(Array.isArray(d))for(let p=0;p<d.length;++p)h.push({key:this.inputs[p],value:d[p]});else h.push({key:this.inputs[0],value:d});const f=new vo(h);return Pu(this.outputs,f)}).forEach((c,u)=>o[u].push(c));return is(o.map(a=>as(a,0)))})}predict(e,n={}){const s=zF(e);eN(s,this.inputNames,this.feedInputShapes,!1);try{const r=n.batchSize==null?32:n.batchSize;return gy(r),this.predictLoop(s,r)}finally{kr(s,e)}}predictOnBatch(e){eN(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,s=!0,r){if(this.optimizer_==null)throw new cr("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let o=0;o<this.feedOutputShapes.length;++o){const a=this.feedOutputShapes[o];this.feedLossFns[o]===Fm?i.push(a.slice(0,a.length-1).concat([1])):i.push(a)}if(e=Z$(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=Z$(n,this.feedOutputNames,i,!1,"target"),aJ(e,n),lJ(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new z(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,s,r,i=!0,o){const[a,l]=this.standardizeUserDataXY(e,n,i,o);if(s!=null)throw new Error("sample weight is not supported yet.");let c=null;if(r!=null){const u=PF(r,this.outputNames);c=[];for(let d=0;d<u.length;++d)c.push(await LF(l[d],null,u[d]))}return[a,l,c]}testLoop(e,n,s,r=0,i){return Q(()=>{const o=this.checkNumSamples(n,s,i,"steps"),a=[];if(r>0)throw new Xe("Verbose mode is not implemented yet.");if(i!=null)throw new Xe("steps mode in testLoop() is not implemented yet");{const l=xy(o,s),c=Ss(zr(0,o));for(let u=0;u<l.length;++u){const d=l[u][0],h=l[u][1],f=Ma(c,d,h-d),p=m1(n,f),m=e(p);if(u===0)for(let g=0;g<m.length;++g)a.push(ht(0));for(let g=0;g<m.length;++g){const x=m[g];a[g]=xe(a[g],B(h-d,x))}}for(let u=0;u<a.length;++u)a[u]=Me(a[u],o)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let s=0;s<e.length;++s){const r=e[s];let i=r;if(M$(e,r)>1){const o=M$(e.slice(0,s),r);i+=`_${o}`}n.push(i)}return n}makeTrainFunction(){return e=>{const n=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],a=()=>{const d=[];for(let m=0;m<this.inputs.length;++m)d.push({key:this.inputs[m],value:s[m]});const h=new vo(d),f=Pu(this.outputs,h,{training:!0});let p;for(let m=0;m<this.lossFunctions.length;++m){const g=this.lossFunctions[m];let x=g(r[m],f[m]);i[m]!=null&&(x=ZQ(x,i[m]));const b=en(x);n.push(b),m===0?p=x:p=xe(p,x)}for(let m=0;m<this.metricsTensors.length;++m){let g;if(this.outputs.length>1&&m<this.outputs.length)g=n[m];else{const x=this.metricsTensors[m][0],b=this.metricsTensors[m][1];g=en(x(r[b],f[b]))}mi(g),o.push(g)}return p=en(p),this.calculateLosses().forEach(m=>{p=xe(p,m)}),p},l=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(a,!0,l)].concat(o)}}makeTestFunction(){this.testFunction=e=>Q(()=>{const n=[];let s;const r=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let c=0;c<this.inputs.length;++c)o.push({key:this.inputs[c],value:r[c]});const a=new vo(o),l=Pu(this.outputs,a);for(let c=0;c<this.lossFunctions.length;++c){const u=this.lossFunctions[c],d=en(u(i[c],l[c]));c===0?s=d:s=xe(s,d),n.push(s)}for(let c=0;c<this.metricsTensors.length;++c){const u=this.metricsTensors[c][0],d=this.metricsTensors[c][1],h=en(u(i[d],l[d]));n.push(h)}return n})}async fit(e,n,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,i,o,a,l,c,u,d,h;try{const f=s.batchSize==null?32:s.batchSize;gy(f);const m=await this.standardizeUserData(e,n,s.sampleWeight,s.classWeight,!1,f);r=m[0],i=m[1],h=m[2];let g=!1,x;if(s.validationData!=null&&s.validationData.length>0){if(g=!0,s.validationData.length===2)l=s.validationData[0],c=s.validationData[1];else throw s.validationData.length===3?new Xe("validationData including sample weights is not supported yet."):new z(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const A=await this.standardizeUserData(l,c,null,null,!0,f);u=A[0],d=A[1],x=u.concat(d)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){g=!0;const _=Math.floor(r[0].shape[0]*(1-s.validationSplit)),A=r[0].shape[0];u=Iu(r,_,A),o=r,r=Iu(r,0,_),d=Iu(i,_,A),a=i,i=Iu(i,0,_),x=u.concat(d)}else s.validationSteps!=null&&(g=!0);const b=r.concat(i).concat(h);this.checkTrainableWeightsConsistency();const v=this.makeTrainFunction(),w=this.getDedupedMetricsNames();let C,$;g?(this.makeTestFunction(),C=this.testFunction,$=w.slice().concat(w.map(_=>"val_"+_))):(C=null,x=[],$=w.slice());const T=NF(s.callbacks,s.yieldEvery);return await this.fitLoop(v,b,w,f,s.epochs,s.verbose,T,C,x,s.shuffle,$,s.initialEpoch,null,null)}finally{this.isTraining=!1,kr(r,e),kr(i,n),kr(o,e),kr(a,n),kr(u,l),kr(d,c),h!=null&&et(h)}}async fitLoop(e,n,s,r,i,o,a,l,c,u,d,h,f,p){r==null&&(r=32),i==null&&(i=1),u==null&&(u=!0),h==null&&(h=0);let m=!1;if(l!=null&&c!=null&&(m=!0),p!=null&&(m=!0,f==null))throw new z("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const g=this.checkNumSamples(n,r,f,"steps_per_epoch");let x;g!=null&&(x=zr(0,g)),o==null&&(o=1);const{callbackList:b,history:v}=TF(a,o,i,h,g,f,r,m,d);b.setModel(this),this.history=v,await b.onTrainBegin(),this.stopTraining_=!1;for(let w=h;w<i;++w){await b.onEpochBegin(w);const C={};if(f!=null)throw new Xe("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new Xe("batch shuffling is not implemneted yet");u&&qG(x);const $=Ss(x),T=xy(g,r);for(let N=0;N<T.length;++N){const _={};if(await b.onBatchBegin(N,_),Q(()=>{const A=T[N][0],O=T[N][1],W=Ma($,A,O-A);_.batch=N,_.size=O-A;const G=m1(n,W),q=e(G);for(let U=0;U<s.length;++U){const Y=s[U],te=q[U];_[Y]=te,mi(te)}if(N===T.length-1&&m){const U=this.testLoop(l,c,r);for(let Y=0;Y<s.length;++Y){const te=s[Y],M=U[Y];mi(M),C["val_"+te]=M}}}),await b.onBatchEnd(N,_),$F(_),this.stopTraining_)break}$.dispose()}if(await b.onEpochEnd(w,C),this.stopTraining_)break}return await b.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return nJ(this,e,n)}async trainOnBatch(e,n){const s=await this.standardizeUserData(e,n),r=s[0],i=s[1],a=this.makeTrainFunction()(r.concat(i)),l=[];for(const c of a){const u=await c.data();l.push(u[0])}return et(a),kr(s[0],e),kr(s[1],n),is(l)}getNamedWeights(e){const n=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,i=this.getWeights(s);for(let o=0;o<r.length;++o)s&&!r[o].trainable||n.push({name:r[o].originalName,tensor:i[o]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=v$().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-v$().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=Ai(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>Ai(n))}else{const n=Object.keys(this.loss);e={};const s=this.loss;for(const r of n)if(typeof s[r]=="string")e[r]=Ai(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Ai(ap(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Ai(ap(e)));{const e={};for(const n in this.metrics)e[n]=Ai(ap(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=f1(e.optimizer_config),s=zi(n);let r;if(typeof e.loss=="string")r=wa(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(o=>wa(o));else if(e.loss!=null){r={};for(const o in e.loss)r[o]=wa(e.loss[o])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(o=>wa(o));else if(e.metrics!=null){i={};for(const o in e.metrics)i[o]=wa(e.metrics[o])}this.compile({loss:r,metrics:i,optimizer:s})}async save(e,n){if(typeof e=="string"){const c=UH(e);if(c.length===0)throw new z(`Cannot find any save handlers for URL '${e}'`);if(c.length>1)throw new z(`Found more than one (${c.length}) save handlers for URL '${e}'`);e=c[0]}if(e.save==null)throw new z("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await k$(this.getNamedWeights(n)),a={modelTopology:this.toJSON(null,!1),format:uJ,generatedBy:`TensorFlow.js tfjs-layers v${OF}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:u,specs:d}=await k$(await this.optimizer.getWeights(),c);s.specs.push(...d),s.data=VH([s.data,u])}return this.userDefinedMetadata!=null&&(q$(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=s.data,a.weightSpecs=s.specs,e.save(a)}setUserDefinedMetadata(e){q$(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}ic.className="Model";de(ic);class BF extends ic{}BF.className="Functional";de(BF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Od extends ic{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:Px("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new z(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof Od||e instanceof ic;let s;if(n){if(s=e,s.outputs.length!==1)throw new z("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new z("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new z("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=hQ({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new z(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new z("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=wF(this.outputs[0])}this.inboundNodes=[],new Mx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:sl(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(lt(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new ic({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,s=console.log){this.built||this.build(),super.summary(e,n,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,s={}){if(!this.built)throw new cr("The model needs to be compiled before being used.");return this.model.evaluate(e,n,s)}async evaluateDataset(e,n){if(!this.built)throw new cr("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,s={}){if(!this.built)throw new cr("The model needs to be compiled before being used.");return this.model.fit(e,n,s)}async fitDataset(e,n){if(!this.built)throw new cr("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,s={},r=!1){let i,o={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new z("Legacy serialization format not supported yet.");i=n}else R(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=n.layers,delete n.layers,o=n;const a=new e(o);if(!(a instanceof Od))throw new Xe(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of i){const u=zi(l,void 0,r);r&&u.setFastWeightInitDuringBuild(!0),a.add(u)}return a}set stopTraining(e){if(this.model==null)throw new z("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new z("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),e.push(s)}return{name:this.name,layers:e}}}Od.className="Sequential";de(Od);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Bn=class extends Uc{getConfig(){return{}}};class WF extends Bn{apply(e,n=1){return YY(e,n)}}WF.className="elu";de(WF);class jF extends Bn{apply(e){return iD(e)}}jF.className="selu";de(jF);class VF extends Bn{apply(e){return gl(e)}}VF.className="relu";de(VF);class UF extends Bn{apply(e){return Q(()=>Rd(6,gl(e)))}}UF.className="relu6";de(UF);class GF extends Bn{apply(e){return e}}GF.className="linear";de(GF);class HF extends Bn{apply(e){return Wc(e)}}HF.className="sigmoid";de(HF);class KF extends Bn{apply(e){return JY(e)}}KF.className="hardSigmoid";de(KF);class XF extends Bn{apply(e){return Hh(e)}}XF.className="softplus";de(XF);class qF extends Bn{apply(e){return QY(e)}}qF.className="softsign";de(qF);class YF extends Bn{apply(e){return $x(e)}}YF.className="tanh";de(YF);let nC=class extends Bn{apply(e,n=-1){return ik(e,n)}};nC.className="softmax";de(nC);class QF extends Bn{apply(e,n=-1){return YA(e,n)}}QF.className="logSoftmax";de(QF);class JF extends Bn{apply(e){return Q(()=>Q(()=>{const n=Math.sqrt(2),s=B(.5,xe(1,GA(Me(e,n))));return B(e,s)}))}}JF.className="gelu";de(JF);class ZF extends Bn{apply(e){return Q(()=>B(.5,B(e,xe(1,$x(B(Mn(Me(2,Math.PI)),xe(e,B(.044715,el(e,3)))))))))}}ZF.className="gelu_new";de(ZF);class eO extends Bn{apply(e){return Q(()=>B(e,$x(Hh(e))))}}eO.className="mish";de(eO);class tO extends Bn{apply(e,n=1){return Q(()=>B(Wc(B(e,n)),e))}}tO.className="swish";de(tO);function jo(t){return t.getClassName()}function yy(t,e={}){return Zh(t,sr.getMap().classNameMap,e,"activation")}function Vo(t){if(t==null){const e={};return e.className="linear",e.config={},yy(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},yy(e)}else return t instanceof Bn?t:yy(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dJ(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class nO extends Uc{}class sO extends nO{constructor(e){super(),dJ(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return Q(()=>{let n=bn([1]);return this.hasL1&&(n=xe(n,Pe(B(this.l1,Gn(e))))),this.hasL2&&(n=xe(n,Pe(B(this.l2,tf(e))))),H(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}sO.className="L1L2";de(sO);const tN={l1l2:"L1L2"};function vt(t){return jk(t)}function nN(t,e={}){return Zh(t,sr.getMap().classNameMap,e,"regularizer")}function Mt(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in tN?tN[t]:t,config:{}};return nN(n)}else return t instanceof nO?t:nN(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class rO extends Je{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=Be(e);let s=gl(e);return this.maxValue!=null&&(s=Vs(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}rO.className="ReLU";de(rO);class iO extends Je{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=Be(e);return Vw(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}iO.className="LeakyReLU";de(iO);class oO extends Je{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=Lt(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Mt(e.alphaRegularizer),this.alphaConstraint=fn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new z(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=lt(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)n[r-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new dn({ndim:e.length,axes:s})],this.built=!0}call(e,n){return e=Be(e),qw(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Bt(this.alphaInitializer),alphaRegularizer:vt(this.alphaRegularizer),alphaConstraint:hn(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}oO.className="PReLU";de(oO);let aO=class extends Je{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Xe(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=Be(e);return Ex(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};aO.className="ELU";de(aO);class lO extends Je{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const s=Be(e);return B(s,Se(Hs(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}lO.className="ThresholdedReLU";de(lO);class cO extends Je{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new nC().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return Q(()=>{let s=Be(e);const r=n.mask;if(r!=null){const i=B(ze(na(s.shape),Se(r,s.dtype)),ht(-1e9));s=xe(s,i)}return this.axis instanceof Array?this.axis.length>1?vi(ze(s,QA(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}cO.className="Softmax";de(cO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function oc(t,e,n){if(typeof t=="number")return sl(t,e);if(t.length!==e)throw new z(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let s=0;s<e;++s){const r=t[s];if(!HY(r))throw new z(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${r}`)}return t}function Pr(t,e,n,s,r=1){if(t==null)return t;const i=e+(e-1)*(r-1);let o;return n==="same"?o=t:o=t-i+1,Math.floor((o+s-1)/s)}function li(t,e,n,s){if(t==null)return null;if(s==="valid")t=t*e+Wo([n-e,0]);else if(s==="same")t=t*e;else throw new z(`Unsupport padding mode: ${s}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sC(t,e){return Q(()=>(Yt(e),e==="channelsFirst"?rt(t,[0,2,3,1]):t))}function uO(t,e){return Q(()=>(Yt(e),e==="channelsFirst"?rt(t,[0,2,3,4,1]):t))}function hJ(t,e,n,s=1,r="valid",i,o=1){return Q(()=>{if(i==null&&(i=Br()),Yt(i),t.shape.length!==3)throw new z(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new z(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new z(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(i==="channelsFirst"&&(t=rt(t,[0,2,1])),r==="causal")throw new Xe("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=BA(t,e,s,r==="same"?"same":"valid","NWC",o);return n!=null&&(a=Ur(a,n)),a})}function sN(t,e,n,s=[1,1],r="valid",i,o,a=null){return Q(()=>{if(i==null&&(i=Br()),Yt(i),t.rank!==3&&t.rank!==4)throw new z(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new z(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=sC(t,i);if(r==="causal")throw new Xe("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=w9({x:l,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:a}),i==="channelsFirst"&&(l=rt(l,[0,3,1,2])),l})}function fJ(t,e,n,s=[1,1,1],r="valid",i,o){return Q(()=>{if(i==null&&(i=Br()),Yt(i),t.rank!==4&&t.rank!==5)throw new z(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new z(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=uO(t,i);if(r==="causal")throw new Xe("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=v8(a,e,s,r==="same"?"same":"valid","NDHWC",o),n!=null&&(a=Ur(a,n)),i==="channelsFirst"&&(a=rt(a,[0,4,1,2,3])),a})}class Wx extends Je{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Wx.verifyArgs(n),this.rank=e,wn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Xe(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=oc(n.kernelSize,e,"kernelSize"),this.strides=oc(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,Ks(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Yt(this.dataFormat),this.activation=Vo(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=Lt(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=fn(n.biasConstraint),this.biasRegularizer=Mt(n.biasRegularizer),this.activityRegularizer=Mt(n.activityRegularizer),this.dilationRate=oc(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new z(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new z(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new z(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(ai("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!Vk(e.kernelSize,"number",1,3))throw new z(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:jo(this.activation),useBias:this.useBias,biasInitializer:Bt(this.biasInitializer),biasRegularizer:vt(this.biasRegularizer),activityRegularizer:vt(this.activityRegularizer),biasConstraint:hn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class Gc extends Wx{constructor(e,n){super(e,n),this.kernel=null,Gc.verifyArgs(n),this.filters=n.filters,wn(this.filters,"filters"),this.kernelInitializer=Lt(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=fn(n.kernelConstraint),this.kernelRegularizer=Mt(n.kernelRegularizer)}build(e){e=lt(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new z(`The channel dimension of the input should be defined. Found ${e[n]}`);const s=e[n],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(e,n){return Q(()=>{e=Be(e);let s;const r=this.bias==null?null:this.bias.read(),i=oF(this.activation.getClassName());if(i!=null&&this.rank===2)s=sN(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)s=hJ(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=sN(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=fJ(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Xe("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=lt(e);const n=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<s.length;++i){const o=Pr(s[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);n.push(o)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(n),r.push(this.filters)):(r.push(this.filters),r=r.concat(n)),r}getConfig(){const e={filters:this.filters,kernelInitializer:Bt(this.kernelInitializer),kernelRegularizer:vt(this.kernelRegularizer),kernelConstraint:hn(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new z(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class of extends Gc{constructor(e){super(2,e),of.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!Vk(e.kernelSize,"number",1,2))throw new z(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}of.className="Conv2D";de(of);class af extends Gc{constructor(e){super(3,e),af.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new z(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}af.className="Conv3D";de(af);class dO extends of{constructor(e){if(super(e),this.inputSpec=[new dn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new z(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=lt(e),e.length!==4)throw new z("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new z("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new dn({ndim:4,axes:{[n]:s}})],this.built=!0}call(e,n){return Q(()=>{let s=Be(e);if(s.shape.length!==4)throw new z(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let o,a;this.dataFormat==="channelsFirst"?(o=2,a=3):(o=1,a=2);const l=r[o],c=r[a],u=this.kernelSize[0],d=this.kernelSize[1],h=this.strides[0],f=this.strides[1],p=li(l,h,u,this.padding),m=li(c,f,d,this.padding),g=[i,p,m,this.filters];this.dataFormat!=="channelsLast"&&(s=rt(s,[0,2,3,1]));let x=WA(s,this.kernel.read(),g,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(x=rt(x,[0,3,1,2])),this.bias!=null&&(x=Ur(x,this.bias.read(),this.dataFormat)),this.activation!=null&&(x=this.activation.apply(x)),x})}computeOutputShape(e){e=lt(e);const n=e.slice();let s,r,i;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3):(s=3,r=1,i=2);const o=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return n[s]=this.filters,n[r]=li(n[r],l,o,this.padding),n[i]=li(n[i],c,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}dO.className="Conv2DTranspose";de(dO);class hO extends af{constructor(e){if(super(e),this.inputSpec=[new dn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new z(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=lt(e),e.length!==5)throw new z("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new z("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new dn({ndim:5,axes:{[n]:s}})],this.built=!0}call(e,n){return Q(()=>{let s=Be(e);if(s.shape.length!==5)throw new z(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let o,a,l;this.dataFormat==="channelsFirst"?(l=2,o=3,a=4):(l=1,o=2,a=3);const c=r[l],u=r[o],d=r[a],h=this.kernelSize[0],f=this.kernelSize[1],p=this.kernelSize[2],m=this.strides[0],g=this.strides[1],x=this.strides[2],b=li(c,m,h,this.padding),v=li(u,g,f,this.padding),w=li(d,x,p,this.padding),C=[i,b,v,w,this.filters];this.dataFormat!=="channelsLast"&&(s=rt(s,[0,2,3,4,1]));let $=C8(s,this.kernel.read(),C,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&($=rt($,[0,4,1,2,3])),this.bias!==null&&($=Ur($,this.bias.read(),this.dataFormat)),this.activation!==null&&($=this.activation.apply($)),$})}computeOutputShape(e){e=lt(e);const n=e.slice();let s,r,i,o;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3,o=4):(s=4,r=1,i=2,o=3);const a=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],u=this.strides[0],d=this.strides[1],h=this.strides[2];return n[s]=this.filters,n[r]=li(n[r],u,a,this.padding),n[i]=li(n[i],d,l,this.padding),n[o]=li(n[o],h,c,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}hO.className="Conv3DTranspose";de(hO);class fO extends Gc{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new z("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new z("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new z(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=Lt(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Mt(n.depthwiseRegularizer),this.depthwiseConstraint=fn(n.depthwiseConstraint),this.pointwiseInitializer=Lt(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Mt(n.pointwiseRegularizer),this.pointwiseConstraint=fn(n.pointwiseConstraint)}build(e){if(e=lt(e),e.length<this.rank+2)throw new z(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new z(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const s=e[n],r=this.kernelSize.concat([s,this.depthMultiplier]),i=[];for(let a=0;a<this.rank;++a)i.push(1);i.push(s*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new dn({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(e,n){return Q(()=>{e=Be(e);let s;if(this.rank===1)throw new Xe("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=rt(e,[0,2,3,1])),s=oD(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=Ur(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=rt(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Bt(this.depthwiseInitializer),e.pointwiseInitializer=Bt(this.pointwiseInitializer),e.depthwiseRegularizer=vt(this.depthwiseRegularizer),e.pointwiseRegularizer=vt(this.pointwiseRegularizer),e.depthwiseConstraint=hn(this.depthwiseConstraint),e.pointwiseConstraint=hn(this.pointwiseConstraint),e}}fO.className="SeparableConv";class pO extends fO{constructor(e){super(2,e)}}pO.className="SeparableConv2D";de(pO);class jx extends Gc{constructor(e){super(1,e),jx.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!Vk(e.kernelSize,"number",1,1))throw new z(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}jx.className="Conv1D";de(jx);class mO extends Je{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return Q(()=>{if(e=Be(e),this.dataFormat==="channelsLast"){const s=op(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return op(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=op(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return op(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}mO.className="Cropping2D";de(mO);class gO extends Je{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Yt(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,VY(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,s]}else{const n=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],n,s,e[3]]}}call(e,n){return Q(()=>{let s=Be(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=rt(s,[0,2,3,1]);const i=this.size[0]*r[2],o=this.size[1]*r[3],a=this.interpolation==="nearest"?Li.resizeNearestNeighbor(s,[i,o]):Li.resizeBilinear(s,[i,o]);return rt(a,[0,3,1,2])}else{const i=this.size[0]*r[1],o=this.size[1]*r[2];return this.interpolation==="nearest"?Li.resizeNearestNeighbor(s,[i,o]):Li.resizeBilinear(s,[i,o])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}gO.className="UpSampling2D";de(gO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pJ(t,e,n=[1,1],s="valid",r,i){return Q(()=>{r==null&&(r=Br()),Yt(r);let o=sC(t,r);if(t.rank!==4)throw new z(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new z(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return o=zw(o,e,n,s==="same"?"same":"valid","NHWC",i),r==="channelsFirst"&&(o=rt(o,[0,3,1,2])),o})}class xO extends Wx{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=Lt(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=fn(e.depthwiseConstraint),this.depthwiseRegularizer=Mt(e.depthwiseRegularizer)}build(e){if(e=lt(e),e.length<4)throw new z(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new z(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const s=e[n],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return Q(()=>{e=Be(e);let s=pJ(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=Ur(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=lt(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=Pr(n,this.kernelSize[0],this.padding,this.strides[0]),o=Pr(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,i,o]:[e[0],i,o,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Bt(this.depthwiseInitializer),e.depthwiseRegularizer=vt(this.depthwiseRegularizer),e.depthwiseConstraint=hn(this.depthwiseRegularizer),e}}xO.className="DepthwiseConv2D";de(xO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yO(t,e,n,s){if(Array.isArray(t)){if(e!=null||n!=null)throw new z("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=t.slice(t.length-s,t.length),t=t.slice(0,t.length-s)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function r(i){return i==null||Array.isArray(i)?i:[i]}return e=r(e),n=r(n),{inputs:t,initialState:e,constants:n}}function bO(t,e,n,s=!1,r,i,o=!1,a=!1){return Q(()=>{const l=e.shape.length;if(l<3)throw new z(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(zr(2,l));e=rt(e,c),o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=Se(Se(r,"bool"),"float32"),r.rank===l-1&&(r=rs(r,-1)),r=rt(r,c)),s&&(e=tl(e,0),r!=null&&(r=tl(r,0)));const u=[];let d,h=n;const f=e.shape[0],p=nl(e);let m;r!=null&&(m=nl(r));for(let x=0;x<f;++x){const b=p[x],v=Q(()=>t(b,h));if(r==null)d=v[0],h=v[1];else{const w=Q(()=>{const C=m[x],$=ze(mr(C),C),T=xe(B(v[0],C),B(h[0],$)),N=h.map((_,A)=>xe(B(v[1][A],C),B(_,$)));return{output:T,newStates:N}});d=w.output,h=w.newStates}a&&u.push(d)}let g;return a&&(g=Gi(u,1)),[d,g,h]})}class ra extends Je{constructor(e){super(e);let n;if(e.cell==null)throw new z("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new oC({cells:e.cell}):n=e.cell,n.stateSize==null)throw new z("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new dn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return zr(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){u1(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const i=[];for(const o of n)i.push([e[0],o]);return[r].concat(i)}else return r}computeMask(e,n){return Q(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const r=this.states.map(i=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<e;++s)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Xe("Constants support is not implemented in RNN yet.");u1(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new dn({shape:[n,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!ft(this.stateSpec.map(o=>o.shape[o.shape.length-1]),i))throw new z(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(o=>new dn({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){Q(()=>{if(!this.stateful)throw new oi("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new z("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>bn([s,r])):this.states_=[bn([s,this.cell.stateSize])];else if(e==null)et(this.states_),this.keptStates!=null&&(et(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>bn([s,r])):this.states_[0]=bn([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new z(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):et(this.states_);for(let r=0;r<this.states_.length;++r){const i=e[r],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,a=[s,o];if(!ft(i.shape,a))throw new z(`State ${r} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${i.shape}`);this.states_[r]=i}}this.states_=this.states_.map(r=>mi(r.clone()))})}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const i=yO(e,s,r,this.numConstants);e=i.inputs,s=i.initialState,r=i.constants;let o=[],a=[];if(s!=null){n.initialState=s,o=o.concat(s),this.stateSpec=[];for(const c of s)this.stateSpec.push(new dn({shape:c.shape}));a=a.concat(this.stateSpec)}if(r!=null&&(n.constants=r,o=o.concat(r),this.numConstants=r.length),o[0]instanceof ki){const c=[e].concat(o),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return Q(()=>{const s=n==null?null:n.mask,r=n==null?null:n.training;let i=n==null?null:n.initialState;e=Be(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==o)throw new z(`RNN Layer has ${o} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:r},c=bO((p,m)=>{const g=this.cell.call([p].concat(m),a);return[g[0],g.slice(1)]},e,i,this.goBackwards,s,null,this.unroll,this.returnSequences),u=c[0],d=c[1],h=c[2];this.stateful&&this.resetStates(h,r);const f=this.returnSequences?d:u;return this.returnState?[f].concat(h):f})}getInitialState(e){return Q(()=>{let n=bn(e.shape);return n=Pe(n,[1,2]),n=ef(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?l1(n,[1,s]):n):this.cell.stateSize>1?[l1(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===ra.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),n)}static fromConfig(e,n,s={}){const r=n.cell,i=zi(r,s);return new e(Object.assign(n,{cell:i}))}}ra.className="RNN";de(ra);class Vx extends Je{}class rC extends Vx{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,wn(this.units,"units"),this.activation=Vo(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Lt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Lt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Lt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Mt(e.kernelRegularizer),this.recurrentRegularizer=Mt(e.recurrentRegularizer),this.biasRegularizer=Mt(e.biasRegularizer),this.kernelConstraint=fn(e.kernelConstraint),this.recurrentConstraint=fn(e.recurrentConstraint),this.biasConstraint=fn(e.biasConstraint),this.dropout=Cc([1,Wo([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Cc([1,Wo([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=lt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return Q(()=>{if(e=e,e.length!==2)throw new z(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Uo({ones:()=>mr(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Uo({ones:()=>mr(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let i;const o=this.dropoutMask,a=this.recurrentDropoutMask;o!=null?i=yi(B(e,o),this.kernel.read()):i=yi(e,this.kernel.read()),this.bias!=null&&(i=Ur(i,this.bias.read())),a!=null&&(s=B(s,a));let l=xe(i,yi(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:jo(this.activation),useBias:this.useBias,kernelInitializer:Bt(this.kernelInitializer),recurrentInitializer:Bt(this.recurrentInitializer),biasInitializer:Bt(this.biasInitializer),kernelRegularizer:vt(this.kernelRegularizer),recurrentRegularizer:vt(this.recurrentRegularizer),biasRegularizer:vt(this.biasRegularizer),activityRegularizer:vt(this.activityRegularizer),kernelConstraint:hn(this.kernelConstraint),recurrentConstraint:hn(this.recurrentConstraint),biasConstraint:hn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}rC.className="SimpleRNNCell";de(rC);class vO extends ra{constructor(e){e.cell=new rC(e),super(e)}call(e,n){return Q(()=>{this.cell.dropoutMask!=null&&(et(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(et(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return new e(n)}}vO.className="SimpleRNN";de(vO);class iC extends Vx{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new z("GRUCell does not support reset_after parameter set to true.");this.units=e.units,wn(this.units,"units"),this.activation=Vo(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Vo(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Lt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Lt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Lt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Mt(e.kernelRegularizer),this.recurrentRegularizer=Mt(e.recurrentRegularizer),this.biasRegularizer=Mt(e.biasRegularizer),this.kernelConstraint=fn(e.kernelConstraint),this.recurrentConstraint=fn(e.recurrentConstraint),this.biasConstraint=fn(e.biasConstraint),this.dropout=Cc([1,Wo([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Cc([1,Wo([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=lt(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return Q(()=>{if(e=e,e.length!==2)throw new z(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training==null?!1:n.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Uo({ones:()=>mr(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Uo({ones:()=>mr(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let a,l,c;0<this.dropout&&this.dropout<1&&(e=B(e,i[0]));let u=yi(e,this.kernel.read());this.useBias&&(u=Ur(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=B(r,o[0]));const d=this.recurrentKernel.read(),[h,f]=Ws(d,[2*this.units,this.units],d.rank-1),p=yi(r,h),[m,g,x]=Ws(u,3,u.rank-1),[b,v]=Ws(p,2,p.rank-1);a=this.recurrentActivation.apply(xe(m,b)),l=this.recurrentActivation.apply(xe(g,v));const w=yi(B(l,r),f);c=this.activation.apply(xe(x,w));const C=xe(B(a,r),B(xe(1,Kt(a)),c));return[C,C]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:jo(this.activation),recurrentActivation:jo(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Bt(this.kernelInitializer),recurrentInitializer:Bt(this.recurrentInitializer),biasInitializer:Bt(this.biasInitializer),kernelRegularizer:vt(this.kernelRegularizer),recurrentRegularizer:vt(this.recurrentRegularizer),biasRegularizer:vt(this.biasRegularizer),activityRegularizer:vt(this.activityRegularizer),kernelConstraint:hn(this.kernelConstraint),recurrentConstraint:hn(this.recurrentConstraint),biasConstraint:hn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}iC.className="GRUCell";de(iC);class wO extends ra{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new iC(e),super(e)}call(e,n){return Q(()=>{this.cell.dropoutMask!=null&&(et(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(et(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}wO.className="GRU";de(wO);class Ux extends Vx{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,wn(this.units,"units"),this.activation=Vo(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Vo(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Lt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Lt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Lt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Mt(e.kernelRegularizer),this.recurrentRegularizer=Mt(e.recurrentRegularizer),this.biasRegularizer=Mt(e.biasRegularizer),this.kernelConstraint=fn(e.kernelConstraint),this.recurrentConstraint=fn(e.recurrentConstraint),this.biasConstraint=fn(e.biasConstraint),this.dropout=Cc([1,Wo([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Cc([1,Wo([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=lt(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,o=this.units;r=new(n=class extends xr{apply(l,c){const u=i.apply([o]),d=new Gk().apply([o]),h=i.apply([o*2]);return B$(B$(u,d),h)}},n.className="CustomInit",n)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return Q(()=>{const s=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new z(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Uo({ones:()=>mr(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Uo({ones:()=>mr(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let l,c,u,d;0<this.dropout&&this.dropout<1&&(e=B(e,o[0]));let h=yi(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=B(r,a[0])),h=xe(h,yi(r,this.recurrentKernel.read())),this.useBias&&(h=Ur(h,this.bias.read()));const[f,p,m,g]=Ws(h,4,h.rank-1);l=this.recurrentActivation.apply(f),c=this.recurrentActivation.apply(p),u=xe(B(c,i),B(l,this.activation.apply(m))),d=this.recurrentActivation.apply(g);const x=B(d,this.activation.apply(u));return[x,x,u]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:jo(this.activation),recurrentActivation:jo(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Bt(this.kernelInitializer),recurrentInitializer:Bt(this.recurrentInitializer),biasInitializer:Bt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:vt(this.kernelRegularizer),recurrentRegularizer:vt(this.recurrentRegularizer),biasRegularizer:vt(this.biasRegularizer),activityRegularizer:vt(this.activityRegularizer),kernelConstraint:hn(this.kernelConstraint),recurrentConstraint:hn(this.recurrentConstraint),biasConstraint:hn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}Ux.className="LSTMCell";de(Ux);class kO extends ra{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Ux(e),super(e)}call(e,n){return Q(()=>{this.cell.dropoutMask!=null&&(et(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(et(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}kO.className="LSTM";de(kO);class oC extends Vx{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return Q(()=>{e=e;let s=e.slice(1);const r=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?r.push(s.splice(0,a.stateSize.length)):r.push(s.splice(0,1));r.reverse();const i=[];let o;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];s=r[a],a===0?o=[e[0]].concat(s):o=[o[0]].concat(s),o=l.call(o,n),i.push(o.slice(1))}s=[];for(const a of i.slice().reverse())s.push(...a);return[o[0]].concat(s)})}build(e){u1(e)&&(e=e[0]),e=e;let n;this.cells.forEach((s,r)=>{La(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=i=>({className:i.getClassName(),config:i.getConfig()}),r={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),r)}static fromConfig(e,n,s={}){const r=[];for(const i of n.cells)r.push(zi(i,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return d1(e)}setWeights(e){const n=[];for(const s of this.cells){const r=s.weights.length,i=e.splice(r);for(let o=0;o<s.weights.length;++o)n.push([s.weights[o],i[o]])}Jk(n)}}oC.className="StackedRNNCells";de(oC);function Uo(t){const{ones:e,rate:n,training:s=!1,count:r=1,dropoutFunc:i}=t,o=()=>i!=null?i(e(),n):fF(e(),n),a=()=>nf(o,e,s);return!r||r<=1?mi(a().clone()):Array(r).fill(void 0).map(a).map(c=>mi(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var mJ=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};class CO extends ra{constructor(e){if(e.unroll)throw new Xe("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Xe("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new dn({ndim:5})]}call(e,n){return Q(()=>{if(this.cell.dropoutMask!=null&&(et(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(et(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new z("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return Q(()=>{const{stateSize:n}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)],o=bn(i);return Array.isArray(n)?Array(n.length).fill(o):[o]})}resetStates(e,n=!1){Q(()=>{if(!this.stateful)throw new oi("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)];if(s[0]==null)throw new z("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>bn(i)):this.states_=[bn(i)];else if(e==null)et(this.states_),this.keptStates!=null&&(et(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>bn(i)):this.states_[0]=bn(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new z(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):et(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],c=i;if(!ft(l.shape,c))throw new z(`State ${a} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>mi(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:s,kernelSize:r,padding:i,strides:o,dilationRate:a}=this.cell,l=n==="channelsFirst",c=e[l?3:2],u=e[l?4:3],d=Pr(c,r[0],i,o[0],a[0]),h=Pr(u,r[1],i,o[1],a[1]);return[...e.slice(0,2),...l?[s,d,h]:[d,h,s]]}}CO.className="ConvRNN2D";class aC extends Ux{constructor(e){const{filters:n,kernelSize:s,strides:r,padding:i,dataFormat:o,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,wn(this.filters,"filters"),this.kernelSize=oc(s,2,"kernelSize"),this.kernelSize.forEach(l=>wn(l,"kernelSize")),this.strides=oc(r||1,2,"strides"),this.strides.forEach(l=>wn(l,"strides")),this.padding=i||"valid",Ks(this.padding),this.dataFormat=o||"channelsLast",Yt(this.dataFormat),this.dilationRate=oc(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>wn(l,"dilationRate"))}build(e){var n;e=lt(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new z(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],i=4,o=this.kernelSize.concat([r,this.filters*i]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,u=this.filters;l=new(n=class extends xr{apply(h,f){const p=c.apply([u]),m=na([u]),g=c.apply([u*2]);return Uk([p,m,g])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return Q(()=>{if(e.length!==3)throw new z(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training||!1,r=e[0],i=e[1],o=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Uo({ones:()=>mr(r),rate:this.dropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(Z,oe,ae)=>!oe||!oe[ae]?Z:B(oe[ae],Z);let u=c(r,l,0),d=c(r,l,1),h=c(r,l,2),f=c(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Uo({ones:()=>mr(i),rate:this.recurrentDropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let m=c(i,p,0),g=c(i,p,1),x=c(i,p,2),b=c(i,p,3);const v=3,[w,C,$,T]=Ws(this.kernel.read(),a,v),[N,_,A,O]=this.useBias?Ws(this.bias.read(),a):[null,null,null,null];u=this.inputConv(u,w,N,this.padding),d=this.inputConv(d,C,_,this.padding),h=this.inputConv(h,$,A,this.padding),f=this.inputConv(f,T,O,this.padding);const[W,G,q,U]=Ws(this.recurrentKernel.read(),a,v);m=this.recurrentConv(m,W),g=this.recurrentConv(g,G),x=this.recurrentConv(x,q),b=this.recurrentConv(b,U);const Y=this.recurrentActivation.apply(xe(u,m)),te=this.recurrentActivation.apply(xe(d,g)),M=xe(B(te,o),B(Y,this.activation.apply(xe(h,x)))),X=B(this.recurrentActivation.apply(xe(f,b)),this.activation.apply(M));return[X,X,M]})}getConfig(){const e=super.getConfig(),{units:n}=e,s=mJ(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},s),r)}inputConv(e,n,s,r){const i=Za(e,n,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?Ur(i,s,this.dataFormat):i}recurrentConv(e,n){return Za(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}aC.className="ConvLSTM2DCell";de(aC);class SO extends CO{constructor(e){const n=new aC(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}SO.className="ConvLSTM2D";de(SO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class lC extends Je{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?n[r]:this.noiseShape[r]);return s}call(e,n){return Q(()=>{this.invokeCallHook(e,n);const s=Be(e);if(0<this.rate&&this.rate<1){const r=n.training==null?!1:n.training,i=this.getNoiseShape(s);return nf(()=>fF(s,this.rate,i,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}lC.className="Dropout";de(lC);class IO extends lC{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}IO.className="SpatialDropout1D";de(IO);class $O extends Je{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,wn(this.units,"units"),this.activation=Vo(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=Lt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Lt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=fn(e.kernelConstraint),this.biasConstraint=fn(e.biasConstraint),this.kernelRegularizer=Mt(e.kernelRegularizer),this.biasRegularizer=Mt(e.biasRegularizer),this.activityRegularizer=Mt(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=lt(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=lt(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return Q(()=>{this.invokeCallHook(e,n);const s=Be(e),r=oF(this.activation.getClassName());let i;return r!=null?i=yi(s,this.kernel.read(),r,this.bias?this.bias.read():null):(i=yi(s,this.kernel.read()),this.bias!=null&&(i=Ur(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const e={units:this.units,activation:jo(this.activation),useBias:this.useBias,kernelInitializer:Bt(this.kernelInitializer),biasInitializer:Bt(this.biasInitializer),kernelRegularizer:vt(this.kernelRegularizer),biasRegularizer:vt(this.biasRegularizer),activityRegularizer:vt(this.activityRegularizer),kernelConstraint:hn(this.kernelConstraint),biasConstraint:hn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}$O.className="Dense";de($O);class NO extends Je{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=lt(e);for(const n of e.slice(1))if(n==null)throw new z(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Oo(e,1)]}call(e,n){return Q(()=>{this.invokeCallHook(e,n);let s=Be(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let i=2;i<s.rank;++i)r.push(i);r.push(1),s=rt(s,r)}return qY(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}NO.className="Flatten";de(NO);class TO extends Je{constructor(e){super(e),this.supportsMasking=!0,this.activation=Vo(e.activation)}call(e,n){return Q(()=>{this.invokeCallHook(e,n);const s=Be(e);return this.activation.apply(s)})}getConfig(){const e={activation:jo(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}TO.className="Activation";de(TO);class EO extends Je{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return Q(()=>(e=Be(e),KY(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}EO.className="RepeatVector";de(EO);class _O extends Je{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const s="Total size of new array must be unchanged.",r=n.slice();let i=1,o=null;for(let l=0;l<r.length;++l){const c=r[l];if(this.isUnknown(c))if(o===null)o=l;else throw new z("Can only specifiy one unknown dimension.");else i*=c}const a=Oo(e);if(o!==null){if(i===0||a%i!==0)throw new z(s);r[o]=a/i}else if(a!==i)throw new z(s);return r}computeOutputShape(e){let n=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return Q(()=>{this.invokeCallHook(e,n);const s=Be(e),r=s.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return H(s,i)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}_O.className="Reshape";de(_O);class RO extends Je{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=zr(1,e.dims.length+1);if(!ft(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new dn({ndim:this.dims.length+1})]}computeOutputShape(e){e=lt(e);const n=e.slice();return this.dims.forEach((s,r)=>{n[r+1]=e[s]}),n}call(e,n){return rt(Be(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}RO.className="Permute";de(RO);class AO extends Je{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const s=Be(e);return t1($m(s,this.maskValue),-1)}call(e,n){return Q(()=>{this.invokeCallHook(e,n);const s=Be(e),o=t1($m(s,this.maskValue),-1,!0);return B(s,Se(o,s.dtype))})}}AO.className="Masking";de(AO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class DO extends Je{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(mt(e.inputLength))}this.inputDim=e.inputDim,wn(this.inputDim,"inputDim"),this.outputDim=e.outputDim,wn(this.outputDim,"outputDim"),this.embeddingsInitializer=Lt(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Mt(e.embeddingsRegularizer),this.activityRegularizer=Mt(e.activityRegularizer),this.embeddingsConstraint=fn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return Q(()=>this.maskZero?(e=Be(e),$m(e,it(e))):null)}computeOutputShape(e){if(e=lt(e),this.inputLength==null)return[...e,this.outputDim];const n=mt(this.inputLength);if(n.length!==e.length-1)throw new z(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<n.length;++r){const i=n[r],o=e[r+1];if(i!=null&&o!=null&&i!==o)throw new z(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(n[s]=o),s++}}return[e[0],...n,this.outputDim]}call(e,n){return Q(()=>{this.invokeCallHook(e,n);let s=Be(e);s.dtype!=="int32"&&(s=xi(s,"int32"));const r=hF(this.embeddings.read(),H(s,[s.size]));return H(r,lt(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Bt(this.embeddingsInitializer),embeddingsRegularizer:vt(this.embeddingsRegularizer),activityRegularizer:vt(this.activityRegularizer),embeddingsConstraint:hn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}DO.className="Embedding";de(DO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class bl extends Je{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Xe}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const s=e.slice(0,e.length-n.length);for(let r=0;r<n.length;++r){const i=e[e.length-n.length+r],o=n[r];if(i==null||o==null||i<0||o<0)s.push(null);else if(i===1)s.push(o);else if(o===1)s.push(i);else{if(i!==o)throw new z("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));s.push(i)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[lt(e)]),e=e,e.length<2)throw new z(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const i of e)i!=null&&i[0]!==null&&n.push(i[0]);if(n=Fo(n),n.length>1)throw new z(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){const o=e[i]==null?null:e[i].slice(1);s=this.computeElementwiseOpOutputShape(s,o)}const r=e.map(i=>i.length);e.indexOf(null)===-1&&Fo(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return Q(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(i=>i.rank);if(r.indexOf(null)===-1){const i=Wo(r);for(let o of e){const a=o.rank;for(let l=0;l<i-a;++l)o=ef(o,1);s.push(o)}return this.mergeFunction(s)}else{let i=!1;for(const l of e){const c=l.rank;if(c==null){const u=l.shape,d=u[0],h=u.slice(1).concat([d]);let f=H(l,[d].concat(Oo(u.slice(1))));f=rt(f,[1,0]),f=H(f,h),s.push(f),i=!0}else if(c>1){const u=zr(1,c).concat([0]);s.push(rt(l,u)),i=!0}else s.push(l)}let o=this.mergeFunction(s);const a=o.rank;if(i){if(a==null){const l=o.shape,c=l.length,u=l[c-1],d=[u].concat(l.slice(0,l.length-1));o=H(rt(H(o,[-1,u]),[1,0]),d)}else if(a>1){const l=[a-1].concat(zr(0,a-1));o=rt(o,l)}}return o}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let r=1;r<e.length;++r){const i=e[r]==null?null:e[r].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=Fo(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(e,n){return Q(()=>{if(n==null)return null;if(!Array.isArray(n))throw new z("`mask` should be an Array");if(!Array.isArray(e))throw new z("`inputs` should be an Array");if(n.length!==e.length)throw new z(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(r=>r==null))return null;n=n.map(r=>r==null?r:rs(r,0));let s=n[0];for(let r=1;r<n.length-1;++r)s=Ui(s,n[r]);return s})}}class FO extends bl{constructor(e){super(e)}mergeFunction(e){return Q(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=xe(n,e[s]);return n})}}FO.className="Add";de(FO);class OO extends bl{constructor(e){super(e)}mergeFunction(e){return Q(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=B(n,e[s]);return n})}}OO.className="Multiply";de(OO);class PO extends bl{constructor(e){super(e)}mergeFunction(e){return Q(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=xe(n,e[s]);return B(1/e.length,n)})}}PO.className="Average";de(PO);class LO extends bl{constructor(e){super(e)}mergeFunction(e){return Q(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=ta(n,e[s]);return n})}}LO.className="Maximum";de(LO);class MO extends bl{constructor(e){super(e)}mergeFunction(e){return Q(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=Rd(n,e[s]);return n})}}MO.className="Minimum";de(MO);class zO extends bl{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new z("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const r of e)if(r!=null){n=!1;break}if(n)return;const s=[];for(let r=0;r<e.length;++r){const i=e[r].slice();i.splice(this.axis,1);let o=!1;for(const a of s)if(ft(a,i)){o=!0;break}o||s.push(i)}if(s.length>1)throw new z("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return Q(()=>Uk(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new z("A `Concatenate` layer should be called on a list of inputs.");const n=e,s=n[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const i of n.slice(1)){if(s[r]==null||i[r]==null){s[r]=null;break}s[r]+=i[r]}return s}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new z("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new z("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new z(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return Q(()=>{let s=!0;if(n.forEach(o=>{if(o!=null){s=!1;return}}),s)return null;const r=[];for(let o=0;o<e.length;++o)n[o]==null?r.push(Se(mr(e[o]),"bool")):n[o].rank<e[o].rank?r.push(rs(n[o],-1)):r.push(n[o]);const i=as(r,this.axis);return zA(i,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}zO.className="Concatenate";de(zO);function $u(t,e){for(;t<0;)t+=e;return t}function gJ(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Xe("batchDot is not implemented for tensors of 4D or higher rank yet");if(R(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),R(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new Xe("batchDot is not implemented for complex64-type Tensors yet.");const s=t.shape.length,r=e.shape.length;n==null&&(n=[s-1,r-2]);const i=n;return Q(()=>{let o;if(s>r){o=s-r;const l=[];for(let c=0;c<o;++c)l.push(1);e=H(e,e.shape.concat(l))}else if(r>s){o=r-s;const l=[];for(let c=0;c<o;++c)l.push(1);t=H(t,t.shape.concat(l))}else o=0;let a;if(t.shape.length===2&&e.shape.length===2)i[0]===i[1]?a=Pe(B(t,e),i[0]):a=Pe(B(rt(t,[1,0]),e),i[1]);else{const l=i[0]!==t.shape.length-1,c=i[1]===e.shape.length-1;a=dt(t,e,l,c)}if(o>0){let l;s>r?l=s+r-3:l=s-1;const c=[];for(let u=l;u<l+o;++u)c.push(u);a=Xh(a,c)}return a.shape.length===1&&(a=rs(a,1)),a})}class BO extends bl{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){R(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],s=e[1];if(n.length>3||s.length>3)throw new Xe("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);if(n[r[0]]!==s[r[1]])throw new z(`Dimension incompatibility: ${n[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new z(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((i,o)=>$u(i,e[o].shape.length)):r=[$u(this.axes,n.shape.length),$u(this.axes,s.shape.length)],this.normalize&&(n=Dm(n,r[0]),s=Dm(s,r[1])),gJ(n,s,r)}interpretAxes(e,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[$u(this.axes,e.length),$u(this.axes,n.length)],s}computeOutputShape(e){R(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),s=e[1].slice();if(n.length>3||s.length>3)throw new Xe("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);n.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const i=n.concat(s);return i.length===1&&i.push(1),i}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}BO.className="Dot";de(BO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class WO extends Je{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return Q(()=>{this.invokeCallHook(e,n);const s=Be(e);return nf(()=>xe(Lx(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}WO.className="GaussianNoise";de(WO);class jO extends Je{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return Q(()=>{this.invokeCallHook(e,n);const s=Be(e);return this.rate>0&&this.rate<1?nf(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return B(s,Lx(s.shape,1,i))},()=>s,n.training||!1):s})}}jO.className="GaussianDropout";de(jO);class VO extends Je{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||Be(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return Q(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return nf(()=>{const i=Be(e),a=-1.6732632423543772*1.0507009873554805;let l=pl(Kh(s),this.rate);l=xi(l,"float32");const c=((1-this.rate)*(1+this.rate*a**2))**-.5,u=-c*a*this.rate,d=xe(B(i,l),B(xe(l,-1),a));return xe(B(d,c),u)},()=>Be(e),n.training||!1)}return e})}}VO.className="AlphaDropout";de(VO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Pd(t,e,n,s,r,i=.001){let o;if(t.rank===2)o=Y6(t,e,n,s,r,i);else if(t.rank===3)o=J6(t,e,n,s,r,i);else if(t.rank===4)o=e8(t,e,n,s,r,i);else throw new Xe(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return o}function xJ(t,e,n,s,r=.001){return Q(()=>{const i=Hw(t,s),o=i.mean,a=i.variance;return[Pd(t,o,a,n,e,r),o,a]})}function yJ(t,e,n,s,r=.001){return Q(()=>{const i=Hw(t,s),o=i.mean,a=i.variance,l=[];for(const p of zr(0,t.rank))s.indexOf(p)!==-1?l.push(1):l.push(t.shape[p]);const c=H(o,l),u=H(a,l),d=e==null?null:H(e,l),h=n==null?null:H(n,l);return[Pd(t,c,u,h,d,r),o,a]})}function bJ(t,e,n,s,r=.001){return ft(s.slice().sort(),zr(0,t.rank-1))?xJ(t,e,n,s,r):yJ(t,e,n,s,r)}class UO extends Je{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Lt(e.betaInitializer||"zeros"),this.gammaInitializer=Lt(e.gammaInitializer||"ones"),this.movingMeanInitializer=Lt(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Lt(e.movingVarianceInitializer||"ones"),this.betaConstraint=fn(e.betaConstraint),this.gammaConstraint=fn(e.gammaConstraint),this.betaRegularizer=Mt(e.betaRegularizer),this.gammaRegularizer=Mt(e.gammaRegularizer)}build(e){e=lt(e);const n=this.axis>=0?this.axis:this.axis+e.length,s=e[n];if(s==null)throw new z(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new dn({ndim:e.length,axes:{[n]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return Q(()=>{const s=n.training==null?!1:n.training,r=Be(e),i=r.shape,o=i.length,a=zr(0,o),l=this.axis>=0?this.axis:this.axis+o;a.splice(l,1);const c=sl(1,o);c[l]=i[l];const u=a.slice();u.sort();const d=!ft(u,zr(0,o).slice(0,o-1)),h=()=>{if(d){const b=H(this.movingMean.read(),c),v=H(this.movingVariance.read(),c),w=this.center?H(this.beta.read(),c):null,C=this.scale?H(this.gamma.read(),c):null;return Pd(r,b,v,w,C,this.epsilon)}else return Pd(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return h();const[f,p,m]=bJ(r,this.gamma.read(),this.beta.read(),a,this.epsilon),g=(b,v,w)=>{Q(()=>{const C=1-w,$=b.read(),T=B(ze($,v),C);b.write(ze($,T))})};return(()=>{g(this.movingMean,p,this.momentum),g(this.movingVariance,m,this.momentum)})(),f})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Bt(this.betaInitializer),gammaInitializer:Bt(this.gammaInitializer),movingMeanInitializer:Bt(this.movingMeanInitializer),movingVarianceInitializer:Bt(this.movingVarianceInitializer),betaRegularizer:vt(this.betaRegularizer),gammaRegularizer:vt(this.gammaRegularizer),betaConstraint:hn(this.betaConstraint),gammaConstraint:hn(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}UO.className="BatchNormalization";de(UO);class GO extends Je{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Lt(e.betaInitializer||"zeros"),this.gammaInitializer=Lt(e.gammaInitializer||"ones"),this.betaRegularizer=Mt(e.betaRegularizer),this.gammaRegularizer=Mt(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=lt(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=n);for(const i of this.axis)if(i<0||i>=n)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==Fo(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(i=>e[i]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,n){const s=Be(e),r=s.shape,i=r.length;return Q(()=>{let{mean:a,variance:l}=Hw(s,this.axis,!0);const c=sl(1,i);for(const m of this.axis)c[m]=r[m];const u=m=>m!=null&&m.shape.length!==i?H(m,c):m;let d=this.scale?u(this.gamma.read()):null,h=this.center?u(this.beta.read()):null;const f=[],p=[];for(let m=0;m<i;++m)this.axis.indexOf(m)!==-1?(f.push(r[m]),p.push(1)):(f.push(1),p.push(r[m]));return a=_r(a,f),l=_r(l,f),d!=null&&(d=_r(d,p)),h!=null&&(h=_r(h,p)),Pd(s,a,l,h,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Bt(this.betaInitializer),gammaInitializer:Bt(this.gammaInitializer),betaRegularizer:vt(this.betaRegularizer),gammaRegularizer:vt(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}GO.className="LayerNormalization";de(GO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vJ(t,e,n){return Q(()=>{if(t.rank!==4)throw new z(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new z("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Br()),n!=="channelsLast"&&n!=="channelsFirst")throw new z(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],Kw(t,s)})}class HO extends Je{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Br():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new z(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,s;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new z(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new z(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[n,s]}this.inputSpec=[new dn({ndim:4})]}computeOutputShape(e){e=lt(e);let n,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],n,s]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],n,s,e[3]])}call(e,n){return Q(()=>vJ(Be(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}HO.className="ZeroPadding2D";de(HO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Gx(t,e,n,s,r,i){return Q(()=>{Yt(r),lF(i),Ks(s),n==null&&(n=[1,1]),s==null&&(s="valid"),r==null&&(r=Br()),i==null&&(i="max"),t=sC(t,r);let o;const a=s==="same"?"same":"valid";return i==="max"?o=Gw(t,e,n,a):o=Ow(t,e,n,a),r==="channelsFirst"&&(o=rt(o,[0,3,1,2])),o})}function KO(t,e,n,s,r,i){return Q(()=>{Yt(r),lF(i),Ks(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),r==null&&(r=Br()),i==null&&(i="max"),t=uO(t,r);let o;const a=s==="same"?"same":"valid";return i==="max"?o=MK(t,e,n,a):o=B6(t,e,n,a),r==="channelsFirst"&&(o=rt(o,[0,4,1,2,3])),o})}class XO extends Je{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new z(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(wn(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new z(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);wn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Ks(this.padding),this.inputSpec=[new dn({ndim:3})]}computeOutputShape(e){e=lt(e);const n=Pr(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return Q(()=>{this.invokeCallHook(e,n),e=ef(Be(e),2);const s=this.poolingFunction(Be(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Xh(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class qO extends XO{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Yt(i),Ks(r),Gx(e,n,s,r,i,"max")}}qO.className="MaxPooling1D";de(qO);class YO extends XO{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Yt(i),Ks(r),Gx(e,n,s,r,i,"avg")}}YO.className="AveragePooling1D";de(YO);class QO extends Je{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new z(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];wn(this.poolSize,"poolSize"),wn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Yt(this.dataFormat),Ks(this.padding),this.inputSpec=[new dn({ndim:4})]}computeOutputShape(e){e=lt(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=Pr(n,this.poolSize[0],this.padding,this.strides[0]),s=Pr(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s]:[e[0],n,s,e[3]]}call(e,n){return Q(()=>(this.invokeCallHook(e,n),this.poolingFunction(Be(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class JO extends QO{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Yt(i),Ks(r),Gx(e,n,s,r,i,"max")}}JO.className="MaxPooling2D";de(JO);class ZO extends QO{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Yt(i),Ks(r),Gx(e,n,s,r,i,"avg")}}ZO.className="AveragePooling2D";de(ZO);class eP extends Je{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new z(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];wn(this.poolSize,"poolSize"),wn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Yt(this.dataFormat),Ks(this.padding),this.inputSpec=[new dn({ndim:5})]}computeOutputShape(e){e=lt(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=Pr(n,this.poolSize[0],this.padding,this.strides[0]),s=Pr(s,this.poolSize[1],this.padding,this.strides[1]),r=Pr(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s,r]:[e[0],n,s,r,e[4]]}call(e,n){return Q(()=>(this.invokeCallHook(e,n),this.poolingFunction(Be(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class tP extends eP{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Yt(i),Ks(r),KO(e,n,s,r,i,"max")}}tP.className="MaxPooling3D";de(tP);class nP extends eP{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Yt(i),Ks(r),KO(e,n,s,r,i,"avg")}}nP.className="AveragePooling3D";de(nP);class sP extends Je{constructor(e){super(e),this.inputSpec=[new dn({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new Xe}}class rP extends sP{constructor(e){super(e||{})}call(e,n){return Q(()=>{const s=Be(e);return en(s,1)})}}rP.className="GlobalAveragePooling1D";de(rP);class iP extends sP{constructor(e){super(e||{})}call(e,n){return Q(()=>{const s=Be(e);return Or(s,1)})}}iP.className="GlobalMaxPooling1D";de(iP);class oP extends Je{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Yt(this.dataFormat),this.inputSpec=[new dn({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new Xe}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class aP extends oP{call(e,n){return Q(()=>{const s=Be(e);return this.dataFormat==="channelsLast"?en(s,[1,2]):en(s,[2,3])})}}aP.className="GlobalAveragePooling2D";de(aP);class lP extends oP{call(e,n){return Q(()=>{const s=Be(e);return this.dataFormat==="channelsLast"?Or(s,[1,2]):Or(s,[2,3])})}}lP.className="GlobalMaxPooling2D";de(lP);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class cP extends Je{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,s={}){const r=n.layer,i=zi(r,s);delete n.layer;const o={layer:i};return Object.assign(o,n),new e(o)}}class uP extends cP{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=lt(e),e.length<3)throw new z(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=lt(e);const n=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(n),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,n){return Q(()=>(e=Be(e),bO((o,a)=>[Be(this.layer.call(o,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}uP.className="TimeDistributed";de(uP);function wJ(t){yl(jY,"BidirectionalMergeMode",t)}const kJ="concat";class dP extends cP{constructor(e){super(e);const n=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=n,this.forwardLayer=zi(s),n.goBackwards=n.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=n,this.backwardLayer=zi(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?kJ:e.mergeMode,wJ(this.mergeMode),e.weights)throw new Xe("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,s=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,r,i;return this.returnState&&(i=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(i).concat(i.slice()):[s].concat(i).concat(i.slice()):is(r)}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const i=yO(e,s,r,this.numConstants);if(e=i.inputs,s=i.initialState,r=i.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,n);const o=[],a=[];if(s!=null){const c=s.length;if(c%2>0)throw new z("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,o.push(...s);const u=s.map(d=>new dn({shape:d.shape}));this.forwardLayer.stateSpec=u.slice(0,c/2),this.backwardLayer.stateSpec=u.slice(c/2),a.push(...u)}if(r!=null)throw new Xe("Support for constants in Bidirectional layers is not implemented yet.");const l=o[0]instanceof ki;for(const c of o)if(c instanceof ki!==l)throw new z("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[e].concat(o),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return Q(()=>{const s=n.initialState;let r,i;if(s==null)r=this.forwardLayer.call(e,n),i=this.backwardLayer.call(e,n);else{const l=s.slice(0,s.length/2),c=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),i=this.backwardLayer.call(e,Object.assign(n,{initialState:c}))}let o;this.returnState&&(Array.isArray(r)&&(o=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),this.returnSequences&&(i=tl(i,1));let a;return this.mergeMode==="concat"?a=Uk([r,i]):this.mergeMode==="sum"?a=xe(r,i):this.mergeMode==="ave"?a=B(.5,xe(r,i)):this.mergeMode==="mul"?a=B(r,i):this.mergeMode==null&&(a=[r,i]),this.returnState?this.mergeMode==null?a.concat(o):[a].concat(o):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){La(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),La(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const i=this.forwardLayer.states.map(o=>null);return Array.isArray(s)?s.concat(i).concat(i):[s].concat(i).concat(i)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const s=zi(n.layer);if(delete n.layer,n.numConstants!=null)throw new Xe("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=n;return r.layer=s,new e(r)}}dP.className="Bidirectional";de(dP);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class hP extends Je{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return Q(()=>(e=Be(e),e.dtype!=="float32"&&(e=xi(e,"float32")),xe(B(e,this.scale),this.offset)))}}hP.className="Rescaling";de(hP);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:CJ,cropAndResize:SJ}=Li;class fP extends Je{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,s,r,i,o,a,l){return Q(()=>{let c,u=!1;const d=n/o,h=s/a,f=(r+n)/o,p=(i+s)/a,m=[d,h,f,p],g=[];e.rank===3?(u=!0,c=Gi([e])):c=e;for(let C=0;C<c.shape[0];C++)g.push(m);const x=EA(g,[g.length,4]),b=Ad(0,g.length,1,"int32"),w=SJ(c,x,b,[r,i],"nearest");return xi(u?Be(nl(w)):w,l)})}upsize(e,n,s,r){return Q(()=>{const i=CJ(e,[n,s]);return xi(i,r)})}call(e,n){return Q(()=>{const s=Be(e),r=s.dtype,i=s.shape,o=i[i.length-3],a=i[i.length-2];let l=0;o!==this.height&&(l=Math.floor((o-this.height)/2));let c=0;return a!==this.width&&(c=Math.floor((a-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(s,l,c,this.height,this.width,o,a,r):this.upsize(e,this.height,this.width,r)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=lt(e);const n=e.length-3,s=e.length-2;return e[n]=this.height,e[s]=this.width,e}}fP.className="CenterCrop";de(fP);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function IJ(t,e,n,s){let r=Be(t);if(r.dtype!=="int32"&&(r=xi(r,"int32")),e==="int")return r;const i=r.shape;if(r.rank===0&&(r=rs(r,-1)),e==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=rs(r,-1)),r.rank>2)throw new z(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${i} which would result in output rank ${r.rank}.`);const o=["multiHot","oneHot"].includes(e),a=r;let l;if(typeof s<"u"&&e==="count"?l=I$(a,s,n,o):l=I$(a,[],n,o),e!=="tfIdf")return l;if(s)return B(l,s);throw new z("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class pP extends Je{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=lt(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return Q(()=>{e=Be(e),e.dtype!=="int32"&&(e=xi(e,"int32"));let s;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new z(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);s=Be(n.countWeights)}const r=Or(e),i=Sm(e),o=Hs(this.numTokens,r).bufferSync().get(0),a=pl(i,0).bufferSync().get(0);if(!(o&&a))throw new z(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return IJ(e,this.outputMode,this.numTokens,s)})}}pP.className="CategoryEncoding";de(pP);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const $J=["bilinear","nearest"],rN=new Set($J);class mP extends Je{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(rN.has(e.interpolation))this.interpolation=e.interpolation;else throw new z(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=lt(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return Q(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return Li.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Li.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...rN]} are supported`)})}}mP.className="Resizing";de(mP);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class gP{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}gP.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class xP extends Je{constructor(e){super(e),this.randomGenerator=new gP(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}xP.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const NJ=["bilinear","nearest"],iN=new Set(NJ);class yP extends xP{constructor(e){super(e);const{factor:n,interpolation:s="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new z(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new z(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new z(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(iN.has(s))this.interpolation=s;else throw new z(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=lt(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return Q(()=>{const s=Be(e);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=Kh([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*r;i=Math.round(i);const o=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return Li.resizeBilinear(e,o);case"nearest":return Li.resizeNearestNeighbor(e,o);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...iN]} are supported`)}})}}yP.className="RandomWidth";de(yP);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TJ=ee();TJ.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var oN;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(oN||(oN={}));var aN;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(aN||(aN={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var lN;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(lN||(lN={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _e(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&R(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EJ=pD;class Hx extends Mv{nextDataId(){return Hx.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new DR(this,si())}write(e,n,s){this.firstUse&&(this.firstUse=!1,ee().get("IS_NODE")&&Ps(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&qd(s[0])){const i=s.map(o=>Do(o));r=this.write(i,e,n)}else r=this.write(s,e,n);return{dataId:r,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,s,r,i){this.data.set(e,{values:n,dtype:r,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:s}=this.data.get(e);if(n==="complex64"){const r=this.readSync(s.real.dataId),i=this.readSync(s.imag.dataId);return Hi(r,i)}return tH(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>Bo(r));return Ye(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ye(e.shape,e.dtype,n)}makeOutput(e,n,s){return si().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=ss();return e(),{kernelMs:ss()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){_e([e],"where");const n=this.readSync(e.dataId);return EJ(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}Hx.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bP(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const _J=t=>{const{x:e}=t.inputs,n=t.backend;_e(e,"abs");let s=new Float32Array(re(e.shape));const r=n.data.get(e.dataId).values;return s=bP(r),n.makeOutput(s,e.shape,e.dtype)},RJ={kernelName:Cg,backendName:"cpu",kernelFunc:_J};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qt(t){return(e,n,s,r,i)=>{const o=He(e,n),a=o.length,l=Fe(o),c=re(o),u=Pn(i,c),d=e.length,h=n.length,f=Fe(e),p=Fe(n),m=wc(e,o),g=wc(n,o);if(m.length+g.length===0)for(let x=0;x<u.length;++x)u[x]=t(s[x%s.length],r[x%r.length]);else for(let x=0;x<u.length;++x){const b=Mc(x,a,l),v=b.slice(-d);m.forEach(T=>v[T]=0);const w=pi(v,d,f),C=b.slice(-h);g.forEach(T=>C[T]=0);const $=pi(C,h,p);u[x]=t(s[w],r[$])}return[u,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vs(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,a=n.makeTensorInfo(s.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",i),imag:n.makeTensorInfo(r.shape,"float32",o)},a}const AJ={kernelName:Qv,backendName:"cpu",kernelFunc:vs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mm(t,e,n="float32"){if(n==="complex64"){const r=Mm(t,e,"float32"),i=Mm(t,e,"float32");return vs({inputs:{real:r,imag:i},backend:t})}const s=Ln(re(e),n);return t.makeTensorInfo(e,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ci(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const DJ={kernelName:gh,backendName:"cpu",kernelFunc:Ci};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rl(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.real,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}const FJ={kernelName:ww,backendName:"cpu",kernelFunc:rl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vP(t,e,n,s){if(s==="int32"){const r=Int32Array.from(t);return[e,"int32",r]}if(s==="bool"){const r=fl([0],n),[i,o]=Qt((a,l)=>a!==l?1:0)(e,[],t,r,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function Go(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return Ci({inputs:{x:r},backend:n});const u=Mm(n,r.shape,r.dtype),d=Go({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),h=vs({inputs:{real:d,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),h}if(r.dtype==="complex64"){const u=rl({inputs:{input:r},backend:n}),d=Go({inputs:{x:u},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(u),d}if(!PR(r.dtype,i)){const u=Ci({inputs:{x:r},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:i}}const o=n.data.get(r.dataId).values,[a,l,c]=vP(o,r.shape,r.dtype,i);return n.makeTensorInfo(a,l,c)}const OJ={kernelName:sh,backendName:"cpu",kernelFunc:Go};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mn(t,e,n,s){return n==null?({inputs:r,backend:i})=>{const{a:o,b:a}=r,l=i;_e([o,a],t);const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,d=o.dtype==="string"?Ki(c):c,h=o.dtype==="string"?Ki(u):u,f=s||o.dtype,[p,m]=e(o.shape,a.shape,d,h,f);return l.makeTensorInfo(m,f,p)}:({inputs:r,backend:i})=>{const{a:o,b:a}=r,l=i;if(o.dtype==="complex64"||a.dtype==="complex64"){const c=Go({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),d=u.complexTensorInfos.real,h=u.complexTensorInfos.imag,f=l.data.get(d.dataId).values,p=l.data.get(h.dataId).values,m=Go({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),g=l.data.get(m.dataId),x=g.complexTensorInfos.real,b=g.complexTensorInfos.imag,v=l.data.get(x.dataId).values,w=l.data.get(b.dataId).values,[C,$,T]=n(o.shape,a.shape,f,p,v,w),N=l.makeTensorInfo(T,"float32",C),_=l.makeTensorInfo(T,"float32",$),A=vs({inputs:{real:N,imag:_},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(m),l.disposeIntermediateTensorInfo(N),l.disposeIntermediateTensorInfo(_),A}else{const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,d=s||o.dtype,[h,f]=e(o.shape,a.shape,c,u,d);return l.makeTensorInfo(f,d,h)}}}function cC(t){return(e,n,s,r,i,o)=>{const a=He(e,n),l=re(a),c=a.length,u=Fe(a),d=Pn("float32",l),h=Pn("float32",l),f=wc(e,a),p=wc(n,a),m=Hi(s,r),g=Hi(i,o),x=e.length,b=Fe(e),v=n.length,w=Fe(n);if(f.length+p.length===0)for(let C=0;C<d.length;C++){const $=C%m.length,T=C%g.length,N=t(m[$*2],m[$*2+1],g[T*2],g[T*2+1]);d[C]=N.real,h[C]=N.imag}else for(let C=0;C<d.length;C++){const $=Mc(C,c,u),T=$.slice(-x);f.forEach(W=>T[W]=0);const N=pi(T,x,b),_=$.slice(-v);p.forEach(W=>_[W]=0);const A=pi(_,v,w),O=t(m[N*2],m[N*2+1],g[A*2],g[A*2+1]);d[C]=O.real,h[C]=O.imag}return[d,h,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wP=Qt((t,e)=>t+e),PJ=cC((t,e,n,s)=>({real:t+n,imag:e+s})),Sc=mn(zc,wP,PJ),LJ={kernelName:zc,backendName:"cpu",kernelFunc:Sc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uC(t,e,n,s,r){const i=re(s),o=Ln(r,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(i>0?o[l]+=e[a]:o[l]+=1)}return o}function kP(t,e,n,s=!1){const r=t.shape[0],i=t.shape[1],o=Ye([r,n],e.dtype);for(let a=0;a<r;a++)for(let l=0;l<i;l++){const c=t.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(s?o.set(1,a,c):e.size>0?o.set(o.get(a,c)+e.get(a,l),a,c):o.set(o.get(a,c)+1,a,c))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CP=Qt((t,e)=>t&e),MJ=mn(Yv,CP),zJ={kernelName:Yv,backendName:"cpu",kernelFunc:MJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Si(t){return(e,n,s)=>{const r=Ht(n,e.length);for(let i=0;i<e.length;++i)r[i]=t(e[i],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gt(t,e,n){const s=Si(e);return ia(t,s,n)}function ia(t,e,n){return({inputs:s,attrs:r,backend:i})=>{const{x:o}=s;_e(o,t);const a=i,l=a.data.get(o.dataId).values;let c;if(o.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=Ki(l)}else c=l;const u=n||o.dtype,d=e(c,u,r);return a.makeTensorInfo(o.shape,u,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SP=Si(t=>Math.ceil(t)),BJ=ia(rh,SP),WJ={kernelName:rh,backendName:"cpu",kernelFunc:BJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IP(t,e,n,s){const r=Ht(n,re(e));if(s&&n!=="string"){let i=0;t.forEach(o=>{const a=re(o.shape);r.set(o.vals,i),i+=a})}else{let i=0;t.forEach(o=>{const a=n==="string"?Ki(o.vals):o.vals;let l=0;for(let c=0;c<o.shape[0];++c){const u=c*e[1]+i;for(let d=0;d<o.shape[1];++d)r[u+d]=a[l++]}i+=o.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $P=Qt((t,e)=>t===e?1:0),NP=mn(Mg,$P,null,"bool"),jJ={kernelName:Mg,backendName:"cpu",kernelFunc:NP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TP=Si(t=>Math.exp(t)),EP=ia(dh,TP,"float32"),VJ={kernelName:dh,backendName:"cpu",kernelFunc:EP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _P=Si(t=>Math.expm1(t)),UJ=ia(hh,_P),GJ={kernelName:hh,backendName:"cpu",kernelFunc:UJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RP=Si(t=>Math.floor(t)),HJ=ia(fh,RP),KJ={kernelName:fh,backendName:"cpu",kernelFunc:HJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AP=Qt((t,e)=>Math.floor(t/e)),XJ=mn(ph,AP,null,"int32"),qJ={kernelName:ph,backendName:"cpu",kernelFunc:XJ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DP(t,e,n,s,r,i,o,a,l){const c=Ye([s,i],n);for(let u=0;u<s;u++){const d=[];let h=0;for(let f=0;f<r;f++){const p=t[u*r+f];h+=p*o[f],d.push(p)}if(h<0||h>=l/i)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let f=0;f<i;f++)c.values[u*i+f]=e.get(...e.indexToLoc(h*i+f))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FP(t,e,n){const s=Ye(n,t.dtype);for(let r=0;r<s.size;++r){const o=s.indexToLoc(r).slice(),a=o[0],l=o[2],c=e.locToIndex([a,l]);o[2]=e.values[c];const u=t.locToIndex(o);0<=u&&u<t.values.length&&(s.values[r]=t.values[u])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OP=Qt((t,e)=>t>e?1:0),YJ=mn(jg,OP,null,"bool"),QJ={kernelName:jg,backendName:"cpu",kernelFunc:YJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PP=Qt((t,e)=>t>=e?1:0),JJ=mn(mh,PP,null,"bool"),ZJ={kernelName:mh,backendName:"cpu",kernelFunc:JJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LP=Qt((t,e)=>t<e?1:0),eZ=mn(Ug,LP,null,"bool"),tZ={kernelName:Ug,backendName:"cpu",kernelFunc:eZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MP=Qt((t,e)=>t<=e?1:0),nZ=mn(Gg,MP,null,"bool"),sZ={kernelName:Gg,backendName:"cpu",kernelFunc:nZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zP(t,e,n){const s=(e-t)/(n-1),r=Ln(n,"float32");r[0]=t;for(let i=1;i<r.length;i++)r[i]=r[i-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BP=Si(t=>Math.log(t)),rZ=ia(vh,BP),iZ={kernelName:vh,backendName:"cpu",kernelFunc:rZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WP(t,e,n,s){const r=Pn(s,re(n));for(let i=0;i<r.length;++i){const o=i*e;let a=t[o];for(let l=0;l<e;++l){const c=t[o+l];(Number.isNaN(c)||c>a)&&(a=c)}r[i]=a}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jP=Qt((t,e)=>Math.max(t,e)),oZ=mn(kh,jP),aZ={kernelName:kh,backendName:"cpu",kernelFunc:oZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VP=Qt((t,e)=>Math.min(t,e)),lZ=mn(Ch,VP),cZ={kernelName:Ch,backendName:"cpu",kernelFunc:lZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dC=Qt((t,e)=>t*e),uZ=cC((t,e,n,s)=>({real:t*n-e*s,imag:t*s+e*n})),Kx=mn(Ih,dC,uZ),dZ={kernelName:Ih,backendName:"cpu",kernelFunc:Kx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UP(t,e,n){const s=Jo(-1,n);return dC([],e,s,t,n)}function hZ(t){const{inputs:e,backend:n}=t,{x:s}=e;_e(s,"neg");const r=n.data.get(s.dataId).values,[i,o]=UP(r,s.shape,s.dtype);return n.makeTensorInfo(o,s.dtype,i)}const fZ={kernelName:nx,backendName:"cpu",kernelFunc:hZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GP=Qt((t,e)=>t!==e?1:0),pZ=mn(sx,GP,null,"bool"),mZ={kernelName:sx,backendName:"cpu",kernelFunc:pZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hC(t,e,n,s,r){const i=e.length,o=re(e),a=Fe(e),l=Fe(r),c=Pn(n,re(r));for(let u=0;u<o;++u){const d=Mc(u,i,a),h=new Array(d.length);for(let p=0;p<h.length;p++)h[p]=d[s[p]];const f=pi(h,i,l);c[f]=t[u]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cs(t){const{inputs:e,attrs:n,backend:s}=t,{x:r}=e,{perm:i}=n;_e(r,"transpose");const o=r.shape.length,a=new Array(o);for(let d=0;d<a.length;d++)a[d]=r.shape[i[d]];const l=s.data.get(r.dataId).values,c=hC(l,r.shape,r.dtype,i,a);return{dataId:s.write(c,a,r.dtype),shape:a,dtype:r.dtype}}const gZ={kernelName:sc,backendName:"cpu",kernelFunc:cs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HP(t,e,n,s){const[r,i]=kn(t,s),o=_s(e,"int32"),a=Ln(re(r),o),l=re(i);for(let c=0;c<a.length;++c){const u=c*l;let d=1;for(let h=0;h<l;++h)d*=n[u+h];a[c]=d}return{outVals:a,outShape:r,outDtype:o}}function xZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;_e(r,"prod");const a=r.shape.length,l=Qe(i,r.shape),c=Wt(l,a);let u=l,d=r;const h=[];c!=null&&(d=cs({inputs:{x:r},backend:n,attrs:{perm:c}}),h.push(d),u=qt(u.length,a));const f=n.data.get(d.dataId).values,{outVals:p,outShape:m,outDtype:g}=HP(d.shape,d.dtype,f,u);let x=m;return o&&(x=rn(m,l)),h.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.makeTensorInfo(x,g,p)}const yZ={kernelName:cx,backendName:"cpu",kernelFunc:xZ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bZ(t,e,n){t.forEach((s,r)=>{if(s<0||s>=n){const i=Mc(r,e.length,Fe(e)).join(",");throw new Error(`indices[${i}] = ${s} is not in [0, ${n})`)}})}function vZ(t,e){for(let n=0;n<t.length;++n){const s=t[n],r=n===t.length-1?e:t[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let i=1;i<s.length;++i)if(s[i-1]>s[i])throw new Error("Ragged splits must be sorted in ascending order")}}function wZ(t,e,n,s){const r=[];let i=0;const o=e.length-1+n.length,a=new Array(o).fill(null).map(()=>[0]);vZ(n,s);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const u=e[c+1];for(let d=1;d<l+1;++d)a[c].push(d*u)}for(let c=0;c<t.length;++c){let u=t[c],d=t[c]+1;for(let h=0;h<n.length;++h){const f=n[h],p=h+e.length-1;if(p>=0){const m=a[p],g=m[m.length-1]-f[u];for(let x=u;x<d;++x)a[p].push(f[x+1]+g)}u=f[u],d=f[d]}d!==u&&(r.push([u,d]),i+=d-u)}return{outSplits:a,valueSlices:r,numValues:i}}function kZ(t){const e=[];for(let n=0;n<t.length;++n){const s=t[n].length,r=Ht("int32",s);e.push(r),t[n].forEach((i,o)=>r[o]=i)}return e}function cN(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let s=e;s<t.length;s++)n[e-1]*=t[s];return n}function CZ(t,e,n,s,r,i){const o=cN(e,2)[1],a=cN(i,2)[1];let l=0;for(const c of n)for(let u=c[0];u<c[1];++u){for(let d=0;d<s;++d)r[l*a+d]=t[u*o+d];++l}}function SZ(t,e,n,s,r){const i=e.slice();i[0]=r;const o=Ht(n,re(i)),a=t.length,l=a===0?0:a/e[0];return CZ(t,e,s,l,o,i),[o,i]}function KP(t,e,n,s,r,i,o,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(bZ(i,o,l),s.length===0)throw new Error("params.rank must be nonzero");const c=s[0],{outSplits:u,valueSlices:d,numValues:h}=wZ(i,o,t,c),f=kZ(u),p=SZ(n,s,r,d,h);return[f,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uN=2147483647;function XP(t,e,n,s,r,i,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=r.length===0,c=o.length===0,u=[];a||u.push(e[0]),l||u.push(r[0]),c||u.push(o[0]);for(let g=1;g<u.length;++g)if(u[g]!==u[g-1])throw new Error("starts, limits, and deltas must have the same shape");const d=u.length===0?1:u[0],h=Ht("int32",d+1);h[0]=0;for(let g=0;g<d;++g){const x=a?t[0]:t[g],b=l?s[0]:s[g],v=c?i[0]:i[g];if(v===0)throw new Error("Requires delta != 0");let w;if(v>0&&b<x||v<0&&b>x)w=0;else if(w=Math.ceil(Math.abs((b-x)/v)),w>uN)throw new Error(`Requires ((limit - start) / delta) <= ${uN}`);h[g+1]=h[g]+w}const f=h[d],p=Ht(n,f);let m=0;for(let g=0;g<d;++g){const x=h[g+1]-h[g];let b=a?t[0]:t[g];const v=c?i[0]:i[g];for(let w=0;w<x;++w)p[m++]=b,b+=v}return[h,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Js=Tr;class zm{constructor(e,n,s,r,i,o,a,l,c,u){this.shape=e,this.shapeShape=n,this.values=s,this.valuesShape=r,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=DD(u),this.raggedRank=FD(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Js.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Js.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Js.VALUE_ROWIDS:return zm.getMaxWidthValueRowID(n);case Js.ROW_SPLITS:return zm.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Js[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let s=0;for(let r=0;r<n-1;++r){const i=e[r+1]-e[r];i>s&&(s=i)}return s}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let s=0,r=e[0],i=0;for(let o=1;o<n;++o){const a=e[o];a!==r&&(r=a,i=Math.max(o-s,i),s=o)}return Math.max(n-s,i)}tensorShapeFromTensor(e,n,s=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return hN(e,s)}calculateOutputSize(e){const n=this.valuesShape,s=this.defaultValueShape;OD(s,n);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=AD(this.raggedRank,r,n);o[0]<0&&(o[0]=e);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(e,n,s){const r=Math.min(e,s),i=[];let o=0;for(let a=0;a<r;++a,o+=n)i.push(o);for(let a=r;a<e;++a)i.push(-1);return R(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,n,s,r){const i=e.length,o=[];for(let a=0;a<i-1;++a){const l=e[a+1]-e[a];let c=Math.min(r,l),u=n[a];u===-1&&(c=0);for(let d=0;d<c;++d)o.push(u),u+=s;for(let d=0;d<l-c;++d)o.push(-1)}if(i>0&&o.length!==e[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,n,s,r){const i=e.length,o=[];if(i===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];o.push(c);for(let u=1;u<i;++u){const d=e[u];if(d===l)c>=0&&(++a,a<r?c+=s:c=-1);else{if(a=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);c=n[d]}o.push(c)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,n,s,r){const i=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case Js.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,n,s,r);case Js.ROW_SPLITS:if(i.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(i,n,s,r);default:throw new Error(`Unsupported partition type: ${Js[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case Js.FIRST_DIM_SIZE:return e[0];case Js.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Js.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Js[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const i=hN(s,!1),o=Ht(this.valuesDType,re(i));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(n,r[0],s[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,r[c],s[c]);this.setOutput(this.raggedRank,l,o,i)}return[i,o]}setOutput(e,n,s,r){if(s.length===0)return;const i=this.values,o=s;let a=r.slice();a=a.slice(e+1);const l=re(a),c=n.length;let u=this.defaultValue;if(u.length!==l&&u.length!==1){const p=this.defaultValueShape;Q(()=>{const m=H(u,p);u=td(m,a).dataSync()})}let d=0,h=0,f=0;for(let p=0;p<=c;++p){let m=p<c?n[p]:-1;if(m===f){++f;continue}if(h<f){const g=i.subarray(d*l),x=o.subarray(h*l),b=(f-h)*l;dN(x,g,b)}if(p>=c){const g=s.length;m=Math.floor(g/l)}if(m>f)if(this.defaultValue.length===1)o.subarray(f*l,m*l).fill(this.defaultValue[0]),f=m;else for(;m>f;){const g=o.slice(f*l);dN(g,u,l),++f}m<0?(d=p+1,h=f):(d=p,h=f,f=h+1)}}}function dN(t,e,n){for(let s=0;s<n;s++)t[s]=e[s]}function hN(t,e){const n=[];for(let s of t){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function qP(t,e,n,s,r,i,o,a,l,c){return new zm(t,e,n,s,r,i,o,a,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YP(t,e,n,s){const r=t===e,i=t<e&&n<0,o=e<t&&n>1;if(r||i||o)return Ln(0,s);const a=Math.abs(Math.ceil((e-t)/n)),l=Ln(a,s);e<t&&n===1&&(n=-1),l[0]=t;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QP=Si(t=>1/Math.sqrt(t)),IZ=ia(Rh,QP),$Z={kernelName:Rh,backendName:"cpu",kernelFunc:IZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ra(t,e,n,s,r,i,o,a,l,c){const u=[s/r,r],d=t.values,h=e.values;if(s===0)return Ye(n,e.dtype);const f=l instanceof Nn?l:Ye(u,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let p=0;p<i;p++){const m=[];let g=0;for(let x=0;x<o;x++){const b=d[p*o+x];m.push(b),g+=b*a[x]}if(g<0||g>=s/r)throw new Error(`Invalid indices: ${m} does not index into ${n}`);for(let x=0;x<r;x++)c?f.values[g*r+x]+=h[p*r+x]:f.values[g*r+x]=e.rank===0?h[0]:h[p*r+x]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NZ=Si(t=>1/(1+Math.exp(-t))),JP=gt(Ph,t=>1/(1+Math.exp(-t))),TZ={kernelName:Ph,backendName:"cpu",kernelFunc:JP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZP(t,e,n,s,r){const i=bk(s,e,n),o=re(n),a=Fe(s);if(i){const d=vk(e,a);return r==="string"?t.slice(d,d+o):t.subarray(d,d+o)}const l=r==="string"?Ki(t):t,c=Ye(s,r,l),u=Ye(n,r);for(let d=0;d<u.size;++d){const h=u.indexToLoc(d),f=h.map((p,m)=>p+e[m]);u.set(c.get(...f),...h)}return r==="string"?tF(u.values):u.values}function il(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,size:o}=s;_e(r,"slice");const[a,l]=Ax(r,i,o);xk(r,a,l);const c=n.data.get(r.dataId).values,u=ZP(c,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,u)}const EZ={kernelName:mx,backendName:"cpu",kernelFunc:il};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eL(t,e,n,s,r,i,o){const a=e[0],l=i[0],c=new Array(l),u=new Array(a),d=e[1];if(l===0){if(a!==0)throw new Error(jD(a));const g=Ht(n,0),x=Ht(r,0);return[g,[0,d],x,c,u]}let h=!0,f=0;const p=new Array(l).fill(0);for(let g=0;g<a;++g){const x=t[g*d];if(x<0)throw new Error(VD(g,x));if(x>=l)throw new Error(UD(g,x,l));++p[x],h=h&&x>=f,f=x}let m=!0;for(let g=0;g<l;++g){const x=p[g]===0;c[g]=x,m=m&&!x,p[g]=Math.max(p[g],1),g>0&&(p[g]+=p[g-1])}if(m&&h){const g=t,x=s;for(let b=0;b<a;++b)u[b]=b;return[g,[a,d],x,c,u]}else{const g=p[l-1],x=Ht(n,g*d),b=Ht(r,g),v=new Array(l).fill(0);for(let w=0;w<a;++w){const C=t[w*d],$=v[C],T=(C===0?0:p[C-1])+$;v[C]++;for(let N=0;N<d;++N)x[T*d+N]=t[w*d+N];b[T]=s[w],u[w]=T}for(let w=0;w<l;++w)if(v[w]===0){const $=w===0?0:p[w-1];x[$*d+0]=w;for(let T=1;T<d;++T)x[$*d+T]=0;b[$]=o}return[x,[g,d],b,c,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tL(t,e,n,s,r){const i=re(s),o=e[0],a=r.length,l=[];let c=1,u=-1;for(let g=0;g<a;++g){const x=r[g];if(x===-1){if(u!==-1)throw new Error(GD(u,g));u=g,l.push(1)}else{if(x<0)throw new Error(HD(g,x));c*=x,l.push(x)}}if(u!==-1){if(c<=0)throw new Error(KD());const g=Math.trunc(i/c);if(c*g!==i)throw new Error(XD(s,l));l[u]=g}if(re(l)!==i)throw new Error(qD(s,l));const h=s.length,f=[];if(h>0){f[h-1]=1;for(let g=h-2;g>=0;--g)f[g]=f[g+1]*s[g+1]}const p=[];if(a>0){p[a-1]=1;for(let g=a-2;g>=0;--g)p[g]=p[g+1]*l[g+1]}const m=Ht(n,o*a);for(let g=0;g<o;++g){let x=0;for(let b=0;b<h;++b)x+=t[g*h+b]*f[b];for(let b=0;b<a;++b)m[g*a+b]=Math.trunc(x/p[b]),x%=p[b]}return[m,[o,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fC(t,e,n,s,r,i=!1,o=0){const a=s.length,l=[e[0],t.length/e[0]],c=l[1],d=a>0?r[a-1]+1:0;if(d<0)throw new Error(o1());const h=e.slice();h[0]=d;const f=h.reduce((v,w)=>v*w,1),p=Ht(n,f);if(a===0)return d>0&&p.fill(o),[p,h];if(d<=0)throw new Error(o1());let m=0,g=1,x=0,b=r[m];for(;;){let v=0;if(g<a){if(v=r[g],b===v){++g;continue}if(b>=v)throw new Error(YD())}if(b<0||b>=d)throw new Error(QD(b,d));b>x&&p.fill(o,x*c,b*c);for(let w=m;w<g;++w){const C=s[w];if(C<0||C>=l[0])throw new Error(JD(w,s[w],l[0]));for(let $=0;$<c;$++)p[b*c+$]+=t[C*c+$]}if(i)for(let w=0;w<c;w++)p[b*c+w]/=g-m;if(m=g,++g,x=b+1,b=v,g>a)break}return x<d&&p.fill(o,x*c,d*c),[p,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Z=Si(t=>Math.sqrt(t)),RZ=gt(Mh,t=>Math.sqrt(t)),AZ={kernelName:Mh,backendName:"cpu",kernelFunc:RZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nL=Qt((t,e)=>{const n=t-e;return n*n}),DZ=mn(zh,nL),FZ={kernelName:zh,backendName:"cpu",kernelFunc:DZ};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sL=Si((t,e)=>{const{pattern:n,replaceGlobal:s,rewrite:r}=e;return t.replace(new RegExp(n,s?"g":""),r)}),OZ=ia(Iw,sL),PZ={kernelName:Iw,backendName:"cpu",kernelFunc:OZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rL(t,e,n,s){const r=Ye(t,e.dtype);for(let i=0;i<r.size;i++){const o=r.indexToLoc(i),a=new Array(o.length);for(let l=0;l<a.length;l++)a[l]=o[l]*n[l]+s[l];r.set(e.get(...a),...o)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LZ{constructor(e,n,s,r,i,o){this.separator=Do(e),this.nGramWidths=n,this.leftPad=Do(s),this.rightPad=Do(r),this.padWidth=i,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const s=this.getPadWidth(n);return Math.max(0,e+2*s-n+1)}createNGrams(e,n,s,r,i,o){for(let a=0;a<i;++a){const l=this.getPadWidth(o),c=Math.max(0,l-a),u=Math.max(0,l-(i-(a+1))),d=o-(c+u),h=n+(c>0?0:a-l);let f=0;f+=c*this.leftPad.length;for(let b=0;b<d;++b)f+=e[h+b].length;f+=u*this.rightPad.length;const p=c+u+d-1;f+=p*this.separator.length,s[r+a]=new Uint8Array(f);const m=s[r+a];let g=0;const x=b=>b.forEach(v=>m[g++]=v);for(let b=0;b<c;++b)x(this.leftPad),x(this.separator);for(let b=0;b<d-1;++b)x(e[h+b]),x(this.separator);if(d>0){x(e[h+d-1]);for(let b=0;b<u;++b)x(this.separator),x(this.rightPad)}else{for(let b=0;b<u-1;++b)x(this.rightPad),x(this.separator);x(this.rightPad)}}}compute(e,n){const s=e.length,r=n.length;if(r>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<r;++c){let u=n[c]>=l;if(u=u&&n[c]<=s,!u)throw new Error(`Invalid split value ${n[c]}, must be in [${l}, ${s}]`);l=n[c]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const i=r-1,o=Ht("int32",r);if(s===0||r===0){const l=new Array(s);for(let c=0;c<=i;++c)o[c]=0;return[l,o]}o[0]=0;for(let l=1;l<=i;++l){const c=n[l]-n[l-1];let u=0;this.nGramWidths.forEach(d=>{u+=this.getNumNGrams(c,d)}),this.preserveShort&&c>0&&u===0&&(u=1),o[l]=o[l-1]+u}const a=new Array(o[i]);for(let l=0;l<i;++l){const c=n[l];let u=o[l];if(this.nGramWidths.forEach(d=>{const h=n[l+1]-n[l],f=this.getNumNGrams(h,d);this.createNGrams(e,c,a,u,f,d),u+=f}),this.preserveShort&&u===o[l]){const d=n[l+1]-n[l];if(d===0)continue;const h=d+2*this.padWidth;this.createNGrams(e,c,a,u,1,h)}}return[a,o]}}function iL(t,e,n,s,r,i,o,a){return new LZ(n,s,r,i,o,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MZ(t,e,n,s){if(!t.length)return;if(e.length===0){for(let i=0;i<t.length;++i)s.push(t.subarray(i,i+1));return}if(e.length===1){const i=e[0];let o=t.indexOf(i);for(;o!==-1;){const a=t.subarray(0,o);(!n||a.length!==0)&&s.push(a),t=t.subarray(o+1),o=t.indexOf(i)}(!n||t.length!==0)&&s.push(t);return}let r=0;for(let i=0;i<t.length+1;i++)if(i===t.length||e.indexOf(t[i])!==-1){const o=t.subarray(r,i);(!n||o.length!==0)&&s.push(o),r=i+1}}function oL(t,e,n){const s=t.length,r=[];let i=0,o=0;const a=new Array(s);for(let h=0;h<s;++h){const f=r.length;MZ(t[h],e,n,r);const p=r.length-f;a[h]=p,i+=p,o=Math.max(o,p)}const l=Ht("int32",i*2),c=new Array(i),u=[s,o];let d=0;for(let h=0;h<s;++h)for(let f=0;f<a[h];++f)l[d*2]=h,l[d*2+1]=f,c[d]=r[d],++d;return[l,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aL(t,e){const n=Ht("int32",t.length);for(let s=0;s<t.length;++s)n[s]=vH(t[s]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lL=Qt((t,e)=>t-e),zZ=cC((t,e,n,s)=>({real:t-n,imag:e-s})),pC=mn(Bh,lL,zZ),BZ={kernelName:Bh,backendName:"cpu",kernelFunc:pC};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cL(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const s=Ye(n,t.dtype);for(let r=0;r<s.values.length;++r){const i=s.indexToLoc(r),o=new Array(t.rank);for(let l=0;l<o.length;l++)o[l]=i[l]%t.shape[l];const a=t.locToIndex(o);s.values[r]=t.values[a]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lu=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function uL(t,e,n=0,s=t.length-1){for(;s>n;){if(s-n>600){const a=s-n+1,l=e-n+1,c=Math.log(a),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(a-u)/a)*Math.sign(l-a/2),h=Math.max(n,Math.floor(e-l*u/a+d)),f=Math.min(s,Math.floor(e+(a-l)*u/a+d));uL(t,e,h,f)}const r=t[e];let i=n,o=s;for(Al(t,n,e),Lu(t[s],r)>0&&Al(t,n,s);i<o;){for(Al(t,i,o),i++,o--;Lu(t[i],r)<0;)i=i+1;for(;Lu(t[o],r)>0;)o=o-1}Lu(t[n],r)===0?Al(t,n,o):(o=o+1,Al(t,o,s)),o<=e&&(n=o+1),e<=o&&(s=o-1)}}function dL(t,e,n,s,r){const i=e[e.length-1],[o,a]=[t.length/i,i],l=Pn(n,o*s),c=Pn("int32",o*s);for(let d=0;d<o;d++){const h=d*a,f=t.subarray(h,h+a);let p=new Array(f.length);f.forEach((b,v)=>p[v]={value:b,index:v}),s<p.length&&(uL(p,s),p=p.slice(0,s)),r&&p.sort(Lu);const m=d*s,g=l.subarray(m,m+s),x=c.subarray(m,m+s);for(let b=0;b<s;b++)g[b]=p[b].value,x[b]=p[b].index}const u=e.slice();return u[u.length-1]=s,[Ye(u,n,l),Ye(u,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hL(t,e,n,s){const r=Qe(e,n)[0],i=[1,n[0],1];for(let p=0;p<r;p++)i[0]*=n[p];i[1]=n[r];for(let p=r+1;p<n.length;p++)i[2]*=n[p];const o=new Map,a=new Int32Array(n[r]),l=new Nn(i,s,t),c=[],u=i[0]===1&&i[2]===1;for(let p=0;p<n[r];p++){let m;if(u)m=t[p].toString();else{const x=[];for(let b=0;b<i[0];b++)for(let v=0;v<i[2];v++)x.push(l.get(b,p,v));m=x.join(",")}const g=o.get(m);if(g!=null)a[p]=g;else{const x=o.size;o.set(m,x),a[p]=x,c.push(p)}}const d=i.slice();d[1]=o.size;const h=new Nn(d,s);c.forEach((p,m)=>{for(let g=0;g<i[0];g++)for(let x=0;x<i[2];x++)h.set(l.get(g,p,x),g,m,x)});const f=n.slice();return f[r]=d[1],{outputValues:h.values,outputShape:f,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WZ=Object.freeze(Object.defineProperty({__proto__:null,addImpl:wP,bincountImpl:uC,bincountReduceImpl:kP,bitwiseAndImpl:CP,castImpl:vP,ceilImpl:SP,concatImpl:IP,equalImpl:$P,expImpl:TP,expm1Impl:_P,floorDivImpl:AP,floorImpl:RP,gatherNdImpl:DP,gatherV2Impl:FP,greaterEqualImpl:PP,greaterImpl:OP,lessEqualImpl:MP,lessImpl:LP,linSpaceImpl:zP,logImpl:BP,maxImpl:WP,maximumImpl:jP,minimumImpl:VP,multiplyImpl:dC,negImpl:UP,notEqualImpl:GP,prodImpl:HP,raggedGatherImpl:KP,raggedRangeImpl:XP,raggedTensorToTensorImpl:qP,rangeImpl:YP,rsqrtImpl:QP,scatterImpl:Ra,sigmoidImpl:NZ,simpleAbsImpl:bP,sliceImpl:ZP,sparseFillEmptyRowsImpl:eL,sparseReshapeImpl:tL,sparseSegmentReductionImpl:fC,sqrtImpl:_Z,squaredDifferenceImpl:nL,staticRegexReplaceImpl:sL,stridedSliceImpl:rL,stringNGramsImpl:iL,stringSplitImpl:oL,stringToHashBucketFastImpl:aL,subImpl:lL,tileImpl:cL,topKImpl:dL,transposeImpl:hC,uniqueImpl:hL},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */_A("cpu",()=>new Hx,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fL=gt(ch,t=>t>=0?t:Math.exp(t)-1),jZ={kernelName:ch,backendName:"cpu",kernelFunc:fL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pL(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:i}=s;_e([r],"leakyRelu");const o=re(r.shape),a=n.data.get(r.dataId).values,l=Pn("float32",o);for(let c=0;c<a.length;c++)l[c]=a[c]<0?i*a[c]:a[c];return n.makeTensorInfo(r.shape,"float32",l)}const VZ={kernelName:Vg,backendName:"cpu",kernelFunc:pL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UZ=Qt((t,e)=>t<0?e*t:t);function mL(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e;_e([s,r],"prelu");const i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,[a,l]=UZ(s.shape,r.shape,i,o,"float32");return n.makeTensorInfo(l,"float32",a)}const GZ={kernelName:lx,backendName:"cpu",kernelFunc:mL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gL=gt(Th,t=>Math.max(0,t)),HZ={kernelName:Th,backendName:"cpu",kernelFunc:gL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xL=gt(Eh,t=>Math.min(Math.max(0,t),6)),KZ={kernelName:Eh,backendName:"cpu",kernelFunc:xL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bm(t,e,n,s,r){if(n==="linear")return Ci({inputs:{x:e},backend:t});if(n==="relu")return gL({inputs:{x:e},backend:t});if(n==="elu")return fL({inputs:{x:e},backend:t});if(n==="relu6")return xL({inputs:{x:e},backend:t});if(n==="prelu")return mL({inputs:{x:e,alpha:s},backend:t});if(n==="leakyrelu")return pL({inputs:{x:e},backend:t,attrs:{alpha:r}});if(n==="sigmoid")return JP({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ct(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:i}=s,o=re(r.shape),a=OR(i,o),l=re(a);R(o===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${r.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(r.dataId);const c=n.data.get(r.dataId);if(c.complexTensorInfos!=null){const u=c.complexTensorInfos.real,d=c.complexTensorInfos.imag;u.shape=a,d.shape=a}return{dataId:r.dataId,shape:a,dtype:r.dtype}}const XZ={kernelName:ux,backendName:"cpu",kernelFunc:Ct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yL(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i}=e,{transposeA:o,transposeB:a}=s;_e([r,i],"matMul");const l=r.shape.length,c=i.shape.length,u=o?r.shape[l-2]:r.shape[l-1],d=a?i.shape[c-1]:i.shape[c-2],h=o?r.shape[l-1]:r.shape[l-2],f=a?i.shape[c-2]:i.shape[c-1],p=r.shape.slice(0,-2),m=i.shape.slice(0,-2),g=re(p),x=re(m),v=He(r.shape.slice(0,-2),i.shape.slice(0,-2)).concat([h,f]);R(u===d,()=>`Error in matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${r.shape} and ${i.shape} and transposeA=${o} and transposeB=${a} must match.`);const w=o?[g,u,h]:[g,h,u],C=a?[x,f,d]:[x,d,f],$=Ct({inputs:{x:r},backend:n,attrs:{shape:w}}),T=Ct({inputs:{x:i},backend:n,attrs:{shape:C}}),N=o?$.shape[1]:$.shape[2],_=o?$.shape[2]:$.shape[1],A=a?T.shape[1]:T.shape[2],O=Math.max(g,x),W=n.data.get($.dataId).values,G=n.data.get(T.dataId).values,q=Fe($.shape),U=Fe(T.shape),[Y,te,M]=o?[q[0],1,q[1]]:[q[0],q[1],1],[X,Z,oe]=a?[1,U[1],U[0]]:[U[1],1,U[0]],ae=_*A,ce=Ye([O,_,A],$.dtype),pe=ce.values,fe=n.blockSize;for(let be=0;be<O;be++){const Ne=be%g,Te=be%x;for(let De=0;De<_;De+=fe){const je=Math.min(De+fe,_);for(let ue=0;ue<A;ue+=fe){const le=Math.min(ue+fe,A);for(let me=0;me<N;me+=fe){const he=Math.min(me+fe,N);for(let $e=De;$e<je;$e++)for(let Le=ue;Le<le;Le++){let Re=0;for(let We=me;We<he;We++){const nt=W[Ne*Y+$e*te+We*M],Ge=G[We*X+Le*Z+Te*oe];Re+=nt*Ge}pe[be*ae+($e*A+Le)]+=Re}}}}}return n.disposeIntermediateTensorInfo($),n.disposeIntermediateTensorInfo(T),n.makeTensorInfo(v,ce.dtype,ce.values)}const qZ={kernelName:Tg,backendName:"cpu",kernelFunc:yL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YZ(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=s;let h,f,p;const m=[];h=yL({inputs:{a:r,b:i},attrs:{transposeA:l,transposeB:c},backend:n}),o&&(f=Sc({inputs:{a:h,b:o},backend:n}),m.push(h),h=f),u&&(p=Bm(n,h,u,a,d),m.push(h),h=p);for(const x of m)n.disposeIntermediateTensorInfo(x);return h}const QZ={kernelName:bm,backendName:"cpu",kernelFunc:YZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JZ=gt(Yd,t=>Math.acos(t)),ZZ={kernelName:Yd,backendName:"cpu",kernelFunc:JZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eee=gt(Qd,t=>Math.acosh(t)),tee={kernelName:Qd,backendName:"cpu",kernelFunc:eee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nee(t){const{inputs:e,backend:n}=t,s=e;_e(e,"addN");const r=s.map(a=>n.data.get(a.dataId).values),i=Ye(s[0].shape,s[0].dtype),o=i.values;for(let a=0;a<s.length;a++){const l=r[a];for(let c=0;c<o.length;c++)o[c]+=l[c]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}const see={kernelName:Uv,backendName:"cpu",kernelFunc:nee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ree(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;_e(r,"all");const a=Qe(i,r.shape);let l=a;const c=Wt(l,r.shape.length);let u=r;c!=null&&(u=cs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=qt(l.length,r.shape.length)),En("all",l,u.shape.length);const[d,h]=kn(u.shape,l),f=re(h),p=Ln(re(d),u.dtype),m=n.data.get(u.dataId).values;for(let x=0;x<p.length;++x){const b=x*f;let v=m[b];for(let w=0;w<f;++w){const C=m[b+w];v=v&&C}p[x]=v}c!=null&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,p);if(o){const x=rn(d,a),b=Ct({inputs:{x:g},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(g),b}return g}const iee={kernelName:Gv,backendName:"cpu",kernelFunc:ree};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oee(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;_e(r,"any");const a=Qe(i,r.shape);let l=a;const c=Wt(l,r.shape.length);let u=r;c!=null&&(u=cs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=qt(l.length,r.shape.length)),En("any",l,u.shape.length);const[d,h]=kn(u.shape,l),f=re(h),p=Ln(re(d),u.dtype),m=n.data.get(u.dataId).values;for(let x=0;x<p.length;++x){const b=x*f;let v=m[b];for(let w=0;w<f;++w){const C=m[b+w];v=v||C}p[x]=v}c!=null&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,p);if(o){const x=rn(d,a),b=Ct({inputs:{x:g},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(g),b}return g}const aee={kernelName:Hv,backendName:"cpu",kernelFunc:oee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lee(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;_e(r,"argMax");let o=Qe(i,r.shape);const a=Wt(o,r.shape.length);let l=r;const c=[];a!=null&&(l=cs({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=qt(o.length,l.shape.length)),o=[o[0]],En("argMax",o,l.shape.length);const[u,d]=kn(l.shape,o),h=re(u),f=Ln(h,"int32"),p=re(d),m=n.data.get(l.dataId).values;for(let g=0;g<f.length;++g){const x=g*p;let b=m[x],v=0;for(let w=0;w<p;++w){const C=m[x+w];C>b&&(b=C,v=w)}f[g]=v}return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(u,"int32",f)}const cee={kernelName:Sg,backendName:"cpu",kernelFunc:lee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uee(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;_e(r,"argMin");let o=Qe(i,r.shape);const a=Wt(o,r.shape.length);let l=r;const c=[];a!=null&&(l=cs({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=qt(o.length,l.shape.length)),o=[o[0]],En("argMin",o,l.shape.length);const[u,d]=kn(l.shape,o),h=re(u),f=Ln(h,"int32"),p=re(d),m=n.data.get(l.dataId).values;for(let g=0;g<f.length;++g){const x=g*p;let b=m[x],v=0;for(let w=0;w<p;++w){const C=m[x+w];C<b&&(b=C,v=w)}f[g]=v}return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(u,"int32",f)}const dee={kernelName:Ig,backendName:"cpu",kernelFunc:uee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hee=gt(Jd,t=>Math.asin(t)),fee={kernelName:Jd,backendName:"cpu",kernelFunc:hee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pee=gt(Zd,t=>Math.asinh(t)),mee={kernelName:Zd,backendName:"cpu",kernelFunc:pee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gee=gt(eh,t=>Math.atan(t)),xee={kernelName:eh,backendName:"cpu",kernelFunc:gee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yee=Qt((t,e)=>Math.atan2(t,e)),bee=mn(nh,yee),vee={kernelName:nh,backendName:"cpu",kernelFunc:bee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wee=gt(th,t=>Math.atanh(t)),kee={kernelName:th,backendName:"cpu",kernelFunc:wee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mC(t,e,n,s,r,i){const o=r.strideHeight,a=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,u=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,f=r.padInfo.left,p=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Ye(r.outShape,n),g=m.values,x=r.outShape[1]*r.outShape[2]*r.outShape[3],b=r.outShape[2]*r.outShape[3],v=r.outShape[3];for(let w=0;w<r.batchSize;++w){const C=w*x,$=w*s[0];for(let T=0;T<r.inChannels;++T)for(let N=0;N<r.outHeight;++N){const _=N*o-h,A=Math.max(0,_),O=Math.min(r.inHeight,u+_),W=C+N*b;for(let G=0;G<r.outWidth;++G){const q=G*a-f,U=Math.max(0,q),Y=Math.min(r.inWidth,d+q);let te=p,M=0,X=0;for(let oe=A;oe<O;oe+=l){const ae=$+oe*s[1];for(let ce=U;ce<Y;ce+=c){const pe=ae+ce*s[2],fe=t[pe+T];i==="max"&&fe>te?te=fe:i==="avg"&&(M+=fe,X++)}if(isNaN(te))break}const Z=W+G*v+T;g[Z]=i==="avg"?M/X:te}}}return m}function bL(t,e,n,s,r=!1,i=!1){const o=Ye(s.outShape,"int32"),a=s.strideHeight,l=s.strideWidth,c=s.dilationHeight,u=s.dilationWidth,d=s.effectiveFilterHeight,h=s.effectiveFilterWidth,f=s.padInfo.top,p=s.padInfo.left,m=Ye(e,n,t);for(let g=0;g<s.batchSize;++g)for(let x=0;x<s.inChannels;++x)for(let b=0;b<s.outHeight;++b){const v=b*a-f;let w=v;for(;w<0;)w+=c;const C=Math.min(s.inHeight,d+v);for(let $=0;$<s.outWidth;++$){const T=$*l-p;let N=T;for(;N<0;)N+=u;const _=Math.min(s.inWidth,h+T);let A=Number.NEGATIVE_INFINITY,O=-1;for(let W=w;W<C;W+=c){const G=W-v;for(let q=N;q<_;q+=u){const U=q-T,Y=m.get(g,W,q,x);Y>A&&(A=Y,r?O=i?((g*s.inHeight+W)*s.inWidth+q)*s.inChannels+x:(W*s.inWidth+q)*s.inChannels+x:O=G*h+U)}}o.set(O,g,b,$,x)}}return o}function vL(t,e,n,s,r,i){const o=r.strideDepth,a=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,u=r.dilationHeight,d=r.dilationWidth,h=r.effectiveFilterDepth,f=r.effectiveFilterHeight,p=r.effectiveFilterWidth,m=r.padInfo.front,g=r.padInfo.top,x=r.padInfo.left,b=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=Ye(r.outShape,n),w=v.values,C=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],$=r.outShape[2]*r.outShape[3]*r.outShape[4],T=r.outShape[3]*r.outShape[4],N=r.outShape[4];for(let _=0;_<r.batchSize;++_){const A=_*C,O=_*s[0];for(let W=0;W<r.inChannels;++W)for(let G=0;G<r.outDepth;++G){const q=G*o-m;let U=q;for(;U<0;)U+=c;const Y=Math.min(r.inDepth,h+q),te=A+G*$;for(let M=0;M<r.outHeight;++M){const X=M*a-g;let Z=X;for(;Z<0;)Z+=u;const oe=Math.min(r.inHeight,f+X),ae=te+M*T;for(let ce=0;ce<r.outWidth;++ce){const pe=ce*l-x;let fe=pe;for(;fe<0;)fe+=d;const be=Math.min(r.inWidth,p+pe),Ne=ae+ce*N;let Te=b,De=0,je=0;for(let le=U;le<Y;le+=c){const me=O+le*s[1];for(let he=Z;he<oe;he+=u){const $e=me+he*s[2];for(let Le=fe;Le<be;Le+=d){const Re=$e+Le*s[3],We=t[Re+W];if(i==="max"&&We>Te?Te=We:i==="avg"&&(De+=We,je++),isNaN(Te))break}if(isNaN(Te))break}if(isNaN(Te))break}const ue=Ne+W;w[ue]=i==="avg"?De/Math.max(je,1):Te}}}}return v}function Cee(t,e){const n=Ye(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left;for(let m=0;m<e.batchSize;++m)for(let g=0;g<e.inChannels;++g)for(let x=0;x<e.outDepth;++x){const b=x*s-h;let v=b;for(;v<0;)v+=o;const w=Math.min(e.inDepth,c+b);for(let C=0;C<e.outHeight;++C){const $=C*r-f;let T=$;for(;T<0;)T+=a;const N=Math.min(e.inHeight,u+$);for(let _=0;_<e.outWidth;++_){const A=_*i-p;let O=A;for(;O<0;)O+=l;const W=Math.min(e.inWidth,d+A);let G=Number.NEGATIVE_INFINITY,q=-1;for(let U=v;U<w;U+=o){const Y=U-b;for(let te=T;te<N;te+=a){const M=te-$;for(let X=O;X<W;X+=l){const Z=X-A,oe=t.get(m,U,te,X,g);oe>=G&&(G=oe,q=Y*u*d+M*u+Z)}}}n.set(q,m,x,C,_,g)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function See(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;_e(r,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;R(zn(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=gr(r.shape,i,o,c,a,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&ft(u.inShape,u.outShape))d=Ci({inputs:{x:r},backend:n});else{const h=n.data.get(r.dataId).values,f=Fe(r.shape),p=mC(h,r.shape,r.dtype,f,u,"avg");d=n.makeTensorInfo(u.outShape,r.dtype,p.values)}return d}const Iee={kernelName:$g,backendName:"cpu",kernelFunc:See};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ee(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s;_e(r,"avgPool3d");const u=Yi(r.shape,i,o,1,a,l,c),d=n.data.get(r.dataId).values,h=vL(d,r.shape,r.dtype,Fe(r.shape),u,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}const Nee={kernelName:Ng,backendName:"cpu",kernelFunc:$ee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tee(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=s;_e([r,i],"avgPool3DGrad");const u=Yi(i.shape,o,a,1,l,c),d=u.strideDepth,h=u.strideHeight,f=u.strideWidth,p=u.filterDepth,m=u.filterHeight,g=u.filterWidth,x=u.dilationDepth,b=u.dilationHeight,v=u.dilationWidth,w=u.effectiveFilterDepth,C=u.effectiveFilterHeight,$=u.effectiveFilterWidth,T=w-1-u.padInfo.front,N=$-1-u.padInfo.left,_=C-1-u.padInfo.top,A=Ye(i.shape,"float32"),O=1/(p*m*g),W=n.bufferSync(r);for(let G=0;G<u.batchSize;++G)for(let q=0;q<u.inChannels;++q)for(let U=0;U<u.inDepth;++U)for(let Y=0;Y<u.inHeight;++Y)for(let te=0;te<u.inWidth;++te){const M=U-T,X=Y-_,Z=te-N;let oe=0;for(let ae=0;ae<w;ae+=x){const ce=(M+ae)/d;if(!(ce<0||ce>=u.outDepth||Math.floor(ce)!==ce))for(let pe=0;pe<C;pe+=b){const fe=(X+pe)/h;if(!(fe<0||fe>=u.outHeight||Math.floor(fe)!==fe))for(let be=0;be<$;be+=v){const Ne=(Z+be)/f;if(Ne<0||Ne>=u.outWidth||Math.floor(Ne)!==Ne)continue;const Te=W.get(G,ce,fe,Ne,q);oe+=Te}}}A.set(oe*O,G,U,Y,te,q)}return n.makeTensorInfo(A.shape,A.dtype,A.values)}const Eee={kernelName:Xv,backendName:"cpu",kernelFunc:Tee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ee(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i;_e([r,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=gr(o.shape,a,l,1,c),d=u.strideHeight,h=u.strideWidth,f=u.filterHeight,p=u.filterWidth,m=u.dilationHeight,g=u.dilationWidth,x=u.effectiveFilterHeight,b=u.effectiveFilterWidth,v=b-1-u.padInfo.left,w=x-1-u.padInfo.top,C=Ye(o.shape,"float32"),$=1/(f*p),T=n.data.get(r.dataId).values,N=Ye(r.shape,"float32",T);for(let _=0;_<u.batchSize;++_)for(let A=0;A<u.inChannels;++A)for(let O=0;O<u.inHeight;++O)for(let W=0;W<u.inWidth;++W){const G=O-w,q=W-v;let U=0;for(let Y=0;Y<x;Y+=m){const te=(G+Y)/d;if(!(te<0||te>=u.outHeight||Math.floor(te)!==te))for(let M=0;M<b;M+=g){const X=(q+M)/h;if(X<0||X>=u.outWidth||Math.floor(X)!==X)continue;const Z=N.get(_,te,X,A);U+=Z}}C.set(U*$,_,O,W,A)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const Ree={kernelName:Kv,backendName:"cpu",kernelFunc:_ee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aee(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,scale:i,offset:o,mean:a,variance:l}=e;R(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),R(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),R(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),_e([r,a,l,i,o],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const u=n.data.get(r.dataId).values,d=n.data.get(a.dataId).values,h=n.data.get(l.dataId).values,f=i?n.data.get(i.dataId).values:new Float32Array([1]),p=o?n.data.get(o.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),g=p.length,x=f.length,b=h.length,v=d.length;let w=0,C=0,$=0,T=0;for(let N=0;N<u.length;++N)m[N]=p[w++]+(u[N]-d[C++])*f[$++]/Math.sqrt(h[T++]+c),w>=g&&(w=0),C>=v&&(C=0),$>=x&&($=0),T>=b&&(T=0);return n.makeTensorInfo(r.shape,r.dtype,m)}const Dee={kernelName:Bg,backendName:"cpu",kernelFunc:Aee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fee(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,crops:o}=s;_e([r],"batchToSpaceND");const a=i.reduce((x,b)=>x*b),l=Yh(r.shape,i,a),c=Qh(l.length,i.length),u=Jh(r.shape,i,a),d=Ik(o,i.length),h=$k(u,o,i.length),f=Ct({inputs:{x:r},backend:n,attrs:{shape:l}}),p=cs({inputs:{x:f},backend:n,attrs:{perm:c}}),m=Ct({inputs:{x:p},backend:n,attrs:{shape:u}}),g=il({inputs:{x:m},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}const Oee={kernelName:Eg,backendName:"cpu",kernelFunc:Fee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pee(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o}=s,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=uC(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const Lee={kernelName:qv,backendName:"cpu",kernelFunc:Pee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mee(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,a=He(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const zee={kernelName:WR,backendName:"cpu",kernelFunc:Mee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bee=gt(ih,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),Wee={kernelName:ih,backendName:"cpu",kernelFunc:Bee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jee=t=>{const{x:e}=t.inputs,n=t.backend,s=new Float32Array(re(e.shape)),r=n.data.get(e.dataId),i=r.complexTensorInfos.real,o=r.complexTensorInfos.imag,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values;for(let c=0;c<a.length;c++){const u=a[c],d=l[c];s[c]=Math.hypot(u,d)}return n.makeOutput(s,e.shape,"float32")},Vee={kernelName:_g,backendName:"cpu",kernelFunc:jee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ic(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.imag,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}const Uee={kernelName:fw,backendName:"cpu",kernelFunc:Ic};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $c(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,i=Qe(r,e[0].shape)[0],o=e.map(m=>m.shape);kk(o,i);let a=gi(e.map(m=>m.shape),i);if(re(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(m=>re(m.shape)>0);if(l.length===1)return Ci({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const m=l.map(w=>rl({inputs:{input:w},backend:n})),g=l.map(w=>Ic({inputs:{input:w},backend:n})),x=$c({inputs:m,backend:n,attrs:{axis:i}}),b=$c({inputs:g,backend:n,attrs:{axis:i}}),v=vs({inputs:{real:x,imag:b},backend:n});return m.forEach(w=>n.disposeIntermediateTensorInfo(w)),g.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(b),v}const c=l.map(m=>{const x=[-1,re(m.shape.slice(i))];return Ct({inputs:{x:m},backend:n,attrs:{shape:x}})}),u=c.map(m=>({vals:n.data.get(m.dataId).values,shape:m.shape}));a=gi(c.map(m=>m.shape),1);const d=c[0].shape[0]===1,h=IP(u,a,e[0].dtype,d),f=gi(l.map(m=>m.shape),i),p=n.makeTensorInfo(f,e[0].dtype,h);return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const Gee={kernelName:Rg,backendName:"cpu",kernelFunc:$c};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wL(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s;_e([r,i],"conv2d");const d=Qi(l),h=Tn(r.shape,i.shape,o,c,a,u,!1,d),f=h.filterHeight,p=h.filterWidth,m=h.dilationHeight,g=h.dilationWidth,x=h.padInfo.left,b=h.padInfo.top,v=h.dataFormat==="channelsLast",w=new Nn(h.outShape,r.dtype),C=Fe(r.shape),$=Fe(i.shape),T=C[0],N=v?C[1]:C[2],_=v?C[2]:1,A=v?1:C[1],O=w.strides[0],W=v?w.strides[1]:w.strides[2],G=v?w.strides[2]:1,q=v?1:w.strides[1],U=n.data.get(r.dataId).values,Y=n.data.get(i.dataId).values,te=w.values;for(let M=0;M<h.batchSize;++M){const X=M*T,Z=M*O;for(let oe=0;oe<h.outHeight;++oe){const ae=Z+oe*W,ce=oe*h.strideHeight-b;for(let pe=0;pe<f;++pe){const fe=ce+pe*m;if(fe<0||fe>=h.inHeight)continue;const be=pe*$[0],Ne=X+fe*N;for(let Te=0;Te<h.outWidth;++Te){const De=ae+Te*G,je=Te*h.strideWidth-x;for(let ue=0;ue<p;++ue){const le=je+ue*g;if(le<0||le>=h.inWidth)continue;const me=be+ue*$[1],he=Ne+le*_;let $e=me;for(let Le=0;Le<h.inChannels;++Le){const Re=U[he+Le*A];for(let We=0;We<h.outChannels;++We)te[De+We*q]+=Re*Y[$e+We];$e+=h.outChannels}}}}}}return n.makeTensorInfo(w.shape,w.dtype,te)}const Hee={kernelName:Ag,backendName:"cpu",kernelFunc:wL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kee(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s;_e([r,i],"conv2dBackpropFilter");const d=Qi(l),h=Tn(r.shape,u,o,1,a,c,!1,d),{strideHeight:f,strideWidth:p,filterHeight:m,filterWidth:g}=h,x=h.dataFormat==="channelsLast",b=new Nn(h.filterShape,"float32"),v=h.padInfo.left,w=h.padInfo.top,C=n.data.get(r.dataId).values,$=n.data.get(i.dataId).values,T=new Nn(r.shape,r.dtype,C),N=new Nn(i.shape,i.dtype,$);for(let _=0;_<m;++_){const A=Math.max(0,Math.ceil((w-_)/f)),O=Math.min(h.outHeight,(h.inHeight+w-_)/f);for(let W=0;W<g;++W){const G=Math.max(0,Math.ceil((v-W)/p)),q=Math.min(h.outWidth,(h.inWidth+v-W)/p);for(let U=0;U<h.inChannels;++U)for(let Y=0;Y<h.outChannels;++Y){let te=0;for(let M=0;M<h.batchSize;++M)for(let X=A;X<O;++X){const Z=_+X*f-w;for(let oe=G;oe<q;++oe){const ae=W+oe*p-v;x?te+=T.get(M,Z,ae,U)*N.get(M,X,oe,Y):te+=T.get(M,U,Z,ae)*N.get(M,Y,X,oe)}}b.set(te,_,W,U,Y)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const Xee={kernelName:Jv,backendName:"cpu",kernelFunc:Kee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qee(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s;_e([r,i],"conv2dBackpropInput");const d=Fe(i.shape),h=Fe(r.shape);let f=Qi(c);const p=Tn(o,i.shape,a,1,l,u,!1,f),m=new Nn(p.inShape,"float32"),g=m.values,x=n.data.get(r.dataId).values,b=n.data.get(i.dataId).values,[v,w,C]=d,{batchSize:$,filterHeight:T,filterWidth:N,inChannels:_,inHeight:A,inWidth:O,outChannels:W,outHeight:G,outWidth:q,strideHeight:U,strideWidth:Y}=p;f=p.dataFormat;const te=T-1-p.padInfo.top,M=N-1-p.padInfo.left,X=f==="channelsLast",Z=m.strides[0],oe=X?m.strides[1]:m.strides[2],ae=X?m.strides[2]:1,ce=X?1:m.strides[1],pe=h[0],fe=X?h[1]:h[2],be=X?h[2]:1,Ne=X?1:h[1];for(let Te=0;Te<$;++Te)for(let De=0;De<_;++De)for(let je=0;je<A;++je){const ue=je-te,le=Math.max(0,Math.ceil(ue/U)),me=Math.min(G,(T+ue)/U);for(let he=0;he<O;++he){const $e=he-M,Le=Math.max(0,Math.ceil($e/Y)),Re=Math.min(q,(N+$e)/Y);let We=0;for(let Ge=le;Ge<me;++Ge){const on=Ge*U-ue;for(let pt=Le;pt<Re;++pt){const gn=pt*Y-$e,_t=pe*Te+fe*Ge+be*pt,fs=v*(T-1-on)+w*(N-1-gn)+C*De;for(let ts=0;ts<W;++ts){const Xs=x[_t+Ne*ts],Gr=b[fs+ts];We+=Xs*Gr}}}const nt=Z*Te+oe*je+ae*he+ce*De;g[nt]=We}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const Yee={kernelName:Dg,backendName:"cpu",kernelFunc:qee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qee(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s;_e([r,i],"conv3d");const c=Zo(r.shape,i.shape,o,l,a),{filterDepth:u,filterHeight:d,filterWidth:h,dilationDepth:f,dilationHeight:p,dilationWidth:m,padInfo:g}=c,x=g.front,b=g.left,v=g.top,w=new Nn(c.outShape,r.dtype),C=n.data.get(r.dataId).values,$=n.data.get(i.dataId).values,T=w.values,N=Fe(r.shape),_=Fe(i.shape);for(let A=0;A<c.batchSize;++A){const O=A*N[0],W=A*w.strides[0];for(let G=0;G<c.outDepth;++G){const q=W+G*w.strides[1],U=G*c.strideDepth-x;for(let Y=0;Y<u;++Y){const te=U+Y*f;if(te<0||te>=c.inDepth)continue;const M=Y*_[0],X=O+te*N[1];for(let Z=0;Z<c.outHeight;++Z){const oe=q+Z*w.strides[2],ae=Z*c.strideHeight-v;for(let ce=0;ce<d;++ce){const pe=ae+ce*p;if(pe<0||pe>=c.inHeight)continue;const fe=M+ce*_[1],be=X+pe*N[2];for(let Ne=0;Ne<c.outWidth;++Ne){const Te=oe+Ne*c.outChannels,De=Ne*c.strideWidth-b;for(let je=0;je<h;++je){const ue=De+je*m;if(ue<0||ue>=c.inWidth)continue;const le=fe+je*_[2],me=be+ue*c.inChannels;let he=le;for(let $e=0;$e<c.inChannels;++$e){const Le=C[me+$e];for(let Re=0;Re<c.outChannels;++Re)T[Te+Re]+=Le*$[he+Re];he+=c.outChannels}}}}}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const Jee={kernelName:Fg,backendName:"cpu",kernelFunc:Qee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zee(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,filterShape:l}=s;_e([r,i],"conv3dBackpropFilterV2");const c=Fe(r.shape),u=Fe(i.shape),d=Zo(r.shape,l,o,1,a),h=d.strideDepth,f=d.strideHeight,p=d.strideWidth,m=d.filterDepth,g=d.filterHeight,x=d.filterWidth,b=new Nn(d.filterShape,"float32"),v=b.values,[w,C,$,T]=b.strides,N=n.data.get(i.dataId).values,[_,A,O,W]=u,G=n.data.get(r.dataId).values,[q,U,Y,te]=c,M=d.padInfo.front,X=d.padInfo.left,Z=d.padInfo.top;for(let oe=0;oe<m;++oe){const ae=Math.max(0,Math.ceil((M-oe)/h)),ce=Math.min(d.outDepth,(d.inDepth+M-oe)/h),pe=oe*w;for(let fe=0;fe<g;++fe){const be=Math.max(0,Math.ceil((Z-fe)/f)),Ne=Math.min(d.outHeight,(d.inHeight+Z-fe)/f),Te=fe*C+pe;for(let De=0;De<x;++De){const je=Math.max(0,Math.ceil((X-De)/p)),ue=Math.min(d.outWidth,(d.inWidth+X-De)/p),le=De*$+Te;for(let me=0;me<d.inChannels;++me){const he=me*T+le;for(let $e=0;$e<d.outChannels;++$e){let Le=0;for(let Re=0;Re<d.batchSize;++Re){const We=Re*q,nt=Re*_;for(let Ge=ae;Ge<ce;++Ge){const pt=(oe+Ge*h-M)*U+We,gn=Ge*A+nt;for(let _t=be;_t<Ne;++_t){const ts=(fe+_t*f-Z)*Y+pt,Xs=_t*O+gn;for(let Gr=je;Gr<ue;++Gr){const eu=(De+Gr*p-X)*te+ts,Sl=Gr*W+Xs;Le+=G[eu+me]*N[Sl+$e]}}}}v[he+$e]=Le}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const ete={kernelName:Zv,backendName:"cpu",kernelFunc:Zee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tte(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{pad:o,strides:a,inputShape:l}=s;_e([r],"conv3dBackpropInputV2");const c=Fe(r.shape),u=Fe(i.shape),d=Zo(l,i.shape,a,1,o),h=new Nn(d.inShape,"float32"),f=h.values,[p,m,g,x]=h.strides,b=n.data.get(r.dataId).values,[v,w,C,$]=c,T=n.data.get(i.dataId).values,[N,_,A,O]=u,{batchSize:W,filterDepth:G,filterHeight:q,filterWidth:U,inChannels:Y,inDepth:te,inHeight:M,inWidth:X,outChannels:Z,outDepth:oe,outHeight:ae,outWidth:ce,strideDepth:pe,strideHeight:fe,strideWidth:be}=d,Ne=G-1-d.padInfo.front,Te=q-1-d.padInfo.top,De=U-1-d.padInfo.left;for(let je=0;je<W;++je)for(let ue=0;ue<Y;++ue)for(let le=0;le<te;++le){const me=le-Ne,he=Math.max(0,Math.ceil(me/pe)),$e=Math.min(oe,(G+me)/pe);for(let Le=0;Le<M;++Le){const Re=Le-Te,We=Math.max(0,Math.ceil(Re/fe)),nt=Math.min(ae,(q+Re)/fe);for(let Ge=0;Ge<X;++Ge){const on=Ge-De,pt=Math.max(0,Math.ceil(on/be)),gn=Math.min(ce,(U+on)/be);let _t=0;for(let fs=he;fs<$e;++fs){const ts=fs*pe-me;for(let Xs=We;Xs<nt;++Xs){const Gr=Xs*fe-Re;for(let Zi=pt;Zi<gn;++Zi){const eu=Zi*be-on,Sl=v*je+w*fs+C*Xs+$*Zi,pf=N*(G-1-ts)+_*(q-1-Gr)+A*(U-1-eu)+O*ue;for(let Hr=0;Hr<Z;++Hr){const tu=b[Sl+Hr],mf=T[pf+Hr];_t+=tu*mf}}}}f[p*je+m*le+g*Le+x*Ge+ue]=_t}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const nte={kernelName:ew,backendName:"cpu",kernelFunc:tte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ste=gt(oh,t=>Math.cos(t)),rte={kernelName:oh,backendName:"cpu",kernelFunc:ste};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ite=gt(ah,t=>Math.cosh(t)),ote={kernelName:ah,backendName:"cpu",kernelFunc:ite};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ate(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=s,[u,d,h,f]=r.shape,p=i.shape[0],[m,g]=a,x=Ye([p,m,g,f],"float32"),b=n.data.get(i.dataId).values,v=n.data.get(o.dataId).values,w=n.data.get(r.dataId).values,C=Fe(r.shape),$=Fe(x.shape);for(let T=0;T<p;T++){const N=T*4,_=b[N],A=b[N+1],O=b[N+2],W=b[N+3],G=v[T];if(G>=u)continue;const q=m>1?(O-_)*(d-1)/(m-1):0,U=g>1?(W-A)*(h-1)/(g-1):0;for(let Y=0;Y<m;Y++){const te=m>1?_*(d-1)+Y*q:.5*(_+O)*(d-1);if(te<0||te>d-1){for(let M=0;M<g;M++)for(let X=0;X<f;X++){const Z=X+M*$[2]+Y*$[1]+T*$[0];x.values[Z]=c}continue}if(l==="bilinear"){const M=Math.floor(te),X=Math.ceil(te),Z=te-M;for(let oe=0;oe<g;oe++){const ae=g>1?A*(h-1)+oe*U:.5*(A+W)*(h-1);if(ae<0||ae>h-1){for(let be=0;be<f;be++){const Ne=be+oe*$[2]+Y*$[1]+T*$[0];x.values[Ne]=c}continue}const ce=Math.floor(ae),pe=Math.ceil(ae),fe=ae-ce;for(let be=0;be<f;be++){let Ne=be+ce*C[2]+M*C[1]+G*C[0];const Te=w[Ne];Ne=be+pe*C[2]+M*C[1]+G*C[0];const De=w[Ne];Ne=be+ce*C[2]+X*C[1]+G*C[0];const je=w[Ne];Ne=be+pe*C[2]+X*C[1]+G*C[0];const ue=w[Ne],le=Te+(De-Te)*fe,me=je+(ue-je)*fe;Ne=be+oe*$[2]+Y*$[1]+T*$[0],x.values[Ne]=le+(me-le)*Z}}}else for(let M=0;M<g;++M){const X=g>1?A*(h-1)+M*U:.5*(A+W)*(h-1);if(X<0||X>h-1){for(let ae=0;ae<f;ae++){const ce=ae+M*$[2]+Y*$[1]+T*$[0];x.values[ce]=c}continue}const Z=Math.round(X),oe=Math.round(te);for(let ae=0;ae<f;ae++){const ce=ae+Z*C[2]+oe*C[1]+G*C[0],pe=ae+M*$[2]+Y*$[1]+T*$[0];x.values[pe]=w[ce]}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const lte={kernelName:nw,backendName:"cpu",kernelFunc:ate};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cte(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;_e(r,"cumprod");const l=Wt([i],r.shape.length);let c=r;l!=null&&(c=cs({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=qt(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=_s(c.dtype,"int32"),h=Wv(re(c.shape),d),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=a?(x,b)=>x+p-b-1:(x,b)=>x+b;for(let x=0;x<f.length;x+=p)for(let b=0;b<p;b++){const v=m(x,b);if(b===0)h[v]=o?1:f[v];else{const w=m(x,b-1);h[v]=o?f[w]*h[w]:f[v]*h[w]}}const g=n.makeTensorInfo(c.shape,d,h);if(l!=null){const x=ea(l),b=cs({inputs:{x:g},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),b}return g}const ute={kernelName:tw,backendName:"cpu",kernelFunc:cte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dte(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;_e(r,"cumsum");const l=Wt([i],r.shape.length);let c=r;l!=null&&(c=cs({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=qt(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=_s(c.dtype,"int32"),h=Ln(re(c.shape),d),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=a?(x,b)=>x+p-b-1:(x,b)=>x+b;for(let x=0;x<f.length;x+=p)for(let b=0;b<p;b++){const v=m(x,b);if(b===0)h[v]=o?0:f[v];else{const w=m(x,b-1);h[v]=o?f[w]+h[w]:f[v]+h[w]}}const g=n.makeTensorInfo(c.shape,d,h);if(l!=null){const x=ea(l),b=cs({inputs:{x:g},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),b}return g}const hte={kernelName:Og,backendName:"cpu",kernelFunc:dte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fte(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o,binaryOutput:a}=s;if(r.shape.length===1){const l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=uC(l,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(i),u=kP(l,c,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const pte={kernelName:sw,backendName:"cpu",kernelFunc:fte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mte(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:i,dataFormat:o}=s;R(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=r.shape[0],l=r.shape[1],c=r.shape[2],u=r.shape[3],d=l*i,h=c*i,f=u/(i*i),p=n.data.get(r.dataId).values,m=new Float32Array(a*d*h*f);let g=0;for(let x=0;x<a;++x)for(let b=0;b<d;++b){const v=Math.floor(b/i),w=b%i;for(let C=0;C<h;++C){const $=Math.floor(C/i),T=C%i,N=(w*i+T)*f;for(let _=0;_<f;++_){const O=_+N+u*($+c*(v+l*x));m[g++]=p[O]}}}return n.makeTensorInfo([a,d,h,f],r.dtype,m)}const gte={kernelName:rw,backendName:"cpu",kernelFunc:mte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kL(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=s;_e([r,i],"depthwiseConv2DNative");const u=Fe(r.shape),d=Fe(i.shape);let h=l;h==null&&(h=[1,1]),R(zn(o,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${h}'`);const f=Tn(r.shape,i.shape,o,h,a,c,!0),{filterHeight:p,filterWidth:m,dilationHeight:g,dilationWidth:x,padInfo:b}=f,v=b.left,w=b.top,C=f.outChannels/f.inChannels,$=new Nn(f.outShape,r.dtype),T=n.data.get(r.dataId).values,N=n.data.get(i.dataId).values,_=$.values;for(let A=0;A<f.batchSize;++A){const O=A*u[0],W=A*$.strides[0];for(let G=0;G<f.outHeight;++G){const q=W+G*$.strides[1],U=G*f.strideHeight-w;for(let Y=0;Y<p;++Y){const te=U+Y*g;if(te<0||te>=f.inHeight)continue;const M=Y*d[0],X=O+te*u[1];for(let Z=0;Z<f.outWidth;++Z){const oe=q+Z*$.strides[2],ae=Z*f.strideWidth-v;for(let ce=0;ce<m;++ce){const pe=ae+ce*x;if(pe<0||pe>=f.inWidth)continue;const fe=M+ce*d[1],be=X+pe*f.inChannels;let Ne=oe,Te=fe;for(let De=0;De<f.inChannels;++De){const je=T[be+De];for(let ue=0;ue<C;++ue)_[Ne+ue]+=je*N[Te+ue];Ne+=C,Te+=C}}}}}}return n.makeTensorInfo($.shape,$.dtype,$.values)}const xte={kernelName:Pg,backendName:"cpu",kernelFunc:kL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yte(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s;_e([r,i],"depthwiseConv2dNativeBackpropFilter");const d=Tn(r.shape,u,o,a,l,c,!0),{strideHeight:h,strideWidth:f,filterHeight:p,filterWidth:m}=d,g=new Nn(d.filterShape,"float32"),x=d.padInfo.left,b=d.padInfo.top,v=d.outChannels/d.inChannels,w=n.data.get(r.dataId).values,C=new Nn(r.shape,r.dtype,w),$=n.data.get(i.dataId).values,T=new Nn(i.shape,i.dtype,$);for(let N=0;N<p;++N){const _=Math.max(0,Math.ceil((b-N)/h)),A=Math.min(d.outHeight,(d.inHeight+b-N)/h);for(let O=0;O<m;++O){const W=Math.max(0,Math.ceil((x-O)/f)),G=Math.min(d.outWidth,(d.inWidth+x-O)/f);for(let q=0;q<d.outChannels;++q){const U=Math.trunc(q/v),Y=q%v;let te=0;for(let M=0;M<d.batchSize;++M)for(let X=_;X<A;++X){const Z=N+X*h-b;for(let oe=W;oe<G;++oe){const ae=O+oe*f-x;te+=C.get(M,Z,ae,U)*T.get(M,X,oe,q)}}g.set(te,N,O,U,Y)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const bte={kernelName:iw,backendName:"cpu",kernelFunc:yte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vte(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s;_e([r,i],"depthwiseConv2DNativeBackpropInput");const d=Fe(r.shape),h=Fe(i.shape),f=Tn(u,i.shape,o,a,l,c,!0),p=new Nn(f.inShape,"float32"),m=p.values,[g,x,b]=p.strides,v=n.data.get(r.dataId).values,[w,C,$]=d,T=n.data.get(i.dataId).values,[N,_,A]=h,{batchSize:O,filterHeight:W,filterWidth:G,inChannels:q,inHeight:U,inWidth:Y,outChannels:te,outHeight:M,outWidth:X,strideHeight:Z,strideWidth:oe}=f,ae=W-1-f.padInfo.top,ce=G-1-f.padInfo.left,pe=te/q;for(let fe=0;fe<O;++fe)for(let be=0;be<q;++be)for(let Ne=0;Ne<U;++Ne){const Te=Ne-ae,De=Math.max(0,Math.ceil(Te/Z)),je=Math.min(M,(W+Te)/Z);for(let ue=0;ue<Y;++ue){const le=ue-ce,me=Math.max(0,Math.ceil(le/oe)),he=Math.min(X,(G+le)/oe);let $e=0;for(let Le=De;Le<je;++Le){const Re=Le*Z-Te;for(let We=me;We<he;++We){const nt=We*oe-le,Ge=w*fe+C*Le+$*We,on=N*(W-1-Re)+_*(G-1-nt)+A*be;for(let pt=0;pt<pe;++pt){const gn=be*pe+pt,_t=v[Ge+gn],fs=T[on+pt];$e+=_t*fs}}}m[g*fe+x*Ne+b*ue+be]=$e}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const wte={kernelName:ow,backendName:"cpu",kernelFunc:vte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kte(t){const{inputs:e,backend:n}=t,{x:s}=e,r=re(s.shape),i=n.data.get(s.dataId).values,o=Ye([r,r],s.dtype),a=o.values;for(let c=0;c<i.length;c++)a[c*r+c]=i[c];const l=[...s.shape,...s.shape];return n.makeTensorInfo(l,o.dtype,o.values)}const Cte={kernelName:jR,backendName:"cpu",kernelFunc:kte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ste={kernelName:Lg,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r}=t,{strides:i,pad:o,dilations:a}=n,l=e,c=l.data.get(s.dataId).values,u=s.shape.length,d=l.data.get(r.dataId).values,h=r.shape.length,{batchSize:f,inHeight:p,inWidth:m,inChannels:g,outHeight:x,outWidth:b,padInfo:v,strideHeight:w,strideWidth:C,filterHeight:$,filterWidth:T,dilationHeight:N,dilationWidth:_,outShape:A}=Gh(s.shape,r.shape,i,o,"NHWC",a),O=re(A),W=A.length,G=Ht(s.dtype,O);for(let U=0;U<f;++U)for(let Y=0;Y<x;++Y){const te=Y*w-v.top;for(let M=0;M<b;++M){const X=M*C-v.left;for(let Z=0;Z<g;++Z){let oe=Number.MIN_SAFE_INTEGER;for(let ce=0;ce<$;++ce){const pe=te+ce*N;if(pe>=0&&pe<p)for(let fe=0;fe<T;++fe){const be=X+fe*_;if(be>=0&&be<m){const Ne=pi([U,pe,be,Z],u,Fe(s.shape)),Te=pi([ce,fe,Z],h,Fe(r.shape)),De=c[Ne]+d[Te];De>oe&&(oe=De)}}}const ae=pi([U,Y,M,Z],W,Fe(A));G[ae]=oe}}}return{dataId:l.write(fl(G,s.dtype),A,s.dtype),shape:A,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ite={kernelName:Ub,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:i}=t,{strides:o,pad:a,dilations:l}=n,c=e,u=Fr(s.shape,c.data.get(s.dataId).values),d=Fr(r.shape,c.data.get(r.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:m,outHeight:g,outWidth:x,padInfo:b,strideHeight:v,strideWidth:w,filterHeight:C,filterWidth:$,dilationHeight:T,dilationWidth:N,outShape:_}=Gh(s.shape,r.shape,o,a,"NHWC",l);R(i.rank===_.length,()=>`Error in ${Ub}, dy must have the same rank as output ${_.length}, but got ${i.rank}`);const A=Fr(_,c.data.get(i.dataId).values),O=MR(r.shape,r.dtype);for(let G=0;G<h;++G)for(let q=0;q<g;++q){const U=q*v-b.top;for(let Y=0;Y<x;++Y){const te=Y*w-b.left;for(let M=0;M<m;++M){let X=Number.MIN_SAFE_INTEGER,Z=0,oe=0;for(let ae=0;ae<C;++ae){const ce=U+ae*T;if(ce>=0&&ce<f)for(let pe=0;pe<$;++pe){const fe=te+pe*N;if(fe>=0&&fe<p){const be=u[G][ce][fe][M]+d[ae][pe][M];be>X&&(X=be,Z=ae,oe=pe)}}}O[Z][oe][M]+=A[G][q][Y][M]}}}return{dataId:c.write(fl(O,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $te={kernelName:Vb,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:i}=t,{strides:o,pad:a,dilations:l}=n,c=e,u=Fr(s.shape,c.data.get(s.dataId).values),d=Fr(r.shape,c.data.get(r.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:m,outHeight:g,outWidth:x,padInfo:b,strideHeight:v,strideWidth:w,filterHeight:C,filterWidth:$,dilationHeight:T,dilationWidth:N,outShape:_}=Gh(s.shape,r.shape,o,a,"NHWC",l);R(i.rank===_.length,()=>`Error in ${Vb}, dy must have the same rank as output ${_.length}, but got ${i.rank}`);const A=Fr(_,c.data.get(i.dataId).values),O=MR(s.shape,s.dtype);for(let G=0;G<h;++G)for(let q=0;q<g;++q){const U=q*v-b.top;for(let Y=0;Y<x;++Y){const te=Y*w-b.left;for(let M=0;M<m;++M){let X=Number.MIN_SAFE_INTEGER,Z=U<0?0:U,oe=te<0?0:te;for(let ae=0;ae<C;++ae){const ce=U+ae*T;if(ce>=0&&ce<f)for(let pe=0;pe<$;++pe){const fe=te+pe*N;if(fe>=0&&fe<p){const be=u[G][ce][fe][M]+d[ae][pe][M];be>X&&(X=be,Z=ce,oe=fe)}}}O[G][Z][oe][M]+=A[G][q][Y][M]}}}return{dataId:c.write(fl(O,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nte(t){const{inputs:e,backend:n,attrs:s}=t,{image:r}=e,{canvas:i,options:o}=s,{contextOptions:a,imageOptions:l}=o||{},c=(l==null?void 0:l.alpha)||1,u=(a==null?void 0:a.contextType)||"2d";if(u!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const d=i.getContext(u,(a==null?void 0:a.contextAttributes)||{});if(d==null)throw new Error(`Could not get the context with ${u} type.`);const[h,f]=r.shape.slice(0,2),p=r.shape.length===2?1:r.shape[2],m=n.data.get(r.dataId).values,g=r.dtype==="float32"?255:1,x=new Uint8ClampedArray(f*h*4);for(let v=0;v<h*f;++v){const w=[0,0,0,255*c];for(let $=0;$<p;$++){const T=m[v*p+$];if(r.dtype==="float32"){if(T<0||T>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${T}.`)}else if(r.dtype==="int32"&&(T<0||T>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${T}.`);p===1?(w[0]=T*g,w[1]=T*g,w[2]=T*g):w[$]=T*g}const C=v*4;x[C+0]=Math.round(w[0]),x[C+1]=Math.round(w[1]),x[C+2]=Math.round(w[2]),x[C+3]=Math.round(w[3])}i.width=f,i.height=h;const b=new ImageData(x,f,h);return d.putImageData(b,0,0),r}const Tte={kernelName:cH,backendName:"cpu",kernelFunc:Nte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lf(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;_e(r,"sum");let a;r.dtype==="bool"?a=Go({inputs:{x:r},backend:n,attrs:{dtype:"int32"}}):a=Ci({inputs:{x:r},backend:n});const l=a.shape.length,c=Qe(i,a.shape),u=Wt(c,l);let d=c,h=a;u!=null&&(h=cs({inputs:{x:a},backend:n,attrs:{perm:u}}),d=qt(d.length,l)),En("sum",d,h.shape.length);const[f,p]=kn(h.shape,d),m=_s(h.dtype,"int32");let g=Mm(n,f,m);const x=re(p),b=n.data.get(g.dataId).values,v=n.data.get(h.dataId).values;for(let w=0;w<b.length;++w){const C=w*x;let $=0;for(let T=0;T<x;++T)$+=v[C+T];b[w]=$}if(o){const w=rn(g.shape,c),C=g;g=Ct({inputs:{x:g},backend:n,attrs:{shape:w}}),n.disposeIntermediateTensorInfo(C)}return n.disposeIntermediateTensorInfo(a),u!=null&&n.disposeIntermediateTensorInfo(h),g}const Ete={kernelName:gx,backendName:"cpu",kernelFunc:lf};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _te(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,i=e,{allDims:o,summedDims:a,idDims:l}=Fk(r,i.length);Pk(o.length,l,i);const{path:c,steps:u}=Lk(a,l),d=u.length;let h=null,f=o.length;const p=[];for(let m=0;m<d;++m){for(const g of u[m]){const{permutationIndices:x,expandDims:b}=Ok(f,l[g]);let v;Mk(x)?v=i[g]:(v=cs({inputs:{x:i[g]},backend:n,attrs:{perm:x}}),p.push(v));const w=v.shape.slice();for(let C=0;C<b.length;++C)w.splice(b[C],0,1);ft(v.shape,w)||(v=Ct({inputs:{x:v},backend:n,attrs:{shape:w}}),p.push(v)),h===null?h=v:(h=Kx({inputs:{a:v,b:h},backend:n}),p.push(h))}m<d-1&&(c[m]>=0&&(h=lf({inputs:{x:h},backend:n,attrs:{axis:c[m]-(o.length-f),keepDims:!1}}),p.push(h)),f--)}for(const m of p)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const Rte={kernelName:aw,backendName:"cpu",kernelFunc:_te};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ate(t){const{inputs:e,backend:n}=t,{dy:s,y:r}=e;_e([s,r],"eluGrad");const i=new Float32Array(re(r.shape)),o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values;for(let l=0;l<o.length;++l){const c=o[l];c>=0?i[l]=a[l]:i[l]=a[l]*(c+1)}return n.makeTensorInfo(r.shape,"float32",i)}const Dte={kernelName:lw,backendName:"cpu",kernelFunc:Ate};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fte=Nk,Ote=Tk,Pte=Ek,Lte=_k,Mte=Rk,zte=Ak,Bte=gt(uh,t=>{const e=Math.sign(t),n=Math.abs(t),s=1/(1+Fte*n);return e*(1-((((zte*s+Mte)*s+Lte)*s+Pte)*s+Ote)*s*Math.exp(-n*n))}),Wte={kernelName:uh,backendName:"cpu",kernelFunc:Bte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wm(t){const{inputs:e,backend:n,attrs:s}=t,{input:r}=e,{dim:i}=s,o=r.shape.length,a=r.shape.slice();let l=i;return i<0&&(R(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+i+1),a.splice(l,0,1),Ct({inputs:{x:r},backend:n,attrs:{shape:a}})}const jte={kernelName:zg,backendName:"cpu",kernelFunc:Wm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vte=Qt((t,e)=>t/e),gC=mn(lh,Vte),x1={kernelName:lh,backendName:"cpu",kernelFunc:gC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CL(t,e,n){const s=t.shape,r=s[0],i=s[1],o=n.data.get(t.dataId),a=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,c=[r,i],u=re(c),d=Pn("float32",u),h=Pn("float32",u);for(let g=0;g<r;g++){const x=il({inputs:{x:a},backend:n,attrs:{begin:[g,0],size:[1,i]}}),b=il({inputs:{x:l},backend:n,attrs:{begin:[g,0],size:[1,i]}}),v=vs({inputs:{real:x,imag:b},backend:n}),{real:w,imag:C}=Ute(v,e,n),$=Hi(w,C);for(let T=0;T<i;T++){const N=Dk($,T);d[g*i+T]=N.real,h[g*i+T]=N.imag}n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(v)}const f=n.makeTensorInfo(c,"float32",d),p=n.makeTensorInfo(c,"float32",h),m=vs({inputs:{real:f,imag:p},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),m}function Ute(t,e,n){const s=re(t.shape),r=n.data.get(t.dataId),i=n.data.get(r.complexTensorInfos.real.dataId).values,o=n.data.get(r.complexTensorInfos.imag.dataId).values;if(Gte(s)){const a=y1(i,o,s,e,n),l=[t.shape[0],t.shape[1]];if(e){const c=n.makeTensorInfo(l,"float32",a.real),u=n.makeTensorInfo(l,"float32",a.imag),d=n.makeTensorInfo([],"float32",Jo(s,"float32")),h=Ci({inputs:{x:d},backend:n}),f=x1.kernelFunc({inputs:{a:c,b:d},backend:n}),p=x1.kernelFunc({inputs:{a:u,b:h},backend:n}),m=n.data.get(f.dataId).values,g=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),{real:m,imag:g}}return a}else{const a=Hi(i,o),l=Hte(a,s,e);return PD(l)}}function Gte(t){return(t&t-1)===0}function y1(t,e,n,s,r){if(n===1)return{real:t,imag:e};const i=Hi(t,e),o=n/2,a=LD(i),l=a.real,c=a.imag,u=[l.length],d=r.makeTensorInfo(u,"float32",l),h=r.makeTensorInfo(u,"float32",c),f=vs({inputs:{real:d,imag:h},backend:r}),p=MD(i),m=p.real,g=p.imag,x=[m.length],b=r.makeTensorInfo(x,"float32",m),v=r.makeTensorInfo(x,"float32",g),w=vs({inputs:{real:b,imag:v},backend:r}),C=y1(l,c,o,s,r),$=C.real,T=C.imag,N=[$.length],_=r.makeTensorInfo(N,"float32",$),A=r.makeTensorInfo(N,"float32",T),O=vs({inputs:{real:_,imag:A},backend:r}),W=y1(m,g,o,s,r),G=W.real,q=W.imag,U=[G.length],Y=r.makeTensorInfo(U,"float32",G),te=r.makeTensorInfo(U,"float32",q),M=vs({inputs:{real:Y,imag:te},backend:r}),X=BD(n,s),Z=[X.real.length],oe=r.makeTensorInfo(Z,"float32",X.real),ae=r.makeTensorInfo(Z,"float32",X.imag),ce=vs({inputs:{real:oe,imag:ae},backend:r}),pe=Kx({inputs:{a:ce,b:M},backend:r}),fe=Sc({inputs:{a:O,b:pe},backend:r}),be=pC({inputs:{a:O,b:pe},backend:r}),Ne=rl({inputs:{input:fe},backend:r}),Te=rl({inputs:{input:be},backend:r}),De=Ic({inputs:{input:fe},backend:r}),je=Ic({inputs:{input:be},backend:r}),ue=$c({inputs:[Ne,Te],backend:r,attrs:{axis:0}}),le=$c({inputs:[De,je],backend:r,attrs:{axis:0}}),me=r.data.get(ue.dataId).values,he=r.data.get(le.dataId).values;return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(w),r.disposeIntermediateTensorInfo(_),r.disposeIntermediateTensorInfo(A),r.disposeIntermediateTensorInfo(O),r.disposeIntermediateTensorInfo(Y),r.disposeIntermediateTensorInfo(te),r.disposeIntermediateTensorInfo(M),r.disposeIntermediateTensorInfo(oe),r.disposeIntermediateTensorInfo(ae),r.disposeIntermediateTensorInfo(ce),r.disposeIntermediateTensorInfo(pe),r.disposeIntermediateTensorInfo(fe),r.disposeIntermediateTensorInfo(be),r.disposeIntermediateTensorInfo(Ne),r.disposeIntermediateTensorInfo(De),r.disposeIntermediateTensorInfo(Te),r.disposeIntermediateTensorInfo(je),r.disposeIntermediateTensorInfo(ue),r.disposeIntermediateTensorInfo(le),{real:me,imag:he}}function Hte(t,e,n){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let i=0,o=0;for(let a=0;a<e;a++){const l=WD(r*a,e,n),c=Dk(t,a);i+=c.real*l.real-c.imag*l.imag,o+=c.real*l.imag+c.imag*l.real}n&&(i/=e,o/=e),zD(s,i,o,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kte(t){const{inputs:e,backend:n}=t,{input:s}=e,r=re(s.shape),i=s.shape[s.shape.length-1],o=r/i,a=Ct({inputs:{x:s},backend:n,attrs:{shape:[o,i]}}),l=CL(a,!1,n),c=Ct({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const Xte={kernelName:cw,backendName:"cpu",kernelFunc:Kte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xC(t){const{backend:e,attrs:n}=t,{shape:s,value:r,dtype:i}=n,o=i||Lc(r),a=Ht(o,re(s));return Yte(a,r,o),e.makeTensorInfo(s,o,a)}const qte={kernelName:uw,backendName:"cpu",kernelFunc:xC};function Yte(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qte={kernelName:dw,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,r=n,i=Pn(s.dtype,re(s.shape)),[o,a,l,c]=s.shape,u=r.data.get(s.dataId).values;for(let h=0;h<o;h++){const f=h*l*a*c;for(let p=0;p<a;p++){const m=p*(l*c);for(let g=0;g<l;g++){const x=g*c;for(let b=0;b<c;b++){const v=Math.round(l-g-1),w=f+m+x+b;let C=u[w];if(v>=0&&v<l){const $=v*c,T=f+m+$+b;C=u[T]}i[w]=C}}}}return{dataId:r.write(i,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jte(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s;let m=wL({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(o){const g=m;if(u==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const x=Ct({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=Sc({inputs:{a:m,b:x},backend:n}),n.disposeIntermediateTensorInfo(x)}else m=Sc({inputs:{a:m,b:o},backend:n});n.disposeIntermediateTensorInfo(g)}if(f){const g=m;if(u==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const x=Ct({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});m=Bm(n,m,f,x,p),n.disposeIntermediateTensorInfo(x)}else m=Bm(n,m,f,a,p);n.disposeIntermediateTensorInfo(g)}return m}const Zte={kernelName:vm,backendName:"cpu",kernelFunc:Jte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ene(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s;let m=kL({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(o){const g=m;m=Sc({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(g)}if(f){const g=m;m=Bm(n,m,f,a,p),n.disposeIntermediateTensorInfo(g)}return m}const tne={kernelName:aA,backendName:"cpu",kernelFunc:ene};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nne(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,i=re(s.shape),o=r.shape,a=o[o.length-1],[l,c,u,d]=gk(s,r);if(c===0)return n.makeTensorInfo(l,s.dtype,[]);const h=n.data.get(r.dataId).values,f=n.bufferSync(s),p=DP(h,f,s.dtype,c,a,u,d,s.shape,i);return n.makeTensorInfo(l,s.dtype,p.values)}const sne={kernelName:VR,backendName:"cpu",kernelFunc:nne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rne(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:i}=e,{axis:o,batchDims:a}=s;_e([r,i],"gatherV2");const l=Qe(o,r.shape)[0],c=n.data.get(i.dataId).values,u=r.shape[l];for(let w=0;w<c.length;++w){const C=c[w];R(C<=u-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${u-1}]`)}let d=a;a==null&&(d=0);const h=re(i.shape),f=Bk(r,i,l,d),p=Ct({inputs:{x:r},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),m=Ct({inputs:{x:i},backend:n,attrs:{shape:[f.batchSize,h/f.batchSize]}}),g=[f.batchSize,f.outerSize,h/f.batchSize,f.sliceSize],x=n.bufferSync(m),b=n.bufferSync(p),v=FP(b,x,g);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(f.outputShape,v.dtype,v.values)}const ine={kernelName:Wg,backendName:"cpu",kernelFunc:rne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function one(t){const{inputs:e,backend:n}=t,{input:s}=e,r=re(s.shape),i=s.shape[s.shape.length-1],o=r/i,a=Ct({inputs:{x:s},backend:n,attrs:{shape:[o,i]}}),l=CL(a,!0,n),c=Ct({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const ane={kernelName:hw,backendName:"cpu",kernelFunc:one};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lne=gt(xh,t=>Number.isFinite(t)?1:0,"bool"),cne={kernelName:xh,backendName:"cpu",kernelFunc:lne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const une=gt(yh,t=>Math.abs(t)===1/0?1:0,"bool"),dne={kernelName:yh,backendName:"cpu",kernelFunc:une};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hne=gt(bh,t=>Number.isNaN(t)?1:0,"bool"),fne={kernelName:bh,backendName:"cpu",kernelFunc:hne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pne(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:i}=n,o=zP(s,r,i);return e.makeTensorInfo([o.length],"float32",o)}const mne={kernelName:UR,backendName:"cpu",kernelFunc:pne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gne=gt(wh,t=>Math.log1p(t)),xne={kernelName:wh,backendName:"cpu",kernelFunc:gne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yne=Qt((t,e)=>t&&e),bne=mn(Hg,yne,null,"bool"),vne={kernelName:Hg,backendName:"cpu",kernelFunc:bne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wne=gt(Kg,t=>t?0:1,"bool"),kne={kernelName:Kg,backendName:"cpu",kernelFunc:wne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cne=Qt((t,e)=>t||e),Sne=mn(Xg,Cne,null,"bool"),Ine={kernelName:Xg,backendName:"cpu",kernelFunc:Sne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ne(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=s;_e(r,"LRN");const c=r.shape[3],u=c-1,d=n.data.get(r.dataId).values,h=re(r.shape),f=new Float32Array(h);function p(m){const g=m%c;let x=m-g+Math.max(0,g-i);const b=m-g+Math.min(g+i,u);let v=0;for(;x<=b;x++){const w=d[x];v+=w*w}return v}for(let m=0;m<h;m++){const g=p(m),x=d[m]*Math.pow(o+a*g,-l);f[m]=x}return n.makeTensorInfo(r.shape,r.dtype,f)}const Nne={kernelName:qg,backendName:"cpu",kernelFunc:$ne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tne(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s;_e(o,"LRNGrad");const d=re(o.shape),h=o.shape[3],f=n.data.get(o.dataId).values,p=n.data.get(r.dataId).values,m=n.data.get(i.dataId).values,g=new Float32Array(d),x=d;for(let b=0;b<x;b++){const v=b%h,w=b-v+Math.max(0,v-a),C=b-v+Math.min(h,v+a+1);let $=0;for(let T=w;T<C;T++)$+=Math.pow(p[T],2);$=c*$+l;for(let T=w;T<C;T++){let N=-2*c*u*p[T]*m[b]/$;b===T&&(N+=Math.pow($,-u)),N*=f[b],g[T]+=N}}return n.makeTensorInfo(o.shape,r.dtype,g)}const Ene={kernelName:pw,backendName:"cpu",kernelFunc:Tne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SL(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:i,keepDims:o}=s,a=n;let l=r.shape;const c=l.length,u=Qe(i,l);let d=u;const h=Wt(d,c);let f=a.data.get(r.dataId).values;if(h!=null){const w=new Array(c);for(let C=0;C<w.length;C++)w[C]=l[h[C]];f=hC(f,l,r.dtype,h,w),d=qt(d.length,c),l=w}_e(r,"max"),En("max",d,c);const[p,m]=kn(l,d),g=re(m),x=WP(f,g,p,r.dtype),b=a.write(x,p,r.dtype);let v=p;return o&&(v=rn(p,u)),{dataId:b,shape:v,dtype:r.dtype}}const _ne={kernelName:Yg,backendName:"cpu",kernelFunc:SL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rne(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;_e(r,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;R(zn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=gr(r.shape,i,o,c,a,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&ft(u.inShape,u.outShape))d=Ci({inputs:{x:r},backend:n});else{const h=n.data.get(r.dataId).values,f=Fe(r.shape),p=mC(h,r.shape,r.dtype,f,u,"max");d=n.makeTensorInfo(u.outShape,r.dtype,p.values)}return d}const Ane={kernelName:Qg,backendName:"cpu",kernelFunc:Rne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dne(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s;_e(r,"maxPool3d");const u=Yi(r.shape,i,o,1,a,l,c),d=n.data.get(r.dataId).values,h=vL(d,r.shape,r.dtype,Fe(r.shape),u,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}const Fne={kernelName:Jg,backendName:"cpu",kernelFunc:Dne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function One(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=s;_e([r,i],"maxPool3DGrad");const u=Yi(i.shape,o,a,1,l,c),d=n.bufferSync(i),h=Cee(d,u),f=u.strideDepth,p=u.strideHeight,m=u.strideWidth,g=u.dilationDepth,x=u.dilationHeight,b=u.dilationWidth,v=u.effectiveFilterDepth,w=u.effectiveFilterHeight,C=u.effectiveFilterWidth,$=v-1-u.padInfo.front,T=C-1-u.padInfo.left,N=w-1-u.padInfo.top,_=Ye(i.shape,"float32"),A=n.bufferSync(r);for(let O=0;O<u.batchSize;++O)for(let W=0;W<u.inChannels;++W)for(let G=0;G<u.inDepth;++G)for(let q=0;q<u.inHeight;++q)for(let U=0;U<u.inWidth;++U){const Y=G-$,te=q-N,M=U-T;let X=0;for(let Z=0;Z<v;Z+=g){const oe=(Y+Z)/f;if(!(oe<0||oe>=u.outDepth||Math.floor(oe)!==oe))for(let ae=0;ae<w;ae+=x){const ce=(te+ae)/p;if(!(ce<0||ce>=u.outHeight||Math.floor(ce)!==ce))for(let pe=0;pe<C;pe+=b){const fe=(M+pe)/m;if(fe<0||fe>=u.outWidth||Math.floor(fe)!==fe)continue;const be=v*w*C-1-h.get(O,oe,ce,fe,W),Ne=Z*w*C+ae*C+pe,Te=be===Ne?1:0;if(Te===0)continue;const De=A.get(O,oe,ce,fe,W);X+=De*Te}}}_.set(X,O,G,q,U,W)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}const Pne={kernelName:gw,backendName:"cpu",kernelFunc:One};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lne(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i,output:o}=e,a=i;_e([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=s,h=gr(a.shape,l,c,1,u,d),f=n.data.get(a.dataId).values,p=Ye(h.outShape,a.dtype,bL(f,a.shape,a.dtype,h).values),m=h.strideHeight,g=h.strideWidth,x=h.dilationHeight,b=h.dilationWidth,v=h.effectiveFilterHeight,w=h.effectiveFilterWidth,C=w-1-h.padInfo.left,$=v-1-h.padInfo.top,T=Ye(a.shape,"float32"),N=n.data.get(r.dataId).values,_=Ye(r.shape,"float32",N);for(let A=0;A<h.batchSize;++A)for(let O=0;O<h.inChannels;++O)for(let W=0;W<h.inHeight;++W)for(let G=0;G<h.inWidth;++G){const q=W-$,U=G-C;let Y=0;for(let te=0;te<v;te+=x){const M=(q+te)/m;if(!(M<0||M>=h.outHeight||Math.floor(M)!==M))for(let X=0;X<w;X+=b){const Z=(U+X)/g;if(Z<0||Z>=h.outWidth||Math.floor(Z)!==Z)continue;const oe=v*w-1-p.get(A,M,Z,O),ae=te*w+X,ce=oe===ae?1:0;if(ce===0)continue;const pe=_.get(A,M,Z,O);Y+=pe*ce}}T.set(Y,A,W,G,O)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}const Mne={kernelName:mw,backendName:"cpu",kernelFunc:Lne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zne(t,e,n,s,r){const i=Fe(e),o=mC(t,e,n,i,r,"max"),a=bL(t,e,n,r,!0,s);return[o.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bne={kernelName:GR,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;_e(s,"MaxPoolWithArgmax");const c=l.data.get(s.dataId).values,u=gr(s.shape,r,i,[1,1],o),[d,h]=zne(c,s.shape,s.dtype,a,u),f=l.write(d,u.outShape,s.dtype),p=l.write(h,u.outShape,s.dtype);return[{dataId:f,shape:u.outShape,dtype:s.dtype},{dataId:p,shape:u.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wne(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=Qe(i,r.shape),c=kn(r.shape,a)[1],u=re(c),d=[],h=n.makeTensorInfo([],"float32",new Float32Array([u]));d.push(h);const f=Go({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});d.push(f);const p=gC({inputs:{a:f,b:h},backend:n});d.push(p);const m=lf({inputs:{x:p},backend:n,attrs:{axis:i,keepDims:o}});return d.forEach(g=>n.disposeIntermediateTensorInfo(g)),m}const jne={kernelName:Zg,backendName:"cpu",kernelFunc:Wne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vne(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;_e(r,"min");const a=Qe(i,r.shape);let l=a;const c=Wt(l,r.shape.length);let u=r;c!=null&&(u=cs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=qt(l.length,r.shape.length)),En("min",l,u.shape.length);const[d,h]=kn(u.shape,l),f=re(h),p=Ln(re(d),u.dtype),m=n.data.get(u.dataId).values;for(let x=0;x<p.length;++x){const b=x*f;let v=m[b];for(let w=0;w<f;++w){const C=m[b+w];(Number.isNaN(C)||C<v)&&(v=C)}p[x]=v}c!=null&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,p);if(o){const x=rn(d,a),b=Ct({inputs:{x:g},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(g),b}return g}const Une={kernelName:ex,backendName:"cpu",kernelFunc:Vne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gne(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,mode:o}=s;_e(r,"mirrorPad");const a=i.map((v,w)=>v[0]+r.shape[w]+v[1]),l=i.map(v=>v[0]),c=i.map((v,w)=>v[0]+r.shape[w]),u=o==="reflect"?0:1,d=n.data.get(r.dataId).values,h=r.shape.length,f=Fe(r.shape),p=re(a),m=a.length,g=Fe(a),x=Pn(r.dtype,p);for(let v=0;v<p;v++){let w=Mc(v,m,g);for(let $=0;$<m;$++)w[$]<l[$]?w[$]=l[$]*2-w[$]-u:w[$]>=c[$]&&(w[$]=(c[$]-1)*2-w[$]+u);w=w.map(($,T)=>$-l[T]);const C=pi(w,h,f);x[v]=d[C]}return{dataId:n.write(x,a,r.dtype),shape:a,dtype:r.dtype}}const Hne={kernelName:tx,backendName:"cpu",kernelFunc:Gne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kne=Qt((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),Xne=mn(Sh,Kne),qne={kernelName:Sh,backendName:"cpu",kernelFunc:Xne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IL(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:i}=s,o=r.shape.length;let a=i;if(a===-1&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const l=Qe([a],r.shape),c=SL({inputs:{x:r},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=rn(c.shape,l),d=Ct({inputs:{x:c},backend:n,attrs:{shape:u}}),h=pC({inputs:{a:r,b:d},backend:n}),f=EP({inputs:{x:h},backend:n}),p=lf({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),m=Ct({inputs:{x:p},backend:n,attrs:{shape:u}}),g=gC({inputs:{a:f,b:m},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}const Yne={kernelName:bx,backendName:"cpu",kernelFunc:IL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qne(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:i,seed:o,normalized:a}=s;_e(r,"multinomial");const l=a?r:IL({inputs:{logits:r},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],d=n.data.get(l.dataId).values,h=[c,i],f=Ln(re(h),"int32");for(let p=0;p<c;++p){const m=p*u,g=new Float32Array(u-1);g[0]=d[m];for(let v=1;v<g.length;++v)g[v]=g[v-1]+d[m+v];const x=nk.alea(o.toString()),b=p*i;for(let v=0;v<i;++v){const w=x();f[b+v]=g.length;for(let C=0;C<g.length;C++)if(w<g[C]){f[b+v]=C;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(h,"int32",f)}const Jne={kernelName:HR,backendName:"cpu",kernelFunc:Qne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zne=dk;function ese(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=s;_e(r,"NonMaxSuppression");const c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,{selectedIndices:d}=Zne(c,u,o,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const tse={kernelName:xw,backendName:"cpu",kernelFunc:ese};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nse=hk;function sse(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s;_e(r,"NonMaxSuppressionPadded");const u=n.data.get(r.dataId).values,d=n.data.get(i.dataId).values,{selectedIndices:h,validOutputs:f}=nse(u,d,o,a,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const rse={kernelName:yw,backendName:"cpu",kernelFunc:sse};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ise=fk;function ose(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s;_e(r,"NonMaxSuppressionWithScore");const u=n.data.get(r.dataId).values,d=n.data.get(i.dataId).values,h=o,f=a,p=l,m=c,{selectedIndices:g,selectedScores:x}=ise(u,d,h,f,p,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}const ase={kernelName:bw,backendName:"cpu",kernelFunc:ose};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lse(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:i,depth:o,onValue:a,offValue:l}=s;_e(r,"oneHot");const c=re(r.shape),u=new Float32Array(c*o);u.fill(l);const d=n.data.get(r.dataId).values;for(let h=0;h<c;++h)d[h]>=0&&d[h]<o&&(u[h*o+d[h]]=a);return n.makeTensorInfo([...r.shape,o],i,u)}const cse={kernelName:ix,backendName:"cpu",kernelFunc:lse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jm(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=rl({inputs:{input:s},backend:n}),i=jm({inputs:{x:r},backend:n}),o=Ic({inputs:{input:s},backend:n}),a=jm({inputs:{x:o},backend:n}),l=vs({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return xC({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const use={kernelName:kx,backendName:"cpu",kernelFunc:jm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $L(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=rl({inputs:{input:s},backend:n}),i=$L({inputs:{x:r},backend:n}),o=Ic({inputs:{input:s},backend:n}),a=jm({inputs:{x:o},backend:n}),l=vs({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return xC({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const dse={kernelName:rx,backendName:"cpu",kernelFunc:$L};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NL(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return Wm({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const i=e[0].shape,o=e[0].dtype;e.forEach(u=>{Bv(i,u.shape,"All tensors passed to stack must have matching shapes"),R(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const d=Wm({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(d),d}),c=$c({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const hse={kernelName:ox,backendName:"cpu",kernelFunc:NL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fse(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,constantValue:o}=s;_e(r,"pad");const a=i.map((b,v)=>b[0]+r.shape[v]+b[1]),l=i.map(b=>b[0]),c=n.data.get(r.dataId).values,u=re(r.shape),d=r.shape.length,h=Fe(r.shape),f=re(a),p=a.length,m=Fe(a),g=Pn(r.dtype,f);o!==0&&g.fill(o);for(let b=0;b<u;b++){const w=Mc(b,d,h).map(($,T)=>$+l[T]),C=pi(w,p,m);g[C]=c[b]}return{dataId:n.write(g,a,r.dtype),shape:a,dtype:r.dtype}}const TL={kernelName:ax,backendName:"cpu",kernelFunc:fse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pse=Qt((t,e)=>Math.pow(t,e)),mse=mn($h,pse),gse={kernelName:$h,backendName:"cpu",kernelFunc:mse};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xse(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=s,l=r.map(x=>n.data.get(x.dataId).values),c=r.map(x=>x.shape),u=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,[h,f,p]=KP(l,c,u,i.shape,i.dtype,d,o.shape),m=h.map(x=>n.makeTensorInfo([x.length],"int32",x)),g=n.makeTensorInfo(p,i.dtype,f);return m.concat([g])}const yse={kernelName:KR,backendName:"cpu",kernelFunc:xse};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bse(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:i}=e,o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=XP(o,s.shape,s.dtype,a,r.shape,l,i.shape),d=n.makeTensorInfo([c.length],"int32",c),h=n.makeTensorInfo([u.length],s.dtype,u);return[d,h]}const vse={kernelName:XR,backendName:"cpu",kernelFunc:bse};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wse(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,h=a.map(g=>n.data.get(g.dataId).values),f=a.map(g=>g.shape),[p,m]=qP(c,r.shape,u,i.shape,i.dtype,d,o.shape,h,f,l);return n.makeTensorInfo(p,i.dtype,m)}const kse={kernelName:qR,backendName:"cpu",kernelFunc:wse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cse(t){const{backend:e,attrs:n}=t,{start:s,stop:r,dtype:i,step:o}=n,a=YP(s,r,o,i);return e.makeTensorInfo([a.length],i,a)}const Sse={kernelName:vw,backendName:"cpu",kernelFunc:Cse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ise=gt(Nh,t=>1/t),$se={kernelName:Nh,backendName:"cpu",kernelFunc:Ise};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nse(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s;_e(r,"resizeBilinear");const l=Fe(r.shape),[c,u]=a,[d,h,f,p]=r.shape,m=n.data.get(r.dataId).values,g=new Float32Array(re([d,c,u,p])),x=[i&&c>1?h-1:h,i&&u>1?f-1:f],b=[i&&c>1?c-1:c,i&&u>1?u-1:u];let v=0;const w=x[0]/b[0],C=x[1]/b[1];for(let $=0;$<d;$++)for(let T=0;T<c;T++){let N;o?N=w*(T+.5)-.5:N=w*T;const _=Math.max(0,Math.floor(N)),A=N-_,O=Math.min(h-1,Math.ceil(N)),W=$*l[0]+_*l[1],G=$*l[0]+O*l[1];for(let q=0;q<u;q++){let U;o?U=C*(q+.5)-.5:U=C*q;const Y=Math.max(0,Math.floor(U)),te=U-Y,M=Math.min(f-1,Math.ceil(U)),X=W+Y*l[2],Z=G+Y*l[2],oe=W+M*l[2],ae=G+M*l[2];for(let ce=0;ce<p;ce++){const pe=m[X+ce],fe=m[Z+ce],be=m[oe+ce],Ne=m[ae+ce],Te=pe+(be-pe)*te,De=fe+(Ne-fe)*te,je=Te+(De-Te)*A;g[v++]=je}}}return n.makeTensorInfo([d,c,u,p],"float32",g)}const Tse={kernelName:hx,backendName:"cpu",kernelFunc:Nse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ese(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s;_e([i,r],"resizeBilinearGrad");const a=Fe(r.shape),[l,c,u,d]=r.shape,[,h,f]=i.shape,p=new Float32Array(l*c*u*d),m=[o&&h>1?c-1:c,o&&f>1?u-1:u],g=[o&&h>1?h-1:h,o&&f>1?f-1:f],x=m[0]/g[0],b=m[1]/g[1],v=n.data.get(i.dataId).values;let w=0;for(let C=0;C<l;C++){const $=C*a[0];for(let T=0;T<h;T++){const N=T*x,_=Math.floor(N),A=Math.min(Math.ceil(N),c-1),O=$+_*a[1],W=$+A*a[1],G=N-_,q=1-G;for(let U=0;U<f;U++){const Y=U*b,te=Math.floor(Y),M=Math.min(Math.ceil(Y),u-1),X=Y-te,Z=1-X,oe=O+te*a[2],ae=O+M*a[2],ce=W+te*a[2],pe=W+M*a[2],fe=q*Z,be=q*X,Ne=G*Z,Te=G*X;for(let De=0;De<d;De++){const je=v[w++];p[oe+De]+=je*fe,p[ae+De]+=je*be,p[ce+De]+=je*Ne,p[pe+De]+=je*Te}}}}return n.makeTensorInfo([l,u,c,d],"float32",p)}const _se={kernelName:Cw,backendName:"cpu",kernelFunc:Ese};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rse(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s;_e(r,"resizeNearestNeighbor");const l=Fe(r.shape),[c,u]=a,[d,h,f,p]=r.shape,m=n.data.get(r.dataId).values,g=new Float32Array(d*c*u*p),x=[i&&c>1?h-1:h,i&&u>1?f-1:f],b=[i&&c>1?c-1:c,i&&u>1?u-1:u],v=x[0]/b[0],w=x[1]/b[1];let C=0;for(let $=0;$<d;$++){const T=$*l[0];for(let N=0;N<c;N++){const _=o?v*(N+.5):v*N;let A=Math.min(h-1,i?Math.round(_):Math.floor(_));o&&(A=Math.max(0,A));const O=T+A*l[1];for(let W=0;W<u;W++){const G=o?w*(W+.5):w*W;let q=Math.min(f-1,i?Math.round(G):Math.floor(G));o&&(q=Math.max(0,q));const U=O+q*l[2];for(let Y=0;Y<p;Y++){const te=m[U+Y];g[C++]=te}}}}return n.makeTensorInfo([d,c,u,p],r.dtype,g)}const Ase={kernelName:dx,backendName:"cpu",kernelFunc:Rse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dse(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s;_e([i,r],"resizeNearestNeighborGrad");const a=Fe(r.shape),l=Fe(i.shape),[c,u,d,h]=r.shape,[,f,p]=i.shape,m=new Float32Array(c*u*d*h),g=n.data.get(i.dataId).values,x=[o&&f>1?u-1:u,o&&p>1?d-1:d],b=[o&&f>1?f-1:f,o&&p>1?p-1:p],v=x[0]/b[0],w=x[1]/b[1],C=1/v,$=1/w,T=Math.ceil(C)*2+2,N=Math.ceil($)*2+2;for(let _=0;_<c;_++){const A=_*a[0];for(let O=0;O<u;O++){const W=A+O*a[1],G=Math.floor(O*C),q=Math.floor(G-T/2);for(let U=0;U<d;U++){const Y=W+U*a[2],te=Math.floor(U*$),M=Math.floor(te-N/2);for(let X=0;X<h;X++){let Z=0;for(let oe=0;oe<T;oe++){const ae=oe+q;if(ae<0||ae>=f)continue;const ce=A+ae*l[1],pe=ae*v,fe=Math.min(u-1,o?Math.round(pe):Math.floor(pe));if(O===fe)for(let be=0;be<N;be++){const Ne=be+M;if(Ne<0||Ne>=p)continue;const Te=ce+Ne*l[2],De=Ne*w,je=Math.min(d-1,o?Math.round(De):Math.floor(De));U===je&&(Z+=g[Te+X])}}m[Y+X]=Z}}}}return n.makeTensorInfo(r.shape,r.dtype,m)}const Fse={kernelName:kw,backendName:"cpu",kernelFunc:Dse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ose(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:i}=s;_e(r,"reverse");const o=r.shape.length,a=Qe(i,r.shape);if(o===0)return Ci({inputs:{x:r},backend:n});const l=new Nn(r.shape,r.dtype),c=n.bufferSync(r);for(let u=0;u<l.size;u++){const d=l.indexToLoc(u),h=d.slice();a.forEach(f=>h[f]=r.shape[f]-1-h[f]),l.set(c.get(...h),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const Pse={kernelName:fx,backendName:"cpu",kernelFunc:Ose};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lse={kernelName:_w,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:i,center:o}=e,a=n,l=Pn(s.dtype,re(s.shape)),[c,u,d,h]=s.shape,[f,p]=Sk(o,u,d),m=255,g=Math.sin(r),x=Math.cos(r),b=a.data.get(s.dataId).values;for(let w=0;w<c;w++){const C=w*d*u*h;for(let $=0;$<u;$++){const T=$*(d*h);for(let N=0;N<d;N++){const _=N*h;for(let A=0;A<h;A++){const O=[c,$,N,A],W=O[2],G=O[1];let q=(W-f)*x-(G-p)*g,U=(W-f)*g+(G-p)*x;q=Math.round(q+f),U=Math.round(U+p);let Y=i;if(typeof i!="number"&&(A===3?Y=m:Y=i[A]),q>=0&&q<d&&U>=0&&U<u){const M=U*(d*h),X=q*h,Z=C+M+X+A;Y=b[Z]}const te=C+T+_+A;l[te]=Y}}}}return{dataId:a.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mse=gt(_h,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),zse={kernelName:_h,backendName:"cpu",kernelFunc:Mse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bse(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:i}=e,{shape:o}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=xl(i,r,o),h=!0,f=n.bufferSync(r),p=n.bufferSync(i),m=Ra(f,p,o,d,c,l,a,u,0,h);return n.makeTensorInfo(o,m.dtype,m.values)}const Wse={kernelName:YR,backendName:"cpu",kernelFunc:Bse};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jse(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<e?n=r+1:s=r;return s}function Vse(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<=e?n=r+1:s=r;return s}function Use(t,e,n,s,r,i){const o=Ht("int32",n*r);for(let a=0;a<n;++a){const l=t.slice(a*s,(a+1)*s),c=a*r;for(let u=0;u<r;++u)o[c+u]=i==="left"?jse(l,e[u+c]):Vse(l,e[u+c])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gse(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:i}=e,{side:o}=s,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=Use(a,l,r.shape[0],r.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",c)}const Hse={kernelName:JR,backendName:"cpu",kernelFunc:Gse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kse(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:i}=e;_e([s,r,i],"select");const o=s.shape.length,a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=_s(r.dtype,i.dtype),d=Ln(re(r.shape),u);let h=0;const f=o===0||o>1||r.shape.length===1?1:re(r.shape.slice(1));for(let p=0;p<a.length;p++)for(let m=0;m<f;m++)a[p]===1?d[h++]=l[p]:d[h++]=c[p];return n.makeTensorInfo(r.shape,u,d)}const Xse={kernelName:px,backendName:"cpu",kernelFunc:Kse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qse=Fx,Yse=Ox,Qse=gt(Ah,t=>t>=0?Yse*t:qse*(Math.exp(t)-1)),Jse={kernelName:Ah,backendName:"cpu",kernelFunc:Qse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zse=gt(Oh,t=>t<0?-1:t>0?1:0),ere={kernelName:Oh,backendName:"cpu",kernelFunc:Zse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tre=gt(Dh,t=>Math.sin(t)),nre={kernelName:Dh,backendName:"cpu",kernelFunc:tre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sre=gt(Fh,t=>Math.sinh(t)),rre={kernelName:Fh,backendName:"cpu",kernelFunc:sre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ire=11920928955078125e-23,fN=Math.log(ire)+2,ore=gt(Lh,t=>{const e=t>-fN,n=t<fN,s=Math.exp(t);let r;return n?r=s:e?r=t:r=Math.log(1+s),r}),are={kernelName:Lh,backendName:"cpu",kernelFunc:ore};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lre(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,paddings:o}=s;_e([r],"spaceToBatchND");const a=re(i),l=[[0,0]];l.push(...o);for(let $=1+i.length;$<r.shape.length;++$)l.push([0,0]);const c=TL.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),u=Yh(c.shape,i,a,!1),d=Qh(u.length,i.length,!1),h=Jh(c.shape,i,a,!1),m=Ct({inputs:{x:c},backend:n,attrs:{shape:u}}),b=cs({inputs:{x:m},backend:n,attrs:{perm:d}}),C=Ct({inputs:{x:b},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(b),C}const cre={kernelName:xx,backendName:"cpu",kernelFunc:lre};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ure(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values[0],[d,h,f,p,m]=eL(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(h,s.dtype,d),n.makeTensorInfo([h[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),n.makeTensorInfo([m.length],s.dtype,new Int32Array(m))]}const dre={kernelName:ZR,backendName:"cpu",kernelFunc:ure};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hre(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:i}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.data.get(r.dataId).values),a=n.data.get(s.dataId).values,l=Array.from(n.data.get(i.dataId).values),[c,u,d]=tL(a,s.shape,s.dtype,o,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const fre={kernelName:eA,backendName:"cpu",kernelFunc:hre};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pre(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=fC(o,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const mre={kernelName:tA,backendName:"cpu",kernelFunc:pre};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gre(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=fC(o,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const xre={kernelName:nA,backendName:"cpu",kernelFunc:gre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yre(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:i,defaultValue:o}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=xl(i,r,a),f=!1,p=n.bufferSync(r);let m;switch(i.dtype){case"bool":{const g=n.bufferSync(i),x=!!n.data.get(o.dataId).values[0];m=Ra(p,g,a,h,u,c,l,d,x,f);break}case"float32":{const g=n.bufferSync(i),x=n.data.get(o.dataId).values[0];m=Ra(p,g,a,h,u,c,l,d,x,f);break}case"int32":{const g=n.bufferSync(i),x=n.data.get(o.dataId).values[0];m=Ra(p,g,a,h,u,c,l,d,x,f);break}case"string":{const g=n.bufferSync(i),x=Bo(n.data.get(o.dataId).values[0]);m=Ra(p,g,a,h,u,c,l,d,x,f);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return n.makeTensorInfo(a,m.dtype,m.values)}const bre={kernelName:sA,backendName:"cpu",kernelFunc:yre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vre(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:i,axis:o}=s,a=Qe(o,r.shape)[0],l=zk(r,i,a),c=new Array(r.shape.length).fill(0),u=r.shape.slice();return l.map(d=>{const h=[...u];h[a]=d;const f=il({inputs:{x:r},backend:n,attrs:{begin:c,size:h}});return c[a]+=d,f})}const wre={kernelName:yx,backendName:"cpu",kernelFunc:vre};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kre={kernelName:Sw,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,s=e;_e(n,"square");const r=s.data.get(n.dataId).values,i=new Float32Array(r.length);for(let a=0;a<r.length;++a){const l=r[a];i[a]=l*l}return{dataId:s.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cre=gt(Uh,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),Sre={kernelName:Uh,backendName:"cpu",kernelFunc:Cre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ire(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=s;_e(r,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:x,begin:b,end:v,strides:w}=wk(r.shape,i,o,a,l,c,u,d,h);let C;if(m)C=Ct({inputs:{x:r},backend:n,attrs:{shape:p}});else if(g||x){R(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const $=yk(b,v,w),T=il({inputs:{x:r},backend:n,attrs:{begin:b,size:$}});C=Ct({inputs:{x:T},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(T)}else{const $=n.bufferSync(r),T=rL(f,$,w,b);C=n.makeTensorInfo(p,T.dtype,T.values)}return C}const $re={kernelName:$w,backendName:"cpu",kernelFunc:Ire};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nre(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:d}=e,h=n.data.get(u.dataId).values,f=n.data.get(d.dataId).values,[p,m]=iL(h,f,r,i,o,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",m)]}const Tre={kernelName:rA,backendName:"cpu",kernelFunc:Nre};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ere(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],[c,u,d]=oL(a,l,r),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const _re={kernelName:iA,backendName:"cpu",kernelFunc:Ere};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rre(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(i.dataId).values,a=aL(o,r);return n.makeTensorInfo(i.shape,"int32",a)}const Are={kernelName:oA,backendName:"cpu",kernelFunc:Rre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dre=gt(Wh,t=>Math.tan(t)),Fre={kernelName:Wh,backendName:"cpu",kernelFunc:Dre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ore=gt(jh,t=>Math.tanh(t)),Pre={kernelName:jh,backendName:"cpu",kernelFunc:Ore};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lre(t){const{inputs:e,backend:n}=t,{tensor:s,indices:r,updates:i}=e,{sliceRank:o,numUpdates:a,sliceSize:l,strides:c,outputSize:u}=xl(i,r,s.shape),d=!1,h=n.bufferSync(r),f=n.bufferSync(i),p=n.bufferSync(s),m=Ra(h,f,s.shape,u,l,a,o,c,p,d);return n.makeTensorInfo(s.shape,m.dtype,m.values)}const Mre={kernelName:QR,backendName:"cpu",kernelFunc:Lre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zre(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:i}=s;_e(r,"tile");const o=cL(n.bufferSync(r),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const Bre={kernelName:Vh,backendName:"cpu",kernelFunc:zre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wre(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:i,sorted:o}=s;_e(r,"topk");const a=n.data.get(r.dataId).values,[l,c]=dL(a,r.shape,r.dtype,i,o);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const jre={kernelName:Nw,backendName:"cpu",kernelFunc:Wre};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vre(t){const{inputs:e,attrs:n,backend:s}=t,{image:r,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=n,[u,d,h,f]=r.shape,[p,m]=c??[d,h],g=[u,p,m,f],x=Fe(r.shape),b=x[0],v=x[1],w=x[2],C=Fe(g),$=C[0],T=C[1],N=C[2],_=Pn(r.dtype,re(g));_.fill(l);const A=s.data.get(r.dataId).values,O=s.data.get(i.dataId).values;for(let G=0;G<u;++G){const q=i.shape[0]===1?O:O.subarray(G*8,G*8+8);for(let U=0;U<p;++U)for(let Y=0;Y<m;++Y)for(let te=0;te<f;++te){let M;const X=q[6]*Y+q[7]*U+1;if(X===0)continue;const Z=(q[0]*Y+q[1]*U+q[2])/X,oe=(q[3]*Y+q[4]*U+q[5])/X,ae=pN(Z,h,a),ce=pN(oe,d,a);switch(o){case"nearest":M=qre(A,d,h,b,v,w,G,ce,ae,te,l);break;case"bilinear":M=Yre(A,d,h,b,v,w,G,ce,ae,te,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const pe=G*$+U*T+Y*N+te;_[pe]=M}return s.makeTensorInfo(g,r.dtype,_)}return{dataId:s.write(_,g,r.dtype),shape:r.shape,dtype:r.dtype}}const Ure={kernelName:Tw,backendName:"cpu",kernelFunc:Vre};function pN(t,e,n){switch(n){case"reflect":return Gre(t,e);case"wrap":return Hre(t,e);case"nearest":return Xre(t,e);case"constant":default:return Kre(t)}}function Gre(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=2*e;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-e?n+s:-n-1}else if(n>e-1)if(e<=1)n=0;else{const s=2*e;n-=s*Math.trunc(n/s),n>=e&&(n=s-n-1)}return Ka(0,n,e-1)}function Hre(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=e-1;n+=e*(Math.trunc(-n/s)+1)}else if(n>e-1)if(e<=1)n=0;else{const s=e-1;n-=e*Math.trunc(n/s)}return Ka(0,n,e-1)}function Kre(t,e){return t}function Xre(t,e){return Ka(0,t,e-1)}function Mu(t,e,n,s,r,i,o,a,l,c,u){const d=o*s+a*r+l*i+c;return 0<=a&&a<e&&0<=l&&l<n?t[d]:u}function qre(t,e,n,s,r,i,o,a,l,c,u){const d=Math.round(a),h=Math.round(l);return Mu(t,e,n,s,r,i,o,d,h,c,u)}function Yre(t,e,n,s,r,i,o,a,l,c,u){const d=Math.floor(a),h=Math.floor(l),f=d+1,p=h+1,m=(p-l)*Mu(t,e,n,s,r,i,o,d,h,c,u)+(l-h)*Mu(t,e,n,s,r,i,o,d,p,c,u),g=(p-l)*Mu(t,e,n,s,r,i,o,f,h,c,u)+(l-h)*Mu(t,e,n,s,r,i,o,f,p,c,u);return(f-a)*m+(a-d)*g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qre(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:i}=e;_e(i,"unique");const o=s.data.get(i.dataId).values,{outputValues:a,outputShape:l,indices:c}=hL(o,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const Jre={kernelName:Ew,backendName:"cpu",kernelFunc:Qre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zre(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:i}=s;i<0&&(i+=r.shape.length);const o=r.shape.length,a=r.shape[i],l=new Array(o-1);let c=0;for(let f=0;f<o;f++)f!==i&&(l[c++]=r.shape[f]);const u=new Array(o).fill(0),d=r.shape.slice();d[i]=1;const h=new Array(a);for(let f=0;f<h.length;f++){u[i]=f;const p=il({inputs:{x:r},backend:n,attrs:{begin:u,size:d}});h[f]=Ct({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return h}const eie={kernelName:vx,backendName:"cpu",kernelFunc:Zre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tie(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:i}=e,{numSegments:o}=s;_e(r,"unsortedSegmentSum");const a=r.shape.length,l=i.shape.length,c=[],u=[],d=a-l;let h=i;for(let p=0;p<d;++p){const m=Wm({inputs:{input:h},backend:n,attrs:{dim:p+1}});h=m,u.push(m)}for(let p=0;p<o;++p){const m=Jo(p,"int32"),g=n.makeTensorInfo([],"int32",m),x=NP({inputs:{a:g,b:h},backend:n}),b=Go({inputs:{x},backend:n,attrs:{dtype:"float32"}}),v=Kx({inputs:{a:b,b:r},backend:n}),w=lf({inputs:{x:v},backend:n,attrs:{axis:0,keepDims:!1}});c.push(w),u.push(g),u.push(x),u.push(b),u.push(v),u.push(w)}const f=NL({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const nie={kernelName:wx,backendName:"cpu",kernelFunc:tie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sie=[QZ,RJ,ZZ,tee,LJ,see,iee,aee,cee,dee,fee,mee,xee,vee,kee,Iee,Nee,Eee,Ree,qZ,Dee,Oee,Lee,zJ,zee,OJ,WJ,Wee,AJ,Vee,Gee,Hee,Xee,Yee,Jee,ete,nte,rte,ote,lte,ute,hte,pte,gte,xte,bte,wte,Cte,Ste,Ite,$te,Tte,Rte,jZ,Dte,jJ,Wte,VJ,jte,GJ,Xte,qte,Qte,KJ,qJ,Zte,tne,sne,ine,QJ,ZJ,DJ,ane,Uee,cne,dne,fne,VZ,tZ,sZ,mne,iZ,xne,vne,kne,Ine,Nne,Ene,_ne,aZ,Ane,Fne,Pne,Mne,Bne,jne,Une,cZ,Hne,qne,Jne,dZ,fZ,tse,rse,ase,mZ,cse,dse,hse,TL,gse,GZ,yZ,yse,vse,kse,Sse,FJ,x1,$se,HZ,KZ,XZ,Tse,_se,Ase,Fse,Pse,Lse,zse,$Z,Wse,Hse,Xse,Jse,TZ,ere,nre,rre,EZ,Yne,are,cre,dre,fre,mre,xre,bre,wre,AZ,kre,FZ,PZ,Sre,$re,Tre,_re,Are,BZ,Ete,Fre,Pre,Mre,Bre,jre,Ure,gZ,Jre,eie,nie,use];for(const t of sie)lA(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ka={},lp={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function rie(t,e){ka[t]=e}function Wr(t,e){if(!(t in ka)||e!=null){const s=oie(t,e);if(s!==null)ka[t]=s;else return console.log("Could not get context for WebGL version",t),null}const n=ka[t];return n==null||n.isContextLost()?(delete ka[t],Wr(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),ka[t])}function iie(t){if(!ee().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function oie(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??iie(t);return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete ka[t]},!1),ee().getBool("SOFTWARE_WEBGL_ENABLED")&&(lp.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",lp)||n.getContext("experimental-webgl",lp):n.getContext("webgl2",lp)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ld;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Ld||(Ld={}));var Ms;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(Ms||(Ms={}));var In;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(In||(In={}));function cf(t,e){return[e,t]}function aie(t,e){return t*e}function cp(t){const e=re(t),n=Math.ceil(e/4);return zb(n)}function Hc(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function lie(t,e){const[n,s]=Hc(t,e);return n*s*4}function yC(t,e){const n=t;let s,r,i,o,a,l,c,u,d,h;return ee().getNumber("WEBGL_VERSION")===2?(s=n.R32F,r=n.R16F,i=n.RGBA16F,o=n.RGBA32F,a=n.RED,c=4,u=1,d=n.HALF_FLOAT,h=n.FLOAT,l=n.RGBA8):(s=t.RGBA,r=t.RGBA,i=t.RGBA,o=n.RGBA,a=t.RGBA,c=4,u=4,d=e!=null?e.HALF_FLOAT_OES:null,h=t.FLOAT,l=t.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ce(t,e){const n=e();return ee().getBool("DEBUG")&&cie(t),n}function cie(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+fie(t,e))}const uie=596e-10,die=65504;function hie(t){return!!(ee().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||uie<Math.abs(t)&&Math.abs(t)<die)}function fie(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function up(t,e){return Ji(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function pie(t,e){const n=Ji(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Ce(t,()=>t.shaderSource(n,e)),Ce(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function mie(t,e){const n=Ji(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Ce(t,()=>t.shaderSource(n,e)),Ce(t,()=>t.compileShader(n)),ee().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw EL(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const gie=/ERROR: [0-9]+:([0-9]+):/g;function EL(t,e){const n=gie.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const s=+n[1],r=t.split(`
`),i=r.length.toString().length+2,o=r.map((d,h)=>nc((h+1).toString(),i)+d);let a=0;for(let d=0;d<o.length;d++)a=Math.max(o[d].length,a);const l=o.slice(0,s-1),c=o.slice(s-1,s),u=o.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${nc(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function xie(t){return Ji(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function yie(t,e){if(Ce(t,()=>t.linkProgram(e)),!ee().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function by(t,e){if(Ce(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function bie(t,e){const n=Ji(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Ce(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),Ce(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function vie(t,e){const n=Ji(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Ce(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),Ce(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function wie(t){return Ji(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function kie(t,e){const n=ee().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const s=`[${t}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(t>n||e>n){const s=`[${t}x${e}]`,r=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function Cie(t){return Ji(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function mN(t,e,n,s,r,i,o){const a=t.getAttribLocation(e,n);return a===-1?!1:(Ce(t,()=>t.bindBuffer(t.ARRAY_BUFFER,s)),Ce(t,()=>t.vertexAttribPointer(a,r,t.FLOAT,!1,i,o)),Ce(t,()=>t.enableVertexAttribArray(a)),!0)}function Sie(t,e,n){Eie(t,n),Ce(t,()=>t.activeTexture(t.TEXTURE0+n)),Ce(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function Iie(t,e,n){return Ji(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function $ie(t,e,n){return t.getUniformLocation(e,n)}function Nie(t,e,n,s){Ce(t,()=>Sie(t,e,s)),Ce(t,()=>t.uniform1i(n,s))}function vy(t,e,n){Ce(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),Ce(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function gN(t,e){Ce(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),Ce(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function dp(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Tie(t,e))}function Tie(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Ji(t,e,n){const s=Ce(t,()=>e());if(s==null)throw new Error(n);return s}function Eie(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+t.TEXTURE0;if(s<t.TEXTURE0||s>n){const r=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${r}.`)}}function Nc(t,e=2){return re(t.slice(0,t.length-e))}function Tc(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function hp(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[Nc(t),...Tc(t)]),e}function _ie(t,e=!1){let n=ee().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=ee().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&ee().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=n/2),e&&(n=n*2,s=s*2,t=t.map((a,l)=>l>=t.length-2?zv(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=Qo(t).newShape);let r=re(t),i=null;t.length<=1&&r<=n?i=[1,r]:t.length===2&&t[0]<=n&&t[1]<=n?i=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?i=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?i=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?i=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(i=[t[0],t[1]*t[2]*t[3]]);const o=i!=null&&Math.max(...i)>s&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||o)if(e){const a=Nc(t);let l=2,c=2;t.length&&([l,c]=Tc(t)),r=a*(l/2)*(c/2),i=zb(r).map(u=>u*2)}else i=zb(r);return i}function fp(t){return t%2===0}function Vm(t,e){if(t=t.slice(-2),e=e.slice(-2),ft(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],s=e[e.length-1];if(n===s||fp(n)&&fp(s)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&fp(t[0])&&fp(e[0])}let wy,ky;function Rie(t){if(wy==null){const e=Wr(t);wy=e.getParameter(e.MAX_TEXTURE_SIZE)}return wy}function Aie(t){if(ky==null){const e=Wr(t);ky=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,ky)}function Die(t){if(t===0)return 0;let e;const n=Wr(t);return ur(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:ur(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function ur(t,e){return t.getExtension(e)!=null}function xN(t){try{if(Wr(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function Fie(t){if(t===0)return!1;const e=Wr(t);if(t===1){if(!ur(e,"OES_texture_float"))return!1}else if(!ur(e,"EXT_color_buffer_float"))return!1;return b1(e)}function Oie(t){if(t===0)return!1;const e=Wr(t);if(t===1){if(!ur(e,"OES_texture_float")||!ur(e,"WEBGL_color_buffer_float"))return!1}else{if(ur(e,"EXT_color_buffer_float"))return b1(e);const s="EXT_color_buffer_half_float";if(ur(e,s)){const r=e.getExtension(s);return Pie(e,r)}return!1}return b1(e)}function b1(t){const e=yC(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),o}function Pie(t,e){const n=yC(t,e),s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(s),t.deleteFramebuffer(o),a}function Lie(t){return t!==2?!1:Wr(t).fenceSync!=null}function uf(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&R(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ae=ee();Ae.registerFlag("HAS_WEBGL",()=>Ae.getNumber("WEBGL_VERSION")>0);Ae.registerFlag("WEBGL_VERSION",()=>xN(2)?2:xN(1)?1:0);Ae.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ae.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ae.get("WEBGL_VERSION")===2);Ae.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ae.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ae.registerFlag("WEBGL_PACK",()=>Ae.getBool("HAS_WEBGL"));Ae.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_CLIP",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_REDUCE",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_CONV_IM2COL",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>Rie(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Aie(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Ae.getNumber("WEBGL_VERSION");return t===0?0:Die(t)});Ae.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ae.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!IA());Ae.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Fie(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ae.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ae.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ae.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Oie(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Lie(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ae.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ae.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Ae.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>IA()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Ae.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ae.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ae.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ae.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ae.registerFlag("WEBGL_EXP_CONV",()=>!1);Ae.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ae.getBool("IS_TEST"));Ae.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ae.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ae.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Ae.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function es(){let t,e,n,s,r,i,o,a,l,c;return ee().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",s="in",r="texture",i="outputColor",o="out vec4 outputColor;",a=ee().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",s="varying",r="texture2D",i="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:s,texture2D:r,output:i,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vl(t,e,n="index"){const s=Fe(e);return s.map((r,i)=>{const o=`int ${t[i]} = ${n} / ${r}`,a=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${r}`:`index -= ${t[i]} * ${r}`;return`${o}; ${a};`}).join("")}function Xx(t,e,n="index"){const s=Fe(e);return s.map((r,i)=>{const o=`int ${t[i]} = ${n} / outShapeStrides[${i}]`,a=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * outShapeStrides[${i}]`:`index -= ${t[i]} * outShapeStrides[${i}]`;return`${o}; ${a};`}).join("")}function Mie(t,e){const n=t.length,s=t.map(i=>`${e}[${i}]`),r=new Array(n-1);r[n-2]=s[n-1];for(let i=n-3;i>=0;--i)r[i]=`(${r[i+1]} * ${s[i+1]})`;return r}function zie(t,e,n="index"){const s=t.map((i,o)=>o),r=Mie(s,e);return r.map((i,o)=>{const a=`int ${t[o]} = ${n} / ${r[o]}`,l=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${r[o]}`:`index -= ${t[o]} * ${r[o]}`;return`${a}; ${l};`}).join("")}function bC(t){const e=Fe(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function vC(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const _L=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:RL}=EX;function Bie(t,e,n){const s=[];if(t.forEach(f=>{const p=re(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?s.push(`uniform float ${f.name}${p>1?`[${p}]`:""};`):(s.push(`uniform sampler2D ${f.name};`),s.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:m}=wC(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(m.length){case 1:s.push(`uniform int ${f.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${f.name}Shape;`);break}s.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{s.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const r=s.join(`
`),i=t.map(f=>Wie(f,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=e.texShape,a=es(),l=Uie(a);let c,u,d=Kie(a);return e.isPacked?(c=jie(e.logicalShape,o,n.enableShapeUniforms),u=Hie(a)):(c=Vie(e.logicalShape,o,n.enableShapeUniforms),u=Gie(a)),n.packedInputs&&(d+=Qie),[d,l,u,r,c,i,n.userCode].join(`
`)}function Kc(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return coe(t,e);case 1:return doe(t,e);case 2:return foe(t,e);case 3:return moe(t,e);case 4:return xoe(t,e);case 5:return yoe(t);case 6:return boe(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function AL(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return loe(t);case 1:return uoe(t,e);case 2:return hoe(t,e);case 3:return poe(t,e);default:return goe(t,e)}}function Wie(t,e,n=!1,s){let r="";n?r+=AL(t,s):r+=Kc(t,s);const i=t.shapeInfo.logicalShape,o=e.logicalShape;return i.length<=o.length&&(n?r+=voe(t,e):r+=woe(t,e)),r}function jie(t,e,n){switch(t.length){case 0:return DL();case 1:return Jie(t,e,n);case 2:return ooe(t,e,n);case 3:return eoe(t,e,n);default:return noe(t,e,n)}}function Vie(t,e,n){switch(t.length){case 0:return DL();case 1:return Zie(t,e,n);case 2:return aoe(t,e,n);case 3:return toe(t,e,n);case 4:return soe(t,e,n);case 5:return roe(t,e);case 6:return ioe(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function Uie(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function Gie(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function Hie(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function Kie(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Xie}
    ${qie}
    ${Yie}
  `}const Xie=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,qie=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Yie=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Qie=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function DL(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function Jie(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function Zie(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function eoe(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[2]/2),i=r*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function toe(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${Xx(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const s=vl(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function noe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2);let o=i,a="",l="b, r, c";for(let c=2;c<t.length-1;c++)o*=t[t.length-c-1],a=`
      int b${c} = index / ${o};
      index -= b${c} * ${o};
    `+a,l=`b${c}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${a}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${t.length}(${l});
    }
  `}function soe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${Xx(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const s=vl(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function roe(t,e){const n=vl(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function ioe(t,e){const n=vl(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function ooe(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(ft(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function aoe(t,e,n){return ft(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function wl(t){return`offset${t}`}function loe(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),s=es();return`
    vec4 ${n}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function coe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[r,i]=t.shapeInfo.texShape;if(r===1&&i===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=wl(n);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function uoe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape,i=es();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${i.texture2D}(${n}, uv);
    }
  `}function doe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${Xc(t)}
      }
    `;const r=t.shapeInfo.texShape,i=r[0],o=r[1];if(o===1&&i===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=wl(n);return o===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${i}.0);
        return sampleTexture(${n}, uv);
      }
    `:i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${i}, ${o}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function hoe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape,o=i[0],a=i[1],l=es();if(i!=null&&ft(n,i))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function foe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape;if(i!=null&&ft(n,i)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const h=i[0],f=i[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${h}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:o,keptDims:a}=Qo(n),l=o;if(l.length<n.length){const h=qc(t,l),f=["row","col"];return`
      ${Kc(h,e)}
      float ${r}(int row, int col) {
        return ${r}(${Yc(f,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Xc(t)}
      }
    `;const c=i[0],u=i[1],d=wl(s);return u===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${s}, uv);
    }
  `:c===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${s}, uv);
  }
`}function poe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(n[0]===1){const h=n.slice(1),f=[1,2],p=qc(t,h),m=["b","row","col"];return`
        ${AL(p,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${Yc(m,f)});
        }
      `}const a=es();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `;const l=o[0],c=o[1],u=Math.ceil(n[2]/2),d=u*Math.ceil(n[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${d}, ${u}, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `}function moe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n[1]*n[2],o=n[2],{newShape:a,keptDims:l}=Qo(n),c=a;if(c.length<n.length){const m=qc(t,c),g=["row","col","depth"];return`
        ${Kc(m,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${Yc(g,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${o}, 1)));
        ${Xc(t)}
      }
    `;const u=t.shapeInfo.texShape,d=u[0],h=u[1],f=t.shapeInfo.flatOffset;if(h===i&&f==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${d}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(h===o&&f==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `;const p=wl(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${o} + depth + ${p};
        vec2 uv = uvFromFlat(${d}, ${h}, index);
        return sampleTexture(${s}, uv);
      }
  `}function goe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=es();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${n}, uv);
    }
  `;const i=t.shapeInfo.logicalShape,o=i.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=l[0],u=l[1],d=Math.ceil(i[o-1]/2);let h=d*Math.ceil(i[o-2]/2),f="int b, int row, int col",p=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let m=2;m<o-1;m++)f=`int b${m}, `+f,h*=i[o-m-1],p=`b${m} * ${h} + `+p;return`
    vec4 ${s}(${f}) {
      int index = ${p};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${r.texture2D}(${n}, uv);
    }
  `}function xoe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n[3],o=n[2]*i,a=n[1]*o,{newShape:l,keptDims:c}=Qo(n);if(l.length<n.length){const b=qc(t,l),v=["row","col","depth","depth2"];return`
      ${Kc(b,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${Yc(v,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${o}, ${i}, 1)));
        ${Xc(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1],p=`int stride2 = ${s}Shape[3];`,m=`int stride1 = ${s}Shape[2] * stride2;`,g=`int stride0 = ${s}Shape[1] * stride1;`;if(f===a&&u==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${p}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(f===i&&u==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;const x=wl(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${m}
      ${g}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${x});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${h}, ${f}, index + ${x});
      return sampleTexture(${s}, uv);
    }
  `}function yoe(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[4],i=e[3]*r,o=e[2]*i,a=e[1]*o,{newShape:l,keptDims:c}=Qo(e);if(l.length<e.length){const m=qc(t,l),g=["row","col","depth","depth2","depth3"];return`
      ${Kc(m)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${Yc(g,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${o}, ${i}, ${r})) +
          depth3;
        ${Xc(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1];if(f===a&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${i}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===r&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=wl(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} + depth * ${i} +
          depth2 * ${r} + depth3 + ${p};
      vec2 uv = uvFromFlat(${h}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function boe(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:i}=Qo(e);if(r.length<e.length){const g=qc(t,r),x=["row","col","depth","depth2","depth3","depth4"];return`
      ${Kc(g)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${Yc(x,i)});
      }
    `}const o=e[5],a=e[4]*o,l=e[3]*a,c=e[2]*l,u=e[1]*c;if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${Xc(t)}
      }
    `;const d=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,f=h[0],p=h[1];if(p===u&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${a}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===o&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=wl(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${a} + depth3 * ${o} + depth4 + ${m};
      vec2 uv = uvFromFlat(${f}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Xc(t){const e=t.name,n=re(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function voe(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",i=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,a=RL(t.shapeInfo.logicalShape,e.logicalShape),l=bt(o),c=o-i;let u;const d=["x","y","z","w","u","v"];i===0?u="":o<2&&a.length>=1?u="coords = 0;":u=a.map(b=>`coords.${d[b+c]} = 0;`).join(`
`);let h="";o<2&&i>0?h="coords":h=t.shapeInfo.logicalShape.map((b,v)=>`coords.${d[v+c]}`).join(", ");let f="return outputValue;";const m=re(t.shapeInfo.logicalShape)===1,x=re(e.logicalShape)===1;if(i===1&&!m&&!x)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!x)o===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){const b=i-2,v=i-1;a.indexOf(b)>-1&&a.indexOf(v)>-1?f="return vec4(outputValue.x);":a.indexOf(b)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(v)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${s}(${h});
      ${f}
    }
  `}function woe(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",i=e.texShape,o=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&ft(o,i))return`
      float ${r}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=bt(l),u=RL(t.shapeInfo.logicalShape,e.logicalShape),d=l-a;let h;const f=["x","y","z","w","u","v"];a===0?h="":l<2&&u.length>=1?h="coords = 0;":h=u.map(m=>`coords.${f[m+d]} = 0;`).join(`
`);let p="";return l<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((m,g)=>`coords.${f[g+d]}`).join(", "),`
    float ${r}() {
      ${c} coords = getOutputCoords();
      ${h}
      return get${s}(${p});
    }
  `}function bt(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function wC(t,e,n){const{newShape:s,keptDims:r}=Qo(e),i=e.length,o=t&&i===3&&e[0]===1,a=o?e.slice(1):s,l=!t&&i>1&&!ft(e,n)&&s.length<i||o;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:r}}function qc(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Yc(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function koe(t,e,n,s){const r=n.map((u,d)=>{const h={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(h.flatOffset=u.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:h}}),i=r.map(u=>u.shapeInfo),o={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},a=Bie(r,o,e),l=mie(t.gl,a),c=t.createProgram(l);return ee().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(c),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:i,outShapeInfo:o},FL(t,e,c)))}function FL(t,e,n){const s=[],r=[];let i,o,a,l=null,c=null;c=t.getUniformLocation(n,"NAN",!1),ee().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const u=!1;for(const d of e.variableNames){const h={name:d,uniform:t.getUniformLocation(n,d,u),offset:t.getUniformLocation(n,`offset${d}`,u)};e.enableShapeUniforms&&(h.shape=t.getUniformLocation(n,`${d}Shape`,u),h.texShape=t.getUniformLocation(n,`${d}TexShape`,u)),s.push(h)}if(e.enableShapeUniforms&&(i=t.getUniformLocation(n,"outShape",u),a=t.getUniformLocation(n,"outShapeStrides",u),o=t.getUniformLocation(n,"outTexShape",u)),e.customUniforms)for(const d of e.customUniforms)r.push(t.getUniformLocation(n,d.name,u));return{variablesLocations:s,customUniformLocations:r,infLoc:l,nanLoc:c,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:o}}function yN(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,s)=>{const r=n.logicalShape,i=e[s],o=i.shape;if(!ft(r,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${o} must match`);if(n.isUniform&&i.isUniform)return;const a=n.texShape,l=i.isUniform?null:i.texData.texShape;if(!ft(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function Coe(t,e,n,s,r){e.program.enableShapeUniforms||(yN(e.inShapeInfos,n),yN([e.outShapeInfo],[s]));const i=s.texData.texture,o=s.texData.texShape;s.texData.isPacked?t.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):t.setOutputMatrixTexture(i.texture,o[0],o[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),ee().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const c=n[l],{uniform:u,offset:d,shape:h,texShape:f}=e.variablesLocations[l];if(h){const{uniformShape:p}=wC(e.program.packedInputs,c.shape,c.texData.texShape);switch(p.length){case 1:t.gl.uniform1iv(h,new Int32Array(p));break;case 2:t.gl.uniform2iv(h,new Int32Array(p));break;case 3:t.gl.uniform3iv(h,new Int32Array(p));break;case 4:t.gl.uniform4iv(h,new Int32Array(p));break}}if(f&&t.gl.uniform2i(f,c.texData.texShape[0],c.texData.texShape[1]),u!=null){if(c.isUniform){if(re(c.shape)<2)t.gl.uniform1f(u,c.uniformValues[0]);else{let p=c.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),t.gl.uniform1fv(u,p)}continue}c.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,c.texData.slice.flatOffset),t.setInputMatrixTexture(c.texData.texture.texture,u,l)}}const a=e.outShapeLocation;if(a)switch(s.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(s.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(s.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(s.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=Fe(s.shape);switch(s.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r)for(let l=0;l<e.program.customUniforms.length;++l){const c=e.program.customUniforms[l],u=e.customUniformLocations[l],d=r[l];if(c.type==="float")t.gl.uniform1fv(u,d);else if(c.type==="vec2")t.gl.uniform2fv(u,d);else if(c.type==="vec3")t.gl.uniform3fv(u,d);else if(c.type==="vec4")t.gl.uniform4fv(u,d);else if(c.type==="int")t.gl.uniform1iv(u,d);else if(c.type==="ivec2")t.gl.uniform2iv(u,d);else if(c.type==="ivec3")t.gl.uniform3iv(u,d);else if(c.type==="ivec4")t.gl.uniform4iv(u,d);else throw Error(`uniform type ${c.type} is not supported yet.`)}t.executeProgram()}function Soe(t,e,n){let s="";e.concat(n).forEach(o=>{const a=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:d}=wC(t.packedInputs,o.shape,l);let h="",f="",p="";if(u.length===1&&t.packedInputs){const C=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];h=`${C[0]>1}_${C[1]>1}`}else if(u.length===2&&!t.packedInputs)f=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!t.packedInputs){const C=Fe(u);p=`${C[0]===l[1]}_${C[C.length-1]===l[1]}`}const m=o.shape.length,g=u.length===2&&ft(o.shape,l),x=re(o.shape)===1,b=wc(o.shape,n.shape),v=!t.packedInputs&&m===n.shape.length&&ft(l,n.texData.texShape),w=t.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${m}_${v}_${c?d:""}_${u.length}_${x}_${b}_${g}_${h}_${f}_${p}_${w}_${a}`}else{const l=o.isUniform?"uniform":o.texData.texShape;s+=`${o.shape}_${l}_${a}`}});const r=t.userCode;let i=t.constructor.name;return i+="_"+s+"_"+r+`${ee().getNumber("WEBGL_VERSION")}`,i}function Wn(t){return ee().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ioe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Ld.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=es();this.outputShape=e,this.enableShapeUniforms=Wn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Xx(["r","c","d"],e):vl(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $oe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Ld.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=es();this.outputShape=e,this.enableShapeUniforms=Wn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Xx(["r","c","d"],e):vl(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Noe{constructor(e){this.variableNames=["A"],this.outTexUsage=Ms.DOWNLOAD;const n=es();this.outputShape=e,this.userCode=`
      ${_L}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Toe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Ms.DOWNLOAD;const n=es();this.outputShape=e,this.userCode=`
      ${_L}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eoe={R:0,G:1,B:2,A:3};class bN{constructor(e,n=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=es();this.outputShape=e,this.enableShapeUniforms=Wn(this.outputShape.length);let i="result";n&&(i="floor(result * 255. + 0.5)");let o="";for(let a=0;a<s.length;a++){const l=s[a];o+=`
          if(offset == ${a}) {
            result = values[${Eoe[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?vC():bC(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${o}
        }
        ${r.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _oe{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=es();this.outputShape=e,this.enableShapeUniforms=Wn(this.outputShape.length);let r="",i="result";n&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const l=o*2+a;r+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?vC():bC(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Roe(t){const e=es(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return pie(t,n)}function Aoe(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return bie(t,e)}function Doe(t){const e=new Uint16Array([0,1,2,2,1,3]);return vie(t,e)}function df(t,e,n,s,r,i){kie(e,n);const o=wie(t),a=t.TEXTURE_2D;return Ce(t,()=>t.bindTexture(a,o)),Ce(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),Ce(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),Ce(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),Ce(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),ee().getNumber("WEBGL_VERSION")===1?Ce(t,()=>t.texImage2D(a,0,s,e,n,0,r,i,null)):Ce(t,()=>t.texStorage2D(a,1,s,e,n)),Ce(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:o,texShape:[n,e]}}function OL(t){return t.internalFormatFloat}function Foe(t,e,n,s){const[r,i]=cf(e,n);return df(t,r,i,OL(s),s.textureFormatFloat,t.FLOAT)}function PL(t){return t.internalFormatHalfFloat}function Ooe(t,e,n,s){const[r,i]=cf(e,n);return df(t,r,i,PL(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function LL(t){return t.downloadTextureFormat}function Poe(t,e,n,s){const[r,i]=cf(e,n);return df(t,r,i,LL(s),t.RGBA,t.UNSIGNED_BYTE)}function ML(t){return t.internalFormatPackedFloat}function Loe(t,e,n,s){const[r,i]=Hc(e,n);return df(t,r,i,ML(s),t.RGBA,t.FLOAT)}function zL(t){return t.internalFormatPackedHalfFloat}function Moe(t,e,n,s){const[r,i]=Hc(e,n);return df(t,r,i,zL(s),t.RGBA,s.textureTypeHalfFloat)}function zoe(t,e,n){return Ce(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),mN(t,e,"clipSpacePos",n,3,20,0)&&mN(t,e,"uv",n,2,20,12)}function Boe(t,e,n,s,r,i){Ce(t,()=>t.bindTexture(t.TEXTURE_2D,e));let o,a,l;r instanceof Uint8Array?(o=new Uint8Array(n*s*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(o=new Float32Array(n*s*4),a=t.FLOAT,l=i.internalFormatPackedFloat),o.set(r),ee().getNumber("WEBGL_VERSION")===2?Ce(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,s,t.RGBA,a,o)):Ce(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,s,0,t.RGBA,a,o)),Ce(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Woe(t,e,n){Ce(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?ee().getNumber("WEBGL_VERSION")===2?Ce(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):Ce(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):ee().getNumber("WEBGL_VERSION")===2?Ce(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):Ce(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),Ce(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function joe(t,e,n,s){const r=t.createBuffer();Ce(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,r));const a=4*4*e*n;return Ce(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),Ce(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),Ce(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),r}function Voe(t,e,n){const s=t,r=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function Uoe(t,e,n,s){const[r,i]=cf(e,n),o=4,a=new Uint8Array(aie(e*n,o));return Ce(t,()=>t.readPixels(0,0,r,i,s.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function Goe(t,e,n,s,r,i,o,a){const l=t,c=new Float32Array(lie(i,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function Hoe(t,e,n){const s=new Float32Array(e*n*4);return Ce(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cy{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=ee().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,rie(n,e)):this.gl=Wr(n),e=this.gl,ee().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>Ce(i,()=>i.createVertexArray()),this.bindVertexArray=o=>Ce(i,()=>i.bindVertexArray(o)),this.deleteVertexArray=o=>Ce(i,()=>i.deleteVertexArray(o)),this.getVertexArray=()=>Ce(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Ce(e,()=>i.createVertexArrayOES()),this.bindVertexArray=o=>Ce(e,()=>i.bindVertexArrayOES(o)),this.deleteVertexArray=o=>Ce(e,()=>i.deleteVertexArrayOES(o)),this.getVertexArray=()=>Ce(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),ee().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=up(this.gl,i),ur(this.gl,o))this.textureHalfFloatExtension=up(this.gl,o);else if(ee().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),ur(this.gl,r))this.colorBufferHalfFloatExtension=up(this.gl,r);else if(ee().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",ur(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(ur(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Aoe(this.gl),this.indexBuffer=Doe(this.gl),this.framebuffer=Cie(this.gl),this.textureConfig=yC(this.gl,this.textureHalfFloatExtension)}get debug(){return ee().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;Ce(e,()=>e.finish()),Ce(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Ce(e,()=>e.deleteFramebuffer(this.framebuffer)),Ce(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Ce(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Ce(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),Foe(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),Ooe(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),Poe(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),Woe(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,s,r){this.throwIfDisposed(),Boe(this.gl,e,n,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),Moe(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),Loe(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(gN(this.gl,this.framebuffer),this.outputTexture=null),Ce(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,s){return this.downloadMatrixDriver(e,()=>Uoe(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,s,r,i,o){return Goe(this.gl,e,n,s,r,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return Voe(this.gl,e,n)}createBufferFromTexture(e,n,s){this.bindTextureToFrameBuffer(e);const r=joe(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,s;if(ee().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const o=r.clientWaitSync(i,0,0);return o===r.ALREADY_SIGNALED||o===r.CONDITION_SATISFIED},n=i}else ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(e,n,s){return this.downloadMatrixDriver(e,()=>Hoe(this.gl,n,s))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=Roe(n));const s=xie(n);Ce(n,()=>n.attachShader(s,this.vertexShader)),Ce(n,()=>n.attachShader(s,e)),yie(n,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&by(n,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;Ce(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),zoe(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(Ce(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&by(this.gl,this.program),Ce(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,s=!0){return this.throwIfDisposed(),s?Iie(this.gl,e,n):$ie(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),Ce(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),Nie(this.gl,e,n,s)}setOutputMatrixTexture(e,n,s){this.setOutputMatrixTextureDriver(e,s,n)}setOutputPackedMatrixTexture(e,n,s){this.throwIfDisposed();const[r,i]=Hc(n,s);this.setOutputMatrixTextureDriver(e,r,i)}setOutputMatrixWriteRegion(e,n,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,n)}setOutputPackedMatrixWriteRegion(e,n,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&by(this.gl,this.program),dp(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Ce(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Ce(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=up(this.gl,ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await i$(()=>this.disposed||this.isQueryAvailable(e,ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=Koe(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in ee().platform&&(s=ee().platform.setTimeoutCustom.bind(ee().platform)),i$(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),vy(this.gl,e,this.framebuffer),this.debug&&dp(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(vy(this.gl,this.outputTexture,this.framebuffer),this.debug&&dp(this.gl)):gN(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,n,s){this.throwIfDisposed();const r=this.gl;vy(r,e,this.framebuffer),this.debug&&dp(r),this.outputTexture=e,Ce(r,()=>r.viewport(0,0,n,s)),Ce(r,()=>r.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(e,n,s,r){this.throwIfDisposed(),Ce(this.gl,()=>this.gl.scissor(e,n,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function Koe(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:Xoe,bincountImpl:BL,bincountReduceImpl:qoe,bitwiseAndImpl:Yoe,castImpl:Qoe,ceilImpl:Joe,concatImpl:Zoe,equalImpl:eae,expImpl:tae,expm1Impl:nae,floorImpl:sae,gatherNdImpl:rae,gatherV2Impl:iae,greaterImpl:oae,greaterEqualImpl:aae,lessImpl:lae,lessEqualImpl:cae,linSpaceImpl:uae,logImpl:dae,maxImpl:hae,maximumImpl:fae,minimumImpl:pae,multiplyImpl:mae,negImpl:gae,notEqualImpl:xae,prodImpl:yae,raggedGatherImpl:bae,raggedRangeImpl:vae,raggedTensorToTensorImpl:wae,rangeImpl:kae,rsqrtImpl:Cae,scatterImpl:Sae,sigmoidImpl:Iae,simpleAbsImpl:WL,sliceImpl:$ae,sparseFillEmptyRowsImpl:Nae,sparseReshapeImpl:Tae,sparseSegmentReductionImpl:jL,sqrtImpl:Eae,staticRegexReplaceImpl:_ae,stridedSliceImpl:Rae,stringNGramsImpl:Aae,stringSplitImpl:Dae,stringToHashBucketFastImpl:Fae,subImpl:Oae,tileImpl:Pae,topKImpl:Lae,transposeImpl:kC,uniqueImpl:Mae}=WZ;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VL(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function Xn(t,e){return e===1?[t]:VL(t,e)}function zae(t,e){if(t===1)return"rc";let n="";for(let s=0;s<t;s++)n+=e[s],s<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bae{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Wn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=Xn("rc",this.rank),s=bt(this.rank),r=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let i=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)i=`${e[e.length-1-o]},`+i;n.push(i)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UL{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Wn(this.outputShape.length);let s="";for(let r=0;r<4;r++){let i="thisRC = rc;";r%2===1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),s+=`
        ${i}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${Wae(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?vC():bC(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function Wae(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?zie(["r","c","d"],"inputShape"):vl(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jae{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,s){const r=wN(n,s),i=kN(e,r,s);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=vN(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[i].pop();return this.usedTextures[i].push(l),l}let a;return r===In.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===In.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===In.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===In.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===In.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(e,n,s,r){if(this.freeTextures==null)return;const i=wN(s,r),o=kN(n,i,r);o in this.freeTextures||(this.freeTextures[o]=[]);const a=vN(n,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=ee().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const c=this.usedTextures[o],u=c&&c.indexOf(e);if(u==null||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[u]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Vae(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function vN(t,e,n,s,r){const i=Uae(e,s);let o;if(r){const[l,c]=Hc(t[0],t[1]);o=l*c}else{const[l,c]=cf(t[0],t[1]);o=l*c}const a=Vae(n,i);return o*a}function Uae(t,e){switch(t){case In.PACKED_2X2_FLOAT32:return ML(e);case In.PACKED_2X2_FLOAT16:return zL(e);case In.UNPACKED_FLOAT32:return OL(e);case In.UNPACKED_FLOAT16:return PL(e);case In.PACKED_4X1_UNSIGNED_BYTE:return LL(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function Gae(t){return ee().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?In.PACKED_2X2_FLOAT32:In.UNPACKED_FLOAT32:t?In.PACKED_2X2_FLOAT16:In.UNPACKED_FLOAT16}function wN(t,e){if(t===Ms.UPLOAD)return In.PACKED_2X2_FLOAT32;if(t===Ms.RENDER||t==null)return Gae(e);if(t===Ms.DOWNLOAD||t===Ms.PIXELS)return In.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function kN(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ui{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Wn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const yr="if (isnan(x)) return x;",Hae="return x;",CN="return abs(x);",Kae="return (x >= 0.0) ? x : (exp(x) - 1.0);",Xae=yr+`
  return (x < 0.0) ? 0.0 : x;
`,qae=yr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,lo="return x;",Yae="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qae="return x;",Jae=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Zae=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,ele=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,tle="return 1.0 / (1.0 + exp(-1.0 * x));";class wo{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Wn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nle{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Wn(this.outputShape.length);const n=e.length,s=Xn("rc",n),r=bt(n),i=zae(n,s),o=s.slice(-2),a=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sle=pD,rle=1e-7,ile=1e-4,pp={};function ole(t){return t in pp||(pp[t]={}),pp[t]}const ale=ee().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),lle=600;function cle(){return ee().global.screen==null?1024:ee().global.screen.height*ee().global.screen.width*window.devicePixelRatio*lle/1024/1024}class qx extends Mv{nextDataId(){return qx.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!ee().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof Cy)n=e;else{const s=Wr(ee().getNumber("WEBGL_VERSION"),e);n=new Cy(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=Wr(ee().getNumber("WEBGL_VERSION"));n=new Cy(s),this.binaryCache=ole(ee().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new jae(this.gpgpu),this.numMBBeforeWarning=cle(),this.texData=new DR(this,si())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,s,r,i,o){const a=this.makeTensorInfo(n,s),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[r,i]},l.texShape=[r,i];const c=hp(n),u=new bN(c,!1,o),d=this.runWebGLProgram(u,[a],s,[[r,i]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),d.dataId}write(e,n,s){if((ee().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||ee().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:n,dtype:s,values:e,usage:Ms.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,s,r,i){if(ee().getBool("DEBUG")&&this.checkNumericalProblems(n),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:n,usage:Ms.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:i,slice:o,shape:a,isPacked:l}=n;if(o!=null){let h;l?h=new wo(a,lo):h=new ui(a,lo);const f=this.runWebGLProgram(h,[{dataId:e,shape:a,dtype:r}],r),p=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),p}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const c=this.activeTimers!=null;let u;c&&(u=ss());let d;if(r==="complex64"){const h=this.readSync(i.real.dataId),f=this.readSync(i.imag.dataId);d=Hi(h,f)}else d=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=ss()-u),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(m=>p.push(m))}const n=this.texData.get(e),{values:s,shape:r,slice:i,dtype:o,complexTensorInfos:a,isPacked:l}=n;if(i!=null){let p;l?p=new wo(r,lo):p=new ui(r,lo);const m=this.runWebGLProgram(p,[{dataId:e,shape:r,dtype:o}],o),g=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),g}if(s!=null)return this.convertAndCacheOnCPU(e);if(ee().getBool("DEBUG")&&!ee().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ee().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,u;if(o!=="complex64"&&ee().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(e);const p=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(p.texture.texture,...cp(r))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(o==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),m=p[0],g=p[1];d=Hi(m,g)}else if(c==null)d=this.getValuesFromTexture(e);else{const p=re(r);d=this.gpgpu.downloadFloat32MatrixFromBuffer(c,p)}if(u!=null&&this.disposeIntermediateTensorInfo(u),c!=null){const p=this.gpgpu.gl;Ce(p,()=>p.deleteBuffer(c))}const h=this.convertAndCacheOnCPU(e,d),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(p=>p(h)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&si().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e,n={}){const s=this.texData.get(e),{values:r,shape:i,slice:o,dtype:a,isPacked:l,texture:c}=s;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let f;l?f=new wo(i,lo):f=new ui(i,lo);const p=this.runWebGLProgram(f,[{dataId:e,shape:i,dtype:a}],a),m=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),m}if(c==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,n.customTexShape),d=si().makeTensorFromTensorInfo(u),h=this.texData.get(u.dataId);return Object.assign({tensorRef:d},h.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>Bo(r));return Ye(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ye(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const s=e[n];if(!hie(s))throw ee().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:s,isPacked:r}=this.texData.get(e),i=re(n);if(ee().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(e),f=this.texData.get(h.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...cp(n)).subarray(0,i);return this.disposeIntermediateTensorInfo(h),p}const o=ee().getBool("WEBGL_PACK")&&r===!0,a=o?hp(n):n,l=o?new Toe(a):new Noe(a),c=this.runWebGLProgram(l,[{shape:a,dtype:s,dataId:e}],"float32"),u=this.texData.get(c.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(c),d}timerAvailable(){return ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const i=Xa(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),o=Xa(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,r&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);a.kernelMs=YG(l),a.getExtraProfileInfo=()=>l.map((c,u)=>({name:o[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:ss(),endMs:null}}endTimer(e){return ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=ss(),e)}async getQueryTime(e){if(ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:s,texShape:r,usage:i,isPacked:o,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(n,r,i,o)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=ale){return ee().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&re(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){Ps("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return sle(e.shape,n)}packedUnaryOp(e,n,s){const r=new wo(e.shape,n),i=this.compileAndRun(r,[e],s);return si().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=WL(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(ee().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,CN,e.dtype);const n=new ui(e.shape,CN),s=this.compileAndRun(n,[e]);return si().makeTensorFromTensorInfo(s)}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&qd(s[0])){const i=s.map(o=>Do(o));r=this.write(i,e,n)}else r=this.write(s,e,n);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:n}}makeOutput(e,n,s){return si().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,s),this)}unpackTensor(e){const n=new nle(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new Bae(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const s=[Nc(e.shape),...Tc(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},i=[Nc(n),...Tc(n)],o=new UL(i,s),a=!0,l=[s],c=this.runWebGLProgram(o,[r],e.dtype,l,a);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(e,n){const s=this.texData.get(e),{isPacked:r,shape:i,dtype:o}=s;if(n!=null){const h=re(i),f=n[0]*n[1]*4;R(h<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=hp(i);let l;r?l=new $oe(a):l=new Ioe(a);const c=!0,u=[n??cp(a)],d=this.runWebGLProgram(l,[{shape:a,dtype:o,dataId:e}],o,u,c,n);return{dtype:o,shape:i,dataId:d.dataId}}runWebGLProgram(e,n,s,r,i=!1,o){const a=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===Ld.DENSE){const x=o??cp(e.outputShape);l.texShape=x.map(b=>b*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),re(a.shape)===0)return l.values=Pn(a.dtype,0),a;const c=[],u=n.map(x=>{if(x.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let b=this.texData.get(x.dataId);if(b.texture==null){if(!e.packedInputs&&re(x.shape)<=ee().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:x.shape,texData:null,isUniform:!0,uniformValues:b.values};e.packedInputs&&(b.isPacked=!0,b.shape=x.shape)}if(this.uploadToGPU(x.dataId),!!b.isPacked!=!!e.packedInputs)x=b.isPacked?this.unpackTensor(x):this.packTensor(x),c.push(x),b=this.texData.get(x.dataId);else if(b.isPacked&&!Vm(b.shape,x.shape)){const v=x,w=x.shape;x.shape=b.shape,x=this.packedReshape(x,w),c.push(x),b=this.texData.get(x.dataId),v.shape=w}return{shape:x.shape,texData:b,isUniform:!1}});this.uploadToGPU(a.dataId);const d={shape:a.shape,texData:l,isUniform:!1},h=Soe(e,u,d),f=this.getAndSaveBinary(h,()=>koe(this.gpgpu,e,u,d)),p=this.activeTimers!=null;let m;p&&(m=this.startTimer()),ee().get("ENGINE_COMPILE_ONLY")||Coe(this.gpgpu,f,u,d,r),c.forEach(x=>this.disposeIntermediateTensorInfo(x)),p&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));const g=ee().getNumber("WEBGL_FLUSH_THRESHOLD");if(g>0){const x=ss();x-this.lastGlFlushTime>g&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=x)}if(!ee().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const x=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),x}return a}compileAndRun(e,n,s,r,i=!1){return s=s||n[0].dtype,this.runWebGLProgram(e,n,s,r,i)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(ee().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Q(()=>{if(!ee().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=ee().getBool("DEBUG");ee().set("DEBUG",!1);const n=this.abs(ht(1e-8)).dataSync()[0];if(ee().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?rle:ile}uploadToGPU(e){const n=this.texData.get(e),{shape:s,dtype:r,values:i,texture:o,usage:a,isPacked:l}=n;if(o!=null)return;const c=this.activeTimers!=null;let u;c&&(u=ss());let d=n.texShape;if(d==null&&(d=_ie(s,l),n.texShape=d),i!=null){const h=hp(s);let f,p=d[1],m=d[0];const g=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!g)&&([p,m]=Hc(d[0],d[1])),l?f=new _oe(h,g):f=new bN(h,g);const x=g?[m,p]:d,b=this.makeTensorInfo(x,r),v=this.texData.get(b.dataId);g?v.usage=Ms.PIXELS:v.usage=Ms.UPLOAD,v.texShape=x,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),p,m,i);const w=[[m,p]],$=this.runWebGLProgram(f,[b],r,w,!0),T=this.texData.get($.dataId);n.texShape=T.texShape,n.isPacked=T.isPacked,n.usage=T.usage,ee().get("ENGINE_COMPILE_ONLY")?this.disposeData($.dataId):(n.texture=T.texture,n.values=null,this.texData.delete($.dataId)),this.disposeIntermediateTensorInfo(b),c&&(this.uploadWaitMs+=ss()-u)}else{const h=this.acquireTexture(d,a,r,l);n.texture=h}}convertAndCacheOnCPU(e,n){const s=this.texData.get(e),{dtype:r}=s;return n!=null&&(s.values=ule(n,r)),s.values}acquireTexture(e,n,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,r)}computeBytes(e,n){return e[0]*e[1]*ym(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(n),r(!0)}catch(i){throw i}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await RD(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(EL(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:s,infLoc:r,nanLoc:i,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:l}=FL(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=i,e.outShapeLocation=o,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,s){e.channels=e.channels||"RGBA";const{texture:r,height:i,width:o,channels:a}=e,l=si().backend;if(!l.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(r,n,s,i,o,a);return si().makeTensorFromDataId(c,n,s,l)}}qx.nextDataId=0;function ule(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let s=0;s<n.length;++s)n[s]=Math.round(t[s]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */$A()&&_A("webgl",()=>new qx,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CC=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class ol{constructor(e,n,s){this.variableNames=["A","B"],this.outputShape=He(n,s),this.enableShapeUniforms=Wn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kl=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Qc{constructor(e,n,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=He(n,s);const i=this.outputShape.length;this.enableShapeUniforms=Wn(i);let o="";if(r)if(i===0||re(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${bt(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=Xn("coords",i);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function As(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const dle={kernelName:gh,backendName:"webgl",kernelFunc:As};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oa(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,i=n.makeTensorInfo(s.shape,"complex64"),o=n.texData.get(i.dataId),a=As({inputs:{x:s},backend:n}),l=As({inputs:{x:r},backend:n});return o.complexTensorInfos={real:a,imag:l},i}const hle={kernelName:Qv,backendName:"webgl",kernelFunc:oa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GL="return (a < 0.) ? b * a : a;",HL=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function fle(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:i}=s,o=n.makeTensorInfo([],"float32",Jo(i,"float32")),a=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Qc(HL,r.shape,o.shape):new ol(GL,r.shape,o.shape),l=n.runWebGLProgram(a,[r,o],"float32");return n.disposeIntermediateTensorInfo(o),l}const ple={kernelName:Vg,backendName:"webgl",kernelFunc:fle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KL="return (a < 0.) ? b * a : a;",XL=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function mle(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e,i=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Qc(XL,s.shape,r.shape):new ol(KL,s.shape,r.shape);return n.runWebGLProgram(i,[s,r],"float32")}const gle={kernelName:lx,backendName:"webgl",kernelFunc:mle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jc="if (isnan(x)) return x;";function ot({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:s}){return({inputs:r,backend:i})=>{const{x:o}=r,a=i,l=s||o.dtype;if(a.shouldExecuteOnCPU([o])&&n!=null){const d=a.texData.get(o.dataId),h=n(d.values,l);return a.makeTensorInfo(o.shape,l,h)}const c=ee().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let u;return c?u=new wo(o.shape,e):u=new ui(o.shape,t),a.runWebGLProgram(u,[o],l)}}function _n({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:i}){return({inputs:o,backend:a})=>{const{a:l,b:c}=o,u=a;if(s&&l.dtype==="complex64"){const p=u.texData.get(l.dataId),m=u.texData.get(c.dataId),[g,x]=[[p.complexTensorInfos.real,m.complexTensorInfos.real],[p.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(v=>{const[w,C]=v,$={dataId:w.dataId,dtype:w.dtype,shape:l.shape},T={dataId:C.dataId,dtype:C.dtype,shape:c.shape},N=new ol(t,l.shape,c.shape);return u.runWebGLProgram(N,[$,T],_s(w.dtype,C.dtype))}),b=oa({inputs:{real:g,imag:x},backend:u});return u.disposeIntermediateTensorInfo(g),u.disposeIntermediateTensorInfo(x),b}const d=i||_s(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&r!=null){const p=u.texData.get(l.dataId).values,m=u.texData.get(c.dataId).values,g=l.dtype==="string"?Ki(p):p,x=l.dtype==="string"?Ki(m):m,[b,v]=r(l.shape,c.shape,g,x,d),w=u.makeTensorInfo(v,d),C=u.texData.get(w.dataId);return C.values=b,w}const h=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return h?f=new Qc(e,l.shape,c.shape,n):f=new ol(t,l.shape,c.shape),u.runWebGLProgram(f,[l,c],d)}}function Md(t,e=!1){if(t==="linear")return e?Qae:Hae;if(t==="relu")return e?Zae:Xae;if(t==="elu")return e?Jae:Kae;if(t==="relu6")return e?ele:qae;if(t==="prelu")return e?XL:KL;if(t==="leakyrelu")return e?HL:GL;if(t==="sigmoid")return e?tle:Yae;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qL{constructor(e,n,s,r=!1,i=!1,o=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=Wn(this.outputShape.length);const u=r?e[1]:e[2],d=Math.ceil(u/2),h=r?"i * 2, rc.y":"rc.y, i * 2",f=i?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let g="",x="";a&&(l?g=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?g=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:g=`vec4 activation(vec4 x) {
          ${a}
        }`,x="result = activation(result);");const b=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let v="rc.x",w="rc.x";e[0]<n[0]?v=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(w=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${g}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${v};
        int batchB = ${w};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${m[0]});
          result += (${p[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${b}

        ${x}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SN={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class IN{constructor(e,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=He(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $N="return a * b;";function SC(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,i=_s(s.dtype,r.dtype);if(s.dtype==="complex64"){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),c=new IN(SN.REAL,s.shape,r.shape),u=new IN(SN.IMAG,s.shape,r.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:s.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],h=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(u,d,"float32"),p=oa({inputs:{real:h,imag:f},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}if(n.shouldExecuteOnCPU([s,r])){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),[c,u]=mae(s.shape,r.shape,a.values,l.values,i),d=n.makeTensorInfo(u,i),h=n.texData.get(d.dataId);return h.values=c,d}let o;return ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new Qc($N,s.shape,r.shape):o=new ol($N,s.shape,r.shape),n.runWebGLProgram(o,[s,r],i)}const xle={kernelName:Ih,backendName:"webgl",kernelFunc:SC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yle(t,e,n){const s=[Nc(t.shape),...Tc(t.shape)],r={dtype:t.dtype,shape:s,dataId:t.dataId},i=[Nc(e),...Tc(e)],o=new UL(i,s),a=!0,l=[s],c=n.runWebGLProgram(o,[r],t.dtype,l,a);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:i}=s,o=n,a=re(r.shape),l=OR(i,a),c=re(l);R(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${r.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const u=o.texData.get(r.dataId);return u.isPacked&&!Vm(r.shape,l)&&!(u.texture!==null&&Vm(u.shape,l))?yle(r,l,o):(o.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const ble={kernelName:ux,backendName:"webgl",kernelFunc:ve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NN{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:o}=e;this.outputShape=[r,o];const a=Math.floor(s/4)*4,l=s%4;let c="sumValue += dot(values, ones);";if(n!=null){const d=1/n;c=`sumValue += dot(values * ${xc(d)?d.toPrecision(2):d}, ones);`}let u="";i%s>0&&(u=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vle{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:o}=e;this.outputShape=[r,o];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const u=Math.floor(s/4)*4,d=s%4;let h=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(a="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(a="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let p="";i%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wle(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],s=Dx(n);e.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return e}function Cl(t,e,n,s){const r=wle(t.shape);let i=t;for(let o=0;o<r.length;o++){const{inSize:a,windowSize:l,outSize:c}=r[o];let u,d;n==="mean"?u=o===0?new NN({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},a):new NN({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c}):u=new vle({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},n),d=i,i=s.runWebGLProgram(u,[i],e),d.dataId!==t.dataId&&s.disposeIntermediateTensorInfo(d)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kle{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[n[o]];this.outputShape=s,this.rank=s.length;const r=bt(this.rank),i=Cle(n);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function Cle(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<t.length;r++)s[t[r]]=n[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sle{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let u=0;u<s.length;u++)s[u]=e[n[u]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=bt(this.rank),i=VL("rc",this.rank),o=new Array(this.rank);for(let u=0;u<n.length;u++)o[n[u]]=i[u];const a=`vec2(${o.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${s[this.rank-1]}`,c=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yx(t,e,n){const s=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Sle(t.shape,e):new kle(t.shape,e);return n.runWebGLProgram(s,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ile(t,e,n,s){const r=e,i=t.shape.length,o=Qe(r,t.shape);let a=o;const l=Wt(a,i),c=l!=null;let u=t;c&&(u=Yx(t,l,s),a=qt(a.length,i)),En("sum",a,i);const[d,h]=kn(u.shape,a);let f=d;n&&(f=rn(d,o));const p=re(h),g=re(t.shape)/p,x=ve({inputs:{x:u},attrs:{shape:[g,p]},backend:s}),b=Aw(t.dtype),v=Cl(x,b,"sum",s),w=ve({inputs:{x:v},attrs:{shape:f},backend:s});return s.disposeIntermediateTensorInfo(x),s.disposeIntermediateTensorInfo(v),c&&s.disposeIntermediateTensorInfo(u),w}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qx(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;return Ile(r,i,o,n)}const $le={kernelName:gx,backendName:"webgl",kernelFunc:Qx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zn(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{perm:i}=s,o=n,a=r.shape.length,l=new Array(a);for(let u=0;u<l.length;u++)l[u]=r.shape[i[u]];let c;if(o.shouldExecuteOnCPU([r])){const d=o.texData.get(r.dataId).values,h=kC(d,r.shape,r.dtype,i,l);c=o.makeTensorInfo(l,r.dtype);const f=o.texData.get(c.dataId);f.values=h}else c=Yx(r,i,o);return c}const Nle={kernelName:sc,backendName:"webgl",kernelFunc:Zn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YL=1e3;function Um({a:t,b:e,transposeA:n,transposeB:s,backend:r,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}){const c=t.shape.length,u=e.shape.length,d=n?t.shape[c-2]:t.shape[c-1],h=s?e.shape[u-1]:e.shape[u-2],f=n?t.shape[c-1]:t.shape[c-2],p=s?e.shape[u-2]:e.shape[u-1],m=t.shape.slice(0,-2),g=e.shape.slice(0,-2),x=re(m),b=re(g),w=He(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,p]);R(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${s} must match.`);const C=n?[x,d,f]:[x,f,d],$=s?[b,p,h]:[b,h,p],T=ve({inputs:{x:t},backend:r,attrs:{shape:C}}),N=ve({inputs:{x:e},backend:r,attrs:{shape:$}}),_=[T,N],A=Math.max(x,b),O=n?T.shape[1]:T.shape[2],W=i!=null,G=o!=null,q=l==="leakyrelu",U=l!=null?Md(l,!0):null,Y=W||G||q||U!=null;let te;if((f===1||p===1)&&O>YL&&Y===!1){let X=T,Z=N;n&&(X=Zn({inputs:{x:T},backend:r,attrs:{perm:[0,2,1]}}),_.push(X)),s&&(Z=Zn({inputs:{x:N},backend:r,attrs:{perm:[0,2,1]}}),_.push(Z));const oe=p!==1,ae=p===1;let ce=X;oe&&(ce=ve({inputs:{x:X},backend:r,attrs:{shape:[A,O,1]}}),_.push(ce));const pe=p===1?2:1;let fe=Z;ae&&(fe=ve({inputs:{x:Z},backend:r,attrs:{shape:[A,1,O]}}),_.push(fe));const be=SC({inputs:{a:ce,b:fe},backend:r});te=Qx({inputs:{x:be},backend:r,attrs:{axis:pe,keepDims:!0}}),_.push(be)}else{const X=_s(t.dtype,e.dtype),Z=new qL(C,$,[A,f,p],n,s,W,U,G,q),oe=[T,N];if(i!=null&&oe.push(i),G&&oe.push(o),q){const ae=r.makeTensorInfo([],"float32",Jo(a,"float32"));oe.push(ae),_.push(ae)}te=r.runWebGLProgram(Z,oe,X)}const M=ve({inputs:{x:te},backend:r,attrs:{shape:w}});_.push(te);for(const X of _)r.disposeIntermediateTensorInfo(X);return M}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tle(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=s;return Um({a:r,b:i,transposeA:l,transposeB:c,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:d,activation:u})}const Ele={kernelName:bm,backendName:"webgl",kernelFunc:Tle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TN="return abs(x);";function _le(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const i=n.texData.get(s.dataId),o=WL(i.values);return n.makeTensorInfo(s.shape,s.dtype,o)}let r;return ee().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new wo(s.shape,TN):r=new ui(s.shape,TN),n.runWebGLProgram(r,[s],s.dtype)}const Rle={kernelName:Cg,backendName:"webgl",kernelFunc:_le};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ale=yr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Dle=ot({opSnippet:Ale}),Fle={kernelName:Yd,backendName:"webgl",kernelFunc:Dle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ole=yr+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Ple=ot({opSnippet:Ole}),Lle={kernelName:Qd,backendName:"webgl",kernelFunc:Ple};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EN="return a + b;",Mle=_n({opSnippet:EN,packedOpSnippet:EN,supportsComplex:!0,cpuKernelImpl:Xoe}),zle={kernelName:zc,backendName:"webgl",kernelFunc:Mle};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ble{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const s=[];this.variableNames.forEach(i=>{s.push(`float v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wle{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const s=[];this.variableNames.forEach(i=>{s.push(`vec4 v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Op(t){const{inputs:e,backend:n}=t,s=e;if(s.length===1)return As({inputs:{x:s[0]},backend:n});if(s.length>ee().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),c=Op({inputs:s.slice(0,l),backend:n}),u=Op({inputs:s.slice(l),backend:n});return Op({inputs:[c,u],backend:n})}const r=s.map(l=>l.dtype).reduce((l,c)=>_s(l,c)),i=s.map(l=>l.shape),a=ee().getBool("WEBGL_PACK")?new Wle(s[0].shape,i):new Ble(s[0].shape,i);return n.runWebGLProgram(a,s,r)}const jle={kernelName:Uv,backendName:"webgl",kernelFunc:Op};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vle(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=Qe(i,r.shape);let c=l;const u=Wt(c,a);let d=r;u!=null&&(d=Zn({inputs:{x:r},backend:n,attrs:{perm:u}}),c=qt(c.length,a)),En("all",c,a);const[h,f]=kn(d.shape,c),p=re(f),m=ve({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),g=Cl(m,m.dtype,"all",n);let x;if(o){const b=rn(h,l);x=ve({inputs:{x:g},backend:n,attrs:{shape:b}})}else x=ve({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),x}const Ule={kernelName:Gv,backendName:"webgl",kernelFunc:Vle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gle(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=Qe(i,r.shape);let c=l;const u=Wt(c,a);let d=r;u!=null&&(d=Zn({inputs:{x:r},backend:n,attrs:{perm:u}}),c=qt(c.length,a)),En("any",c,a);const[h,f]=kn(d.shape,c),p=re(f),m=ve({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),g=Cl(m,m.dtype,"any",n);let x;if(o){const b=rn(h,l);x=ve({inputs:{x:g},backend:n,attrs:{shape:b}})}else x=ve({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),x}const Hle={kernelName:Hv,backendName:"webgl",kernelFunc:Gle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kle{constructor(e,n,s){this.variableNames=["A"];const{windowSize:r,batchSize:i,outSize:o}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const a=n==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xle{constructor(e,n,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,R(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],o=Math.ceil(i/n);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,c=bt(l),u=Xn("coords",l);let d,h;if(o===1){h=l+1;const N=bt(h);d=`
        ${N} sourceLocR = ${N}(${u.join()}, 0);
        ++${u[l-1]};
        ${N} sourceLocG = ${N}(${u.join()}, 0);
        ++${u[l-2]};
        ${N} sourceLocA = ${N}(${u.join()}, 0);
        --${u[l-1]};
        ${N} sourceLocB = ${N}(${u.join()}, 0);
        --${u[l-2]};`}else h=l,d=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,h),p="."+f[h-1],m=f.map(N=>"int "+N),g=Xn("sourceLocR",h-1).concat("inIdx.r"),x=Xn("sourceLocG",h-1).concat("inIdx.g"),b=Xn("sourceLocB",h-1).concat("inIdx.b"),v=Xn("sourceLocA",h-1).concat("inIdx.a"),w=s==="max"?"greaterThan":"lessThan",C=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${v.join()})));`,$=`vec4(
            getAChannel(${g.join()}),
            hasNextCol ? getAChannel(${x.join()}) : 0.,
            hasNextRow ? getAChannel(${b.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,T=r?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${T}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${a[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${$};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${C}
          vec4 candidate = ${$};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${w}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QL(t,e,n,s=null){let r=e.shape[0],i=e.shape[1];s!=null&&(r=s.shape[0],i=s.shape[1]);const o=Dx(i),a={windowSize:o,inSize:i,batchSize:r,outSize:Math.ceil(i/o)},l=new Kle(a,n,s==null),c=[e];s!=null&&c.push(s);const u=t.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;const d=QL(t,e,n,u);return t.disposeIntermediateTensorInfo(u),d}function JL(t,e,n,s=null){const r=s!=null?s.shape:e.shape,i=r[r.length-1],o=Dx(i),a=new Xle(r,o,n,s==null),l=s==null?[e]:[e,s],c=t.runWebGLProgram(a,l,"int32");if(c.shape.length===e.shape.length){const u=JL(t,e,n,c);return t.disposeIntermediateTensorInfo(c),u}return c}function ZL(t,e,n,s){const r=[n];if(En("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!ee().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],o=t.texData.get(e.dataId),a=o!==null&&o.isPacked;let l=e;a&&(l=t.unpackTensor(e),i.push(l));const[c,u]=kn(l.shape,r),d=re(u),h=ve({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});i.push(h);const f=QL(t,h,s);i.push(f);const p=ve({inputs:{x:f},backend:t,attrs:{shape:c}});return i.forEach(m=>t.disposeIntermediateTensorInfo(m)),p}return JL(t,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qle(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;let o=Qe(i,r.shape);const a=Wt(o,r.shape.length);let l=r;const c=[];a!=null&&(l=Zn({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=qt(o.length,l.shape.length)),En("argMax",[o[0]],l.shape.length);const u=ZL(n,l,o[0],"max");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const Yle={kernelName:Sg,backendName:"webgl",kernelFunc:qle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qle(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;let o=Qe(i,r.shape);const a=Wt(o,r.shape.length);let l=r;const c=[];a!=null&&(l=Zn({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=qt(o.length,l.shape.length)),En("argMin",[o[0]],l.shape.length);const u=ZL(n,l,o[0],"min");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const Jle={kernelName:Ig,backendName:"webgl",kernelFunc:Qle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zle=yr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,ece=ot({opSnippet:Zle}),tce={kernelName:Jd,backendName:"webgl",kernelFunc:ece};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nce=yr+"return log(x + sqrt(x * x + 1.0));",sce=ot({opSnippet:nce}),rce={kernelName:Zd,backendName:"webgl",kernelFunc:sce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ice=yr+`
  return atan(x);
`,oce=ot({opSnippet:ice}),ace={kernelName:eh,backendName:"webgl",kernelFunc:oce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lce=CC+`
  return atan(a, b);
`,cce=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+kl+`
  return result;
`,uce=_n({opSnippet:lce,packedOpSnippet:cce}),dce={kernelName:nh,backendName:"webgl",kernelFunc:uce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hce=yr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,fce=ot({opSnippet:hce}),pce={kernelName:th,backendName:"webgl",kernelFunc:fce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zd{constructor(e,n,s,r=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const m=n==="avg",g=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,x=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let b="0.0";if(m||(b="-1.0 / 1e-20"),s){const N=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${N} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?i?g:x:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const v="max";let w=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(w="avgValue / max(count, 1.0)");const C=Math.floor(o/4)*4,$=o%4,T=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${v}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${p});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${C}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${T}
          }

          int xC = xCCorner + ${C};
          if (${$===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${T}
          } else if (${$===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${T}
          } else if (${$===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${T}
          }
        }
        setOutput(${w});
      }
    `}}class IC{constructor(e,n,s,r=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideDepth,l=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,d=e.dilationHeight,h=e.dilationWidth,f=e.effectiveFilterDepth,p=e.effectiveFilterHeight,m=e.effectiveFilterWidth,g=e.padInfo.front,x=e.padInfo.top,b=e.padInfo.left;this.outputShape=e.outShape;const v=n==="avg";let w="0.0";if(v||(w="-1.0 / 1e-20"),s){const A=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${c});
        const ivec3 pads = ivec3(${g}, ${x}, ${b});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${A} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const C="max";let $=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&($="avgValue / max(count, 1.0)");const T=Math.floor(o/4)*4,N=o%4,_=`
      if (${v}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${C}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${c});
      const ivec3 pads = ivec3(${g}, ${x}, ${b});
      const float initializationValue = ${w};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${w});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${T}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${_}
            }

            int xC = xCCorner + ${T};
            if (${N===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${_}
            } else if (${N===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${_}
            } else if (${N===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${_}
            }
          }
        }
        setOutput(${$});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mce(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;uf(r,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;R(zn(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=gr(r.shape,i,o,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&ft(u.inShape,u.outShape))return As({inputs:{x:r},backend:n});const d=new zd(u,"avg",!1);return n.runWebGLProgram(d,[r],"float32")}const gce={kernelName:$g,backendName:"webgl",kernelFunc:mce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xce(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s,u=[1,1,1],d=Yi(r.shape,i,o,u,a,l,c),h=new IC(d,"avg",!1);return n.runWebGLProgram(h,[r],"float32")}const yce={kernelName:Ng,backendName:"webgl",kernelFunc:xce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bce{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=l-1-e.padInfo.top,d=c-1-e.padInfo.left,h=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${d});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class vce{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=d-1-e.padInfo.front,m=h-1-e.padInfo.top,g=f-1-e.padInfo.left,x=1/(n*s*r);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${m}, ${g});
      const float avgMultiplier = float(${x});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wce(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,d=[1,1,1],h=Yi(o.shape,a,l,d,c,u),f=new vce(h);return n.runWebGLProgram(f,[r],o.dtype)}const kce={kernelName:Xv,backendName:"webgl",kernelFunc:wce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cce(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i;uf([r,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=gr(o.shape,a,l,1,c),d=new bce(u);return n.runWebGLProgram(d,[r],o.dtype)}const Sce={kernelName:Kv,backendName:"webgl",kernelFunc:Cce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ice(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i}=e,{transposeA:o,transposeB:a}=s;return Um({a:r,b:i,transposeA:o,transposeB:a,backend:n})}const $ce={kernelName:Tg,backendName:"webgl",kernelFunc:Ice};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nce{constructor(e,n,s,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],He(e,n),He(e,s);let a="0.0";r!=null&&(He(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";i!=null&&(He(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tce{constructor(e,n,s,r,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],He(e,n),He(e,s);let a="vec4(0.0)";r!=null&&(He(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(He(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ece=({inputs:t,backend:e,attrs:n})=>{const{x:s,mean:r,variance:i,offset:o,scale:a}=t;R(r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),R(o==null||r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),R(a==null||r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const c=[s,r,i];let u=null;o!=null&&(u=o.shape,c.push(o));let d=null;a!=null&&(d=a.shape,c.push(a));const h=ee().getBool("WEBGL_PACK_NORMALIZATION")?new Tce(s.shape,r.shape,i.shape,u,d,l):new Nce(s.shape,r.shape,i.shape,u,d,l);return e.runWebGLProgram(h,c,c[0].dtype)},_ce={kernelName:Bg,backendName:"webgl",kernelFunc:Ece};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rce{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=bt(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=Ace(this.rank);let r;const i=e.map((o,a)=>`sourceLoc.${v1[a]} = start[${a}] + coords.${v1[a]};`);r=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const v1=["x","y","z","w","u","v"];function Ace(t){if(t===1)return"sourceLoc";if(t<=6)return v1.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dce{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=bt(this.rank),s=Xn("coords",this.rank),r=Xn("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,o=`getChannel(getSource(${r.join()}), ${i})`,a=`
      result.x = ${o};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${o};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${o};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${o};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((u,d)=>`start[${d}]`).join()});`:e.map((u,d)=>`${r[d]} = ${s[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fce(t,e,n,s){const r=s.texData.get(t.dataId),i=s.makeTensorInfo(n,t.dtype),o=s.texData.get(i.dataId);Object.assign(o,r),o.refCount=1,o.shape=n,o.dtype=t.dtype;let a=vk(e,Fe(t.shape));r.slice&&(a+=r.slice.flatOffset),o.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||t.dataId};const l=s.dataRefCount.get(o.slice.origDataId)||1;return s.dataRefCount.set(o.slice.origDataId,l+1),i}function Zc(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,size:o}=s,[a,l]=Ax(r,i,o);if(xk(r,a,l),re(l)===0)return n.makeTensorInfo(l,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||r.dtype==="string"){const d=n.texData.get(r.dataId),h=$ae(d.values,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,h)}const{isPacked:c}=n.texData.get(r.dataId),u=bk(r.shape,a,l);if(c||!u){const d=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Dce(l):new Rce(l),h=[a];return n.runWebGLProgram(d,[r],r.dtype,h)}return n.uploadToGPU(r.dataId),Fce(r,a,l,n)}const Oce={kernelName:mx,backendName:"webgl",kernelFunc:Zc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pce=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,crops:o}=s;R(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((b,v)=>b*v),l=Yh(r.shape,i,a),c=Qh(l.length,i.length),u=Jh(r.shape,i,a),d=Ik(o,i.length),h=$k(u,o,i.length),f=[],p=ve({inputs:{x:r},backend:n,attrs:{shape:l}}),m=Zn({inputs:{x:p},backend:n,attrs:{perm:c}}),g=ve({inputs:{x:m},backend:n,attrs:{shape:u}}),x=Zc({inputs:{x:g},backend:n,attrs:{begin:d,size:h}});return f.push(p),f.push(m),f.push(g),f.forEach(b=>n.disposeIntermediateTensorInfo(b)),x},Lce={kernelName:Eg,backendName:"webgl",kernelFunc:Pce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mce(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o}=s,a=n.readSync(r.dataId),l=n.readSync(i.dataId),c=BL(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const zce={kernelName:qv,backendName:"webgl",kernelFunc:Mce};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bce=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Wce=`
  return float(int(a.r) & int(b.r));
`;function jce(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,i=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=ee().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([s,r])||o===1){const l=n.texData.get(s.dataId).values,c=n.texData.get(r.dataId).values,[u,d]=Yoe(s.shape,r.shape,l,c,s.dtype),h=n.makeTensorInfo(d,s.dtype),f=n.texData.get(h.dataId);return f.values=u,h}let a;return i?a=new Qc(Bce,s.shape,r.shape,!1):a=new ol(Wce,s.shape,r.shape),n.runWebGLProgram(a,[s,r],s.dtype)}const Vce={kernelName:Yv,backendName:"webgl",kernelFunc:jce};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uce(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,i=n.readSync(s.dataId),o=n.readSync(r.dataId),a=He(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Gce={kernelName:WR,backendName:"webgl",kernelFunc:Uce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hce="return float(a != b);",eM=_n({opSnippet:Hce,cpuKernelImpl:xae,dtype:"bool"}),Kce={kernelName:sx,backendName:"webgl",kernelFunc:eM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hf(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return As({inputs:{x:r.complexTensorInfos.real},backend:n})}const Xce={kernelName:ww,backendName:"webgl",kernelFunc:hf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qce="return float(int(x));";function Yce(t,e){const n=new ui(t.shape,qce),s=e.runWebGLProgram(n,[t],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w1(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return As({inputs:{x:r},backend:n});const o=bn(r.shape),a=w1({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),l=oa({inputs:{real:a,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(a),l}if(r.dtype==="complex64"){const o=hf({inputs:{input:r},backend:n}),a=w1({inputs:{x:o},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(o),a}if(!PR(r.dtype,i)){const o=As({inputs:{x:r},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:i}}if(n.shouldExecuteOnCPU([r])){const o=n.texData.get(r.dataId).values,[a,l,c]=Qoe(o,r.shape,r.dtype,i);return n.makeTensorInfo(a,l,c)}if(i==="int32")return Yce(r,n);if(i==="bool"){const o=n.makeTensorInfo([],"bool",Pn("bool",1)),l=eM({inputs:{a:r,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${i}`)}const Qce={kernelName:sh,backendName:"webgl",kernelFunc:w1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _N="return ceil(x);",Jce=ot({opSnippet:_N,packedOpSnippet:_N,cpuKernelImpl:Joe}),Zce={kernelName:rh,backendName:"webgl",kernelFunc:Jce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eue{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tue{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{clipValueMin:i,clipValueMax:o}=s;let a;ee().getBool("WEBGL_PACK_CLIP")?a=new tue(r.shape):a=new eue(r.shape);const l=[[i],[o]];return n.runWebGLProgram(a,[r],r.dtype,l)}const sue={kernelName:ih,backendName:"webgl",kernelFunc:nue};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rue{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RN(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function iue(t){const{inputs:e,backend:n}=t,{x:s}=e,r=n.texData.get(s.dataId),i=new rue(s.shape),o=[RN(s,r.complexTensorInfos.real),RN(s,r.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}const oue={kernelName:_g,backendName:"webgl",kernelFunc:iue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aue{constructor(e){this.outputShape=[],this.outputShape=gi(e,1),this.variableNames=e.map((o,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+e[o][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const a=n[o-1];s.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${a}));`)}const r=n.length,i=n[n.length-1];s.push(`else setOutput(getT${r}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lue{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=gi(e,n);const s=this.outputShape,r=s.length,i=bt(r),o=Xn("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((m,g)=>`T${g}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let m=1;m<l.length;m++)l[m]=l[m-1]+e[m][n];const c=a[n],u=a.slice(-2),d=a.join();let h=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${u.join()}));
        }`;for(let m=1;m<l.length;m++){const g=l[m-1];h+=`
        if (${c} < ${l[m]}  && ${c} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${mp(a,c,g)}),
            vec2(${mp(u,c,g)}));
        }`}const f=l.length,p=l[l.length-1];h+=`
        return getChannel(
          getT${f}(${mp(a,c,p)}),
          vec2(${mp(u,c,p)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${h}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[r-1]} = ${o[r-1]} + 1;
        if (${o[r-1]} < ${s[r-1]}) {
          result.g = getValue(${o});
        }

        ${o[r-2]} = ${o[r-2]} + 1;
        if (${o[r-2]} < ${s[r-2]}) {
          result.a = getValue(${o});
        }

        ${o[r-1]} = ${o[r-1]} - 1;
        if (${o[r-2]} < ${s[r-2]} &&
            ${o[r-1]} < ${s[r-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function mp(t,e,n){const s=t.indexOf(e);return t.map((i,o)=>o===s?`${i} - ${n}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jx(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return As({inputs:{x:r.complexTensorInfos.imag},backend:n})}const cue={kernelName:fw,backendName:"webgl",kernelFunc:Jx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zu(t,e,n){const s=t[0].dtype;if(s==="complex64"){const f=t.map(b=>hf({inputs:{input:b},backend:n})),p=t.map(b=>Jx({inputs:{input:b},backend:n})),m=zu(f,e,n),g=zu(p,e,n),x=oa({inputs:{real:m,imag:g},backend:n});return f.forEach(b=>n.disposeIntermediateTensorInfo(b)),p.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),x}let r=n.shouldExecuteOnCPU(t);if(s==="string"&&(r=!0),r){const f=t.map(w=>{const $=[-1,re(w.shape.slice(e))];return ve({inputs:{x:w},backend:n,attrs:{shape:$}})}),p=f.map(w=>({vals:n.readSync(w.dataId),shape:w.shape})),m=gi(f.map(w=>w.shape),1),g=f[0].shape[0]===1,x=Zoe(p,m,s,g),b=gi(t.map(w=>w.shape),e),v=n.makeTensorInfo(b,s,x);return f.forEach(w=>n.disposeIntermediateTensorInfo(w)),v}const i=t.filter(f=>re(f.shape)>0),o=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const f=o?new ui(t[0].shape,lo):new wo(t[0].shape,lo);return n.runWebGLProgram(f,t,s)}const a=ee().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>a){const f=[];for(let m=0;m<i.length;m+=a){const g=i.slice(m,m+a);f.push(zu(g,e,n))}const p=zu(f,e,n);for(const m of f)n.disposeIntermediateTensorInfo(m);return p}if(o){const f=new lue(i.map(p=>p.shape),e);return n.runWebGLProgram(f,i,s)}const{tensors2D:l,outShape:c}=uue(i,e,n),u=new aue(l.map(f=>f.shape)),d=n.runWebGLProgram(u,l,s);l.forEach(f=>n.disposeIntermediateTensorInfo(f));const h=ve({inputs:{x:d},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(d),h}function uue(t,e,n){const s=gi(t.map(i=>i.shape),e);return{tensors2D:t.map(i=>ve({inputs:{x:i},attrs:{shape:[-1,re(i.shape.slice(e))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tM(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,i=Qe(r,e[0].shape)[0],o=e.map(c=>c.shape);kk(o,i);const a=gi(e.map(c=>c.shape),i);if(re(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(c=>re(c.shape)>0);return l.length===1?As({inputs:{x:l[0]},backend:n}):zu(l,i,n)}const due={kernelName:Rg,backendName:"webgl",kernelFunc:tM};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nM{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,d=e.dilationWidth,h=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4,g=e.dataFormat==="channelsLast",x=g?1:2,b=g?2:3,v=g?3:1;let w="",C="";s&&(r?w=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?w=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:w=`
          float activation(float x) {
            ${s}
          }
        `,C="result = activation(result);");const $=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${w}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${v}];

        ivec2 xRCCorner =
            ivec2(coords[${x}], coords[${b}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${g}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${g}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${g}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${g}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${$}
        ${C}
        setOutput(result);
      }
    `}}class hue{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${o}, ${a});
      const ivec3 pads = ivec3(${n}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sM{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Wn(this.outputShape.length);const o=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,d=u;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<u;g++)h+=`
           vec4 xTexelC${g*2};
           int xTexelC${g*2}Ready;
           vec4 xTexelC${g*2+1};
           int xTexelC${g*2+1}Ready;
           vec4 xC${g};`;h+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let g=0;g<u;g++)h+=`
           xTexelC${g*2} = vec4(0.0);
           xTexelC${g*2}Ready = 0;
           xTexelC${g*2+1} = vec4(0.0);
           xTexelC${g*2+1}Ready = 0;
           xC${g} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let g=0;g<(d+1)/2;g++){const x=g*2;if(h+=`
           xC = xCCorner + ${x*l};
           `,a===1){if(x<u&&(o%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }
               `,l===1&&x>0?h+=`
                 xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                   } else {
                     xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xC${x} = xTexelC${x};
                 `,x+1<u)){const b=o%2===0?zv(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${b};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                     xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${x+1}.zw = vec2(0.0);
                     }
                     xTexelC${x+1}Ready = 1;
                   }
                   `,l>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                     } else {
                      xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                     }
                     `:h+=`
                     xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                     `):b===1?h+=`
                     xC${x+1} = xTexelC${x};
                     `:h+=`
                     xCOffset = xC + ${b};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                       xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${x+1}.zw = vec2(0.0);
                       }
                       xTexelC${x+1}Ready = 1;
                     }

                     xC${x+1} = xTexelC${x+1};
                     `}}else x<u&&(o%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.0);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
               `,x+1<u&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(
                   xTexelC${x}.xy, xTexelC${x+1}.xy);
               `,x+1<u&&(h+=`
                   xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                 `)));x<u&&(h+=`
             wTexel = getW(r, ${x}, d1, d2);
             dotProd += xC${x}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${x}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,x+1<u&&(h+=`
               wTexel = getW(r, ${x+1}, d1, d2);
               dotProd += xC${x+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${x+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let f="",p="";s&&(r?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:i?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:f=`vec4 activation(vec4 x) {
           ${s}
         }`,p="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fue{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Wn(this.outputShape.length);const{dataFormat:s}=n,r=es(),i=s==="channelsLast",o=i?1:2,a=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let u=0;u<=1;u++)for(let d=0;d<=1;d++)c+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${u};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gm(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function rM({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const l=t.shape,c=s.texData.get(t.dataId),u=n.inChannels,d=l[0]*l[1]*l[2],h=n.outChannels,f=n.dataFormat==="channelsLast",p=!1,m=!1;let g;const x=[];if(i!=null){const w=Gm(i.shape,f);w!=null&&(i=ve({inputs:{x:i},backend:s,attrs:{shape:w}}),x.push(i))}if(r!=null){const w=Gm(r.shape,f);w!=null&&(r=ve({inputs:{x:r},backend:s,attrs:{shape:w}}),x.push(r))}if(!((d===1||h===1)&&u>YL)&&c.isPacked&&f&&c.texture!=null&&l[2]%2!==0&&ft(c.shape.slice(-3),l.slice(-3))){const w=l[0]*l[1]*(l[2]+1),C={dataId:t.dataId,shape:[1,w,n.inChannels],dtype:t.dtype},$=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,R(Vm(c.shape,C.shape),()=>`packed reshape ${c.shape} to ${C.shape} isn't free`);const T=ve({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});x.push(T);const N=Um({a:C,b:T,backend:s,transposeA:p,transposeB:m,bias:r,activation:a,preluActivationWeights:i,leakyreluAlpha:o}),_=s.texData.get(N.dataId);R(_.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=$,_.shape=n.outShape,g=As({inputs:{x:N},backend:s}),g.shape=n.outShape,x.push(N)}else{const w=n.outHeight*n.outWidth,C=ve({inputs:{x:t},backend:s,attrs:{shape:f?[n.batchSize,w,n.inChannels]:[n.batchSize,n.inChannels,w]}}),$=ve({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),T=Um({a:f?C:$,b:f?$:C,transposeA:!f,transposeB:m,backend:s,bias:r,activation:a,preluActivationWeights:i,leakyreluAlpha:o});g=ve({inputs:{x:T},backend:s,attrs:{shape:n.outShape}}),x.push(C),x.push($),x.push(T)}for(const w of x)s.disposeIntermediateTensorInfo(w);return g}function iM({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:l,filterHeight:c,inChannels:u,outWidth:d,outHeight:h,dataFormat:f}=n,p=f==="channelsLast",m=l*c*u,g=h*d,x=[n.batchSize,m,g],b=!0,v=!1,w=[];if(i!=null){const M=Gm(i.shape,p);M!=null&&(i=ve({inputs:{x:i},backend:s,attrs:{shape:M}}),w.push(i))}if(r!=null){const M=Gm(r.shape,p);M!=null&&(r=ve({inputs:{x:r},backend:s,attrs:{shape:M}}),w.push(r))}const C=ve({inputs:{x:e},backend:s,attrs:{shape:[1,m,re(e.shape)/m]}});w.push(C);const $=new fue(x,n),T=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],N=s.runWebGLProgram($,[t],"float32",T),_=ve({inputs:{x:N},backend:s,attrs:{shape:x}});w.push(N),w.push(_);const A=r!=null,O=i!=null,W=a==="leakyrelu",G=a?Md(a,!0):null,q=new qL(p?_.shape:C.shape,p?C.shape:_.shape,p?[n.batchSize,g,n.outChannels]:[n.batchSize,n.outChannels,g],b,v,A,G,O,W),U=p?[_,C]:[C,_];if(r&&U.push(r),O&&U.push(i),W){const M=s.makeTensorInfo([],"float32",Jo(o,"float32"));U.push(M),w.push(M)}const Y=s.runWebGLProgram(q,U,"float32"),te=ve({inputs:{x:Y},backend:s,attrs:{shape:n.outShape}});w.push(Y);for(const M of w)s.disposeIntermediateTensorInfo(M);return te}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s,d=Qi(l),h=Tn(r.shape,i.shape,o,c,a,u,!1,d);let f;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))f=rM({x:r,filter:i,convInfo:h,backend:n});else if(h.strideWidth<=2&&d==="channelsLast"&&ee().getBool("WEBGL_EXP_CONV")){const m=new sM(h),g=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];f=n.runWebGLProgram(m,[r,i],"float32",g)}else if(ee().getBool("WEBGL_CONV_IM2COL"))f=iM({x:r,filter:i,convInfo:h,backend:n});else{const m=new nM(h);f=n.runWebGLProgram(m,[r,i],"float32")}const p=ve({inputs:{x:f},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(f),p}const mue={kernelName:Ag,backendName:"webgl",kernelFunc:pue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gue{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class xue{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=s-1-e.padInfo.left,c=o?1:2,u=o?2:3,d=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class yue{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class bue{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,c=s-1-e.padInfo.top,u=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s,d=Qi(l),h=Tn(r.shape,u,o,1,a,c,!1,d),f=new gue(h);return n.runWebGLProgram(f,[r,i],"float32")}const wue={kernelName:Jv,backendName:"webgl",kernelFunc:vue};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kue{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Wn(this.outputShape.length);const n=e.filterHeight,s=e.filterWidth,r=n-1-e.padInfo.top,i=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cue(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s,d=Qi(c),h=Tn(o,i.shape,a,1,l,u,!1,d);if(ee().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const f=[[h.strideHeight,h.strideWidth]],p=new kue(h);return n.runWebGLProgram(p,[r,i],"float32",f)}else{const f=new xue(h);return n.runWebGLProgram(f,[r,i],"float32")}}const Sue={kernelName:Dg,backendName:"webgl",kernelFunc:Cue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s,c=Zo(r.shape,i.shape,o,l,a),u=new hue(c);return n.runWebGLProgram(u,[r,i],"float32")}const $ue={kernelName:Fg,backendName:"webgl",kernelFunc:Iue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,filterShape:l}=s,c=Zo(r.shape,l,o,1,a),u=new yue(c);return n.runWebGLProgram(u,[r,i],"float32")}const Tue={kernelName:Zv,backendName:"webgl",kernelFunc:Nue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eue(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{pad:o,strides:a,inputShape:l}=s,c=Zo(l,i.shape,a,1,o),u=new bue(c);return n.runWebGLProgram(u,[r,i],"float32")}const _ue={kernelName:ew,backendName:"webgl",kernelFunc:Eue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rue=Jc+`
  return cos(x);
`,Aue=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${kl}
  return result;
`,Due=ot({opSnippet:Rue,packedOpSnippet:Aue}),Fue={kernelName:oh,backendName:"webgl",kernelFunc:Due};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oue=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Pue=ot({opSnippet:Oue}),Lue={kernelName:ah,backendName:"webgl",kernelFunc:Pue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mue{constructor(e,n,s,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,l,c]=e,[u]=n,[d,h]=s;this.outputShape=[u,d,h,c];const f=r==="bilinear"?1:0,[p,m]=[`${a-1}.0`,`${l-1}.0`],[g,x,b]=d>1?[`${(a-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[v,w,C]=h>1?[`${(l-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${g});
      const float width_ratio = float(${v});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${x};
        float width_scale = ${w};

        float in_y = ${b};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${C};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zue=t=>{const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=s,u=new Mue(r.shape,i.shape,a,l,c);return n.runWebGLProgram(u,[r,i,o],"float32")},Bue={kernelName:nw,backendName:"webgl",kernelFunc:zue};var Bd;(function(t){t.Prod="*",t.Sum="+"})(Bd||(Bd={}));class AN{constructor(e,n,s,r){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===Bd.Prod?"1.0":"0.0",a=s?o:`getX(${DN(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",u="";s?(c=r?`end != ${l-1}`:"end != 0",u=r?"end + 1":"end - 1"):(c=r?`end + pow2 < ${l}`:"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${bt(i)} coords = getOutputCoords();
        int end = ${FN(i,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${u};
          ${FN(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${DN(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function DN(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function FN(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oM(t,e,n,s,r,i){const o=e.shape.length,a=Wt([s],o);let l=e;a!=null&&(l=Zn({inputs:{x:e},backend:n,attrs:{perm:a}}));const c=qt(1,o)[0];if(c!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const u=l.shape[c];let d=As({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(u))-1;h++){const f=new AN(t,l.shape,!1,i),p=[[h]],m=d;d=n.runWebGLProgram(f,[d],d.dtype,p),n.disposeIntermediateTensorInfo(m)}if(r){const h=new AN(t,l.shape,r,i),f=d;d=n.runWebGLProgram(h,[d],d.dtype),n.disposeIntermediateTensorInfo(f)}if(a!=null){const h=ea(a),f=Zn({inputs:{x:d},backend:n,attrs:{perm:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),f}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;return oM(Bd.Prod,r,n,i,o,a)}const jue={kernelName:tw,backendName:"webgl",kernelFunc:Wue};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;return oM(Bd.Sum,r,n,i,o,a)}const Uue={kernelName:Og,backendName:"webgl",kernelFunc:Vue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o,binaryOutput:a}=s;if(r.shape.length===1){const l=n.readSync(r.dataId),c=n.readSync(i.dataId),u=BL(l,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(i),u=qoe(l,c,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const Hue={kernelName:sw,backendName:"webgl",kernelFunc:Gue};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kue{constructor(e,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:i,dataFormat:o}=s,a=r.shape[0],l=o==="NHWC"?r.shape[1]:r.shape[2],c=o==="NHWC"?r.shape[2]:r.shape[3],u=o==="NHWC"?r.shape[3]:r.shape[1],d=l*i,h=c*i,f=u/(i*i),p=o==="NHWC"?[a,d,h,f]:[a,f,d,h],m=new Kue(p,i,o);return n.runWebGLProgram(m,[r],r.dtype)}const que={kernelName:rw,backendName:"webgl",kernelFunc:Xue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aM{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Wn(this.outputShape.length);const o=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let c="",u="";s&&(r?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:c=`
          float activation(float x) {
            ${s}
          }
        `,u="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lM{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Wn(this.outputShape.length);const o=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,u=e.filterHeight,d=e.filterWidth,h=d;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<d;x++)f+=`
          vec4 xTexelC${x*2};
          int xTexelC${x*2}Ready;
          vec4 xTexelC${x*2+1};
          int xTexelC${x*2+1}Ready;
          vec4 xC${x};`;f+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let x=0;x<d;x++)f+=`
          xTexelC${x*2} = vec4(0.0);
          xTexelC${x*2}Ready = 0;
          xTexelC${x*2+1} = vec4(0.0);
          xTexelC${x*2+1}Ready = 0;
          xC${x} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let x=0;x<(h+1)/2;x++){const b=x*2;if(f+=`
          xC = xCCorner + ${b*c};
          `,l===1){if(b<d&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }
              `,c===1&&b>0?f+=`
                xC${b} = vec4(xTexelC${b-2}.zw, xTexelC${b}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${b} = vec4(previous.zw, xTexelC${b}.xy);
                  } else {
                    xC${b} = vec4(0.0, 0.0, xTexelC${b}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                xC${b} = xTexelC${b};
                `,b+1<d)){const v=a%2===0?zv(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${v};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                    xTexelC${b+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${b+1}.zw = vec2(0.0);
                    }
                    xTexelC${b+1}Ready = 1;
                  }
                  `,c>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${b+1} = vec4(previous.zw, xTexelC${b+1}.xy);
                    } else {
                     xC${b+1} = vec4(0.0, 0.0, xTexelC${b+1}.xy);
                    }
                    `:f+=`
                    xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.xy);
                    `):v===1?f+=`
                    xC${b+1} = xTexelC${b};
                    `:f+=`
                    xCOffset = xC + ${v};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                      xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${b+1}.zw = vec2(0.0);
                      }
                      xTexelC${b+1}Ready = 1;
                    }

                    xC${b+1} = xTexelC${b+1};
                    `}}else b<d&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${b+1}Ready == 0) {
                  xTexelC${b+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${b+1}.zw = vec2(0.0);
                  }
                  xTexelC${b+1}Ready = 1;
                }

                xC${b} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
              `,b+1<d&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${b+1} = vec4(xTexelC${b+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                  xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b+1}.zw = vec2(0.);
                  }
                  xTexelC${b+1}Ready = 1;
                }

                xC${b} = vec4(
                  xTexelC${b}.xy, xTexelC${b+1}.xy);
              `,b+1<d&&(f+=`
                  xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
                `)));b<d&&(f+=`
            wTexel = getW(r, ${b}, d1, q);
            dotProd += xC${b} * vec4(wTexel.xz, wTexel.xz);
          `,b+1<d&&(f+=`
              wTexel = getW(r, ${b+1}, d1, q);
              dotProd += xC${b+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let p="",m="";s&&(r?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:p=`vec4 activation(vec4 x) {
          ${s}
        }`,m="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${g}
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=s;let u=l;u==null&&(u=[1,1]),R(zn(o,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const d=Tn(r.shape,i.shape,o,u,a,c,!0);let h;ee().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?h=new lM(d):h=new aM(d);const f=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[r,i],"float32",f)}const Que={kernelName:Pg,backendName:"webgl",kernelFunc:Yue};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jue{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Zue{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=n-1-e.padInfo.top,a=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ede(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s,d=Tn(r.shape,u,o,a,l,c,!0),h=new Jue(d);return n.runWebGLProgram(h,[r,i],"float32")}const tde={kernelName:iw,backendName:"webgl",kernelFunc:ede};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nde(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s,d=Tn(u,i.shape,o,a,l,c,!0),h=new Zue(d);return n.runWebGLProgram(h,[r,i],"float32")}const sde={kernelName:ow,backendName:"webgl",kernelFunc:nde};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rde{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ide(t){const{inputs:e,backend:n}=t,{x:s}=e,r=[...s.shape,...s.shape],i=re(s.shape),o=ve({inputs:{x:s},backend:n,attrs:{shape:[i]}}),a=new rde(i),l=n.runWebGLProgram(a,[o],o.dtype),c=ve({inputs:{x:l},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}const ode={kernelName:jR,backendName:"webgl",kernelFunc:ide};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ade{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:s,padInfo:r,strideHeight:i,strideWidth:o,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:u}=e,{top:d,left:h}=r;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${d}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lde(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s,c=Gh(r.shape,i.shape,o,a,"NHWC",l);let u;const d=new ade(c);u=n.runWebGLProgram(d,[r,i],"float32");const h=ve({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),h}const cde={kernelName:Lg,backendName:"webgl",kernelFunc:lde};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ude(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,i=e,{allDims:o,summedDims:a,idDims:l}=Fk(r,i.length);Pk(o.length,l,i);const{path:c,steps:u}=Lk(a,l),d=u.length;let h=null,f=o.length;const p=[];for(let m=0;m<d;++m){for(const g of u[m]){const{permutationIndices:x,expandDims:b}=Ok(f,l[g]);let v;Mk(x)?v=i[g]:(v=Zn({inputs:{x:i[g]},backend:n,attrs:{perm:x}}),p.push(v));const w=v.shape.slice();for(let C=0;C<b.length;++C)w.splice(b[C],0,1);ft(v.shape,w)||(v=ve({inputs:{x:v},backend:n,attrs:{shape:w}}),p.push(v)),h===null?h=v:(h=SC({inputs:{a:v,b:h},backend:n}),p.push(h))}m<d-1&&(c[m]>=0&&(h=Qx({inputs:{x:h},backend:n,attrs:{axis:c[m]-(o.length-f),keepDims:!1}}),p.push(h)),f--)}for(const m of p)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const dde={kernelName:aw,backendName:"webgl",kernelFunc:ude};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hde="return (x >= 0.0) ? x : (exp(x) - 1.0);",fde=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,pde=ot({opSnippet:hde,packedOpSnippet:fde}),mde={kernelName:ch,backendName:"webgl",kernelFunc:pde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gde="return (b >= 0.0) ? a : a * (b + 1.0);",xde=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,yde=t=>{const{inputs:e,backend:n}=t,{dy:s,y:r}=e,i=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Qc(xde,s.shape,r.shape):new ol(gde,s.shape,r.shape);return n.runWebGLProgram(i,[s,r],s.dtype)},bde={kernelName:lw,backendName:"webgl",kernelFunc:yde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vde=`
  return vec4(equal(a, b));
`,wde="return float(a == b);",kde=_n({opSnippet:wde,packedOpSnippet:vde,dtype:"bool",cpuKernelImpl:eae}),Cde={kernelName:Mg,backendName:"webgl",kernelFunc:kde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sde=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${Nk};
  float a1 = ${Tk};
  float a2 = ${Ek};
  float a3 = ${_k};
  float a4 = ${Rk};
  float a5 = ${Ak};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,Ide=ot({opSnippet:Sde}),$de={kernelName:uh,backendName:"webgl",kernelFunc:Ide};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nde=Jc+`
  return exp(x);
`,Tde=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,cM=ot({opSnippet:Nde,packedOpSnippet:Tde,cpuKernelImpl:tae,dtype:"float32"}),Ede={kernelName:dh,backendName:"webgl",kernelFunc:cM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k1(t){const{inputs:e,attrs:n,backend:s}=t,{dim:r}=n,{input:i}=e,o=i.shape.length,a=i.shape.slice();let l=r;return r<0&&(R(-(o+1)<=r,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+r+1),a.splice(l,0,1),ve({inputs:{x:i},backend:s,attrs:{shape:a}})}const _de={kernelName:zg,backendName:"webgl",kernelFunc:k1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ON="return exp(x) - 1.0;",Rde=ot({opSnippet:ON,packedOpSnippet:ON,cpuKernelImpl:nae}),Ade={kernelName:hh,backendName:"webgl",kernelFunc:Rde};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PN{constructor(e,n,s){this.variableNames=["real","imag"];const r=n[1];this.outputShape=n;const i=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=s?`${r}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uM(t,e,n){const s=n.texData.get(t.dataId),r=re(t.shape),i=t.shape[t.shape.length-1],o=r/i,a=ve({inputs:{x:t},backend:n,attrs:{shape:[o,i]}}),l=a.shape,c=new PN("real",l,e),u=new PN("imag",l,e),d=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],h=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(u,d,"float32"),p=oa({inputs:{real:h,imag:f},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f);const m=ve({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dde(t){const{inputs:e,backend:n}=t,{input:s}=e;return uM(s,!1,n)}const Fde={kernelName:cw,backendName:"webgl",kernelFunc:Dde};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ode{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ff(t){const{backend:e,attrs:n}=t,{shape:s,value:r}=n;let{dtype:i}=n;if(i=i||Lc(r),i==="string"){const o=Ht(i,re(s));return o.fill(r),e.makeTensorInfo(s,i,o)}else{const o=new Ode(s,r),a=[[r]];return e.runWebGLProgram(o,[],i,a)}}const Pde={kernelName:uw,backendName:"webgl",kernelFunc:ff};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lde{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mde={kernelName:dw,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,s=e,r=new Lde(n.shape);return s.runWebGLProgram(r,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LN="return floor(x);",zde=ot({opSnippet:LN,packedOpSnippet:LN,cpuKernelImpl:sae}),Bde={kernelName:fh,backendName:"webgl",kernelFunc:zde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wde=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,jde=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,Vde=_n({opSnippet:Wde,packedOpSnippet:jde,dtype:"int32"}),Ude={kernelName:ph,backendName:"webgl",kernelFunc:Vde};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gde{constructor(e){this.variableNames=["A"];const n=es(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hde{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=es(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kde={kernelName:dH,backendName:"webgl",kernelFunc:Xde};let Rl,Sy=ee().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Xde(t){const{inputs:e,backend:n,attrs:s}=t;let{pixels:r}=e;const{numChannels:i}=s,o=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,c]=o?[r.videoWidth,r.videoHeight]:[r.width,r.height],u=[c,l],d=[c,l,i];if(a||o){const m=ee().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Rl==null||m!==Sy)&&(Sy=m,Rl=document.createElement("canvas").getContext("2d",{willReadFrequently:Sy})),Rl.canvas.width=l,Rl.canvas.height=c,Rl.drawImage(r,0,0,l,c),r=Rl.canvas}const h=n.makeTensorInfo(u,"int32");n.texData.get(h.dataId).usage=Ms.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),r);const f=ee().getBool("WEBGL_PACK")?new Hde(d):new Gde(d),p=n.runWebGLProgram(f,[h],"int32");return n.disposeData(h.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qde(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s,m=Qi(u),g=Tn(r.shape,i.shape,l,d,c,h,!1,m);let x;const b=[],v=o!=null,w=a!=null,C=f==="leakyrelu",$=()=>{const N=[r,i],_=(A,O)=>{if(O==="NCHW"&&A.shape.length===1&&A.shape[0]!==1){const W=ve({inputs:{x:A},backend:n,attrs:{shape:[A.shape[0],1,1]}});return b.push(W),W}return A};if(v&&N.push(_(o,u)),w&&N.push(_(a,u)),C){const A=n.makeTensorInfo([],"float32",Jo(p,"float32"));N.push(A),b.push(A)}return N};if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type==="SAME"||g.padInfo.type==="VALID"))x=rM({x:r,filter:i,convInfo:g,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else if(g.strideWidth<=2&&m==="channelsLast"&&ee().getBool("WEBGL_EXP_CONV")){const N=f?Md(f,!0):null,_=new sM(g,v,N,w,C),A=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],O=$();x=n.runWebGLProgram(_,O,"float32",A)}else if(ee().getBool("WEBGL_CONV_IM2COL"))x=iM({x:r,filter:i,convInfo:g,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else{const N=f?Md(f,!1):null,_=new nM(g,v,N,w,C),A=$();x=n.runWebGLProgram(_,A,"float32")}const T=ve({inputs:{x},backend:n,attrs:{shape:g.outShape}});return b.push(x),b.forEach(N=>n.disposeIntermediateTensorInfo(N)),T}const Yde={kernelName:vm,backendName:"webgl",kernelFunc:qde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qde(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dilations:u,dimRoundingMode:d,activation:h,leakyreluAlpha:f}=s,p=[];let m=u;m==null&&(m=[1,1]),R(zn(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);const g=Tn(r.shape,i.shape,l,m,c,d,!0),x=ee().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,b=h?Md(h,x):null,v=[r,i],w=o!=null,C=a!=null,$=h==="leakyrelu";if(w&&v.push(o),C&&v.push(a),$){const A=n.makeTensorInfo([],"float32",Jo(f,"float32"));v.push(A),p.push(A)}let T;x?T=new lM(g,w,b,C,$):T=new aM(g,w,b,C,$);const N=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],_=n.runWebGLProgram(T,v,"float32",N);return p.forEach(A=>n.disposeIntermediateTensorInfo(A)),_}const Jde={kernelName:aA,backendName:"webgl",kernelFunc:Qde};class Zde{constructor(e,n,s,r){this.sliceDim=e,this.strides=n,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const i=bt(s.length);let o=`
    int index;`;for(let a=0;a<this.sliceDim;a++)o+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ehe(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,i=r.shape,o=i[i.length-1],a=re(s.shape),[l,c,u,d]=gk(s,r),h=ve({inputs:{x:r},backend:n,attrs:{shape:[c,o]}}),f=ve({inputs:{x:s},backend:n,attrs:{shape:[re(s.shape)/u,u]}});if(n.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const x=n.readSync(r.dataId),b=n.bufferSync(s),v=rae(x,b,s.dtype,c,o,u,d,s.shape,a);return n.makeTensorInfo(l,s.dtype,v.values)}const p=new Zde(o,d,[c,u],s.shape),m=n.runWebGLProgram(p,[f,h],f.dtype),g=ve({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}const the={kernelName:VR,backendName:"webgl",kernelFunc:ehe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nhe{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=bt(this.rank),r=she(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function she(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<t.length;r++)r===2?s.push("index"):s.push(`${n[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dM(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:i}=e,{axis:o,batchDims:a}=s,l=Qe(o,r.shape)[0];if(ee().get("DEBUG")){const b=n.readSync(i.dataId),v=r.shape[l];for(let w=0;w<b.length;++w){const C=b[w];R(C<=v-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${v-1}]`)}}const c=Bk(r,i,l,a),u=re(i.shape),d=[],h=ve({inputs:{x:r},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=ve({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});d.push(h),d.push(f);const p=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([r,i])||r.dtype==="string"){const b=n.bufferSync(f),v=n.bufferSync(h),w=iae(v,b,p);return d.forEach(C=>n.disposeIntermediateTensorInfo(C)),n.makeTensorInfo(c.outputShape,w.dtype,w.values)}const m=new nhe(h.shape,p),g=n.runWebGLProgram(m,[h,f],h.dtype);d.push(g);const x=ve({inputs:{x:g},backend:n,attrs:{shape:c.outputShape}});return d.forEach(b=>n.disposeIntermediateTensorInfo(b)),x}const rhe={kernelName:Wg,backendName:"webgl",kernelFunc:dM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ihe="return float(a > b);",ohe=`
  return vec4(greaterThan(a, b));
`,ahe=_n({opSnippet:ihe,packedOpSnippet:ohe,cpuKernelImpl:oae,dtype:"bool"}),lhe={kernelName:jg,backendName:"webgl",kernelFunc:ahe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const che="return float(a >= b);",uhe=`
  return vec4(greaterThanEqual(a, b));
`,dhe=_n({opSnippet:che,packedOpSnippet:uhe,dtype:"bool",cpuKernelImpl:aae}),hhe={kernelName:mh,backendName:"webgl",kernelFunc:dhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fhe(t){const{inputs:e,backend:n}=t,{input:s}=e;return uM(s,!0,n)}const phe={kernelName:hw,backendName:"webgl",kernelFunc:fhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mhe="return float(!isnan(x) && !isinf(x));",ghe=ot({opSnippet:mhe,dtype:"bool"}),xhe={kernelName:xh,backendName:"webgl",kernelFunc:ghe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yhe="return float(isinf(x));",bhe=ot({opSnippet:yhe,dtype:"bool"}),vhe={kernelName:yh,backendName:"webgl",kernelFunc:bhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const whe="return float(isnan(x));",khe=ot({opSnippet:whe,dtype:"bool"}),Che={kernelName:bh,backendName:"webgl",kernelFunc:khe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const She="return float(a < b);",Ihe=`
  return vec4(lessThan(a, b));
`,$he=_n({opSnippet:She,packedOpSnippet:Ihe,cpuKernelImpl:lae,dtype:"bool"}),Nhe={kernelName:Ug,backendName:"webgl",kernelFunc:$he};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const The="return float(a <= b);",Ehe=`
  return vec4(lessThanEqual(a, b));
`,_he=_n({opSnippet:The,packedOpSnippet:Ehe,cpuKernelImpl:cae,dtype:"bool"}),Rhe={kernelName:Gg,backendName:"webgl",kernelFunc:_he};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ahe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:i}=n,o=uae(s,r,i);return e.makeTensorInfo([o.length],"float32",o)}const Dhe={kernelName:UR,backendName:"webgl",kernelFunc:Ahe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fhe=Jc+`
  return x < 0.0 ? 0./0. : log(x);
`,Ohe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,Phe=ot({opSnippet:Fhe,packedOpSnippet:Ohe,cpuKernelImpl:dae}),Lhe={kernelName:vh,backendName:"webgl",kernelFunc:Phe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mhe=Jc+`
  return log(1.0 + x);
`,zhe=ot({opSnippet:Mhe}),Bhe={kernelName:wh,backendName:"webgl",kernelFunc:zhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Whe="return float(a >= 1.0 && b >= 1.0);",jhe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,Vhe=_n({opSnippet:Whe,packedOpSnippet:jhe,dtype:"bool"}),Uhe={kernelName:Hg,backendName:"webgl",kernelFunc:Vhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ghe="return float(!(x >= 1.0));",Hhe=ot({opSnippet:Ghe}),Khe={kernelName:Kg,backendName:"webgl",kernelFunc:Hhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xhe="return float(a >= 1.0 || b >= 1.0);",qhe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,Yhe=_n({opSnippet:Xhe,packedOpSnippet:qhe,dtype:"bool"}),Qhe={kernelName:Xg,backendName:"webgl",kernelFunc:Yhe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jhe{constructor(e,n,s,r,i){this.variableNames=["x"],this.outputShape=[];const o=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zhe{constructor(e,n,s,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const efe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=s,c=ee().getBool("WEBGL_PACK_NORMALIZATION")?new Zhe(r.shape,i,o,a,l):new Jhe(r.shape,i,o,a,l);return n.runWebGLProgram(c,[r],r.dtype)},tfe={kernelName:qg,backendName:"webgl",kernelFunc:efe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nfe{constructor(e,n,s,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=s,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sfe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s,d=new nfe(r.shape,a,l,c,u);return n.runWebGLProgram(d,[r,i,o],r.dtype)},rfe={kernelName:pw,backendName:"webgl",kernelFunc:sfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ife(t,e,n,s){const r=re(e),o=re(t.shape)/r,a=ve({inputs:{x:t},attrs:{shape:[o,r]},backend:s}),l=Cl(a,t.dtype,"max",s),c=ve({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hM(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:i,keepDims:o}=s,a=r.shape.length,l=Qe(i,r.shape);let c=l;const u=Wt(c,a),d=u!=null,h=n.shouldExecuteOnCPU([r]);let f=r;if(d){if(h){const v=n.texData.get(f.dataId).values,w=new Array(a);for(let T=0;T<w.length;T++)w[T]=r.shape[u[T]];const C=kC(v,r.shape,r.dtype,u,w);f=n.makeTensorInfo(w,r.dtype);const $=n.texData.get(f.dataId);$.values=C}else f=Yx(r,u,n);c=qt(c.length,a)}En("max",c,a);const[p,m]=kn(f.shape,c);let g=p;o&&(g=rn(p,l));let x;if(h){const v=n.texData.get(f.dataId).values,w=hae(v,re(m),g,r.dtype);x=n.makeTensorInfo(g,r.dtype);const C=n.texData.get(x.dataId);C.values=w}else x=ife(f,m,g,n);return d&&n.disposeIntermediateTensorInfo(f),x}const ofe={kernelName:Yg,backendName:"webgl",kernelFunc:hM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const afe=CC+`
  return max(a, b);
`,lfe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+kl+`
  return result;
`,cfe=_n({opSnippet:afe,packedOpSnippet:lfe,cpuKernelImpl:fae}),ufe={kernelName:kh,backendName:"webgl",kernelFunc:cfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dfe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;uf(r,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;R(zn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=gr(r.shape,i,o,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&ft(u.inShape,u.outShape))return As({inputs:{x:r},backend:n});const d=new zd(u,"max",!1);return n.runWebGLProgram(d,[r],r.dtype)}const hfe={kernelName:Qg,backendName:"webgl",kernelFunc:dfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ffe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dataFormat:l,dimRoundingMode:c}=s,u=[1,1,1],d=Yi(r.shape,i,o,u,a,c,l),h=new IC(d,"max",!1);return n.runWebGLProgram(h,[r],r.dtype)}const pfe={kernelName:Jg,backendName:"webgl",kernelFunc:ffe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mfe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,a=i-1-e.padInfo.top,l=o-1-e.padInfo.left,c=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class gfe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=l-1-e.padInfo.front,h=c-1-e.padInfo.top,f=u-1-e.padInfo.left,p=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${h}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xfe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,d=[1,1,1],h=Yi(o.shape,a,l,d,c,u),f=new IC(h,"max",!0),p=n.runWebGLProgram(f,[o],o.dtype),m=new gfe(h),g=n.runWebGLProgram(m,[r,p],o.dtype);return n.disposeIntermediateTensorInfo(p),g}const yfe={kernelName:gw,backendName:"webgl",kernelFunc:xfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bfe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i,output:o}=e,a=i;uf([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=s,h=gr(a.shape,l,c,1,u,d),f=!0,p=new zd(h,"max",f),m=n.runWebGLProgram(p,[a],a.dtype),g=new mfe(h),x=n.runWebGLProgram(g,[r,m],a.dtype);return n.disposeIntermediateTensorInfo(m),x}const vfe={kernelName:mw,backendName:"webgl",kernelFunc:bfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wfe(t,e,n,s){let r=new zd(n,"max",!1);const i=s.runWebGLProgram(r,[t],"float32");r=new zd(n,"max",!0,!0,e);const o=s.runWebGLProgram(r,[t],"float32");return[i,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kfe={kernelName:GR,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;R(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];R(zn(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=gr(s.shape,r,i,c,o),[d,h]=wfe(s,a,u,l);return[d,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cfe(t,e,n,s){const r=re(e),o=re(t.shape)/r,a=ve({inputs:{x:t},attrs:{shape:[o,r]},backend:s}),l=Cl(a,"float32","mean",s),c=ve({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sfe={kernelName:Zg,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{keepDims:r,axis:i}=e,o=n,a=s.shape.length,l=Qe(i,s.shape);let c=l;const u=Wt(c,a),d=u!=null,h=o.shouldExecuteOnCPU([s]),f=[];let p=s;if(d){if(h){const w=o.texData.get(p.dataId).values,C=new Array(a);for(let N=0;N<C.length;N++)C[N]=s.shape[u[N]];const $=kC(w,s.shape,s.dtype,u,C);p=o.makeTensorInfo(C,s.dtype);const T=o.texData.get(p.dataId);T.values=$}else p=Yx(s,u,o);f.push(p),c=qt(c.length,a)}En("sum",c,a);const[m,g]=kn(p.shape,c);let x=m;r&&(x=rn(m,l));const b=Cfe(p,g,x,o);for(const v of f)o.disposeIntermediateTensorInfo(v);return b}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ife(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=Qe(i,r.shape);let c=l;const u=Wt(c,a);let d=r;u!=null&&(d=Zn({inputs:{x:r},backend:n,attrs:{perm:u}}),c=qt(c.length,r.shape.length)),En("min",c,a);const[h,f]=kn(d.shape,c),p=re(f),m=ve({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),g=Cl(m,m.dtype,"min",n);let x;if(o){const b=rn(h,l);x=ve({inputs:{x:g},backend:n,attrs:{shape:b}})}else x=ve({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),x}const $fe={kernelName:ex,backendName:"webgl",kernelFunc:Ife};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nfe=CC+`
  return min(a, b);
`,Tfe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+kl+`
  return result;
`,Efe=_n({opSnippet:Nfe,packedOpSnippet:Tfe,cpuKernelImpl:pae}),_fe={kernelName:Ch,backendName:"webgl",kernelFunc:Efe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rfe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=n.map((u,d)=>u[0]+e[d]+u[1]);const r=e.length,i=bt(r),o=n.map(u=>u[0]).join(","),a=n.map((u,d)=>u[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Afe{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,m)=>p[0]+e[m]+p[1]);const r=e.length,i=bt(r),o=n.map(p=>p[0]).join(","),a=n.map((p,m)=>p[0]+e[m]).join(","),l=Xn("rc",r),c=Xn("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${c.slice(-2).join()})`,h=s==="reflect"?0:1;let f="";if(r===1){const p=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
      `}else{const p=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${p}
          result[2] = getChannel(getX(${c.join()}), ${d});
          ${l[r-1]} += 1;
          if(${u}) {
            ${p}
            result[3] = getChannel(getX(${c.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dfe=({inputs:t,backend:e,attrs:n})=>{const{x:s}=t,{paddings:r,mode:i}=n,o=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Afe(s.shape,r,i):new Rfe(s.shape,r,i);return e.runWebGLProgram(o,[s],s.dtype)},Ffe={kernelName:tx,backendName:"webgl",kernelFunc:Dfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ofe=`if (b == 0.0) return NAN;
  return mod(a, b);`,Pfe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+kl+`
  return result;
`,Lfe=_n({opSnippet:Ofe,packedOpSnippet:Pfe}),Mfe={kernelName:Sh,backendName:"webgl",kernelFunc:Lfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zfe{constructor(e,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bfe=`
if (a == b) {
  return 1.0;
};
return a / b;`,Wfe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,fM=_n({opSnippet:Bfe,packedOpSnippet:Wfe,checkOutOfBounds:!0}),jfe={kernelName:lh,backendName:"webgl",kernelFunc:fM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MN="return a - b;",pM=_n({opSnippet:MN,packedOpSnippet:MN,supportsComplex:!0,cpuKernelImpl:Oae}),Vfe={kernelName:Bh,backendName:"webgl",kernelFunc:pM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mM(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:i}=s,o=Qe([i],r.shape),a=hM({inputs:{x:r},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),l=rn(a.shape,o),c=ve({inputs:{x:a},backend:n,attrs:{shape:l}}),u=pM({inputs:{a:r,b:c},backend:n}),d=cM({inputs:{x:u},backend:n}),h=Qx({inputs:{x:d},backend:n,attrs:{axis:o,keepDims:!1}}),f=ve({inputs:{x:h},backend:n,attrs:{shape:l}}),p=fM({inputs:{a:d,b:f},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}const Ufe={kernelName:bx,backendName:"webgl",kernelFunc:mM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gfe(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:i,seed:o,normalized:a}=s,l=a?r:mM({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),c=l.shape[0],u=l.shape[1],d=new zfe(c,u,i),h=[[o]],f=n.runWebGLProgram(d,[l],"int32",h);return a||n.disposeIntermediateTensorInfo(l),f}const Hfe={kernelName:HR,backendName:"webgl",kernelFunc:Gfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kfe=yr+`
  return -x;
`,Xfe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function qfe(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])){const i=n.texData.get(s.dataId),[o,a]=gae(i.values,s.shape,s.dtype);return n.makeTensorInfo(a,s.dtype,o)}let r;return ee().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new wo(s.shape,Xfe):r=new ui(s.shape,Kfe),n.runWebGLProgram(r,[s],s.dtype)}const Yfe={kernelName:nx,backendName:"webgl",kernelFunc:qfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qfe=dk;function Jfe(t){Ps("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=s,c=n.readSync(r.dataId),u=n.readSync(i.dataId),{selectedIndices:d}=Qfe(c,u,o,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const Zfe={kernelName:xw,backendName:"webgl",kernelFunc:Jfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const epe=hk;function tpe(t){Ps("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s,u=n.readSync(r.dataId),d=n.readSync(i.dataId),{selectedIndices:h,validOutputs:f}=epe(u,d,o,a,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const npe={kernelName:yw,backendName:"webgl",kernelFunc:tpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const spe=fk;function rpe(t){Ps("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s,u=n.readSync(r.dataId),d=n.readSync(i.dataId),h=o,f=a,p=l,m=c,{selectedIndices:g,selectedScores:x}=spe(u,d,h,f,p,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}const ipe={kernelName:bw,backendName:"webgl",kernelFunc:rpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ope{constructor(e,n,s,r){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ape=t=>{const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:i,depth:o,onValue:a,offValue:l}=s,c=re(r.shape),u=new ope(c,o,a,l),d=ve({inputs:{x:r},backend:n,attrs:{shape:[c]}}),h=n.runWebGLProgram(u,[d],i);n.disposeIntermediateTensorInfo(d);const f=[...r.shape,o],p=ve({inputs:{x:h},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(h),p},lpe={kernelName:ix,backendName:"webgl",kernelFunc:ape};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hm(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="complex64"){const r=hf({inputs:{input:s},backend:n}),i=Hm({inputs:{x:r},backend:n}),o=Jx({inputs:{input:s},backend:n}),a=Hm({inputs:{x:o},backend:n}),l=oa({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return ff({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const cpe={kernelName:kx,backendName:"webgl",kernelFunc:Hm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gM(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=hf({inputs:{input:s},backend:n}),i=gM({inputs:{x:r},backend:n}),o=Jx({inputs:{input:s},backend:n}),a=Hm({inputs:{x:o},backend:n}),l=oa({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return ff({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const upe={kernelName:rx,backendName:"webgl",kernelFunc:gM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dpe(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return k1({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const i=e[0].shape,o=e[0].dtype;e.forEach(u=>{Bv(i,u.shape,"All tensors passed to stack must have matching shapes"),R(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const d=k1({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(d),d}),c=tM({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const hpe={kernelName:ox,backendName:"webgl",kernelFunc:dpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fpe{constructor(e,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,u)=>c[0]+e[u]+c[1]);const r=e.length,i=bt(r),o=n.map(c=>c[0]).join(","),a=n.map((c,u)=>c[0]+e[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ppe{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((m,g)=>m[0]+e[g]+m[1]);const r=e.length,i=bt(r),o=n.map(m=>m[0]).join(","),a=n.map((m,g)=>m[0]+e[g]).join(","),l=Xn("rc",r),c=Xn("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${c.slice(-2).join()})`,h=[`${i} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${u}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${u}) {`],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let m=0,g=r===1?2:4;m<g;m++)p+=`
        ${h[m]}
        if (${f}) {
          result[${m}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${m}] = getChannel(getX(${c.join()}), ${d});
        }
      `;p+=r===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xM=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,constantValue:o}=s;if(re(r.shape)===0){const c=i.map((u,d)=>u[0]+r.shape[d]+u[1]);return ff({backend:n,attrs:{shape:c,value:o,dtype:r.dtype}})}const a=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ppe(r.shape,i,o):new fpe(r.shape,i,o),l=[[o]];return n.runWebGLProgram(a,[r],r.dtype,l)},mpe={kernelName:ax,backendName:"webgl",kernelFunc:xM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gpe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,xpe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+kl+`
  return result;
`,ype=_n({opSnippet:gpe,packedOpSnippet:xpe}),bpe={kernelName:$h,backendName:"webgl",kernelFunc:ype};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vpe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=[],c=Qe(i,r.shape);let u=c;const d=Wt(u,a);let h=r;d!=null&&(h=Zn({inputs:{x:r},backend:n,attrs:{perm:d}}),u=qt(u.length,a),l.push(h)),En("prod",u,a);let f;if(n.shouldExecuteOnCPU([h])){const p=n.texData.get(h.dataId).values,{outVals:m,outShape:g,outDtype:x}=yae(h.shape,h.dtype,p,u);f=n.makeTensorInfo(g,x,m)}else{const[p,m]=kn(h.shape,u),g=re(m),x=ve({inputs:{x:h},backend:n,attrs:{shape:[-1,g]}}),b=Aw(r.dtype),v=Cl(x,b,"prod",n);f=ve({inputs:{x:v},backend:n,attrs:{shape:p}}),l.push(x),l.push(v)}if(o){l.push(f);const p=rn(f.shape,c);f=ve({inputs:{x:f},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const wpe={kernelName:cx,backendName:"webgl",kernelFunc:vpe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kpe(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=s,l=r.map(x=>n.readSync(x.dataId)),c=r.map(x=>x.shape),u=n.readSync(i.dataId),d=n.readSync(o.dataId),[h,f,p]=bae(l,c,u,i.shape,i.dtype,d,o.shape,a),m=h.map(x=>n.makeTensorInfo([x.length],"int32",x)),g=n.makeTensorInfo(p,i.dtype,f);return m.concat([g])}const Cpe={kernelName:KR,backendName:"webgl",kernelFunc:kpe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Spe(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:i}=e,o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=vae(o,s.shape,s.dtype,a,r.shape,l,i.shape),d=n.makeTensorInfo([c.length],"int32",c),h=n.makeTensorInfo([u.length],s.dtype,u);return[d,h]}const Ipe={kernelName:XR,backendName:"webgl",kernelFunc:Spe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $pe(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.readSync(r.dataId),u=n.readSync(i.dataId),d=n.readSync(o.dataId),h=a.map(g=>n.readSync(g.dataId)),f=a.map(g=>g.shape),[p,m]=wae(c,r.shape,u,i.shape,i.dtype,d,o.shape,h,f,l);return n.makeTensorInfo(p,i.dtype,m)}const Npe={kernelName:qR,backendName:"webgl",kernelFunc:$pe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yM=t=>{const{backend:e,attrs:n}=t,{start:s,stop:r,step:i,dtype:o}=n,a=kae(s,r,i,o);return e.makeTensorInfo([a.length],o,a)},Tpe={kernelName:vw,backendName:"webgl",kernelFunc:yM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Epe="return 1.0 / x;",_pe=ot({opSnippet:Epe}),Rpe={kernelName:Nh,backendName:"webgl",kernelFunc:_pe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ape=yr+`
  return (x < 0.0) ? 0.0 : x;
`,Dpe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Fpe=ot({opSnippet:Ape,packedOpSnippet:Dpe}),Ope={kernelName:Th,backendName:"webgl",kernelFunc:Fpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ppe=yr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Lpe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Mpe=ot({opSnippet:Ppe,packedOpSnippet:Lpe}),zpe={kernelName:Eh,backendName:"webgl",kernelFunc:Mpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bpe{constructor(e,n,s,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let h;i?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wpe{constructor(e,n,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let h;i?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jpe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s,[l,c]=a,u=ee().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Wpe(r.shape,l,c,i,o):new Bpe(r.shape,l,c,i,o);return n.runWebGLProgram(u,[r],"float32")}const Vpe={kernelName:hx,backendName:"webgl",kernelFunc:jpe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Upe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,i]=n,[,o,a]=e,l=[s&&o>1?r-1:r,s&&a>1?i-1:i],c=[s&&o>1?o-1:o,s&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,p=Math.ceil(h)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gpe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s,a=new Upe(i.shape,r.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const Hpe={kernelName:Cw,backendName:"webgl",kernelFunc:Gpe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kpe{constructor(e,n,s,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],h=r?"0.5":"0.0";let f;i?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xpe{constructor(e,n,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],h=r?"0.5":"0.0";let f;i?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qpe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s,[l,c]=a,u=ee().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Xpe(r.shape,l,c,i,o):new Kpe(r.shape,l,c,i,o);return n.runWebGLProgram(u,[r],r.dtype)}const Ype={kernelName:dx,backendName:"webgl",kernelFunc:qpe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qpe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,i]=n,[,o,a]=e,l=[s&&o>1?r-1:r,s&&a>1?i-1:i],c=[s&&o>1?o-1:o,s&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,p=Math.ceil(h)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jpe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s,a=new Qpe(i.shape,r.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const Zpe={kernelName:kw,backendName:"webgl",kernelFunc:Jpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eme{constructor(e,n){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,i=e.map((a,l)=>r(l)).join(","),o=bt(s);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tme{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=Xn("rc",s),i=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,o=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,a=bt(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${i}){
            result.g = ${c(r.slice())};
          }
          if(${o}) {
            result.b = ${u(r.slice())};
            if(${i}) {
              result.a = ${d(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return h(p)}function c(p){return p[s-1]="("+p[s-1]+" + 1)",h(p)}function u(p){return p[s-2]="("+p[s-2]+" + 1)",h(p)}function d(p){return p[s-1]="("+p[s-1]+" + 1)",p[s-2]="("+p[s-2]+" + 1)",h(p)}function h(p){const m=e.map((b,v)=>f(v,p)),g=m.join(","),x=m.slice(-2).join(",");return`getChannel(getX(${g}), vec2(${x}))`}function f(p,m){return n.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${m[p]} - 1`:`${m[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:i}=s,o=r.shape.length,a=Qe(i,r.shape);if(o===0)return As({inputs:{x:r},backend:n});const l=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new tme(r.shape,a):new eme(r.shape,a);return n.runWebGLProgram(l,[r],r.dtype)}const sme={kernelName:fx,backendName:"webgl",kernelFunc:nme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rme{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let i="";typeof n=="number"?i=`float outputValue = ${n.toFixed(2)};`:i=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ime={kernelName:_w,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:i,center:o}=e,a=n,l=new rme(s.shape,i),[c,u]=Sk(o,s.shape[1],s.shape[2]),d=[[c,u,Math.sin(r),Math.cos(r)]];return a.runWebGLProgram(l,[s],s.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ome=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,ame=ot({opSnippet:ome}),lme={kernelName:_h,backendName:"webgl",kernelFunc:ame};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cme="return inversesqrt(x);",ume=ot({opSnippet:cme,cpuKernelImpl:Cae}),dme={kernelName:Rh,backendName:"webgl",kernelFunc:ume};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $C{constructor(e,n,s,r,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const c=bt(i.length),u=bt(o.length);let d="";s===1?d="i":s===2&&(d="i, j");const h=`getIndices(${d})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let m="";l&&(m="coords[0], coords[1]");const g=`getDefaultValue(${m})`,x=n>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${x};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${g}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hme{constructor(e,n,s,r,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const c=bt(i.length),u=bt(o.length);let d="";s===1?d="i":s===2&&(d="i, j");const h=`getIndices(${d})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let m="";l&&(m="coords[0], coords[1]");const g=`getDefaultValue(${m})`,x=n>1?"strides[j]":"strides",b=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${x};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${b};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${g}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fme(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:i}=e,{shape:o}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=xl(i,r,o),h=[d/c,c];if(d===0)return n.makeTensorInfo(o,r.dtype);const f=ve({inputs:{x:r},backend:n,attrs:{shape:[l,a]}}),p=ve({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let g;ee().getBool("WEBGL_PACK")?g=new hme(l,a,f.shape.length,p.shape.length,u,h):g=new $C(l,a,f.shape.length,p.shape.length,u,h);const x=n.runWebGLProgram(g,[p,f,m],p.dtype),b=ve({inputs:{x},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(m),b}const pme={kernelName:YR,backendName:"webgl",kernelFunc:fme};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mme{constructor(e,n,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const i="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=ee().getNumber("WEBGL_VERSION")===2?i:o,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gme(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:i}=e,{side:o}=s,a=new mme(r.shape[0],r.shape[1],i.shape[1],o),l=[[r.shape[1]]];return n.runWebGLProgram(a,[r,i],"int32",l)}const xme={kernelName:JR,backendName:"webgl",kernelFunc:gme};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yme{constructor(e,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let r,i;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)i="resRC",r="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<n.length;u++)c.push(`${a[u]}`),u<e&&l.push(`${a[u]}`);r=l.join(),i=c.join()}const o=bt(s);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bme(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:i}=e,o=new yme(s.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(o,[s,r,i],_s(r.dtype,i.dtype))}const vme={kernelName:px,backendName:"webgl",kernelFunc:bme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wme=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${Fx};
  float scale = ${Ox};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,kme=ot({opSnippet:wme}),Cme={kernelName:Ah,backendName:"webgl",kernelFunc:kme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sme=Jc+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,Ime=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,$me=ot({opSnippet:Sme,packedOpSnippet:Ime,cpuKernelImpl:Iae}),Nme={kernelName:Ph,backendName:"webgl",kernelFunc:$me};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tme=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,Eme=ot({opSnippet:Tme}),_me={kernelName:Oh,backendName:"webgl",kernelFunc:Eme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rme=Jc+`
  return sin(x);
`,Ame=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${kl}
  return result;
`,Dme=ot({opSnippet:Rme,packedOpSnippet:Ame}),Fme={kernelName:Dh,backendName:"webgl",kernelFunc:Dme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ome=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Pme=ot({opSnippet:Ome}),Lme={kernelName:Fh,backendName:"webgl",kernelFunc:Pme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mme=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,zme=ot({opSnippet:Mme}),Bme={kernelName:Lh,backendName:"webgl",kernelFunc:zme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wme=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,paddings:o}=s;R(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((x,b)=>x*b),l=[[0,0]];l.push(...o);for(let x=1+i.length;x<r.shape.length;++x)l.push([0,0]);const c=[],u=xM({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),d=Yh(u.shape,i,a,!1),h=Qh(d.length,i.length,!1),f=Jh(u.shape,i,a,!1),p=ve({inputs:{x:u},backend:n,attrs:{shape:d}}),m=Zn({inputs:{x:p},backend:n,attrs:{perm:h}}),g=ve({inputs:{x:m},backend:n,attrs:{shape:f}});return c.push(u),c.push(p),c.push(m),c.forEach(x=>n.disposeIntermediateTensorInfo(x)),g},jme={kernelName:xx,backendName:"webgl",kernelFunc:Wme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vme(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.readSync(s.dataId),l=n.readSync(r.dataId),c=n.readSync(i.dataId),u=n.readSync(o.dataId)[0],[d,h,f,p,m]=Nae(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(h,s.dtype,d),n.makeTensorInfo([h[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),n.makeTensorInfo([m.length],s.dtype,new Int32Array(m))]}const Ume={kernelName:ZR,backendName:"webgl",kernelFunc:Vme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gme(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:i}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.readSync(r.dataId)),a=n.readSync(s.dataId),l=Array.from(n.readSync(i.dataId)),[c,u,d]=Tae(a,s.shape,s.dtype,o,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const Hme={kernelName:eA,backendName:"webgl",kernelFunc:Gme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kme(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=jL(o,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const Xme={kernelName:tA,backendName:"webgl",kernelFunc:Kme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qme(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=jL(o,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const Yme={kernelName:nA,backendName:"webgl",kernelFunc:qme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qme(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:i,defaultValue:o}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=xl(i,r,a),f=!1;if(i.dtype==="string"){const x=n.bufferSync(r),b=n.bufferSync(i),v=Bo(n.readSync(o.dataId)[0]),w=Sae(x,b,a,h,u,c,l,d,v,f);return n.makeTensorInfo(a,w.dtype,w.values)}const p=new $C(c,l,r.shape.length,i.shape.length,d,[h,1],f),m=n.runWebGLProgram(p,[i,r,o],i.dtype),g=ve({inputs:{x:m},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(m),g}const Jme={kernelName:sA,backendName:"webgl",kernelFunc:Qme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:i,axis:o}=s,a=Qe(o,r.shape)[0],l=zk(r,i,a),c=r.shape.length,u=new Array(c).fill(0),d=r.shape.slice();return l.map(h=>{const f=[...d];f[a]=h;const p=Zc({inputs:{x:r},backend:n,attrs:{begin:u,size:f}});return u[a]+=h,p})}const ege={kernelName:yx,backendName:"webgl",kernelFunc:Zme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zN="return sqrt(x);",tge=ot({opSnippet:zN,packedOpSnippet:zN,cpuKernelImpl:Eae}),nge={kernelName:Mh,backendName:"webgl",kernelFunc:tge};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sge="return x * x;",rge=ot({opSnippet:sge}),ige={kernelName:Sw,backendName:"webgl",kernelFunc:rge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BN="return (a - b) * (a - b);",oge=_n({opSnippet:BN,packedOpSnippet:BN}),age={kernelName:zh,backendName:"webgl",kernelFunc:oge};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const i=n.readSync(r.dataId),o=Ki(i),a=_ae(o,"string",s);return n.makeTensorInfo(r.shape,"string",a)}const cge={kernelName:Iw,backendName:"webgl",kernelFunc:lge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uge({inputs:t,attrs:e,backend:n}){const{x:s}=t,r=yr+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new ui(s.shape,r);return n.runWebGLProgram(i,[s],s.dtype)}const dge={kernelName:Uh,backendName:"webgl",kernelFunc:uge};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hge{constructor(e,n,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,i=bt(s.length),o=bt(s.length);let a="";if(r===1)a="coords * strides + begin";else{let l=0;a=s.map((c,u)=>(l++,s.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=s,{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:x,begin:b,end:v,strides:w}=wk(r.shape,i,o,a,l,c,u,d,h);let C;if(m)C=ve({inputs:{x:r},backend:n,attrs:{shape:p}});else if(g||x){R(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const T=yk(b,v,w),N=Zc({inputs:{x:r},backend:n,attrs:{begin:b,size:T}});C=ve({inputs:{x:N},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(N)}else if(n.shouldExecuteOnCPU([r])){const N=n.readSync(r.dataId),_=Ye(r.shape,r.dtype,N),A=Rae(f,_,w,b);C=n.makeTensorInfo(p,r.dtype,A.values)}else{const N=new hge(b,w,f);C=n.runWebGLProgram(N,[r],r.dtype)}const $=ve({inputs:{x:C},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(C),$}const pge={kernelName:$w,backendName:"webgl",kernelFunc:fge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mge(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:d}=e,h=n.readSync(u.dataId),f=n.readSync(d.dataId),[p,m]=Aae(h,f,r,i,o,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",m)]}const gge={kernelName:rA,backendName:"webgl",kernelFunc:mge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xge(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],[c,u,d]=Dae(a,l,r),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const yge={kernelName:iA,backendName:"webgl",kernelFunc:xge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bge(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),a=Fae(o,r);return n.makeTensorInfo(i.shape,"int32",a)}const vge={kernelName:oA,backendName:"webgl",kernelFunc:bge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wge="return tan(x);",kge=ot({opSnippet:wge}),Cge={kernelName:Wh,backendName:"webgl",kernelFunc:kge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sge=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,Ige=ot({opSnippet:Sge}),$ge={kernelName:jh,backendName:"webgl",kernelFunc:Ige};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nge(t){const{inputs:e,backend:n,attrs:s}=t,{tensor:r,indices:i,updates:o}=e,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=xl(o,i,r.shape),h=[d/c,c];if(d===0)return n.makeTensorInfo(r.shape,i.dtype);const f=ve({inputs:{x:i},backend:n,attrs:{shape:[l,a]}}),p=ve({inputs:{x:o},backend:n,attrs:{shape:[l,c]}}),m=ve({inputs:{x:r},backend:n,attrs:{shape:h}}),g=new $C(l,a,f.shape.length,p.shape.length,u,h,!1,!0),x=n.runWebGLProgram(g,[p,f,m],m.dtype),b=ve({inputs:{x},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),b}const Tge={kernelName:QR,backendName:"webgl",kernelFunc:Nge};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ege{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[o]*n[o];this.outputShape=s,this.rank=s.length;const r=bt(this.rank),i=_ge(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function _ge(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<t.length;r++)s.push(`imod(${n[r]}, ${t[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bM(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:i}=s;if(r.dtype==="string"||r.shape.length>5){const l=n.readSync(r.dataId),c=r.dtype==="string"?l.map(h=>Bo(h)):l,u=Ye(r.shape,r.dtype,c),d=Pae(u,i);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const o=new Ege(r.shape,i);return n.runWebGLProgram(o,[r],r.dtype)}const Rge={kernelName:Vh,backendName:"webgl",kernelFunc:bM};class Age{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class Dge{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pa(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function WN(t){let e=1;for(;e<t;)e*=2;return e}function Fge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:i,sorted:o}=s,a=ee().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=ee().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=r.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([r])||u<a||i>l){const A=n.readSync(r.dataId),[O,W]=Lae(A,c,r.dtype,i,o);return[n.makeTensorInfo(O.shape,O.dtype,O.values),n.makeTensorInfo(W.shape,W.dtype,W.values)]}if(i===0)return c[c.length-1]=0,[n.makeTensorInfo(c,r.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(u===1)return[r,ff({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const d=n.texData.get(r.dataId),h=d!==null&&d.isPacked,f=h?n.unpackTensor(r):r,m=re(c)/u,g=ve({inputs:{x:f},attrs:{shape:[m,u]},backend:n});h&&pa(n,f);const x=WN(i),b=WN(u);let v=null;const w=()=>v===null?[g,g]:[g,v],C=(A,O,W)=>{const G=w(),q=new Age(W),Y=[[u],[v===null?1:0],[Number.NEGATIVE_INFINITY],[A],[O]],te=v;v=n.runWebGLProgram(q,G,"int32",Y),pa(n,te)};for(let A=1;A<x;A*=2){const O=A*2;for(let W=A;W>=1;W/=2)C(O,W,[m,b])}for(let A=b;A>x;A/=2){const O=w(),W=new Dge([m,A/2]),q=[[u],[v===null?1:0],[x]],U=v;v=n.runWebGLProgram(W,O,"int32",q),pa(n,U);const Y=x/2,te=Y*2;for(let M=Y;M>=1;M/=2)C(te,M,v.shape)}let $=v;v=Zc({inputs:{x:v},backend:n,attrs:{begin:0,size:[m,i]}}),pa(n,$);let T=dM({inputs:{x:g,indices:v},backend:n,attrs:{axis:1,batchDims:1}});pa(n,g);const N=c.slice(0,-1);N.push(i),$=v,v=ve({inputs:{x:v},attrs:{shape:N},backend:n}),pa(n,$);const _=T;return T=ve({inputs:{x:T},attrs:{shape:N},backend:n}),pa(n,_),[T,v]}const Oge={kernelName:Nw,backendName:"webgl",kernelFunc:Fge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pge{constructor(e,n,s,r,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lge(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=s,[u,d,h,f]=r.shape,[p,m]=c??[d,h],g=[u,p,m,f],x=new Pge(d,h,o,a,l,g);return n.runWebGLProgram(x,[r,i],"float32")}const Mge={kernelName:Tw,backendName:"webgl",kernelFunc:Lge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zge(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:i}=e;uf(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=s.readSync(i.dataId),{outputValues:a,outputShape:l,indices:c}=Mae(o,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const Bge={kernelName:Ew,backendName:"webgl",kernelFunc:zge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wge(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:i}=s;i<0&&(i+=r.shape.length);const o=r,a=o.shape.length,l=r.shape[i],c=new Array(a-1);let u=0;for(let m=0;m<a;m++)m!==i&&(c[u++]=o.shape[m]);const d=[],h=new Array(a).fill(0),f=o.shape.slice();f[i]=1;const p=new Array(l);for(let m=0;m<p.length;m++){h[i]=m;const g=Zc({inputs:{x:o},backend:n,attrs:{begin:h,size:f}}),x=ve({inputs:{x:g},backend:n,attrs:{shape:c}});p[m]=x,d.push(g)}return d.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const jge={kernelName:vx,backendName:"webgl",kernelFunc:Wge};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vge{constructor(e,n){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,i=e.inSize,o=e.numSegments,a=o*Math.ceil(i/s);this.outputShape=[r,a];const l="0.0",c="sumValue",u=Math.floor(s/4)*4,d=s%4,h=`
        sumValue += dot(values, segFilter);
    `;let f="";i%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let p="";i%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:i}=e,{numSegments:o}=s,a=r.shape.length,l=[];let c=0;const u=Wt([c],a);let d=r;u!=null&&(d=Zn({inputs:{x:r},backend:n,attrs:{perm:u}}),l.push(d),c=qt(1,a)[0]);const h=eF(d.shape,c,o),f=re([d.shape[c]]),p=ve({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}});l.push(p);const m=Aw(r.dtype),g=(w,C,$,T,N)=>{const _=w.shape[0],A=w.shape[1],O=ZD(A,N),W={windowSize:O,inSize:A,batchSize:_,numSegments:N},G=new Vge(W,C),q=n.compileAndRun(G,[w,$],T);if(l.push(q),q.shape[1]===N)return q;const U=yM({backend:n,attrs:{start:0,stop:N,step:1,dtype:"float32"}}),Y=bM({inputs:{x:U},backend:n,attrs:{reps:[A/O]}});return l.push(U),l.push(Y),g(q,C,Y,T,N)},x=g(p,"unsortedSegmentSum",i,m,o),b=ve({inputs:{x},backend:n,attrs:{shape:h}});let v=b;if(u!=null){l.push(b);const w=ea(u);v=Zn({inputs:{x:v},backend:n,attrs:{perm:w}})}return l.forEach(w=>n.disposeIntermediateTensorInfo(w)),v}const Gge={kernelName:wx,backendName:"webgl",kernelFunc:Uge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hge=[Ele,Rle,Fle,Lle,zle,jle,Ule,Hle,Yle,Jle,tce,rce,ace,dce,pce,gce,yce,kce,Sce,$ce,_ce,Lce,zce,Vce,Gce,Qce,Zce,sue,hle,oue,due,mue,wue,Sue,$ue,Tue,_ue,Fue,Lue,Bue,jue,Uue,Hue,que,Que,tde,sde,ode,cde,dde,mde,bde,Cde,$de,Ede,_de,Ade,Fde,Pde,Mde,Bde,Ude,Kde,Yde,Jde,the,rhe,lhe,hhe,dle,phe,cue,xhe,vhe,Che,ple,Nhe,Rhe,Dhe,Lhe,Bhe,Uhe,Khe,Qhe,tfe,rfe,ofe,ufe,hfe,pfe,yfe,vfe,kfe,Sfe,$fe,_fe,Ffe,Mfe,Hfe,xle,Yfe,Zfe,npe,ipe,Kce,lpe,upe,hpe,mpe,bpe,gle,wpe,Cpe,Ipe,Npe,Tpe,Xce,jfe,Rpe,Ope,zpe,ble,Vpe,Hpe,Ype,Zpe,sme,ime,lme,dme,pme,xme,vme,Cme,Nme,_me,Fme,Lme,Oce,Ufe,Bme,jme,Ume,Hme,Xme,Yme,Jme,ege,nge,ige,age,cge,dge,pge,gge,yge,vge,Vfe,$le,Cge,$ge,Tge,Rge,Oge,Mge,Nle,Bge,jge,Gge,cpe];for(const t of Hge)lA(t);function Kge(){const t=J.useRef(null),e=J.useRef(null),[n,s]=J.useState(!1),[r,i]=J.useState(0),[o,a]=J.useState("none"),[l,c]=J.useState("Position yourself in view"),[u,d]=J.useState(0),[h,f]=J.useState(0),[p,m]=J.useState(100),[g,x]=J.useState(!1),[b,v]=J.useState(0),w=cl(),C=new URLSearchParams(w.search),$=(C.get("name")||"Bodyweight Squats").toString(),T=(C.get("reps")||"").toString(),N=(C.get("gif")||"").toString(),_=parseInt((C.get("idx")||"0").toString(),10),[A,O]=J.useState(""),[W,G]=J.useState(null),[q,U]=J.useState([]),[Y,te]=J.useState({}),[M,X]=J.useState({}),Z=J.useRef(null),oe={"3/4 sit-up":"34-sit-up","bench dip (knees bent)":"bench-dip-knees-bent","left hook. boxing":"left-hook-boxing","archer push up":"archer-push-ups","archer pull up":"archer-pull-up","astride jumps (male)":"astride-jumps-male","all fours squad stretch":"all-fours-squad-stretch","ankle circles":"ankle-circles","bear crawl":"bear-crawl.","back and forth step":"back-and-forth-step."};J.useEffect(()=>{const ue=setInterval(()=>d(le=>le+1),1e3);return()=>clearInterval(ue)},[]),J.useEffect(()=>{if(!g)return;if(b<=0){x(!1),ae("Rest complete, let's go!");return}const ue=setInterval(()=>v(le=>le-1),1e3);return()=>clearInterval(ue)},[g,b]),J.useEffect(()=>{const ue={squat:.32,push:.29,plank:.15,jump:.4,burpee:.5,lunge:.25};let le=0;for(const[me,he]of Object.entries(ue))if($.toLowerCase().includes(me)){le=he;break}f(Math.round(r*le*10)/10)},[r]);function ae(ue){const le=window.speechSynthesis;if(!le)return;const me=new SpeechSynthesisUtterance(ue);me.rate=.9,me.pitch=1,le.cancel(),le.speak(me)}function ce(ue,le){const me=le[ue];me&&(i(0),a("none"),window.location.href=`/trainer?name=${encodeURIComponent(me.name)}&reps=${encodeURIComponent(me.repetitions||"")}&gif=${encodeURIComponent(me.gif_url||"")}&idx=${ue}`)}function pe(ue){const le=(ue||"").toLowerCase().trim(),me=le.match(/^(\d+)\s*x\s*(\d+)$/);if(me){const $e=parseInt(me[1],10),Le=parseInt(me[2],10);if(!isNaN($e)&&!isNaN(Le))return $e*Le}const he=parseInt(le,10);return isNaN(he)?null:he}function fe(){if(!q.length)return;const ue=_+1;if(ue>=q.length){ae("Workout complete. Great job!"),c(" Workout complete!"),setTimeout(()=>window.history.back(),3e3);return}const le=q[ue];i(0),a("none"),x(!0),v(30),ae(`Rest for 30 seconds. Next: ${le.name}`),setTimeout(()=>{window.location.href=`/trainer?name=${encodeURIComponent(le.name)}&reps=${encodeURIComponent(le.repetitions||"")}&gif=${encodeURIComponent(le.gif_url||"")}&idx=${ue}`},31e3)}J.useEffect(()=>{G(pe(T));try{const ue=sessionStorage.getItem("workoutPlan")||"[]",le=JSON.parse(ue),me=Array.isArray(le)?le:[];if(U(me),!C.get("name")&&me.length>0){const he=me[0];window.location.replace(`/trainer?name=${encodeURIComponent(he.name)}&reps=${encodeURIComponent(he.repetitions||"")}&gif=${encodeURIComponent(he.gif_url||"")}&idx=0`)}}catch{U([])}},[]),J.useEffect(()=>{W!==null&&r>=W&&(ae("Exercise complete"),fe())},[r,W]);function be(ue){const le=e.current,me=t.current;if(!le||!me)return;const he=le.getContext("2d");(le.width!==me.videoWidth||le.height!==me.videoHeight)&&(le.width=me.videoWidth,le.height=me.videoHeight),he.save(),he.clearRect(0,0,le.width,le.height),he.scale(-1,1),he.drawImage(me,-le.width,0,le.width,le.height),he.setTransform(1,0,0,1,0,0);const $e=ue.poseLandmarks;if(!$e){he.restore();return}he.lineWidth=3,he.strokeStyle="#10b981",he.lineCap="round";for(const[Le,Re]of oy.POSE_CONNECTIONS){const We=$e[Le],nt=$e[Re];((We==null?void 0:We.visibility)??0)>.5&&((nt==null?void 0:nt.visibility)??0)>.5&&(he.beginPath(),he.moveTo((1-We.x)*le.width,We.y*le.height),he.lineTo((1-nt.x)*le.width,nt.y*le.height),he.stroke())}$e.forEach(Le=>{((Le==null?void 0:Le.visibility)??0)>.5&&(he.beginPath(),he.arc((1-Le.x)*le.width,Le.y*le.height,4,0,2*Math.PI),he.fillStyle="#ffffff",he.fill())}),he.restore()}function Ne(ue){return(ue||"").toLowerCase().replace(/[^a-z0-9\s-]/g,"").trim().replace(/\s+/g,"-")}J.useEffect(()=>{const ue=$.toLowerCase(),le=oe[ue],me=le?`/gifs/${le}.gif`:null,he=`/gifs/${Ne($)}.gif`,$e=(We,nt)=>{const Ge=new Image;Ge.onload=()=>O(We),Ge.onerror=nt,Ge.src=We},Le=()=>{$e(he,()=>{O(""),c("GIF not found - using live guidance")})},Re=()=>{me?$e(me,()=>{Le()}):Le()};N?$e(N,()=>{Re()}):Re()},[$,N]);function Te(ue,le,me){const he={x:ue.x-le.x,y:ue.y-le.y},$e={x:me.x-le.x,y:me.y-le.y},Le=he.x*$e.x+he.y*$e.y,Re=Math.sqrt(he.x**2+he.y**2),We=Math.sqrt($e.x**2+$e.y**2),nt=Le/(Re*We);return Math.acos(Math.min(1,Math.max(-1,nt)))*180/Math.PI}J.useEffect(()=>{if(!A)return;const ue=new Image;ue.crossOrigin="anonymous",ue.onload=async()=>{const le=document.createElement("canvas"),me=le.getContext("2d");le.width=ue.width,le.height=ue.height,me.drawImage(ue,0,0),Z.current||(Z.current=new oy.Pose({locateFile:he=>`https://cdn.jsdelivr.net/npm/@mediapipe/pose/${he}`}),Z.current.setOptions({modelComplexity:1,smoothLandmarks:!0,enableSegmentation:!1})),Z.current.onResults(he=>{const $e=he.poseLandmarks;if(!$e)return;const Le=$.toLowerCase(),Re={hip:$e[23],knee:$e[25],ankle:$e[27],shoulder:$e[11],elbow:$e[13],wrist:$e[15],ear:$e[7]},We={hip:$e[24],knee:$e[26],ankle:$e[28],shoulder:$e[12],elbow:$e[14],wrist:$e[16],ear:$e[8]},nt={};Le.includes("squat")?(nt.knee=Math.round(Te(Re.hip,Re.knee,Re.ankle)),nt.back=Math.round(Te(Re.ear,Re.shoulder,Re.hip))):Le.includes("push")||Le.includes("press-up")?(nt.elbow=Math.round(Te(Re.shoulder,Re.elbow,Re.wrist)),nt.hip=Math.round(Te(Re.shoulder,Re.hip,Re.ankle))):Le.includes("astride")||Le.includes("jump")?(nt.spread=Math.round(Math.abs(Re.ankle.x-We.ankle.x)*100),nt.kneeL=Math.round(Te(Re.hip,Re.knee,Re.ankle)),nt.kneeR=Math.round(Te(We.hip,We.knee,We.ankle))):nt.shoulders=Math.round(Math.abs(Re.shoulder.y-We.shoulder.y)*100),X(nt)}),await Z.current.send({image:le})},ue.src=A},[A,$]);function De(ue){const le=ue.poseLandmarks;if(!le)return;const me=$.toLowerCase(),he={hip:le[23],knee:le[25],ankle:le[27],shoulder:le[11],elbow:le[13],wrist:le[15],ear:le[7]},$e={hip:le[24],knee:le[26],ankle:le[28],shoulder:le[12],elbow:le[14],wrist:le[16],ear:le[8]},Le=me.includes("jump")||me.includes("run")||me.includes("jog")||me.includes("sprint")||me.includes("step");let Re=100;if(me.includes("squat")){const Ge=Te(he.hip,he.knee,he.ankle),on=Te(he.ear,he.shoulder,he.hip),pt=M.knee||90,gn=M.back||150;Ge<pt+10?(o!=="down"&&(a("down"),c(" Great Depth!")),Re-=Math.abs(Ge-pt)*.5):Ge>pt+70&&(o==="down"?(a("up"),i(_t=>_t+1),c(" Good Rep!"),ae("Nice")):o!=="up"&&a("up")),on<gn-10&&(c(" Keep back straight"),ae("Keep your back straighter"),Re-=10),Math.abs(Ge-pt)>20&&(c(" Match the knee bend in the GIF"),ae("Bend your knees more like in the demo")),te({knee:Math.round(Ge),back:Math.round(on)}),m(Math.max(0,Re));return}if(me.includes("push")||me.includes("press-up")){const Ge=Te(he.shoulder,he.elbow,he.wrist),on=Te(he.shoulder,he.hip,he.ankle),pt=M.elbow||60,gn=M.hip||150;Ge<pt+10?(o!=="down"&&(a("down"),c(" Lower down controlled")),Re-=Math.abs(Ge-pt)*.5):Ge>pt+90&&(o==="down"?(a("up"),i(_t=>_t+1),c(" Strong lockout"),ae("Nice rep")):o!=="up"&&a("up")),on<gn-10&&(c(" Keep body straight"),ae("Keep your core tight"),Re-=10),Math.abs(Ge-pt)>20&&(c(" Match the elbow bend in the GIF"),ae("Lower your body more like in the demo")),te({elbow:Math.round(Ge),hip:Math.round(on)}),m(Math.max(0,Re));return}if(me.includes("astride")||me.includes("jump")){const Ge=Math.abs(he.ankle.x-$e.ankle.x),on=Te(he.hip,he.knee,he.ankle),pt=Te($e.hip,$e.knee,$e.ankle),gn=(M.spread||18)/100,_t=M.kneeL||170,fs=M.kneeR||170;Ge>gn+.04?o!=="down"&&(a("down"),c(" Wide stance")):Ge<gn-.06&&o==="down"&&(a("up"),i(ts=>ts+1),c(" Soft landing")),Ge<gn-.02&&o==="down"&&(c(" Wider stance"),Re-=5),on>_t+10&&pt>fs+10&&o!=="down"&&(c(" Bend knees on landing"),Re-=10),Math.abs(Ge-gn)>.05&&(c(" Match the stance in the GIF"),ae("Adjust your foot position")),te({spread:Math.round(Ge*100),kneeL:Math.round(on),kneeR:Math.round(pt)}),m(Math.max(0,Re));return}const We=Math.abs(he.shoulder.y-$e.shoulder.y),nt=(M.shoulders||5)/100;Le||(We>nt+.02?(c(" Square your shoulders"),ae("Square your shoulders"),Re-=5):c(" Good form")),Math.abs(We-nt)>.02&&(c(" Match shoulder alignment in the GIF"),ae("Align your shoulders properly")),te({shoulders:Math.round(We*100)}),m(Math.max(0,Re))}J.useEffect(()=>{const ue=t.current;ue&&navigator.mediaDevices.getUserMedia({video:{width:640,height:480}}).then(le=>{ue.srcObject=le,ue.play().then(()=>s(!0))})},[]),J.useEffect(()=>{if(!n||!t.current)return;const ue=new oy.Pose({locateFile:he=>`https://cdn.jsdelivr.net/npm/@mediapipe/pose/${he}`});ue.setOptions({modelComplexity:1,smoothLandmarks:!0,enableSegmentation:!1}),ue.onResults(he=>{be(he),De(he)});let le=0;async function me(){t.current&&(await ue.send({image:t.current}),le=requestAnimationFrame(me))}return me(),()=>cancelAnimationFrame(le)},[n]);const je=ue=>{const le=Math.floor(ue/60),me=ue%60;return`${le}:${me.toString().padStart(2,"0")}`};return S.jsxs("div",{className:"trainer-page",children:[S.jsx("style",{children:`
        .trainer-page {
          min-height: 100vh;
          background: #0f172a;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          color: white;
          font-family: 'Inter', system-ui, sans-serif;
          padding: 20px;
        }

        .main-workspace {
          display: flex;
          flex-direction: row;
          align-items: flex-start;
          gap: 24px;
          max-width: 1100px;
          width: 100%;
          justify-content: center;
        }

        .hud-container {
          position: relative;
          width: 640px;
          height: 480px;
          border-radius: 24px;
          overflow: hidden;
          box-shadow: 0 20px 50px rgba(0,0,0,0.5);
          border: 1px solid #334155;
          background: #000;
        }

        .gif-panel {
          width: 320px;
          background: #1e293b;
          border: 1px solid #334155;
          border-radius: 24px;
          padding: 20px;
          display: flex;
          flex-direction: column;
          gap: 16px;
          box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .gif-panel img { 
          width: 100%; 
          border-radius: 12px; 
          background: #0f172a;
          aspect-ratio: 1/1;
          object-fit: cover;
        }

        .gif-info h4 { margin: 0; font-size: 1.1rem; color: #f8fafc; }
        .gif-info p { margin: 8px 0 0 0; font-size: 0.9rem; color: #94a3b8; }

        .plan-list { display: flex; flex-direction: column; gap: 10px; max-height: 200px; overflow-y: auto; }
        .plan-item { 
          display: flex; align-items: center; justify-content: space-between;
          background: #0f172a; border: 1px solid #334155; color: #e2e8f0;
          padding: 10px 12px; border-radius: 12px; cursor: pointer; font-weight: 700;
        }
        .plan-item.active { border-color: #10b981; color: #10b981; }
        .plan-item .secondary { font-size: 0.75rem; color: #94a3b8; font-weight: 800; }

        .rep-counter {
          position: absolute;
          top: 20px;
          left: 20px;
          background: #10b981;
          padding: 10px 20px;
          border-radius: 16px;
          text-align: center;
          z-index: 10;
        }

        .rep-count { font-size: 2rem; font-weight: 900; line-height: 1; display: block; }
        .rep-label { font-size: 0.7rem; text-transform: uppercase; font-weight: 700; }

        .feedback-pill {
          position: absolute;
          bottom: 20px;
          left: 50%;
          transform: translateX(-50%);
          background: rgba(15, 23, 42, 0.95);
          padding: 12px 24px;
          border-radius: 100px;
          font-weight: 600;
          color: #10b981;
          border: 1px solid rgba(16, 185, 129, 0.3);
          z-index: 10;
          max-width: 85%;
          text-align: center;
        }

        .status-badge {
          position: absolute;
          top: 20px;
          right: 20px;
          background: rgba(0, 0, 0, 0.5);
          padding: 6px 12px;
          border-radius: 8px;
          font-size: 0.7rem;
          display: flex;
          align-items: center;
          gap: 6px;
          z-index: 10;
        }

        .dot { width: 6px; height: 6px; background: #ef4444; border-radius: 50%; animation: blink 1s infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }

        .angle-panel {
          position: absolute;
          top: 80px;
          left: 20px;
          background: rgba(2, 6, 23, 0.75);
          border: 1px solid rgba(16,185,129,0.3);
          padding: 10px 12px;
          border-radius: 12px;
          display: grid;
          grid-template-columns: auto auto;
          gap: 8px 12px;
          font-size: 0.8rem;
          color: #e2e8f0;
          z-index: 10;
        }
        .angle-item { display: contents; }
        .angle-label { color: #10b981; font-weight: 800; }
        .angle-value { font-weight: 700; }

        .metrics-panel {
          position: absolute;
          top: 20px;
          left: 50%;
          transform: translateX(-50%);
          background: rgba(2, 6, 23, 0.9);
          border: 1px solid rgba(16, 185, 129, 0.3);
          padding: 12px 20px;
          border-radius: 12px;
          display: flex;
          gap: 30px;
          font-size: 0.85rem;
          z-index: 10;
        }

        .metric-item { display: flex; flex-direction: column; align-items: center; }
        .metric-label { color: #94a3b8; font-size: 0.7rem; }
        .metric-value { color: #10b981; font-weight: 800; font-size: 1rem; }

        .form-score {
          position: absolute;
          bottom: 80px;
          right: 20px;
          background: rgba(2, 6, 23, 0.9);
          border: 1px solid rgba(16, 185, 129, 0.3);
          padding: 12px 16px;
          border-radius: 12px;
          text-align: center;
          z-index: 10;
        }

        .form-score-value { font-size: 1.5rem; font-weight: 900; color: #10b981; }
        .form-score-label { font-size: 0.65rem; color: #94a3b8; text-transform: uppercase; }

        .rest-overlay {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.7);
          display: flex;
          align-items: center;
          justify-content: center;
          flex-direction: column;
          z-index: 100;
          border-radius: 24px;
        }

        .rest-timer { font-size: 4rem; font-weight: 900; color: #fbbf24; }
        .rest-text { font-size: 1rem; color: #e2e8f0; margin-top: 10px; }

        .controls { margin-top: 32px; }
        .exit-btn {
          background: #ef4444;
          color: white;
          border: none;
          padding: 12px 40px;
          border-radius: 12px;
          font-weight: 700;
          cursor: pointer;
          transition: 0.3s;
        }
        .exit-btn:hover { background: #dc2626; }

        @media (max-width: 1000px) {
          .main-workspace { flex-direction: column; align-items: center; }
          .hud-container, .gif-panel { width: 100%; max-width: 640px; }
        }
      `}),S.jsxs("div",{className:"main-workspace",children:[S.jsxs("div",{className:"hud-container",children:[S.jsx("video",{ref:t,width:640,height:480,style:{display:"none"}}),S.jsx("canvas",{ref:e}),S.jsxs("div",{className:"rep-counter",children:[S.jsx("span",{className:"rep-count",children:r}),S.jsx("span",{className:"rep-label",children:"Reps"})]}),S.jsxs("div",{className:"status-badge",children:[S.jsx("div",{className:"dot"})," LIVE AI"]}),S.jsxs("div",{className:"metrics-panel",children:[S.jsxs("div",{className:"metric-item",children:[S.jsx("span",{className:"metric-label",children:"Time"}),S.jsx("span",{className:"metric-value",children:je(u)})]}),S.jsxs("div",{className:"metric-item",children:[S.jsx("span",{className:"metric-label",children:"Calories"}),S.jsx("span",{className:"metric-value",children:h})]}),S.jsxs("div",{className:"metric-item",children:[S.jsx("span",{className:"metric-label",children:"Target"}),S.jsx("span",{className:"metric-value",children:T})]})]}),S.jsx("div",{className:"feedback-pill",children:l}),S.jsxs("div",{className:"form-score",children:[S.jsxs("div",{className:"form-score-value",children:[p,"%"]}),S.jsx("div",{className:"form-score-label",children:"Form Score"})]}),S.jsx("div",{className:"angle-panel",children:Object.entries(Y).map(([ue,le])=>S.jsxs("div",{className:"angle-item",children:[S.jsx("span",{className:"angle-label",children:ue.toUpperCase()}),S.jsxs("span",{className:"angle-value",children:[le,""]})]},ue))}),g&&S.jsxs("div",{className:"rest-overlay",children:[S.jsx("div",{className:"rest-timer",children:b}),S.jsx("div",{className:"rest-text",children:"Rest Time"})]})]}),S.jsxs("div",{className:"gif-panel",children:[A&&S.jsx("img",{src:A,alt:$,onError:ue=>{ue.target.style.display="none",c("GIF not found - using live guidance")}}),S.jsxs("div",{className:"gif-info",children:[S.jsx("h4",{children:$}),S.jsxs("p",{children:["Target: ",S.jsx("strong",{children:T||"N/A"})]}),Object.keys(M).length>0&&S.jsxs("div",{className:"reference-angles",children:[S.jsx("p",{children:"Reference Angles:"}),Object.entries(M).map(([ue,le])=>S.jsxs("span",{className:"ref-angle",children:[ue.toUpperCase(),": ",le," "]},ue))]})]}),S.jsx("div",{className:"plan-list",children:q.map((ue,le)=>S.jsxs("div",{className:`plan-item ${le===_?"active":""}`,onClick:()=>ce(le,q),children:[S.jsx("span",{children:ue.name}),S.jsx("span",{className:"secondary",children:ue.repetitions||"N/A"})]},`${ue.name}-${le}`))})]})]}),S.jsx("div",{className:"controls",children:S.jsx("button",{className:"exit-btn",onClick:()=>window.history.back(),children:"Finish Session"})})]})}function Xge(){const[t,e]=J.useState(""),[n,s]=J.useState(100),[r,i]=J.useState(0),[o,a]=J.useState("remain fit and healthy"),[l,c]=J.useState([]),[u,d]=J.useState([]),[h,f]=J.useState(0),[p,m]=J.useState(null),[g,x]=J.useState(!1),b=J.useRef(null);J.useEffect(()=>{cn.get("/profile").then(_=>a(_.data.motive||"remain fit and healthy")),cn.get("/images/foods").then(_=>{const A=Array.isArray(_.data)?_.data:[];c(A),d(A),A.length>0&&(e(A[0]),v(A[0]))}).catch(_=>console.error("Could not load food list",_));const N=_=>{b.current&&!b.current.contains(_.target)&&x(!1)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]);async function v(N){try{const _=await cn.get("/images/nutrition",{params:{food:N}});_.data&&(m(_.data),f(Number(_.data.calories_per_100g||0)))}catch{m(null),f(0)}}const w=N=>{e(N);const _=l.filter(A=>A.toLowerCase().includes(N.toLowerCase()));d(_),x(!0),i(0)},C=N=>{e(N),x(!1),v(N)},$=()=>{const N=Math.round(h*n/100);i(N)},T=N=>{if(!p)return 0;const _=Object.keys(p).find(O=>N.some(W=>O.toLowerCase().includes(W.toLowerCase()))),A=_?p[_]:0;return Number(A)*n/100};return S.jsxs("div",{className:"analyzer-wrapper",children:[S.jsxs("div",{className:"analyzer-card",children:[S.jsxs("div",{className:"header",children:[S.jsxs("div",{className:"brand",children:[S.jsx("div",{className:"logo",children:""}),S.jsx("h3",{children:"Nutrition"})]}),S.jsx("span",{className:"goal-badge",children:o})]}),S.jsxs("div",{className:"calc-inputs",children:[S.jsxs("div",{className:"input-group search-container",ref:b,children:[S.jsx("label",{children:"Food Item"}),S.jsx("input",{type:"text",placeholder:"Type or select...",value:t,onFocus:()=>x(!0),onChange:N=>w(N.target.value)}),g&&u.length>0&&S.jsx("div",{className:"custom-dropdown",children:u.map(N=>S.jsx("div",{className:"dropdown-item",onClick:()=>C(N),children:N},N))})]}),S.jsxs("div",{className:"input-group",children:[S.jsx("label",{children:"Weight (g)"}),S.jsx("input",{type:"number",value:n,onChange:N=>s(Number(N.target.value))})]})]}),S.jsx("button",{className:"compute-btn",onClick:$,children:"Generate Report"}),S.jsxs("div",{className:`result-area ${r>0?"visible":""}`,children:[S.jsx("div",{className:"result-header",children:S.jsxs("div",{className:"kcal-box",children:[S.jsx("span",{className:"number",children:r}),S.jsx("span",{className:"label",children:"Total kcal"})]})}),S.jsxs("div",{className:"nutri-grid",children:[S.jsxs("div",{className:"nutri-item",children:[S.jsx("span",{children:"Protein"}),S.jsxs("strong",{children:[T(["protein"]).toFixed(1),"g"]})]}),S.jsxs("div",{className:"nutri-item",children:[S.jsx("span",{children:"Carbs"}),S.jsxs("strong",{children:[T(["carb","carbohydrate"]).toFixed(1),"g"]})]}),S.jsxs("div",{className:"nutri-item",children:[S.jsx("span",{children:"Fat"}),S.jsxs("strong",{children:[T(["fat"]).toFixed(1),"g"]})]}),S.jsxs("div",{className:"nutri-item",children:[S.jsx("span",{children:"Fiber"}),S.jsxs("strong",{children:[T(["fibre","fiber"]).toFixed(1),"g"]})]})]})]})]}),S.jsx("style",{children:`
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap');
        .analyzer-wrapper { display: flex; justify-content: center; align-items: center; min-height: 100vh; background: #f8fafc; font-family: 'Plus Jakarta Sans', sans-serif; padding: 20px; }
        .analyzer-card { width: 100%; max-width: 440px; background: #fff; border-radius: 32px; padding: 32px; box-shadow: 0 20px 50px rgba(0,0,0,0.05); }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; }
        .brand { display: flex; align-items: center; gap: 10px; }
        .brand h3 { margin: 0; font-size: 18px; color: #1e293b; }
        .goal-badge { background: #eff6ff; color: #3b82f6; padding: 6px 12px; border-radius: 100px; font-size: 11px; font-weight: 700; }
        .drop-zone { display: flex; align-items: center; gap: 15px; padding: 16px; background: #f8fafc; border: 2px dashed #e2e8f0; border-radius: 20px; cursor: pointer; }
        .icon-circle { width: 44px; height: 44px; background: #fff; border-radius: 12px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .text-content strong { display: block; font-size: 14px; color: #1e293b; }
        .text-content p { margin: 0; font-size: 11px; color: #94a3b8; }
        .calc-inputs { display: grid; grid-template-columns: 1.5fr 1fr; gap: 12px; margin: 20px 0; position: relative; }
        .input-group label { display: block; font-size: 11px; font-weight: 700; color: #64748b; margin-bottom: 6px; }
        .input-group input { width: 100%; padding: 12px; border-radius: 12px; border: 1px solid #e2e8f0; font-family: inherit; font-size: 14px; }
        .search-container { position: relative; }
        .custom-dropdown { 
          position: absolute; top: 100%; left: 0; right: 0; background: #fff; 
          border: 1px solid #e2e8f0; border-radius: 12px; z-index: 100; 
          max-height: 200px; overflow-y: auto; box-shadow: 0 10px 25px rgba(0,0,0,0.1); margin-top: 5px;
        }
        .dropdown-item { padding: 10px 15px; font-size: 13px; cursor: pointer; transition: 0.2s; }
        .dropdown-item:hover { background: #f1f5f9; color: #6366f1; }
        .compute-btn { width: 100%; padding: 14px; background: #1e293b; color: #fff; border: none; border-radius: 15px; font-weight: 800; cursor: pointer; }
        .result-area { margin-top: 25px; display: none; }
        .result-area.visible { display: block; animation: fadeIn 0.4s ease; }
        .kcal-box { text-align: center; }
        .kcal-box .number { font-size: 40px; font-weight: 800; color: #1e293b; }
        .kcal-box .label { font-size: 12px; color: #94a3b8; font-weight: 600; text-transform: uppercase; }
        .nutri-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; }
        .nutri-item { background: #f8fafc; padding: 12px; border-radius: 15px; display: flex; flex-direction: column; gap: 2px; }
        .nutri-item span { font-size: 10px; color: #94a3b8; font-weight: 700; text-transform: uppercase; }
        .nutri-item strong { font-size: 16px; color: #1e293b; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .scanning { border-color: #6366f1 !important; animation: pulse 1.5s infinite; }
        @keyframes pulse { 50% { opacity: 0.6; } }
      `})]})}const jN=window.SpeechRecognition||window.webkitSpeechRecognition,Zr=jN?new jN:null;function qge(){const[t,e]=J.useState(""),[n,s]=J.useState(""),[r,i]=J.useState([]),[o,a]=J.useState(!1),[l,c]=J.useState(!1);J.useEffect(()=>{Zr&&(Zr.continuous=!1,Zr.interimResults=!1,Zr.lang="en-US",Zr.onresult=p=>{const m=p.results[0][0].transcript;e(g=>g+(g?" ":"")+m),c(!1)},Zr.onerror=()=>c(!1),Zr.onend=()=>c(!1))},[]);const u=()=>{if(!Zr)return alert("Voice recognition not supported in this browser.");l?Zr.stop():(c(!0),Zr.start())};async function d(){if(!(!t.trim()&&r.length===0))try{a(!0);const p=new FormData;p.append("message",t),r.forEach(g=>p.append("images",g));const m=await cn.post("/chat/ask",p,{headers:{"Content-Type":"multipart/form-data"}});s(m.data.answer)}catch(p){console.error(p)}finally{a(!1)}}const h=p=>{const m=p.target.files;m&&i(g=>[...g,...Array.from(m)])},f=p=>{i(r.filter((m,g)=>g!==p))};return S.jsxs("div",{className:"center-container",children:[S.jsxs("div",{className:"medium-chat-card",children:[S.jsxs("header",{className:"chat-header",children:[S.jsxs("div",{className:"status-indicator",children:[S.jsx("span",{className:"pulse"}),S.jsx("strong",{children:"Medical AI"})]}),S.jsx("span",{className:"mode-tag",children:"Encrypted Voice & Vision"})]}),S.jsxs("div",{className:"chat-viewport",children:[!n&&!o&&S.jsxs("div",{className:"empty-chat",children:[S.jsx("div",{className:"ai-avatar",children:""}),S.jsx("p",{children:"Speak or upload images to begin diagnosis."})]}),o&&S.jsxs("div",{className:"typing-indicator",children:["AI is analyzing",S.jsx("span",{children:"."}),S.jsx("span",{children:"."}),S.jsx("span",{children:"."})]}),n&&S.jsx("div",{className:"response-bubble",children:S.jsx("p",{children:n})})]}),S.jsxs("div",{className:"chat-input-area",children:[S.jsx("div",{className:"upload-previews",children:r.map((p,m)=>S.jsxs("div",{className:"thumb",children:[S.jsx("img",{src:URL.createObjectURL(p),alt:"upload"}),S.jsx("button",{className:"remove-btn",onClick:()=>f(m),children:""})]},m))}),S.jsxs("div",{className:"input-row",children:[S.jsxs("label",{className:"action-icon",title:"Upload Images",children:["",S.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:h,hidden:!0})]}),S.jsx("button",{className:`action-icon ${l?"mic-active":""}`,onClick:u,title:"Voice Input",children:l?"":""}),S.jsx("input",{className:"main-input",value:t,onChange:p=>e(p.target.value),placeholder:l?"Listening...":"Describe symptoms...",onKeyDown:p=>p.key==="Enter"&&d()}),S.jsx("button",{className:"send-circle",onClick:d,disabled:o,children:o?"...":""})]})]})]}),S.jsx("style",{children:`
        .center-container { display: flex; justify-content: center; align-items: center; min-height: 80vh; padding: 20px; font-family: sans-serif; }
        .medium-chat-card { width: 100%; max-width: 480px; background: #fff; border-radius: 24px; box-shadow: 0 12px 40px rgba(0,0,0,0.08); border: 1px solid #f1f5f9; overflow: hidden; display: flex; flex-direction: column; }
        .chat-header { padding: 16px 20px; background: #f8fafc; border-bottom: 1px solid #f1f5f9; display: flex; justify-content: space-between; align-items: center; }
        .status-indicator { display: flex; align-items: center; gap: 8px; font-size: 0.9rem; }
        .pulse { width: 8px; height: 8px; background: #10b981; border-radius: 50%; animation: pulse-green 2s infinite; }
        .mode-tag { font-size: 0.7rem; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.5px; }
        .chat-viewport { height: 350px; padding: 20px; overflow-y: auto; background: #fff; display: flex; flex-direction: column; }
        .empty-chat { text-align: center; margin: auto; color: #94a3b8; }
        .ai-avatar { font-size: 2.5rem; margin-bottom: 10px; }
        .response-bubble { background: #f1f5f9; padding: 14px 18px; border-radius: 18px 18px 18px 4px; font-size: 0.9rem; line-height: 1.5; color: #334155; align-self: flex-start; animation: slideIn 0.3s ease-out; }
        .chat-input-area { padding: 16px; border-top: 1px solid #f1f5f9; }
        .input-row { display: flex; align-items: center; gap: 10px; background: #f8fafc; padding: 6px 15px; border-radius: 30px; border: 1px solid #e2e8f0; }
        .main-input { flex: 1; border: none; background: transparent; outline: none; font-size: 0.9rem; padding: 8px; }
        .action-icon { cursor: pointer; font-size: 1.2rem; background: none; border: none; padding: 0; transition: 0.2s; }
        .mic-active { color: #ef4444; animation: blink 1s infinite; }
        .send-circle { background: #10b981; color: white; border: none; width: 35px; height: 35px; border-radius: 50%; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .send-circle:disabled { background: #cbd5e1; }
        .upload-previews { display: flex; gap: 8px; margin-bottom: 12px; flex-wrap: wrap; }
        .thumb { position: relative; width: 55px; height: 55px; border: 2px solid #f1f5f9; border-radius: 10px; }
        .thumb img { width: 100%; height: 100%; object-fit: cover; border-radius: 8px; }
        .remove-btn { position: absolute; top: -8px; right: -8px; background: #ef4444; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; font-size: 12px; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        
        @keyframes pulse-green { 0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); } 70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(16, 185, 129, 0); } 100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); } }
        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
        @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
      `})]})}function so({children:t}){const[e,n]=J.useState(!1),[s,r]=J.useState(null),[i,o]=J.useState(!0),[a,l]=J.useState(!0),c=ul(),u=cl();J.useEffect(()=>{const p=localStorage.getItem("token");if(!p){c("/signin");return}Ga(p),cn.get("/profile").then(m=>r(m.data)).catch(m=>{var g;((g=m==null?void 0:m.response)==null?void 0:g.status)===401&&(localStorage.removeItem("token"),c("/signin"))}).finally(()=>o(!1))},[c]);const d=()=>{localStorage.removeItem("token"),r(null),c("/signin")},h=p=>{switch(p==null?void 0:p.toLowerCase()){case"underweight":return"#3b82f6";case"healthy":return"#10b981";case"overweight":return"#f59e0b";case"obese":return"#ef4444";default:return"#64748b"}},f=[{path:"/home",label:"Home",icon:""},{path:"/dashboard",label:"Dashboard",icon:""},{path:"/recommendations",label:"My Plan",icon:""},{path:"/trainer",label:"AI Trainer",icon:""},{path:"/reports",label:"Reports",icon:""},{path:"/chat",label:"Chatbot",icon:""},{path:"/images",label:"Calories",icon:""}];return i?S.jsxs("div",{className:"loading-screen",children:[S.jsx("div",{className:"spinner"}),S.jsx("p",{children:"Loading Workspace..."})]}):S.jsxs("div",{className:`app-layout ${a?"sidebar-expanded":"sidebar-collapsed"}`,children:[S.jsx("style",{children:`
        :root {
          --primary: #10b981;
          --primary-dark: #059669;
          --bg-main: #f8fafc;
          --sidebar-bg: #ffffff;
          --text-dark: #1e293b;
          --text-light: #64748b;
          --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .app-layout {
          display: flex;
          min-height: 100vh;
          background-color: var(--bg-main);
          font-family: 'Inter', -apple-system, sans-serif;
        }

        /* --- SIDEBAR --- */
        .sidebar {
          width: 240px;
          background: var(--sidebar-bg);
          border-right: 1px solid #e2e8f0;
          display: flex;
          flex-direction: column;
          position: fixed;
          height: 100vh;
          transition: var(--transition);
          z-index: 100;
        }

        .sidebar-collapsed .sidebar { width: 80px; }

        .sidebar-header {
          padding: 30px 24px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 1.8rem;
        }

        .nav-list {
          flex: 1;
          padding: 12px;
          list-style: none;
        }

        .nav-link {
          display: flex;
          align-items: center;
          padding: 14px 18px;
          margin-bottom: 6px;
          border-radius: 12px;
          text-decoration: none;
          color: var(--text-light);
          font-weight: 500;
          transition: var(--transition);
          gap: 15px;
        }

        .nav-link:hover {
          background: #f1f5f9;
          color: var(--text-dark);
        }

        .nav-link.active {
          background: #ecfdf5;
          color: var(--primary-dark);
          box-shadow: inset 4px 0 0 var(--primary-dark);
        }

        .nav-label {
          opacity: 1;
          transition: var(--transition);
          white-space: nowrap;
        }
        .sidebar-collapsed .nav-label { opacity: 0; pointer-events: none; width: 0; }

        /* --- TOP BAR --- */
        .top-bar {
          height: 70px;
          background: rgba(255, 255, 255, 0.8);
          backdrop-filter: blur(10px);
          border-bottom: 1px solid #e2e8f0;
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 0 30px;
          position: sticky;
          top: 0;
          z-index: 90;
        }

        /* --- CONTENT AREA --- */
        .main-wrapper {
          flex: 1;
          margin-left: 240px;
          transition: var(--transition);
          display: flex;
          flex-direction: column;
        }
        .sidebar-collapsed .main-wrapper { margin-left: 80px; }

        .content-container {
          padding: 30px;
          max-width: 1200px;
          width: 100%;
          margin: 0 auto;
        }

        /* --- PROFILE DROPDOWN --- */
        .user-profile-trigger {
          display: flex;
          align-items: center;
          gap: 12px;
          cursor: pointer;
          padding: 6px 12px;
          border-radius: 50px;
          transition: var(--transition);
          border: 1px solid transparent;
        }
        .user-profile-trigger:hover { 
            background: #ffffff;
            border-color: #e2e8f0;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
        }

        .avatar-circle {
          width: 36px;
          height: 36px;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          font-weight: bold;
          font-size: 0.9rem;
        }

        .dropdown-card {
          position: absolute;
          top: 65px;
          right: 30px;
          width: 260px;
          background: white;
          border-radius: 16px;
          box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04);
          border: 1px solid #e2e8f0;
          padding: 20px;
          z-index: 1000;
          animation: slideDown 0.2s ease-out;
        }

        .dropdown-header { border-bottom: 1px solid #f1f5f9; padding-bottom: 12px; margin-bottom: 12px; }
        .dropdown-header h4 { margin: 0; color: var(--text-dark); font-size: 1rem; }
        .dropdown-header p { margin: 4px 0 0; font-size: 0.8rem; color: var(--text-light); }

        .info-row { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 0.85rem; }
        .info-row span:first-child { color: var(--text-light); }
        .info-row span:last-child { font-weight: 600; color: var(--text-dark); }

        .btn-group { display: flex; flex-direction: column; gap: 8px; margin-top: 15px; }
        .btn { padding: 10px; border-radius: 8px; font-size: 0.85rem; font-weight: 600; cursor: pointer; border: none; transition: 0.2s; text-decoration: none; text-align: center; }
        .btn-update { background: var(--primary); color: white; }
        .btn-signout { background: #f8fafc; color: #ef4444; border: 1px solid #fee2e2; }
        .btn:hover { filter: brightness(0.95); transform: translateY(-1px); }

        .loading-screen { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; color: var(--primary); background: #fff; }
        .spinner { width: 30px; height: 30px; border: 3px solid #f1f5f9; border-top: 3px solid var(--primary); border-radius: 50%; animation: spin 0.8s linear infinite; margin-bottom: 12px; }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-8px); } to { opacity: 1; transform: translateY(0); } }

        @media (max-width: 768px) {
          .sidebar { transform: translateX(-100%); }
          .sidebar-expanded .sidebar { transform: translateX(0); width: 240px; }
          .main-wrapper { margin-left: 0 !important; }
        }
      `}),S.jsxs("aside",{className:"sidebar",children:[S.jsx("div",{className:"sidebar-header"}),S.jsx("nav",{className:"nav-list",children:f.map(p=>S.jsxs(Pi,{to:p.path,className:`nav-link ${u.pathname===p.path?"active":""}`,children:[S.jsx("span",{style:{fontSize:"1.2rem"},children:p.icon}),S.jsx("span",{className:"nav-label",children:p.label})]},p.path))})]}),S.jsxs("main",{className:"main-wrapper",children:[S.jsxs("header",{className:"top-bar",children:[S.jsx("button",{style:{background:"#f1f5f9",border:"none",width:"36px",height:"36px",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#64748b"},onClick:()=>l(!a),children:a?"":""}),S.jsxs("div",{className:"user-profile-trigger",onClick:()=>n(!e),children:[S.jsx("div",{className:"avatar-circle",style:{backgroundColor:h(s==null?void 0:s.bmi_category)},children:s!=null&&s.name?s.name.charAt(0).toUpperCase():""}),S.jsxs("div",{style:{textAlign:"left"},className:"nav-label",children:[S.jsx("div",{style:{fontWeight:600,fontSize:"0.85rem",color:"#1e293b"},children:(s==null?void 0:s.name)||"Guest"}),S.jsx("div",{style:{fontSize:"0.7rem",color:"#94a3b8"},children:(s==null?void 0:s.bmi_category)||"Status"})]})]}),e&&S.jsxs("div",{className:"dropdown-card",children:[S.jsxs("div",{className:"dropdown-header",children:[S.jsx("h4",{children:s==null?void 0:s.name}),S.jsx("p",{children:(s==null?void 0:s.motive)||"Active Member"})]}),S.jsxs("div",{className:"info-row",children:[S.jsx("span",{children:"BMI Category"}),S.jsx("span",{style:{color:h(s==null?void 0:s.bmi_category)},children:s==null?void 0:s.bmi_category})]}),S.jsxs("div",{className:"btn-group",children:[S.jsx(Pi,{to:"/intake",className:"btn btn-update",onClick:()=>n(!1),children:"Update Profile"}),S.jsx("button",{onClick:d,className:"btn btn-signout",children:"Sign Out"})]})]})]}),S.jsx("section",{className:"content-container",children:t})]})]})}function ro({children:t}){const[e,n]=J.useState(!0),[s,r]=J.useState(null);return J.useEffect(()=>{const i=localStorage.getItem("token");r(i),n(!1)},[]),e?null:s?t:S.jsx(wv,{to:"/signin",replace:!0})}function VN({children:t}){return localStorage.getItem("token")?S.jsx(wv,{to:"/dashboard",replace:!0}):t}function Yge(){return S.jsx(yj,{children:S.jsxs(RB,{children:[S.jsx(Zs,{path:"/",element:S.jsx(wv,{to:"/signin",replace:!0})}),S.jsx(Zs,{path:"/signin",element:S.jsx(VN,{children:S.jsx(vj,{})})}),S.jsx(Zs,{path:"/signup",element:S.jsx(VN,{children:S.jsx(bj,{})})}),S.jsx(Zs,{path:"/home",element:S.jsx(ro,{children:S.jsx(so,{children:S.jsx(wj,{})})})}),S.jsx(Zs,{path:"/dashboard",element:S.jsx(ro,{children:S.jsx(so,{children:S.jsx(jG,{})})})}),S.jsx(Zs,{path:"/intake",element:S.jsx(ro,{children:S.jsx(so,{children:S.jsx(UG,{})})})}),S.jsx(Zs,{path:"/recommendations",element:S.jsx(ro,{children:S.jsx(so,{children:S.jsx(GG,{})})})}),S.jsx(Zs,{path:"/reports",element:S.jsx(ro,{children:S.jsx(so,{children:S.jsx(HG,{})})})}),S.jsx(Zs,{path:"/trainer",element:S.jsx(ro,{children:S.jsx(so,{children:S.jsx(Kge,{})})})}),S.jsx(Zs,{path:"/images",element:S.jsx(ro,{children:S.jsx(so,{children:S.jsx(Xge,{})})})}),S.jsx(Zs,{path:"/chat",element:S.jsx(ro,{children:S.jsx(so,{children:S.jsx(qge,{})})})})]})})}const vM=document.getElementById("root");if(!vM)throw new Error("Root container missing in index.html");const Qge=i_(vM);Qge.render(S.jsx(nT.StrictMode,{children:S.jsx(MB,{children:S.jsx(Yge,{})})}));
